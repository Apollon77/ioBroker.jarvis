import{a4 as K,bw as W,Q as v,dp as Ze,dq as V,bt as Y,aG as A,ay as S,U as D,b1 as k,a2 as g,bS as be,bT as se,X as Q,D as Z,bD as Me,bB as M,bU as ie,bV as Le,A as R,bW as xe,af as _e,cB as ge,cC as et,a9 as tt,ck as nt,ac as Ce,bx as st,co as ee,k as P,bQ as le,cK as re,cq as B,b3 as L,bn as z,aF as Te,dr as it,dk as ot,aY as we,r as ze,cS as at,cG as Oe,V as O,W as H,I as U,aE as oe,C as N,bF as lt,bG as Ae,bH as de,a1 as ve,cu as rt,ds as dt,cs as We,u as ct,df as ut,dt as ft,bO as pt,aI as gt,bM as mt,cr as vt,dj as Ne,di as Fe,bp as ht,ct as qe,du as bt,d8 as wt,dv as he,as as yt,d3 as St,aZ as $e,dw as me,dx as kt}from"./index-0d12e9b6.js";import Ct from"./StateList-56166aac.js";import{b as Tt,c as $t,Q as Dt,a as Et}from"./QFooter-b28a874f.js";import{Q as jt}from"./QHeader-ff5d7623.js";import{Q as It}from"./QBtnDropdown-7e7d3c9b.js";import{Q as Ht}from"./QBadge-701d0f05.js";import{m as Pt}from"./marked.esm-56a8835f.js";import"./StateListGroup-3cb7df5a.js";import"./StateListItem-e75199b8.js";var Rt=`
body {
	scrollbar-width: none;
	-ms-overflow-style: none;
	overflow-y: scroll;
}

body::-webkit-scrollbar {
	width: 0px;
	background: transparent;
}`,Bt=`
@media (max-width: $breakpoint-md-min) {
	.container.desktop {
		padding: 0;
		/*grid-template-columns: none !important;*/
		grid-template-rows: none !important;
	}
	
	.container.desktop .widget-scaler {
		transform: none !important;
	}
}

/*
 * TWO COLUMNS
 */
@media (min-width: $breakpoint-sm-min) and (max-width: $breakpoint-md-min) {
	.container.desktop > .box:nth-child(odd) {
		grid-area: auto / auto / auto / auto !important;
		grid-column: 1 / span 6 !important;
	}
	
	.container.desktop > .box:nth-child(even) {
		grid-area: auto / auto / auto / auto !important;
		grid-column: 7 / span 6 !important;
	}
}

/*
 * ONE COLUMN
 */
@media (min-width: 0) and (max-width: $breakpoint-sm-min) {
	.container.desktop > .box {
		grid-area: auto / auto / auto / auto !important;
		grid-column: 1 / span 12 !important;
	}
}
`;const Mt=K({name:"DeviceDetailsPopup",components:{StateList:Ct},setup(){const e=W(),t=v(()=>e.selectedDevice),n=v(()=>{const i=[];for(const a in t.value.states){const l=t.value.states[a];if(l.hide===!0||l.state===void 0&&l.action===void 0)continue;const{label:s,...r}=l;i.push({id:Ze(t.value.id+":"+a,V.get("UUID")),type:"device",deviceId:t.value.id,bodyStateKey:a,primaryStateKey:a,...r,deviceStateDetails:!0})}return{items:i}});return{onClose:()=>e.set("selectedDeviceId",null),device:t,widget:n}}}),Lt={class:"text-h6"};function zt(e,t,n,o,i,a){const l=A("state-list");return S(),D(xe,{"model-value":!!e.device.id,onHide:e.onClose,class:R({"jarvis-popup-container":!0,["jarvis-device-"+e.device.id]:!0})},{default:k(()=>[g(be,{class:"column jarvis-popup",style:{width:"800px","max-width":"95vw","flex-wrap":"nowrap"}},{default:k(()=>[g(se,{class:"row items-center"},{default:k(()=>[Q("div",Lt,Z(e.device.label||e.device.name),1),g(Me),g(M,{flat:"",round:"",color:"grey",icon:"close",onClick:e.onClose},null,8,["onClick"])]),_:1}),g(ie),g(se,{class:"col q-pa-none scroll body",style:{"overflow-x":"hidden"}},{default:k(()=>[g(l,{openDeviceDetails:!1,widget:e.widget,isPopup:""},null,8,["widget"])]),_:1}),g(ie),g(Le,{align:"right"},{default:k(()=>[g(M,{flat:"",label:e.$t("Close"),onClick:e.onClose,color:"primary"},null,8,["label","onClick"])]),_:1})]),_:1})]),_:1},8,["model-value","onHide","class"])}var Ot=Y(Mt,[["render",zt]]);const At={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function Wt(){const{props:e,proxy:{$q:t}}=tt(),n=_e(et,ge);if(n===ge)return console.error("QPageSticky needs to be child of QLayout"),ge;const o=v(()=>{const u=e.position;return{top:u.indexOf("top")>-1,right:u.indexOf("right")>-1,bottom:u.indexOf("bottom")>-1,left:u.indexOf("left")>-1,vertical:u==="top"||u==="bottom",horizontal:u==="left"||u==="right"}}),i=v(()=>n.header.offset),a=v(()=>n.right.offset),l=v(()=>n.footer.offset),s=v(()=>n.left.offset),r=v(()=>{let u=0,h=0;const m=o.value,f=t.lang.rtl===!0?-1:1;m.top===!0&&i.value!==0?h=`${i.value}px`:m.bottom===!0&&l.value!==0&&(h=`${-l.value}px`),m.left===!0&&s.value!==0?u=`${f*s.value}px`:m.right===!0&&a.value!==0&&(u=`${-f*a.value}px`);const b={transform:`translate(${u}, ${h})`};return e.offset&&(b.margin=`${e.offset[1]}px ${e.offset[0]}px`),m.vertical===!0?(s.value!==0&&(b[t.lang.rtl===!0?"right":"left"]=`${s.value}px`),a.value!==0&&(b[t.lang.rtl===!0?"left":"right"]=`${a.value}px`)):m.horizontal===!0&&(i.value!==0&&(b.top=`${i.value}px`),l.value!==0&&(b.bottom=`${l.value}px`)),b}),d=v(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function w(u){const h=nt(u.default);return Ce("div",{class:d.value,style:r.value},e.expand===!0?h:[Ce("div",h)])}return{$layout:n,getStickyContent:w}}var Nt=st({name:"QPageSticky",props:At,setup(e,{slots:t}){const{getStickyContent:n}=Wt();return()=>n(t)}});function Ft(){const e=ee(),t=P(!1);return{jumperIsOpen:t,jumperOpen:(o,i={})=>{const a=le(o);t.value=!0;const l=a.map(s=>new Promise(r=>{const d=w=>{s.icon=w.icon;const u=Iconify.getIcon(s.icon.indexOf(":")===-1?"mdi:"+s.icon:s.icon);if(u){const h=[],m=[];let f;const b=RegExp('(?<= (.+?)=\\")(.+?)(?=\\")',"g");for(;(f=b.exec(u.body))!==null;)if(f.index===b.lastIndex&&b.lastIndex++,f[1]==="d")h[h.length]=f[2];else{const C=m.length;m[C]=m[C]||[],m[C].push([f[1],f[2]])}s.icon=h.map((C,E)=>{const y=m[E].map(c=>c[0]+":"+c[1]);return C+"@@"+y.join("@@")}).join("&&")+"|"+u.left+" "+u.top+" "+u.width+" "+u.height}r(s)};s.icon&&typeof s.icon=="object"?re.getBindings({config:{icon:s.icon}},d):s.icon&&d({icon:s.icon})}));Promise.allSettled(l).then(s=>{const r=s.map(d=>d.value);e.bottomSheet({...i,actions:r}).onOk(d=>i.onSuccess&&i.onSuccess(d)).onCancel(()=>i.onCancel&&i.onCancel()).onDismiss(()=>{t.value=!1})})}}}const qt=K({name:"Container",props:["tabsCount"],setup(e){B.dev("DEBUG","Container","setup()");const t=W(),n=v(()=>t.drawerMiniMode);return{settings:v(()=>t.settings),drawerMiniMode:n,onHeaderReveals:a=>{B.dev("DEBUG","Container","onHeaderReveals()"),t.set("headerVisible",a)}}}});function Vt(e,t,n,o,i,a){return e.settings.tabsBottom!==!0?L((S(),D(jt,{key:0,class:"jarvis-header text-white",bordered:"",onReveal:e.onHeaderReveals,reveal:e.settings.tabsShow==="hide"},{default:k(()=>[Te(e.$slots,"default")]),_:3},8,["onReveal","reveal"])),[[z,e.drawerMiniMode!==!0||e.drawerMiniMode===!0&&e.tabsCount>1]]):L((S(),D(Tt,{key:1,class:"jarvis-footer text-white",bordered:"",onReveal:e.onHeaderReveals,reveal:e.settings.tabsShow==="hide"},{default:k(()=>[Te(e.$slots,"default")]),_:3},8,["onReveal","reveal"])),[[z,e.drawerMiniMode!==!0||e.drawerMiniMode===!0&&e.tabsCount>1]])}var Qt=Y(qt,[["render",Vt]]);const Ut=K({name:"Tabs",props:["page","tabs"],setup(e){B.dev("DEBUG","Tabs","setup()");const t=ee(),n=W(),o=it(),i=ot.isPro(),a=P([]),l=p=>{const T=a.value.findIndex(j=>j.id===p.id);a.value[T]={...p,revision:at().substr(0,5)}};we(()=>e.tabs,()=>{B.dev("DEBUG","Tabs","tabsWithResolvedBindings()"),a.value=le(e.tabs);for(const p of a.value)p.config=le(p),re.getBindings(p,l)},{immediate:!0});const s=v(()=>n.drawerMiniMode),r=v(()=>n.settings),d=v({get(){return n.getSelectedTabId},set(p){p&&n.set({selectedTabId:p})}}),w=P([]),u=P(!1),h=P(!1),m=()=>{B.dev("DEBUG","Tabs","tabsHiddenShow()"),h.value=!t.platform.is.mobile},f=ze([]),b=(p,T)=>{f[p]=T},C=p=>{const T=p&&p.width||t.screen.width;u.value=!1,w.value=[],f&&f.length&&r.value.tabsCollapse!==!1?f.forEach((j,I)=>{const $=j.$el;$.style.display="inherit",($.offsetLeft+$.offsetWidth+220>T||u.value===!0)&&($.style.display="none",u.value=!0,w.value.push(a.value[I]))}):f&&f.length&&r.value.tabsCollapse===!1&&f.forEach(j=>{const I=j.$el;I.style.display="inherit"})},E=p=>n.set("drawerSidebar",p),y=v(()=>o.getUnread.length);return{setRef:b,elTabs:f,tabsWithResolvedBindings:a,tabId:d,tabsHiddenDropdownEnabled:u,tabsHiddenDropdown:h,tabsHiddenShow:m,tabsHidden:w,toggleNotifications:p=>n.set("drawerNotifications",p),toggleSidebar:E,notificationsUnread:y,drawerMiniMode:s,settings:r,isPro:i,onResize:C}}}),Gt={class:"row nowrap",style:{margin:"2px 0"}},Jt={key:0,class:"q-tab__label"},Kt={class:"q-tab__label"};function Yt(e,t,n,o,i,a){const l=A("icon");return S(),D(rt,{modelValue:e.tabId,"onUpdate:modelValue":t[4]||(t[4]=s=>e.tabId=s),"inline-label":"",dense:"",align:"left",style:N({"padding-left":(e.drawerMiniMode!==!0?0:5)+"px","padding-right":"48px"}),id:"tabBar",class:R({"jarvis-tabs-container":!0,"jarvis-tabs-bottom":e.settings.tabsBottom===!0}),"content-class":"jarvis-tabs","indicator-color":"white"},{default:k(()=>[g(Oe,{onResize:e.onResize},null,8,["onResize"]),e.settings.drawerShowMenuButton!==!1?(S(),D(M,{key:0,flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:t[0]||(t[0]=s=>e.toggleSidebar(!0)),class:R(["q-ml-sm",{"lt-md":e.drawerMiniMode===!0}])},null,8,["class"])):O("",!0),Q("div",Gt,[(S(!0),H(U,null,oe(e.tabsWithResolvedBindings,(s,r)=>(S(),D($t,{key:s.id+"-"+s.revision,ref_for:!0,ref:d=>e.setRef(r,d),name:s.id,to:{params:{tabId:s.id}},style:N(e.isPro&&s.id===e.tabId&&s.bodySelectedStyle||e.isPro&&s.bodyStyle||{}),class:R(["jarvis-tab",["jarvis-tab-"+s.id,e.isPro&&s.id===e.tabId&&s.bodySelectedStyle&&s.bodySelectedStyle.display&&s.bodySelectedStyle.display.startsWith("none")?"hidden":"",e.isPro&&s.bodyStyle&&s.bodyStyle.display&&s.bodyStyle.display.startsWith("none")?"hidden":""]]),"content-class":e.settings.tabsDense?"dense":"normal"},{default:k(()=>[L(g(l,{name:s.icon,size:"xs",class:"tabIcon",style:N({margin:e.settings.tabsDense?"4px 4px 0 0":"0",...e.isPro&&s.id===e.tabId&&s.iconSelectedStyle||e.isPro&&s.iconStyle||{}})},null,8,["name","style"]),[[z,s.icon]]),e.page.hideLabels!==!0?(S(),H("div",Jt,Z(s.title),1)):O("",!0)]),_:2},1032,["name","to","style","class","content-class"]))),128)),L(g(It,{modelValue:e.tabsHiddenDropdown,"onUpdate:modelValue":t[1]||(t[1]=s=>e.tabsHiddenDropdown=s),onMouseover:t[2]||(t[2]=s=>e.tabsHiddenDropdown=!0),"auto-close":"",stretch:"",flat:""},{label:k(()=>[Q("div",{class:R(e.settings.tabsDense?"dense":"normal")},[g(l,{name:"mdi-tab-unselected",size:"xs",class:"tabIcon",style:N({margin:e.settings.tabsDense?"1px 5px 0 0":"-1px 0 1px 0"})},null,8,["style"]),Q("div",Kt,Z(e.$t("More")+"..."),1)],2)]),default:k(()=>[g(lt,null,{default:k(()=>[(S(!0),H(U,null,oe(e.tabsHidden,s=>(S(),D(Ae,{key:s.id,clickable:"",onClick:r=>e.tabId=s.id,class:R({"q-tab--active":s.id===e.tabId})},{default:k(()=>[g(de,{avatar:""},{default:k(()=>[g(l,{name:s.icon},null,8,["name"])]),_:2},1024),g(de,null,{default:k(()=>[ve(Z(s.title),1)]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1})]),_:1},8,["modelValue"]),[[z,e.tabsHiddenDropdownEnabled]])]),L(g(M,{flat:"",dense:"",round:"",icon:"mdi-bell","aria-label":"Notifications",onClick:t[3]||(t[3]=s=>e.toggleNotifications(!0)),class:"q-mr-sm notification-drawer-button"},{default:k(()=>[g(Ht,{color:"secondary",align:"middle",floating:""},{default:k(()=>[ve(Z(e.notificationsUnread),1)]),_:1})]),_:1},512),[[z,e.isPro]])]),_:1},8,["modelValue","style","class"])}var Xt=Y(Ut,[["render",Yt]]);function Zt(e,t){const n=v(()=>typeof e.value!="object"?P({fullscreenSize:e.value}):e),o=P(),i=P(!1),a=()=>{i.value=!0;const r=o.value;r.classList.add("isFullscreen"),r.style.overflow="auto";const d=r.querySelector(".jarvis-widget-scaler");d.style.height="auto"},l=()=>{i.value=!1;const r=o.value;r.classList.remove("isFullscreen"),r.style.overflow="initial";const d=r.querySelector(".jarvis-widget-scaler");d.style.height=n.value.fullscreenSize+"px",document.exitFullscreen?document.exitFullscreen().catch(w=>{}):document.mozCancelFullScreen?document.mozCancelFullScreen().catch(w=>{}):document.webkitCancelFullScreen&&document.webkitCancelFullScreen().catch(w=>{})};return we(()=>o.value,()=>{o.value.addEventListener("fullscreenchange",()=>{document.fullscreenElement===null&&l()})}),{fullscreenElement:o,fullscreenActive:i,fullscreenToggle:r=>{r=typeof r=="boolean"?r:!i.value,dt.toggle(o.value).then(()=>{r===!1?l():a()}).catch(d=>{console.error(d)})}}}const xt=K({name:"Widget",props:["page","tab","widgets","config","layout","containerSize"],setup(e){const t=ee(),n=We(),o=W(),i=ct(e,"config")||{};P();const a=P(),l=v(()=>{const $=i.value.alignmentHorizontal||"center",ae=i.value.alignmentVertical||"top",te=i.value.scaleToFitContents!==void 0?i.value.scaleToFitContents:!0;return{h:$,v:ae,fit:te}}),s=v(()=>l.value.v!=="middle"?{}:{transform:"translateY(-50%)",position:"relative",top:"50%"}),r=ze({width:0,height:0}),d=v(()=>a.value&&a.value.$el.offsetHeight||0),w=v(()=>e.containerSize.height-d.value),u=v(()=>l.value.fit===!1||ut.includes(C.value.module)?{x:1,y:1}:{x:r?Math.min(1,e.containerSize.width/r.width):1,y:r?Math.min(1,w.value/r.height):1}),h=v(()=>{const $=[0,0];return $[0]=l.value.h==="center"?"50%":l.value.h==="right"?"100%":l.value.h,$[1]=l.value.v==="middle"?"50%":l.value.v==="bottom"?"100%":l.value.v,$}),m=v(()=>({width:l.value.h!=="fill-width"?"100%":Math.floor(1/(u.value.y<u.value.x?u.value.y:u.value.x)*100)+"% !important",height:w.value-1+"px"})),f=v(()=>T.value===!0?1:u.value.y<u.value.x?u.value.y:u.value.x),b=v(()=>{const $={"-webkit-transform":"scale("+f.value+")","-webkit-transform-origin":h.value.join(" "),transform:"scale("+f.value+")","transform-origin":h.value.join(" ")};return l.value.v==="middle"&&($.margin="auto"),t.screen.lt.lg||e.layout==="desktop"&&t.platform.is.mobile?{}:$}),C=v(()=>{const $=e.widgets[0];return $&&o.widgets[$]||{}}),E=()=>{B.dev("DEBUG","Widget","jump"),C.value.link&&(C.value.link.indexOf("http")>-1||C.value.link.indexOf("www")>-1)?window.open((C.value.link.indexOf("http")===-1?"http://":"")+C.value.link,"_blank"):C.value.link&&n.push({params:{tabId:C.value.link}}).catch($=>console.warn($))};let y=null;const c=$=>{y&&clearTimeout(y),y=setTimeout(()=>{B.dev("DEBUG","Widget","onResize()"),Object.assign(r,$)},500)},{fullscreenElement:p,fullscreenActive:T,fullscreenToggle:j}=Zt(w),I=P(i.value.allowFullscreen||!1);return{alignment:l,verticalAlignment:s,scaleSizes:m,scaleStyle:b,size:r,widget:C,widgetTitle:a,widgetTitleSize:d,jump:E,onResize:c,fullscreenEnabled:I,fullscreenElement:p,fullscreenActive:T,fullscreenToggle:j}}});function _t(e,t,n,o,i,a){const l=A("icon");return S(),H("div",{ref:"fullscreenElement",onDblclick:t[1]||(t[1]=s=>e.fullscreenEnabled&&e.fullscreenToggle()),class:R(["jarvis-widget-container bgcolor",{tile:e.tab.widgetEdges,paper:!e.tab.widgetEdges,fullscreenEnabled:e.fullscreenEnabled}])},[e.fullscreenEnabled?(S(),H("div",{key:0,class:R(["fullscreener",{close:e.fullscreenActive}]),onClick:t[0]||(t[0]=(...s)=>e.fullscreenToggle&&e.fullscreenToggle(...s))},null,2)):O("",!0),g(be,{flat:"",class:R(["jarvis-widget full-width full-height",{["jarvis-widget-module-"+e.widget.module]:!0,["jarvis-widget-"+e.widget.id]:!0}])},{default:k(()=>[e.widget.hideTitle!==!0&&(e.widget.icon||e.widget.title)?(S(),D(Ae,{key:0,class:"jarvis-widget-header",ref:"widgetTitle"},{default:k(()=>[e.widget.icon?(S(),D(de,{key:0,side:"",class:R({"cursor-pointer":e.widget.link}),onClick:e.jump},{default:k(()=>[g(ft,{square:e.tab.widgetEdges,rounded:!e.tab.widgetEdges,class:"jarvis-widget-icon","font-size":"24px"},{default:k(()=>[g(l,{name:e.widget.icon},null,8,["name"])]),_:1},8,["square","rounded"])]),_:1},8,["class","onClick"])):O("",!0),g(de,null,{default:k(()=>[g(pt,{class:R(["text-h6",{"cursor-pointer":e.widget.link}]),onClick:e.jump},{default:k(()=>[ve(Z(e.widget.label||e.widget.title),1)]),_:1},8,["class","onClick"])]),_:1})]),_:1},512)):O("",!0),e.widget.hideSeparator!==!0&&e.widget.hideTitle!==!0&&(e.widget.icon||e.widget.title)?(S(),D(ie,{key:1})):O("",!0),g(se,{horizontal:"",class:"jarvis-widget-content",style:N(e.alignment.fit===!1?{"overflow-y":"auto",...e.scaleSizes,...e.verticalAlignment}:e.verticalAlignment)},{default:k(()=>[g(Oe,{onResize:e.onResize},null,8,["onResize"]),Q("div",{class:"jarvis-widget-scaler full-width",style:N(e.scaleStyle)},[(S(),D(gt(e.widget.module),{key:e.widget.revision,class:"full-width",widget:e.widget,_alignment:e.alignment,_fullscreen:e.fullscreenActive,_containerSize:{width:e.containerSize.width,height:e.containerSize.height-e.widgetTitleSize},_widgetSize:{width:e.size.width,height:e.size.height}},null,8,["widget","_alignment","_fullscreen","_containerSize","_widgetSize"]))],4)]),_:1},8,["style"])]),_:1},8,["class"])],34)}var en=Y(xt,[["render",_t]]);const tn=K({name:"TabPanel",props:["page","tab"],components:{Widget:en},setup(e){B.dev("DEBUG","TabPanel","setup()");const t=W(),n=ee(),o=n.platform.is.mobile,i=!1,a=v(()=>e.tab.widgetConfig),l=v(()=>Math.max(o&&a.value.smartphoneGapSize||i||a.value.desktopGapSize||5,0)),s=v(()=>{let f=[];return o&&a.value.smartphoneSameAs==="specific-layout"||i?f=e.tab.widgetsSmartphone||[]:o&&a.value.smartphoneSameAs==="tablet"?f=e.tab.widgetsTablet||[]:f=e.tab.widgetsDesktop||[],f}),r=v(()=>Math.max.apply(Math,s.value.map(f=>f.y+f.h))),d=v(()=>{var f;return((f=s.value)==null?void 0:f[0])||{}}),w=n.screen.width,u=v(()=>t.pageHeight),h=v(()=>{const f=(o?a.value.smartphoneFitPageHeight:a.value.desktopFitPageHeight)||!1,b=o&&a.value.smartphoneWidgetHeight||i||a.value.desktopWidgetHeight||50;return f===!0?(u.value-2*l.value)/r.value-l.value:b}),m=v(()=>o&&a.value.smartphoneSameAs==="specific-layout"||i?"smartphone":o&&a.value.smartphoneSameAs==="tablet"?"tablet":"desktop");return{containerRows:r,fullscreenContainer:d,pageWidth:w,pageHeight:u,widgetGap:l,widgetHeight:h,widgetLayout:m,widgetContainers:s}}});function nn(e,t,n,o,i,a){const l=A("widget");return S(),H("div",{class:R({["jarvis-page-"+e.page.id]:!0,["jarvis-tab-"+e.tab.id]:!0})},[e.tab.fullscreen!==!0?(S(),H("div",{key:0,class:R(["container",e.widgetLayout]),style:N({gridTemplateRows:"repeat("+e.containerRows+", "+e.widgetHeight+"px)",columnGap:e.widgetGap+"px",rowGap:e.widgetGap+"px",padding:e.widgetGap+"px"})},[(S(!0),H(U,null,oe(e.widgetContainers,s=>(S(),H(U,null,[s&&s.items&&s.items.length>0?(S(),H("div",{key:s.i,style:N({gridArea:s.y+1+" / "+(s.x+1)+" / span "+s.h+" / span "+s.w}),class:"box"},[g(l,{page:e.page,tab:e.tab,widgets:s.items||[],config:s,layout:e.widgetLayout,containerSize:{width:e.pageWidth/12*s.w,height:s.h*e.widgetHeight+(s.h-1)*e.widgetGap}},null,8,["page","tab","widgets","config","layout","containerSize"])],4)):O("",!0)],64))),256))],6)):(S(),H("div",{key:1,style:N({height:e.pageHeight+"px"})},[g(l,{fullscreen:"",page:e.page,tab:e.tab,widgets:e.fullscreenContainer.items||[],config:e.fullscreenContainer,layout:e.widgetLayout,containerSize:{width:e.pageWidth,height:e.pageHeight}},null,8,["page","tab","widgets","config","layout","containerSize"])],4))],2)}var sn=Y(tn,[["render",nn]]);const on=K({name:"Page",props:["page"],components:{Container:Qt,Tabs:Xt,TabPanel:sn},setup(e){B.dev("DEBUG","Page","setup()");const t=ee(),n=mt(),o=We(),i=vt(),a=W(),l=v(()=>t.platform.is.mobile),s=v(()=>a.drawerMiniMode),r=v(()=>a.settings),d=v(()=>Object.keys(e.page.tabs).length),w=v({get(){return"tab-"+a.getSelectedTabId},set(y){y&&o.push({params:{tabId:y.replace("tab-","")}})}}),u=(y,c)=>{const p=document.querySelector(".jarvis-header");y=p&&p.offsetHeight?p.offsetHeight:y;const T=c-y;return T!==a.pageHeight&&(B.dev("DEBUG","Page","setPageContainer",y,c,T,a.pageHeight),a.set("pageHeight",c-y)),{}},h=()=>a.set("selectedTabReady",!1),m=()=>a.set("selectedTabReady",!0),{jumperOpen:f}=Ft(),b=(y,c,p)=>{const T=c.id;o.push({params:{...i.params,tabId:T}}).then(()=>{if(p.id!=="_root"){const j=l.value&&c.widgetConfig.smartphoneWidgetHeight||c.widgetConfig.desktopWidgetHeight||50,I=document.querySelector(".jarvis-header"),$=I&&I.offsetHeight?I.offsetHeight:0;setTimeout(()=>window.scrollTo(0,p.y*j+$+1),100)}}).catch(()=>{})},C=(y,c)=>{let p=t.platform.is.mobile?c.widgetsSmartphone:c.widgetsDesktop;p=a.getWidgets(p),p=p.concat([{},{color:"primary",icon:"mdi-tab",label:n.t("Jump directly to")+" "+c.label,id:"_root"}]),f(p,{class:"jarvis-quick-jumper",message:y.title+" / "+c.title+": "+n.t("Widgets"),onSuccess:T=>b(y,c,T)})},E=y=>{const c=a.getTabs(y);f(c,{class:"jarvis-quick-jumper",message:y.title+": "+n.t("Tabs"),onSuccess:p=>C(y,p)})};return{jumperOpen:()=>f(a.getPages,{class:"jarvis-quick-jumper",message:n.t("Pages"),onSuccess:E}),setPageContainer:u,onSelectedTabMoving:h,onSelectedTabReady:m,drawerMiniMode:s,isMobile:l,tabsCount:d,tabId:w,tabAnimated:v(()=>r.value.tabsSwipeAnimation==="always"||(!r.value.tabsSwipeAnimation||r.value.tabsSwipeAnimation==="mobile")&&l.value),tabSwipeable:v(()=>r.value.tabsSwipe==="always"||(!r.value.tabsSwipe||r.value.tabsSwipe==="mobile")&&l.value),settings:r}}});function an(e,t,n,o,i,a){const l=A("Tabs"),s=A("Container"),r=A("TabPanel");return S(),D(Et,{style:{"padding-top":"0"}},{default:k(()=>[g(s,{tabsCount:e.tabsCount},{default:k(()=>[g(l,{page:e.page,tabs:e.page.tabs},null,8,["page","tabs"])]),_:1},8,["tabsCount"]),g(Dt,{"style-fn":e.setPageContainer,class:"jarvis-page jarvis-body"},{default:k(()=>[g(Ne,{modelValue:e.tabId,"onUpdate:modelValue":t[0]||(t[0]=d=>e.tabId=d),"keep-alive":!0,animated:e.tabAnimated,swipeable:e.tabSwipeable,style:{"background-color":"transparent"},onBeforeTransition:e.onSelectedTabMoving,onTransition:e.onSelectedTabReady},{default:k(()=>[(S(!0),H(U,null,oe(e.page.tabs,d=>(S(),D(Fe,{key:d.id,name:"tab-"+d.id,style:N({padding:0,"margin-top":e.drawerMiniMode&&(e.settings.tabsBottom||e.page.tabs.length<=1)?0:e.settings.tabsDense?"40px":"60px"})},{default:k(()=>[g(r,{page:e.page,tab:{widgetConfig:{},...d}},null,8,["page","tab"])]),_:2},1032,["name","style"]))),128))]),_:1},8,["modelValue","animated","swipeable","onBeforeTransition","onTransition"]),L(g(Nt,{position:"bottom-right",offset:[18,18],style:{"z-index":"5999"}},{default:k(()=>[g(M,{fab:"",icon:"mdi-tab-search",color:"accent",onClick:t[1]||(t[1]=ht(d=>e.jumperOpen(),["stop"]))})]),_:1},512),[[z,e.settings.quickJumper==="always"||e.isMobile&&e.settings.quickJumper==="mobile"]])]),_:1},8,["style-fn"])]),_:1})}var ln=Y(on,[["render",an],["__scopeId","data-v-1380b883"]]);function Ve(e){return e.split("-")[0]}function rn(e){return e.split("-")[1]}function dn(e){return["top","bottom"].includes(Ve(e))?"x":"y"}function cn(e){return e==="y"?"height":"width"}function De(e,t,n){let{reference:o,floating:i}=e;const a=o.x+o.width/2-i.width/2,l=o.y+o.height/2-i.height/2,s=dn(t),r=cn(s),d=o[r]/2-i[r]/2,w=Ve(t),u=s==="x";let h;switch(w){case"top":h={x:a,y:o.y-i.height};break;case"bottom":h={x:a,y:o.y+o.height};break;case"right":h={x:o.x+o.width,y:l};break;case"left":h={x:o.x-i.width,y:l};break;default:h={x:o.x,y:o.y}}switch(rn(t)){case"start":h[s]-=d*(n&&u?-1:1);break;case"end":h[s]+=d*(n&&u?-1:1);break}return h}const un=async(e,t,n)=>{const{placement:o="bottom",strategy:i="absolute",middleware:a=[],platform:l}=n,s=a.filter(Boolean),r=await(l.isRTL==null?void 0:l.isRTL(t));let d=await l.getElementRects({reference:e,floating:t,strategy:i}),{x:w,y:u}=De(d,o,r),h=o,m={},f=0;for(let b=0;b<s.length;b++){const{name:C,fn:E}=s[b],{x:y,y:c,data:p,reset:T}=await E({x:w,y:u,initialPlacement:o,placement:h,strategy:i,middlewareData:m,rects:d,platform:l,elements:{reference:e,floating:t}});if(w=y!=null?y:w,u=c!=null?c:u,m={...m,[C]:{...m[C],...p}},T&&f<=50){f++,typeof T=="object"&&(T.placement&&(h=T.placement),T.rects&&(d=T.rects===!0?await l.getElementRects({reference:e,floating:t,strategy:i}):T.rects),{x:w,y:u}=De(d,h,r)),b=-1;continue}}return{x:w,y:u,placement:h,strategy:i,middlewareData:m}};function Ee(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function Qe(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function q(e){if(e==null)return window;if(!Qe(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function G(e){return q(e).getComputedStyle(e)}function J(e){return Qe(e)?"":e?(e.nodeName||"").toLowerCase():""}function Ue(){const e=navigator.userAgentData;return e!=null&&e.brands?e.brands.map(t=>t.brand+"/"+t.version).join(" "):navigator.userAgent}function F(e){return e instanceof q(e).HTMLElement}function _(e){return e instanceof q(e).Element}function fn(e){return e instanceof q(e).Node}function je(e){if(typeof ShadowRoot=="undefined")return!1;const t=q(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function fe(e){const{overflow:t,overflowX:n,overflowY:o,display:i}=G(e);return/auto|scroll|overlay|hidden/.test(t+o+n)&&!["inline","contents"].includes(i)}function pn(e){return["table","td","th"].includes(J(e))}function ye(e){const t=/firefox/i.test(Ue()),n=G(e),o=n.backdropFilter||n.WebkitBackdropFilter;return n.transform!=="none"||n.perspective!=="none"||(o?o!=="none":!1)||t&&n.willChange==="filter"||t&&(n.filter?n.filter!=="none":!1)||["transform","perspective"].some(i=>n.willChange.includes(i))||["paint","layout","strict","content"].some(i=>{const a=n.contain;return a!=null?a.includes(i):!1})}function Ge(){return!/^((?!chrome|android).)*safari/i.test(Ue())}function Se(e){return["html","body","#document"].includes(J(e))}const Ie=Math.min,ne=Math.max,ce=Math.round;function x(e,t,n){var o,i,a,l;t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect();let r=1,d=1;t&&F(e)&&(r=e.offsetWidth>0&&ce(s.width)/e.offsetWidth||1,d=e.offsetHeight>0&&ce(s.height)/e.offsetHeight||1);const w=_(e)?q(e):window,u=!Ge()&&n,h=(s.left+(u&&(o=(i=w.visualViewport)==null?void 0:i.offsetLeft)!=null?o:0))/r,m=(s.top+(u&&(a=(l=w.visualViewport)==null?void 0:l.offsetTop)!=null?a:0))/d,f=s.width/r,b=s.height/d;return{width:f,height:b,top:m,right:h+f,bottom:m+b,left:h,x:h,y:m}}function X(e){return((fn(e)?e.ownerDocument:e.document)||window.document).documentElement}function pe(e){return _(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Je(e){return x(X(e)).left+pe(e).scrollLeft}function gn(e){const t=x(e);return ce(t.width)!==e.offsetWidth||ce(t.height)!==e.offsetHeight}function mn(e,t,n){const o=F(t),i=X(t),a=x(e,o&&gn(t),n==="fixed");let l={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if(o||!o&&n!=="fixed")if((J(t)!=="body"||fe(i))&&(l=pe(t)),F(t)){const r=x(t,!0);s.x=r.x+t.clientLeft,s.y=r.y+t.clientTop}else i&&(s.x=Je(i));return{x:a.left+l.scrollLeft-s.x,y:a.top+l.scrollTop-s.y,width:a.width,height:a.height}}function ue(e){if(J(e)==="html")return e;const t=e.assignedSlot||e.parentNode||(je(e)?e.host:null)||X(e);return je(t)?t.host:t}function He(e){return!F(e)||G(e).position==="fixed"?null:e.offsetParent}function vn(e){let t=ue(e);for(;F(t)&&!Se(t);){if(ye(t))return t;t=ue(t)}return null}function Pe(e){const t=q(e);let n=He(e);for(;n&&pn(n)&&G(n).position==="static";)n=He(n);return n&&(J(n)==="html"||J(n)==="body"&&G(n).position==="static"&&!ye(n))?t:n||vn(e)||t}function Re(e){if(F(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=x(e);return{width:t.width,height:t.height}}function hn(e){let{rect:t,offsetParent:n,strategy:o}=e;const i=F(n),a=X(n);if(n===a)return t;let l={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if((i||!i&&o!=="fixed")&&((J(n)!=="body"||fe(a))&&(l=pe(n)),F(n))){const r=x(n,!0);s.x=r.x+n.clientLeft,s.y=r.y+n.clientTop}return{...t,x:t.x-l.scrollLeft+s.x,y:t.y-l.scrollTop+s.y}}function bn(e,t){const n=q(e),o=X(e),i=n.visualViewport;let a=o.clientWidth,l=o.clientHeight,s=0,r=0;if(i){a=i.width,l=i.height;const d=Ge();(d||!d&&t==="fixed")&&(s=i.offsetLeft,r=i.offsetTop)}return{width:a,height:l,x:s,y:r}}function wn(e){var t;const n=X(e),o=pe(e),i=(t=e.ownerDocument)==null?void 0:t.body,a=ne(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=ne(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0);let s=-o.scrollLeft+Je(e);const r=-o.scrollTop;return G(i||n).direction==="rtl"&&(s+=ne(n.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:s,y:r}}function Ke(e){const t=ue(e);return Se(t)?e.ownerDocument.body:F(t)&&fe(t)?t:Ke(t)}function Ye(e,t){var n;t===void 0&&(t=[]);const o=Ke(e),i=o===((n=e.ownerDocument)==null?void 0:n.body),a=q(o),l=i?[a].concat(a.visualViewport||[],fe(o)?o:[]):o,s=t.concat(l);return i?s:s.concat(Ye(l))}function yn(e,t){const n=x(e,!1,t==="fixed"),o=n.top+e.clientTop,i=n.left+e.clientLeft;return{top:o,left:i,x:i,y:o,right:i+e.clientWidth,bottom:o+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}function Be(e,t,n){return t==="viewport"?Ee(bn(e,n)):_(t)?yn(t,n):Ee(wn(X(e)))}function Sn(e){let t=Ye(e).filter(i=>_(i)&&J(i)!=="body"),n=e,o=null;for(;_(n)&&!Se(n);){const i=G(n);i.position==="static"&&o&&["absolute","fixed"].includes(o.position)&&!ye(n)?t=t.filter(a=>a!==n):o=i,n=ue(n)}return t}function kn(e){let{element:t,boundary:n,rootBoundary:o,strategy:i}=e;const l=[...n==="clippingAncestors"?Sn(t):[].concat(n),o],s=l[0],r=l.reduce((d,w)=>{const u=Be(t,w,i);return d.top=ne(u.top,d.top),d.right=Ie(u.right,d.right),d.bottom=Ie(u.bottom,d.bottom),d.left=ne(u.left,d.left),d},Be(t,s,i));return{width:r.right-r.left,height:r.bottom-r.top,x:r.left,y:r.top}}const Cn={getClippingRect:kn,convertOffsetParentRelativeRectToViewportRelativeRect:hn,isElement:_,getDimensions:Re,getOffsetParent:Pe,getDocumentElement:X,getElementRects:e=>{let{reference:t,floating:n,strategy:o}=e;return{reference:mn(t,Pe(n),o),floating:{...Re(n),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>G(e).direction==="rtl"},Tn=(e,t,n)=>un(e,t,{platform:Cn,...n});var $n=`[\r
   {\r
      "id":"cfbea70b-925b-40d1-9e8e-d0768336e3da",\r
      "title":"Main Site",\r
      "type":"page",\r
      "icon":"mdi-file",\r
      "tabs":[\r
         {\r
            "id":"0559b5e5-1c56-4ea4-8211-d51226417202",\r
            "title":"Dashboard",\r
            "icon":"mdi-monitor-dashboard",\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":8,\r
                  "i":"77ac22da-738d-4646-b0f5-940298bd6571",\r
                  "moved":false,\r
                  "items":[\r
                     "3958dfb0-83da-48ae-96f3-e66969a92cac"\r
                  ]\r
               },\r
               {\r
                  "x":4,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"28e602ec-4064-48d0-94d8-80e64fe37f87",\r
                  "moved":false,\r
                  "items":[\r
                     "be31acad-6bb4-40ed-a9cf-24cd981d8545"\r
                  ]\r
               },\r
               {\r
                  "x":4,\r
                  "y":4,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"0f1c06bc-f5c3-4e32-84e6-41fc0b4d05b5",\r
                  "moved":false,\r
                  "items":[\r
                     "b073226b-14d9-40e9-bbd7-4a54080cfa87"\r
                  ]\r
               },\r
               {\r
                  "x":8,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"a3c543c8-8135-47ef-905e-681982708764",\r
                  "moved":false,\r
                  "items":[\r
                     "99142690-4245-445b-bbc4-be8d09b93b83"\r
                  ]\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         },\r
         {\r
            "id":"e2055e5e-c0a8-46dc-8019-30c97e157d62",\r
            "title":"Map",\r
            "icon":"map",\r
            "fullscreen":true,\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"3587d28c-ffbe-4121-9e93-35cc52a5e947",\r
                  "moved":false,\r
                  "items":[\r
                     "232c9a69-1077-4b03-9c68-2d27eb148e6f"\r
                  ]\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         },\r
         {\r
            "id":"c9ae69c1-5c33-49bb-86e9-6ca2106cb9b7",\r
            "title":"Settings",\r
            "icon":"cog",\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":30,\r
                  "i":"252b1b88-f112-4095-aa75-a8f97fc6856b",\r
                  "moved":false,\r
                  "items":[\r
                     "dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937"\r
                  ],\r
                  "scaleToFitContents":false\r
               },\r
               {\r
                  "x":4,\r
                  "y":0,\r
                  "w":8,\r
                  "h":5,\r
                  "i":"6367c1cf-9e5d-4ec7-a383-f578e6dd0ea2",\r
                  "moved":false,\r
                  "items":[\r
                     "6fc7cca0-306e-40f6-a7c6-556ebd1fbd73"\r
                  ]\r
               },\r
               {\r
                  "x":8,\r
                  "y":5,\r
                  "w":4,\r
                  "h":25,\r
                  "i":"9f4dbd4d-cbe7-4dcd-94f3-c35850e28778",\r
                  "moved":false,\r
                  "items":[\r
                     "e90fd75a-f510-4481-845d-b2cdac5c4e2f"\r
                  ],\r
                  "scaleToFitContents":false\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         }\r
      ]\r
   }\r
]`,Dn=`{\r
   "232c9a69-1077-4b03-9c68-2d27eb148e6f":{\r
      "id":"232c9a69-1077-4b03-9c68-2d27eb148e6f",\r
      "config":{\r
      },\r
      "module":"Map"\r
   }\r
}`,En=[{title:"#introduction.title",message:"#introduction.content",onEnter:({props:e})=>{const t=he.getConnection,n=W();t.setState(V.get("NODE_SETTINGS"),JSON.stringify({...n.settings,["tour"+qe(e.tour)]:!0})).catch(o=>console.warn("Tours.Introduction",o.message||o))}},{target:"#SettingsButton",spotlight:".jarvis-sidebar-container",title:"#settings.title",message:"#settings.content",params:{placement:"right"},secondaryButton:"#settings.buttons.manually",secondaryAction:({finishTour:e,step:t})=>{document.querySelector("#SettingsButton").click(),e()},primaryButton:"#settings.buttons.automatically",primaryAction:({finishTour:e,nextStep:t,step:n})=>{t();const o={},i={};re.importDevices(V.get("DEFAULT_ADAPTERIMPORT").concat(["daswetter"])).then(a=>{a.forEach(m=>{if(m.status==="fulfilled"){const f=m.value;o[f.function]=o[f.function]||[],o[f.function].push(f),i[f.id]=f}});const l=JSON.parse($n),s=JSON.parse(Dn),r={config:{},items:[],module:"StateList",title:""},d=[{widgetId:"3958dfb0-83da-48ae-96f3-e66969a92cac",function:"light",icon:"mdi-lightbulb-on"},{widgetId:"be31acad-6bb4-40ed-a9cf-24cd981d8545",function:"blind",icon:"mdi-window-shutter-open"},{widgetId:"b073226b-14d9-40e9-bbd7-4a54080cfa87",function:"heating",icon:"mdi-radiator"},{widgetId:"99142690-4245-445b-bbc4-be8d09b93b83",function:"window",icon:"mdi-window-closed-variant"}];s["dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937"]={id:"dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937",config:{},items:[],module:"AdapterStatus",title:""},s["6fc7cca0-306e-40f6-a7c6-556ebd1fbd73"]={id:"6fc7cca0-306e-40f6-a7c6-556ebd1fbd73",config:{},items:[],module:"AdapterLogs",title:""},s["e90fd75a-f510-4481-845d-b2cdac5c4e2f"]={id:"e90fd75a-f510-4481-845d-b2cdac5c4e2f",config:{},items:[],module:"ScriptStatus",title:""},d.forEach((m,f)=>{const b=le(r);b.id=m.widgetId,b.title=bt.global.t(m.function),b.icon=m.icon,o[m.function]=o[m.function]||[];for(const E of o[m.function]){if(!E.states)continue;const y=Object.keys(E.states);let c={id:wt(),type:"device",deviceId:E.id,showState:!0,primaryStateKey:y[0]||"",secondaryStatesKeys:[]};E.function==="light"&&(y.includes("power")||y.includes("level"))?c={...c,showState:!1,actionElement:"SwitchAction",primaryStateKey:y.includes("power")?"power":"level"}:E.function==="blind"&&y.includes("level")?c={...c,showState:!1,actionElement:"BlindLevelAction",primaryStateKey:"level"}:E.function==="heating"&&y.includes("temperature")?c={...c,showState:!0,primaryStateKey:"temperature",secondaryStatesKeys:y.filter(p=>["setTemperature","humidity"].includes(p))}:E.function==="window"&&y.includes("open")&&(c={...c,primaryStateKey:"open"}),b.items.push(c)}s[b.id]=b;const{height:C}=re.getDefaultModuleHeight(b,b.items);l[0].tabs[0].widgetsDesktop[f].h=C,l[0].tabs[0].widgetsDesktop[f+1]&&l[0].tabs[0].widgetsDesktop[f].x===l[0].tabs[0].widgetsDesktop[f+1].x&&(l[0].tabs[0].widgetsDesktop[f+1].y=C)});const w=W(),u=he.getConnection,h=[u.setState(V.get("NODE_LAYOUT"),JSON.stringify({version:3,layout:l})),u.setState(V.get("NODE_DEVICES"),JSON.stringify({version:3,devices:i})),u.setState(V.get("NODE_WIDGETS"),JSON.stringify(s)),u.setState(V.get("NODE_SETTINGS"),JSON.stringify({...w.settings,tourInterface:!1}))];Promise.allSettled(h).then(()=>{e(),window.location.reload()}).catch(m=>console.warn("Tours.Introduction",m.message||m))}).catch(a=>{console.warn("Tours.Introduction",a.message||a)})}},{style:{"max-width":"450px"},title:"#jarvis.title",loading:!0,buttons:!1}],jn=[{target:".jarvis-sidebar-container",title:"#drawer.title",message:"#drawer.content",params:{placement:"right"},onEnter:({props:e})=>{const t=he.getConnection,n=W();t.setState(V.get("NODE_SETTINGS"),JSON.stringify({...n.settings,["tour"+qe(e.tour)]:!0})).catch(o=>console.warn("Tours.Interface",o.message||o))}},{target:".jarvis-tabs-container",title:"#tabs.title",message:"#tabs.content"},{spotlight:".q-page-container .jarvis-page",title:"#widgets.title",message:"#widgets.content"},{target:".jarvis-widget-container .jarvis-widget-module-StateList",title:"#modules.title",message:"#modules.content",params:{placement:"right-start"}},{target:".jarvis-widget-container .jarvis-widget-module-StateList .jarvis-widget-header",title:"#WidgetHeader.title",message:"#WidgetHeader.content",targetStyle:{}},{buttons:!1,onSpotlightClick:({nextStep:e})=>{e()},target:".jarvis-widget-container .jarvis-widget-module-StateList .jarvis-widget-content",title:"#WidgetContent.title",message:"#WidgetContent.content",targetStyle:{},params:{placement:"right-start"}},{target:".jarvis-popup",title:"#DeviceStateDetails.title",message:"#DeviceStateDetails.content",params:{placement:"top"}}],In={introduction:En,interface:jn};const Hn=K({name:"Tours",props:{tour:{type:String},start:{type:Boolean,default:!1}},setup(e){const t=P(!1),n=P(null),o=In[e.tour],i=P(null),a=P(null);let l,s,r={};const d=(c,p)=>{s=p?c.style.position:s,c.style.position=p?c.style.position||"relative":s,c.style.zIndex=p?5001:null,c.style.border=p?"5px solid #fff":null,c.style.opacity=p?.7:"unset",l=p?c.parentElement.style.zIndex:l,c.parentElement.style.zIndex=p?5001:l},w=(c,p=!0)=>{const T=c.spotlight||c.target;if(t.value=!0,T){const j=document.querySelector(T);if(j){if(d(j,p),c.onSpotlightClick!==void 0&&(j.style.pointerEvents="all",j.onclick=()=>c.onSpotlightClick({props:e,step:c,nextStep:f,previousStep:m,skipStep:b,finishTour:C})),c.targetStyle&&p===!0){r={};for(const I in c.targetStyle)r[I]=j.style[I],j.style[I]=c.targetStyle[I]}else if(c.targetStyle&&p===!1)for(const I in c.targetStyle)j.style[I]=r[I]}}},u=c=>{const p=document.querySelector(c.value.target||"body"),T={...c.value.params||{},middleware:[]};return Tn(p,n.value,T).then(j=>{const{x:I,y:$}=j;n.value.firstChild&&(n.value.firstChild.style.display="block");const ae=n.value.offsetWidth,te=n.value.offsetHeight,ke=document.querySelector("body");ke.style.pointerEvents="none";const Xe=ke.offsetHeight-te;return n.value.style.left=(c.value.target?I+15:"calc(50% - "+ae/2)+"px",n.value.style.top=(c.value.target?Math.max(10,Math.min(Xe-10,$-te/2+10)):$/2-te/2)+"px",n.value.style.pointerEvents="all",!0})},h=c=>{a.value;const p=a.value===null||a.value===c-2;a.value=c-1,i.value=o[a.value],u(i).then(()=>{o[a.value-1]&&w(o[a.value-1],!1),o[a.value+1]&&w(o[a.value+1],!1),w(i.value)}),p&&i.value&&i.value.onEnter&&i.value.onEnter({props:e,step:i,previousStep:m,nextStep:f,finishTour:C,skipStep:b})},m=()=>h(a.value),f=()=>h(a.value+2),b=()=>{w(i.value,!1),i.value=null,t.value=!1;const c=document.querySelector("body");c.style.pointerEvents="all"},C=()=>{b()},E=v(()=>a.value<=0),y=v(()=>a.value===o.length-1);return W(),yt(()=>{e.start&&h(1)}),{marked:Pt,tooltip:n,overlay:t,step:i,isFirst:E,isLast:y,previousStep:m,nextStep:f,skipStep:b,finishTour:C}}}),Pn={class:"tooltip",ref:"tooltip"},Rn={class:"text-h6"},Bn=["innerHTML"];function Mn(e,t,n,o,i,a){const l=A("q-overlay");return S(),H(U,null,[g(l,{modelValue:e.overlay,"onUpdate:modelValue":t[0]||(t[0]=s=>e.overlay=s),"no-scroll":!0,"z-index":5e3,opacity:.7},null,8,["modelValue","opacity"]),Q("div",Pn,[e.step?(S(),D(be,{key:e.step.title,class:"step"},{default:k(()=>[g(se,null,{default:k(()=>[Q("div",Rn,Z(e.$t(e.step.title||"")),1)]),_:1}),g(ie),e.step.loading===!0?(S(),D(St,{key:0,indeterminate:""})):O("",!0),g(se,{style:{"max-height":"50vh"},class:"body scroll"},{default:k(()=>[Q("div",{innerHTML:e.marked.parse(e.$t(e.step.message||""))},null,8,Bn)]),_:1}),g(ie),e.step.buttons!==!1?(S(),D(Le,{key:1,class:"nowrap"},{default:k(()=>[g(M,{onClick:e.skipStep,flat:"",label:e.$t("Skip"),color:"accent"},null,8,["onClick","label"]),g(Me),e.step.secondaryAction===void 0?L((S(),D(M,{key:0,onClick:e.previousStep,flat:"",label:e.$t("Previous"),color:"secondary"},null,8,["onClick","label"])),[[z,!e.isFirst]]):L((S(),D(M,{key:1,onClick:t[1]||(t[1]=s=>e.step.secondaryAction({step:e.step,previousStep:e.previousStep,nextStep:e.nextStep,finishTour:e.finishTour,skipStep:e.skipStep})),flat:"",label:e.$t(e.step.secondaryButton),color:"secondary"},null,8,["label"])),[[z,!e.isFirst]]),e.step.primaryButton===void 0?L((S(),D(M,{key:2,onClick:e.nextStep,flat:"",label:e.$t("Next"),color:"primary"},null,8,["onClick","label"])),[[z,!e.isLast]]):O("",!0),e.step.primaryButton===void 0?L((S(),D(M,{key:3,onClick:e.finishTour,label:e.$t("Finish"),color:"primary"},null,8,["onClick","label"])),[[z,e.isLast]]):L((S(),D(M,{key:4,onClick:t[2]||(t[2]=s=>e.step.primaryAction({step:e.step,previousStep:e.previousStep,nextStep:e.nextStep,finishTour:e.finishTour,skipStep:e.skipStep})),flat:"",label:e.$t(e.step.primaryButton),color:"primary"},null,8,["label"])),[[z,!e.isFirst]])]),_:1})):O("",!0)]),_:1})):O("",!0)],512)],64)}var Ln=Y(Hn,[["render",Mn]]);const zn=K({name:"Jarvis",components:{DeviceDetailsPopup:Ot,Page:ln,tours:Ln},setup(){B.dev("DEBUG","Jarvis","setup()");const e=ee(),t=W(),n=v(()=>t.settings);$e(()=>{B.dev("DEBUG","Jarvis","watchEffect","scrollbar"),me("style",n.value.scrollbars==="desktop"&&(e.platform.is.desktop||e.platform.is.mobile)||n.value.scrollbars==="mobile"&&e.platform.is.mobile?Rt:" ",{id:"scrollbar",type:"text/css",onlyPro:!1})}),we(e.screen.sizes,()=>{me("style",Bt.replace(/\$breakpoint-sm-min/g,e.screen.sizes.sm+"px").replace(/\$breakpoint-md-min/g,e.screen.sizes.md+"px"),{id:"responsive",type:"text/css",onlyPro:!1})},{immediate:!0});try{$e(()=>{B.dev("DEBUG","Jarvis","watchEffect","styles"),kt("styles",t.styles,{tag:"link",src:"href",rel:"stylesheet"}).then(a=>me("style",a,{id:"css",type:"text/css"}))})}catch(a){console.warn("Jarvis-B7cq4T4m","Error injecting custom styles: "+a.message),console.debug("Jarvis-B7cq4T4m",t.styles)}const o=v(()=>t.layout||[]),i=v(()=>"page-"+t.getSelectedPageId);return{settings:n,pages:o,pageId:i}}});function On(e,t,n,o,i,a){const l=A("tours"),s=A("DeviceDetailsPopup"),r=A("Page");return S(),H(U,null,[g(l,{tour:"introduction",start:e.settings.tourIntroduction!==!0},null,8,["start"]),g(l,{tour:"interface",start:e.settings.tourIntroduction===!0&&e.settings.tourInterface!==!0},null,8,["start"]),g(s),g(Ne,{"model-value":e.pageId,"keep-alive":!0,style:{"background-color":"transparent"},vertical:""},{default:k(()=>[(S(!0),H(U,null,oe(e.pages,d=>(S(),D(Fe,{key:d.id,name:"page-"+d.id,style:{padding:"0",margin:"0"}},{default:k(()=>[g(r,{page:d},null,8,["page"])]),_:2},1032,["name"]))),128))]),_:1},8,["model-value"])],64)}var Jn=Y(zn,[["render",On]]);export{Jn as default};
