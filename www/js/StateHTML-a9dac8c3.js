import{bt as T,a4 as w,bM as H,Q as i,dc as b,ef as k,k as d,dj as c,dw as u,ao as C,aG as I,ay as v,W as f,b3 as p,bn as m,a2 as y,d3 as D,b1 as P,a1 as B,D as $,X as j,C as z}from"./index-962b79b3.js";const K=w({name:"ModuleStateHTML",props:["widget","_containerSize"],setup(e){const g=H(),_=i(()=>e.widget.config);i(()=>({...b.joinConfig(_.value,k)}));const s=d(!1),a=d(null),o=d(),r=(t,Q,E,L)=>{if(s.value=!0,t)return a.value=t&&t.message||t,a.value;o.value=L},n=i(()=>{let t=o.value&&o.value.val||"";return t=!c.isPro()&&t.indexOf("<link")!==-1?t.replace(/(<link(.*)>)/gi,""):t,t=!c.isPro()&&t.indexOf("<style")!==-1?t.replace(/(<style([\s\S]*?)<\/style>)/g,""):t,t}),M=i(()=>c.isPro()&&n.value&&typeof n.value=="string"&&n.value.indexOf("<script")!==-1),l=e.widget.items&&e.widget.items[0]||{},S=u.get(l.deviceId);let h=[];return S?h=u.listen(S.id,l.primaryStateKey,r):(a.value=g.t("Device {deviceId} not found").replace("{deviceId}",l.deviceId),console.warn("StateHTML",a.value),s.value=!0),C(()=>u.unlisten(h)),{loaded:s,error:a,html:n,hasScript:M}}}),N={class:"jarvis-StateHTML StateHTML"},O=["innerHTML"],V=["srcdoc"];function F(e,g,_,s,a,o){const r=I("alert");return v(),f("div",N,[p(y(D,{indeterminate:""},null,512),[[m,!e.loaded&&!e.error]]),p(y(r,null,{default:P(()=>[B($(e.error),1)]),_:1},512),[[m,e.loaded&&e.error]]),p(j("div",null,[e.hasScript?(v(),f("iframe",{key:1,class:"StateHTML-iFrame",style:z({border:0,height:e._containerSize.height+"px"}),srcdoc:e.html},null,12,V)):(v(),f("div",{key:0,innerHTML:e.html},null,8,O))],512),[[m,e.loaded&&!e.error]])])}var U=T(K,[["render",F],["__scopeId","data-v-01c14b25"]]);export{U as default};
