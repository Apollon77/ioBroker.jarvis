import{a3 as v}from"./vendor.quasar-78ba37d9.js";import{b as Z}from"./stores-22cbae97.js";import{M as B}from"./modules-9c8c454f.js";import{C as O}from"./controllers-596cf83c.js";import{_ as $,f as u,k as N}from"./helpers-7b53fe93.js";import{g as P,a as F}from"./vendor.sunrise-sunset-js-d6e1d758.js";import{d as L,u as T,p as d,w as z,M as V,N as A,r as K,o as n,a as m,e as c,g as s,h as p,f as y,t as f,j as E}from"./vendor.vue-1bbf3cb4.js";var U={"DateTime#description":"Zeigt das aktuelle Datum und Zeit sowie Kalendarwoche, Sonnenauf- und Untergang und Stadt.","config#DateTime#style#label":"Style des Textes","config#DateTime#style#description":"CSS-Anweisungen in Javascript Syntax","config#DateTime#format#label":"Format des Datums / Uhrzeit","config#DateTime#format#description":"F\xFCr m\xF6gliche Werte, siehe date-fns Dokumentation. Eigener Text kann mittels einfacher Anf\xFChrungsstriche 'Beispiel Text' hinzugef\xFCgt werden.","config#DateTime#city#label":"Zeigt die Stadt","config#DateTime#sun#label":"Zeigt Zeiten f\xFCr Sonnenauf- und -untergang","config#DateTime#calendarweek#label":"Zeigt die aktuelle Kalenderwoche",Time:"Zeit",CW:"KW"},Te=Object.freeze(Object.defineProperty({__proto__:null,default:U},Symbol.toStringTag,{value:"Module"})),x={"DateTime#description":"Display the current date and time as well as calendar week, city and sunrise / sunset.","config#DateTime#style#label":"Style of the text","config#DateTime#style#description":"CSS statements in javascript notation","config#DateTime#format#label":"Date/Time format","config#DateTime#format#description":"For possible format values, see date-fns documentation","config#DateTime#city#label":"Display your hometown","config#DateTime#sun#label":"Display times of sunrise and -set","config#DateTime#calendarweek#label":"Display current calendar week"},pe=Object.freeze(Object.defineProperty({__proto__:null,default:x},Symbol.toStringTag,{value:"Module"})),G={"DateTime#description":"\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0442\u0435\u043A\u0443\u0449\u0435\u0439 \u0434\u0430\u0442\u044B \u0438 \u0432\u0440\u0435\u043C\u0435\u043D\u0438, \u0434\u043D\u044F \u043D\u0435\u0434\u0435\u043B\u0438, \u0433\u043E\u0440\u043E\u0434\u0430, \u0432\u0440\u0435\u043C\u0435\u043D\u0438 \u0432\u043E\u0441\u0445\u043E\u0434\u0430/\u0437\u0430\u0445\u043E\u0434\u0430 \u0441\u043E\u043B\u043D\u0446\u0430","config#DateTime#style#label":"\u0421\u0442\u0438\u043B\u044C \u0442\u0435\u043A\u0441\u0442\u0430","config#DateTime#style#description":"CSS \u0432\u044B\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0432 \u043D\u043E\u0442\u0430\u0446\u0438\u0438 javascript","config#DateTime#format#label":"\u0424\u043E\u0440\u043C\u0430\u0442 \u0434\u0430\u0442\u044B/\u0432\u0440\u0435\u043C\u0435\u043D\u0438","config#DateTime#format#description":"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0432\u043E\u0437\u043C\u043E\u0436\u043D\u044B\u0445 \u0444\u043E\u0440\u0430\u043C\u0442\u043E\u0432 \u0434\u043E\u0441\u0442\u0443\u043F\u043D\u044B \u0432 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430\u0446\u0438\u0438 date-fns","config#DateTime#city#label":"\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C \u0432\u0430\u0448 \u0433\u043E\u0440\u043E\u0434","config#DateTime#sun#label":"\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C \u0432\u0440\u0435\u043C\u044F \u0432\u043E\u0441\u0445\u043E\u0434\u0430 \u0438 \u0437\u0430\u043A\u0430\u0442\u0430","config#DateTime#calendarweek#label":"\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0442\u044C \u0442\u0435\u043A\u0443\u0449\u0438\u0439 \u0434\u0435\u043D\u044C \u043D\u0435\u0434\u0435\u043B\u0438",Time:"\u0412\u0440\u0435\u043C\u044F",CW:""},ye=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));const J={addGroup:!1,addDivider:!1,addDevice:!1};var H=[{columns:3,parameter:"formatDate",type:"textarea",label:"config#DateTime#format#label",info:"config#DateTime#format#description",link:"https://date-fns.org/v2.16.1/docs/format",value:"d. MMMM yyyy"},{columns:3,parameter:"formatTime",type:"textarea",label:"config#DateTime#format#label",info:"config#DateTime#format#description",link:"https://date-fns.org/v2.16.1/docs/format",value:"HH:mm:ss"},{columns:2,parameter:"city",label:"config#DateTime#city#label",type:"Switch",value:!0},{columns:2,parameter:"sun",label:"config#DateTime#sun#label",type:"Switch",value:!0},{columns:2,parameter:"calendarweek",label:"config#DateTime#calendarweek#label",type:"Switch",value:!0}],_e=Object.freeze(Object.defineProperty({__proto__:null,Settings:J,default:H},Symbol.toStringTag,{value:"Module"}));const Q=L({name:"ModuleDateTime",props:["widget","_containerSize","_widgetSize"],setup(e){const _=Z(),k=T(()=>e.widget.config),a=T(()=>{const t=B.joinConfig(k.value,H);return{...t,refresh:t.formatDate.indexOf("s")>-1||t.formatTime.indexOf("s")>-1?1:t.formatDate.indexOf("m")>-1||t.formatTime.indexOf("m")>-1?10:60}});let o=0;const D=d(null),l=d(null),h=d(null),w=d(null),S=d(null),W=T(()=>_.meta.city),g=T(()=>{const{latitude:t,longitude:i}=_.meta;return!t||!i?null:[t,i]}),j=t=>{if(a.value.sun!==!1&&g.value!==null)try{const i=new Date(t);h.value=u(P(...g.value,i),"HH:mm"),w.value=u(F(...g.value,i),"HH:mm")}catch(i){console.warn("DateTime",i.message||i)}},C=t=>{try{const i=new Date(t);D.value=a.value.formatDate?u(i,a.value.formatDate.replace(/(?:\r|\n|\r\n)/g,"'<br />'")):null,l.value=a.value.formatTime?u(i,a.value.formatTime.replace(/(?:\r|\n|\r\n)/g,"'<br />'")):null,S.value=N(i)}catch(i){console.warn("DateTime",i.message||i),D.value=a.value._defaults.formatDate?u(new Date,a.value._defaults.formatDate):null,l.value=a.value._defaults.formatTime?u(new Date,a.value._defaults.formatTime):null}};z(g,()=>j(o));let r=null;const I=()=>{r&&clearInterval(r),a.value.refresh&&a.value.refresh>0&&(O.getConnection.send("getTime",null,b),r=setInterval(()=>{o=o+a.value.refresh*1e3,C(o)},a.value.refresh*1e3))};let M=null;const b=t=>{o=parseInt(t),C(o),j(o),I()};return z(()=>e.widget.revision,()=>{if(e.widget.revision!==M){M=e.widget.revision;const t=O.getConnection;t.send("getTime",null,b),t.on("_timestamp",b)}}),V(()=>{!r&&I()}),A(()=>{r&&clearInterval(r),r=null}),{moduleConfig:a,date:D,time:l,sunrise:h,sunset:w,week:S,city:W}}}),q={class:"jarvis-DateTime-Clock"},R=["innerHTML"],X=["innerHTML"],Y={class:"row jarvis-DateTime-Details"},ee={key:0,class:"jarvis-DateTime-Details-Item"},te={class:"jarvis-DateTime-Details-Item-City"},ae={key:1,class:"jarvis-DateTime-Details-Item"},ie={class:"jarvis-DateTime-Details-Item-Sunrise"},ne={key:2,class:"jarvis-DateTime-Details-Item"},se={class:"jarvis-DateTime-Details-Item-Sunset"},oe={key:3,class:"jarvis-DateTime-Details-Item"},le={class:"jarvis-DateTime-Details-Item-Week"};function re(e,_,k,a,o,D){const l=K("icon");return n(),m("div",{key:e.widget.revision,class:"jarvis-DateTime-Container"},[c("div",q,[e.date?(n(),m("span",{key:0,class:"jarvis-DateTime-Clock-Date",innerHTML:e.date},null,8,R)):s("",!0),e.time?(n(),m("span",{key:1,class:"jarvis-DateTime-Clock-Time",innerHTML:e.time},null,8,X)):s("",!0)]),c("div",Y,[e.moduleConfig.city!==!1?(n(),m("div",ee,[p(l,{size:"xs",name:"mdi-city-variant-outline",class:"jarvis-DateTime-Details-Icon"}),e.city?s("",!0):(n(),y(v,{key:0,color:"primary"})),c("span",te,f(e.city),1)])):s("",!0),e.moduleConfig.sun!==!1?(n(),m("div",ae,[p(l,{size:"xs",name:"mdi-weather-sunset-up",class:"jarvis-DateTime-Details-Icon"}),e.sunrise?s("",!0):(n(),y(v,{key:0,color:"primary"})),c("span",ie,f(e.sunrise),1)])):s("",!0),e.moduleConfig.sun!==!1?(n(),m("div",ne,[p(l,{size:"xs",name:"mdi-weather-sunset-down",class:"jarvis-DateTime-Details-Icon"}),e.sunset?s("",!0):(n(),y(v,{key:0,color:"primary"})),c("span",se,f(e.sunset),1)])):s("",!0),e.moduleConfig.calendarweek!==!1?(n(),m("div",oe,[p(l,{size:"xs",name:"mdi-calendar-week",class:"jarvis-DateTime-Details-Icon"}),e.week?s("",!0):(n(),y(v,{key:0,color:"primary"})),c("span",le,[c("span",null,f(e.$t("CW")),1),E(" "+f(e.week),1)])])):s("",!0)])])}var me=$(Q,[["render",re]]),be=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));export{be as D,Te as _,pe as a,ye as b,_e as c};
