import{_ as M,x as Q,cR as c,de as W,ee as I,ef as y,cT as q,m as S,o as l,f as r,N as p,ah as u,q as s,d8 as z,w as n,g as a,l as o,t,al as k,k as m,F as D,s as C,a8 as H,dv as T,cX as B,n as L,b as R,U as F,ak as E,S as N,O as V,R as v,ag as _,aj as j}from"./index-0a47fe55.js";import{Q as b}from"./QTooltip-94e00f66.js";import{Q as P}from"./QSpace-72ed55b6.js";import{n as U}from"./index-15ea4cb5.js";import"./___vite-browser-external_commonjs-proxy-0107ae2e.js";import"./_commonjsHelpers-45ea234c.js";const J=Q({name:"Weather",props:["_widgetSize","widget"],data(){return this.format=c,this.refreshHourly=null,this.refreshDaily=null,{size:this._widgetSize,weather:null,error:!1,selectedDay:null}},watch:{_widgetSize(e){this.size=e}},computed:{isMobile(){return this.$q.platform.is.mobile||this.size&&this.size.width<=350},config(){return W.joinConfig(this.widget.config,I)},today(){return this.weather&&this.weather[1]||null},now(){return this.today&&this.today.hour&&this.today.hour[parseInt(new Date().getHours()/3)]||null},daysCaption(){return this.weather?[y.global.t("today"),y.global.t("tomorrow"),c(this.weather[3].date,"EEEE"),c(this.weather[4].date,"EEEE"),c(this.weather[5].date,"EEEE")]:[]},daysCaptionSmall(){return this.weather?[y.global.t("TDY"),y.global.t("TMRW"),c(this.weather[3].date,"E"),c(this.weather[4].date,"E"),c(this.weather[5].date,"E")]:[]}},methods:{init(){this.getData(),this.refreshHourly||(this.refreshHourly=setInterval(()=>{this.getData()},60*60*1e3)),this.refreshDaily||(this.refreshDaily=U.scheduleJob("0 0 * * *",()=>{this.getData()}))},getData(){const e={url:"http://api.daswetter.com/index.php?v=3.0&api_lang="+y.global.locale.substr(0,2)+"&localidad={localid}&affiliate_id={apikey}".replace("{apikey}",this.config.apikey).replace("{localid}",this.config.localid),responseType:"json"};T.getConnection.send("request",e,({err:w,data:f})=>{w||!f||!f.day?(this.error=w||f.error||!0,q.warn("Weather",this.error,e)):this.weather=f.day})},getIcon(e,h,w="weather"){return null}},created(){this.init()},beforeUnmount(){this.refreshHourly&&clearInterval(this.refreshHourly),this.refreshDaily&&this.refreshDaily.cancel()}}),O={key:0,class:"row items-center"},X={class:"col",style:{"text-align":"right"}},Y=a("br",null,null,-1),A=["src"],G={class:"col weather-current-temperature"},K={class:"text-h3 primary",style:{margin:"0"}},Z={class:"text-caption"},x={class:"col",style:{display:"flex"}},ee={class:"weather-details"},te={class:"nowrap"},se={class:"nowrap"},ie={class:"nowrap"},ae={class:"nowrap"},oe={key:1,class:"row"},ne=["onClick"],le=a("div",{class:"q-focus-helper"},null,-1),re={class:"text-caption"},de={key:0,class:"q-pa-sm"},ce={class:"text-body1 nowrap"},he=o(" / "),pe={class:"nowrap text-subtitle2"},ue={key:1,class:"q-pa-sm"},me=["src"],fe=a("br",null,null,-1),ye={key:0,class:"text-caption"},we={key:1,class:"text-caption"},ge={key:2,class:"q-pa-sm"},ve=["src"],_e=a("br",null,null,-1),be={class:"text-caption"},ke={class:"text-h6"},De=["src"],Se={class:"nowrap"},Ce=o(", "),Ee={class:"nowrap"},$e=o(", "),Me={class:"nowrap"},Qe=["src"];function We(e,h,w,f,Ie,qe){const $=S("alert"),d=S("icon");return l(),r("div",{key:e.widget.revision},[p(s(z,{indeterminate:""},null,512),[[u,!e.weather&&!e.error]]),p(s($,null,{default:n(()=>[o(t(typeof e.error=="string"?e.error:e.$t("Incorrect localidad or affiliate_id given! Please provide exact localidad and affiliate_id in module config!")),1)]),_:1},512),[[u,e.error]]),!e.error&&(e.config.display==="both"||e.config.display==="overview")&&e.now&&e.today?(l(),r("div",O,[a("div",X,[o(t(e.now.symbol_description),1),Y,a("img",{src:e.getIcon(e.now.symbol_value,e.config.iconSetWeather),alt:"",height:"60"},null,8,A)]),a("div",G,[a("h3",K,t(e.now.temp)+" "+t(e.today.units.temp),1),a("span",Z,t(e.$t("Feels like"))+" "+t(e.now.temp)+" "+t(e.today.units.temp),1)]),p(a("div",x,[s(k,{vertical:"",inset:""}),a("ul",ee,[a("li",te,[s(b,{anchor:"center left"},{default:n(()=>[o(t(e.$t("Rain")),1)]),_:1}),s(d,{color:"primary",name:"mdi-umbrella"}),o(" "+t(e.now.rain)+" "+t(e.today.units.rain),1)]),a("li",se,[s(b,{anchor:"center left"},{default:n(()=>[o(t(e.$t("Wind")),1)]),_:1}),s(d,{color:"primary",name:"mdi-weather-windy"}),o(" "+t(e.now.wind.speed)+"-"+t(e.now.wind.gusts)+" "+t(e.today.units.wind),1)]),a("li",ie,[s(b,{anchor:"center left"},{default:n(()=>[o(t(e.$t("Pressure")),1)]),_:1}),s(d,{color:"primary",name:"mdi-shore"}),o(" "+t(e.now.pressure)+" "+t(e.today.units.pressure),1)]),a("li",ae,[s(b,{anchor:"center left"},{default:n(()=>[o(t(e.$t("Snowline")),1)]),_:1}),s(d,{color:"primary",name:"mdi-snowflake-melt"}),o(" "+t(e.now.snowline)+" "+t(e.today.units.snowline),1)])])],512),[[u,!e.isMobile]])])):m("",!0),!e.error&&(e.config.display==="both"||e.config.display==="preview")&&e.weather?(l(),r("div",oe,[(l(!0),r(D,null,C(e.weather,(i,g)=>p((l(),r("div",{onClick:ze=>e.selectedDay=i,class:"col weather-day relative-position q-item--clickable q-link cursor-pointer q-focusable q-hoverable",key:i.date,style:L(g>1&&{borderLeft:"1px solid rgba(0, 0, 0, 0.12)"})},[le,p(a("div",{class:"text-overline",style:{"line-height":"auto"}},t(e.daysCaption&&e.daysCaption[g-1]||""),513),[[u,!e.isMobile]]),p(a("div",{class:"text-overline",style:{"line-height":"auto"}},t(e.daysCaptionSmall&&e.daysCaptionSmall[g-1]||""),513),[[u,e.isMobile]]),a("div",re,t(e.format(i.date,"d. MMM")),1),e.config.forecastTemperature!==!1?(l(),r("div",de,[a("span",ce,[s(d,{color:"primary",name:"mdi-thermometer"}),o(" "+t(i.tempmax+" "+i.units.temp),1)]),he,a("span",pe,t(i.tempmin+" "+i.units.temp),1)])):m("",!0),e.config.forecastSunRain!==!1?(l(),r("div",ue,[a("img",{src:e.getIcon(i.symbol_value,e.config.iconSetWeather),alt:"",height:"50"},null,8,me),fe,i.rain>0?(l(),r("span",ye,t(i.rain)+" mm",1)):(l(),r("span",we,"-"))])):m("",!0),e.config.forecastWind!==!1?(l(),r("div",ge,[a("img",{src:e.getIcon(i.wind.symbol,e.config.iconSetWind,"wind"),alt:"",height:"25"},null,8,ve),_e,a("span",be,t(i.wind.speed+" - "+i.wind.gusts+" "+i.units.wind),1)])):m("",!0)],12,ne)),[[B],[u,e.isMobile&&g<5||!e.isMobile]])),128))])):m("",!0),s(H,{value:e.selectedDay!==null,onHide:h[1]||(h[1]=i=>e.selectedDay=null)},{default:n(()=>[e.selectedDay!==null?(l(),R(j,{key:0,style:{width:"600px","max-width":"80vw"}},{default:n(()=>[s(E,{class:"row items-center"},{default:n(()=>[a("div",ke,t(e.$t("Weather Forecast"))+", "+t(e.format(e.selectedDay.date,"d. MMM")),1),s(P),s(F,{flat:"",round:"",color:"grey",icon:"close",onClick:h[0]||(h[0]=i=>e.selectedDay=null)})]),_:1}),s(k),s(E,{class:"col q-pa-none scroll body"},{default:n(()=>[s(N,null,{default:n(()=>[(l(!0),r(D,null,C(e.selectedDay.hour,i=>(l(),r(D,{key:"item-"+i.interval},[s(V,null,{default:n(()=>[s(v,{avatar:"",class:"items-center",style:{"flex-direction":"row"}},{default:n(()=>[o(t(i.interval)+" ",1),a("img",{src:e.getIcon(i.symbol_value,e.config.iconSetWeather),alt:"",height:"30",style:{"margin-left":"8px"}},null,8,De)]),_:2},1024),s(v,null,{default:n(()=>[s(_,null,{default:n(()=>[o(t(i.symbol_description),1)]),_:2},1024),s(_,{caption:""},{default:n(()=>[a("span",Se,[s(d,{color:"primary",name:"mdi-thermometer"}),o(" "+t(i.temp)+" "+t(e.today.units.temp),1)]),Ce,a("span",Ee,[s(d,{color:"primary",name:"mdi-umbrella",style:{"margin-left":"4px"}}),o(" "+t(i.rain)+" "+t(e.today.units.rain),1)]),$e,a("span",Me,[s(d,{color:"primary",name:"mdi-cloud",style:{"margin-left":"4px"}}),o(" "+t(i.clouds),1)])]),_:2},1024)]),_:2},1024),s(v,{avatar:"",style:{padding:"0 4px"}},{default:n(()=>[a("img",{src:e.getIcon(i.wind.symbolB,e.config.iconSetWind,"wind"),alt:"",height:"20"},null,8,Qe)]),_:2},1024),s(v,null,{default:n(()=>[s(_,null,{default:n(()=>[o(t(e.$t("WindDirection#"+i.wind.dir)+" ("+i.wind.dir+")"),1)]),_:2},1024),s(_,{caption:""},{default:n(()=>[o(t(i.wind.speed)+"-"+t(i.wind.gusts)+" "+t(e.today.units.wind),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),s(k)],64))),128))]),_:1})]),_:1})]),_:1})):m("",!0)]),_:1},8,["value"])])}var Ne=M(J,[["render",We]]);export{Ne as default};
