import{Q as ye}from"./QToolbarTitle-c381ef09.js";import{a4 as G,cI as he,cJ as F,cK as re,bt as R,aG as k,ay as p,W as S,a2 as t,b1 as l,bD as H,X as o,D as u,bB as y,A as M,U as D,a1 as w,V as O,bS as ue,bT as W,bU as I,ak as Ce,bV as ve,bW as pe,cn as te,k as Q,Q as E,bR as U,bv as be,b3 as _,bn as q,bp as V,bH as $,I as P,bM as ae,aY as De,bo as Se,aE as N,ct as we,cq as ee,cL as fe,bY as $e,cM as Oe,cN as le,bF as ce,bG as X,cO as ne,bO as B,cP as oe,cQ as ke,C as Z,bw as Ee,bP as Le,bC as Ie,bu as _e,bE as je}from"./index-b9e35d73.js";import{Q as Ke}from"./QBtnDropdown-9ce1a51b.js";import{Q as Ve}from"./QToolbar-540fb5b8.js";import{Q as x}from"./QExpansionItem-a9ce20d4.js";import{Q as me}from"./QTooltip-1569a700.js";import{Q as Qe}from"./QTree-d5ec230a.js";import{u as Te,a as Ae}from"./useDragDrop-106209b0.js";import{Q as ge,a as de,b as J,c as Ue}from"./QTable-92926f87.js";import{u as Pe}from"./useCopyToClipboard-dae4e898.js";import{J as ze}from"./json-editor-e5c9eec8.js";import"./QSlideTransition-52dc18b6.js";import"./QVirtualScroll-29da8702.js";import"./_commonjsHelpers-55d1ff45.js";const Me=G({name:"StateExplorer",props:["id","selected"],data(){return{filter:"",lastUpdate:he(F.get("objectsUpdated"),"dd. MMMM yyyy, HH:mm:ss"),loading:!1,objectTree:{},instanceList:[],selectedItem:this.selected,expandedItems:[]}},methods:{expandNode(e){if(e in this.objects){const s=e.split(".");s.splice(0,2,s[0]+"."+s[1]);let m="";s.forEach(c=>{m+=m?"."+c:c,this.$refs.StateExplorer.setExpanded(m,!0)})}},onLazyLoad({key:e,done:s}){s(this.objectTree[e]&&this.objectTree[e].children||[])},onSelect(e){e=e||this.selectedItem,this.$refs.StateExplorer.isExpanded(e)?this.$refs.StateExplorer.setExpanded(e||this.selectedItem,!1):this.objectTree[e]&&this.objectTree[e].children&&this.$refs.StateExplorer.setExpanded(e,!0),this.selectedItem=e,this.$emit("onChange",{id:this.id||"StateExplorer",value:e||""})},filterMethod(e,s){console.warn(e._id,s);const m=this.objectTree[e._id]||null,c=e._id.indexOf(s)>-1;return m&&m.children&&m.children.forEach(r=>{console.log("->"+r._id)}),c},updateObjects(){this.loading=!0,re.getObjects().then(()=>{this.lastUpdate=he(F.get("objectsUpdated"),"dd. MMMM yyyy, HH:mm:ss"),this.objects=F.get("objects"),this.objectList=F.get("objectList"),this.getInstanceList(),this.loading=!1})},getInstanceList(){const e={},s=[];this.objectList.forEach(m=>{const c=this.objects[m];if(c){const r=c._id.substr(0,c._id.lastIndexOf(".")),C=c._id.substr(0,c._id.indexOf(".",c._id.indexOf(".")+1));C&&!s.find(n=>n._id===C)&&s.push({_id:C,label:C,lazy:!0}),e[r]=e[r]||{children:[]},e[r].children.findIndex(n=>n._id===c._id)===-1&&e[r].children.push({...c,label:c._id.substr(c._id.lastIndexOf(".")+1),lazy:c.type!=="state",isState:c.type==="state"});const f=c._id.split(".");f.length>2&&f.forEach((n,i)=>{const g=f.slice(0,i).join("."),v=g.substr(0,g.lastIndexOf("."));g&&v&&(e[v]=e[v]||{children:[]},e[v].children.findIndex(h=>h._id===g)===-1&&e[v].children.push({_id:g,label:g.substr(g.lastIndexOf(".")+1),lazy:!0,isState:!1}))})}});for(const m in e)e[m].children.sort((c,r)=>c.isState===!1&&r.isState===!0?-1:c.isState===!0&&r.isState===!1?1:c.label.toLowerCase()===r.label.toLowerCase()?0:c.label.toLowerCase()>r.label.toLowerCase()?1:-1);this.objectTree=e,this.instanceList=s.sort((m,c)=>m.label.toLowerCase()===c.label.toLowerCase()?0:m.label.toLowerCase()>c.label.toLowerCase()?1:-1)}},mounted(){this.selected&&(this.expandNode(this.selected),setTimeout(()=>{const e=document.querySelector(".q-tree__node--selected");e&&e.scrollIntoView(!1)},2e3))},created(){this.filterTimeout=null,this.objects=F.get("objects"),this.objectList=F.get("objectList"),this.getInstanceList()}}),Ne={style:{"padding-bottom":"16px"}},Fe={class:"items-center justify-end row"},Be={style:{"padding-right":"8px"}},qe={class:"overflow-dots",style:{width:"5%"}},Ge={class:"overflow-dots q-pr-xs",style:{width:"25%"}},Re={class:"overflow-dots q-pr-xs",style:{width:"45%"}},Je={class:"overflow-dots",style:{width:"10%"}},He={class:"overflow-dots",style:{width:"15%"}};function We(e,s,m,c,r,C){const f=k("paper"),n=k("icon");return p(),S("div",Ne,[t(f,{class:"StateExplorerBar",style:{"min-height":"54px"}},{default:l(()=>[t(H),o("div",Fe,[o("span",Be,u(e.$t("Last Update"))+": "+u(e.lastUpdate),1),t(y,{color:"primary",label:e.$t("Refresh"),icon:"refresh",onClick:e.updateObjects,loading:e.loading,disable:e.loading},null,8,["label","onClick","loading","disable"])])]),_:1}),t(f,{class:"q-pa-sm"},{default:l(()=>[t(Qe,{ref:"StateExplorer",nodes:e.instanceList,"node-key":"_id","label-key":"label",onLazyLoad:e.onLazyLoad,"selected-color":"primary","onUpdate:selected":e.onSelect,selected:e.selectedItem},{"default-header":l(i=>[o("div",{class:M(["row full-width",{item:!i.node.children||i.node.children.length===0}])},[o("div",qe,[t(n,{color:e.selectedItem&&e.selectedItem===i.node._id?"accent":"primary",name:i.node.type==="state"?e.selectedItem&&e.selectedItem===i.node._id?"mdi-bookmark":"mdi-bookmark-outline":"folder"},null,8,["color","name"])]),o("div",Ge,u(i.node.label),1),o("div",Re,[i.node.common&&i.node.common.name&&i.node.common.name.length>50?(p(),D(me,{key:0},{default:l(()=>[w(u(i.node.common.name),1)]),_:2},1024)):O("",!0),w(" "+u(i.node.common&&i.node.common.name?i.node.common.name.length>50?i.node.common.name.substr(0,47)+"...":i.node.common.name:""),1)]),o("div",Je,u(i.node.type),1),o("div",He,u(i.node.common&&i.node.common.role?i.node.common.role:""),1)],2)]),_:1},8,["nodes","onLazyLoad","onUpdate:selected","selected"])]),_:1})])}var Ye=R(Me,[["render",We]]);const Xe=G({name:"StateExplorerPopup",props:["open"],components:{StateExplorer:Ye},data(){return{state:""}},methods:{onClose(){this.$emit("onClose",{id:this.id||"StateExplorer",value:this.state})},onSave(){this.$emit("onSave",{id:this.id||"StateExplorer",value:this.state})},onChange({value:e}){this.state=e}}}),Ze={class:"text-h6"};function xe(e,s,m,c,r,C){const f=k("state-explorer");return p(),D(pe,{"model-value":e.open,persistent:""},{default:l(()=>[t(ue,{class:"column full-height",style:{width:"1000px","max-width":"80vw"}},{default:l(()=>[t(W,{class:"row items-center"},{default:l(()=>[o("div",Ze,u(e.$t("State Explorer")),1),t(H),t(y,{flat:"",round:"",color:"grey",icon:"close",onClick:e.onClose},null,8,["onClick"])]),_:1}),t(I),t(W,{class:"col q-pa-sm scroll body"},{default:l(()=>[t(f,Ce({onOnChange:e.onChange},e.$attrs),null,16,["onOnChange"])]),_:1}),t(I),t(ve,{align:"right"},{default:l(()=>[t(y,{flat:"",label:e.$t("Cancel"),color:"negative",onClick:e.onClose},null,8,["label","onClick"]),t(y,{flat:"",label:e.$t("Apply"),color:"primary",onClick:e.onSave,disable:e.state===""},null,8,["label","onClick","disable"])]),_:1})]),_:1})]),_:1},8,["model-value"])}var et=R(Xe,[["render",xe]]);const tt=G({name:"DeviceState",emits:["onChange","setComponentProps"],props:["expanded","device","stateKey","stateList"],components:{StateExplorerPopup:et},setup(e,{emit:s}){const m=te(),c=Q(!1),r=Q(!1),C=Q(e.expanded||!1);let f="";const n=()=>{s("onChange",{stateKey:e.stateKey,id:"state.newStateKey",value:f}),r.value=!r.value},i=()=>m.copyState({stateKey:e.stateKey}),g=()=>{f=e.stateKey,r.value=!r.value},v=()=>{C.value=!1,c.value=!0,m.removeState({stateKey:e.stateKey})},h=()=>{c.value=!1,m.restoreState({stateKey:e.stateKey})},L=Q(null),T=Q(null),Y=(a,j)=>{L.value=a,T.value=j},b=()=>{L.value=null},K=({value:a})=>{A({id:L.value,stateKey:e.stateKey,value:a}),L.value=null},A=a=>{if(a._error)s("onChange",{...a,error:a._error,stateKey:e.stateKey,id:"state."+a.id});else if(a.id==="stateKeyModified")f=a.value;else{let j=a.value;try{j=j&&a.json!==void 0&&a.value.indexOf("{")>-1&&a.value.indexOf("}")>-1?JSON.parse(a.value):a.value}catch(se){console.warn(a.value,se)}s("onChange",{...a,value:j,stateKey:e.stateKey,id:"state."+a.id})}},z=E(()=>e.device.function==="other"?"_defaults":e.device.function),ie=E(()=>{const a=m.device.states[e.stateKey],j=a.bodyElement||a.bodyElement!==null&&d.value.bodyElement||null,se=a.actionElement||a.actionElement!==null&&d.value.actionElement||null;return{state:a.state&&a.state.node!==void 0?a.state.node:a.state||null,action:a.action&&a.action.node!==void 0?a.action.node:a.action||null,properties:a.properties||"",bodyStyle:a.bodyStyle||"",stateStyle:a.stateStyle||"",display:a.display||"",label:a.label||"",unit:a.unit||"",icon:a.icon||"",iconStyle:a.iconStyle||"",showState:a.showState!==void 0?a.showState:!1,bodyElement:j,bodyElementComponentValues:a[j+"Config"]||{},actionElement:se,actionElementComponentValues:a[se+"Config"]||{},hide:a.hide!==void 0?a.hide:!1}}),d=E(()=>{const a=U.Configurations[z.value]&&U.Configurations[z.value][e.stateKey.toLowerCase()]||{};return{display:JSON.stringify(a.display),stateStyle:JSON.stringify(a.stateStyle),properties:JSON.stringify(a.properties),label:a.label||"",unit:JSON.stringify(a.unit),icon:JSON.stringify(a.icon),iconStyle:JSON.stringify(a.iconStyle),bodyElement:a.bodyElement||"",actionElement:a.actionElement||""}});return{FunctionsComponentsList:U.ComponentsListAsOptions,icon:be,isDeletedState:c,isEditingStateKey:r,isExpanded:C,onStateSave:n,onStateCopy:i,onStateEdit:g,onStateRemove:v,onStateRestore:h,onStateExplorerOpen:Y,stateExplorer:L,stateExplorerSelected:T,onStateExplorerSave:K,onStateExplorerClose:b,onChange:A,placeholders:d,deviceFunction:z,deviceStates:ie}}}),st={style:{margin:"auto 84px -1px auto"}},lt={class:"row items-center"},nt={class:"row",style:{padding:"0 8px"}},ot={class:"col"},at={class:"col"},it={class:"row",style:{padding:"0 8px"}},dt={class:"col"},rt={class:"col"},ct={class:"row",style:{padding:"0 8px"}},ut={class:"col"},vt={class:"row",style:{padding:"0 8px"}},pt={class:"col"},mt={class:"row",style:{padding:"0 8px"}},ht={class:"col"},ft={class:"row",style:{padding:"0 8px"}},gt={class:"col"},bt={class:"row",style:{padding:"0 8px"}},yt={class:"col"},Ct={class:"col"},Dt={class:"row",style:{padding:"0 8px"}},St={class:"col"},wt={class:"col-2"},$t={class:"col"},Ot={class:"row",style:{padding:"0 8px"}},kt={class:"col-2"};function Et(e,s,m,c,r,C){const f=k("state-explorer-popup"),n=k("inputs"),i=k("paper"),g=k("icon");return p(),S(P,null,[t(f,{open:e.stateExplorer!==null,selected:e.stateExplorerSelected,onOnClose:e.onStateExplorerClose,onOnSave:e.onStateExplorerSave},null,8,["open","selected","onOnClose","onOnSave"]),_(t(i,{class:"row",style:{margin:"-2px 0 0 0",padding:"0 0 10px 44px"}},{default:l(()=>[t(n,{onOnChange:e.onChange,id:"stateKeyModified",onClick:s[0]||(s[0]=V(()=>{},["stop"])),label:"",value:e.stateKey,"hide-bottom-space":"",dense:""},null,8,["onOnChange","value"]),o("div",st,[t(y,{size:"sm",flat:"",round:"",onClick:e.onStateSave,icon:"mdi-check"},null,8,["onClick"]),t(y,{size:"sm",flat:"",round:"",onClick:e.onStateEdit,icon:"mdi-cancel"},null,8,["onClick"])])]),_:1},512),[[q,e.isEditingStateKey===!0]]),_(t(x,{modelValue:e.isExpanded,"onUpdate:modelValue":s[5]||(s[5]=v=>e.isExpanded=v),icon:"mdi-drag-horizontal",label:e.stateKey,class:M(["paper full-width",{rowDeleted:e.isDeletedState}]),disable:e.isDeletedState},{header:l(()=>[t($,{avatar:"",class:"dragndrop"},{default:l(()=>[t(g,{name:"mdi-drag-horizontal",class:"dragndrop"})]),_:1}),t($,{class:M({itemDeleted:e.isDeletedState})},{default:l(()=>[w(u(e.stateKey),1)]),_:1},8,["class"]),t($,{side:""},{default:l(()=>[o("div",lt,[_(o("div",null,[_(t(y,{size:"sm",flat:"",round:"",onClick:V(e.onStateEdit,["stop"]),icon:"mdi-pencil"},null,8,["onClick"]),[[q,e.isEditingStateKey===!1]]),t(y,{size:"sm",flat:"",round:"",onClick:V(e.onStateCopy,["stop"]),icon:"mdi-content-copy"},null,8,["onClick"]),t(y,{size:"sm",flat:"",round:"",onClick:V(e.onStateRemove,["stop"]),icon:"mdi-delete",color:"negative"},null,8,["onClick"])],512),[[q,e.isDeletedState!==!0]]),_(o("div",null,[t(y,{size:"sm",flat:"",round:"",onClick:V(e.onStateRestore,["stop"]),icon:"mdi-restore",color:"positive"},null,8,["onClick"])],512),[[q,e.isDeletedState===!0]])])]),_:1})]),default:l(()=>[o("div",nt,[o("div",ot,[t(n,{onOnChange:e.onChange,id:"state",label:"config#Devices#state#label",info:"config#Devices#state#info",value:e.deviceStates.state,options:e.stateList,clearable:""},{end:l(()=>[t(y,{round:"",dense:"",flat:"",icon:"mdi-database-search",color:"secondary",onClick:s[1]||(s[1]=V(v=>e.onStateExplorerOpen("state",e.deviceStates.state),["stop"])),style:{height:"33px",margin:"auto"}})]),_:1},8,["onOnChange","value","options"])]),o("div",at,[t(n,{onOnChange:e.onChange,id:"action",label:"config#Devices#action#label",info:"config#Devices#action#info",placeholder:e.deviceStates.state,value:e.deviceStates.action,options:e.stateList,clearable:""},{end:l(()=>[t(y,{round:"",dense:"",flat:"",icon:"mdi-database-search",color:"secondary",onClick:s[2]||(s[2]=V(v=>e.onStateExplorerOpen("action",e.deviceStates.action||e.deviceStates.state),["stop"])),style:{height:"33px",margin:"auto"}})]),_:1},8,["onOnChange","placeholder","value","options"])])]),o("div",it,[o("div",dt,[t(n,{onOnChange:e.onChange,id:"label",label:"config#Devices#label#label",value:e.deviceStates.label,json:"",placeholder:e.placeholders.label},null,8,["onOnChange","value","placeholder"])]),o("div",rt,[t(n,{onOnChange:e.onChange,id:"unit",label:"config#Devices#unit#label",info:"config#Devices#unit#info",value:e.deviceStates.unit,json:"allowTextInput",placeholder:e.placeholders.unit},null,8,["onOnChange","value","placeholder"])])]),o("div",ct,[o("div",ut,[t(n,{onOnChange:e.onChange,id:"bodyStyle",label:"config#Devices#bodyStyle#label",info:"config#Devices#bodyStyle#info",value:e.deviceStates.bodyStyle,json:"",placeholder:e.placeholders.bodyStyle},null,8,["onOnChange","value","placeholder"])])]),o("div",vt,[o("div",pt,[t(n,{onOnChange:e.onChange,id:"stateStyle",label:"config#Devices#stateStyle#label",info:"config#Devices#stateStyle#label",value:e.deviceStates.stateStyle,json:"",placeholder:e.placeholders.stateStyle},null,8,["onOnChange","value","placeholder"])])]),o("div",mt,[o("div",ht,[t(n,{onOnChange:e.onChange,id:"display",label:"config#Devices#display#label",info:"config#Devices#display#info",value:e.deviceStates.display,json:"",placeholder:e.placeholders.display},null,8,["onOnChange","value","placeholder"])])]),o("div",ft,[o("div",gt,[t(n,{onOnChange:e.onChange,id:"properties",label:"config#Devices#properties#label",info:"config#Devices#properties#info",value:e.deviceStates.properties,json:"",placeholder:e.placeholders.properties},null,8,["onOnChange","value","placeholder"])])]),o("div",bt,[o("div",yt,[t(n,{onOnChange:e.onChange,id:"icon",label:"config#Devices#icon#label",info:"config#Devices#icon#info",link:"https://icon-sets.iconify.design/",value:e.deviceStates.icon,json:"allowTextInput",placeholder:e.placeholders.icon,icon:e.icon(e.deviceStates.icon)},null,8,["onOnChange","value","placeholder","icon"])]),o("div",Ct,[t(n,{onOnChange:e.onChange,id:"iconStyle",label:"config#Devices#iconStyle#label",info:"config#Devices#iconStyle#info",value:e.deviceStates.iconStyle,json:"",placeholder:e.placeholders.iconStyle},null,8,["onOnChange","value","placeholder"])])]),o("div",Dt,[o("div",St,[t(n,{onOnSelect:s[3]||(s[3]=v=>e.onChange({...v,value:v.value||null})),onOnOptions:e.onChange,id:"bodyElement",label:"config#Devices#bodyElement#label",value:e.deviceStates.bodyElement,type:"select.components",components:e.FunctionsComponentsList.bodyElements[e.deviceFunction],componentValues:e.deviceStates.bodyElementComponentValues,device:e.device},null,8,["onOnOptions","value","components","componentValues","device"])]),o("div",wt,[t(n,{type:"Switch",onOnChange:e.onChange,id:"showState",label:"config#Devices#showState#label",value:e.deviceStates.showState},null,8,["onOnChange","value"])]),o("div",$t,[t(n,{onOnSelect:s[4]||(s[4]=v=>e.onChange({...v,value:v.value||null})),onOnOptions:e.onChange,id:"actionElement",label:"config#Devices#actionElement#label",value:e.deviceStates.actionElement,type:"select.components",components:e.FunctionsComponentsList.actionElements[e.deviceFunction],componentValues:e.deviceStates.actionElementComponentValues,device:e.device},null,8,["onOnOptions","value","components","componentValues","device"])])]),o("div",Ot,[o("div",kt,[t(n,{type:"Switch",onOnChange:e.onChange,id:"hide",label:"config#Devices#hide#label",info:"config#Devices#hide#info",value:e.deviceStates.hide},null,8,["onOnChange","value"])])]),t(I,{style:{"margin-top":"16px"}})]),_:1},8,["modelValue","label","class","disable"]),[[q,e.isEditingStateKey===!1]])],64)}var Lt=R(tt,[["render",Et]]);const It=G({name:"DevicePage",components:{DeviceState:Lt},setup(){const e=ae(),s=te(),m=(F.get("stateList")||[]).map(d=>({label:d,value:d})),c=Object.keys(U.Icons).map(d=>({label:e.t(d),icon:U.Icons[d]?"mdi-"+U.Icons[d].replace("mdi-",""):"",value:d})).sort((d,a)=>d.label.toLowerCase()===a.label.toLowerCase()?0:d.label.toLowerCase()>a.label.toLowerCase()?1:-1),r=Q(""),C=Q(null),f=E(()=>Object.keys(s.device.states||{})),n=E(()=>s.device.function==="_defaults"?[]:Object.keys(U.Configurations[s.device.function]||{})),i=E(()=>{const d=Object.keys(s.device.states||{});return n.value.every(a=>a==="_any"||U.Configurations[s.device.function][a].ignore||d.indexOf(a)!==-1)}),g=()=>{n.value.reverse().forEach(d=>d!=="_any"&&!U.Configurations[s.device.function][d].ignore&&v(d))},v=d=>{setTimeout(()=>{d=typeof d=="string"?d:r.value,d?f.value.indexOf(d)>-1?C.value=e.t("State key already used"):(s.newState(d),r.value="",C.value=null):C.value=e.t("Type in a state key / identifier")},25)},h=E({get(){return Object.values(s.device.states||{})},set(d){const a={};d.forEach(j=>{a[j.stateKey]=j}),s.set("device.states",a)}}),{errors:L,hasErrors:T,addError:Y,removeError:b,resetErrors:K}=Te(),A=()=>s.saveDevice(),z=()=>s.discardDevice(),ie=d=>{if(d.error||d._error)Y(d.id,d.error||d._error);else if(d.id.indexOf("device.")>-1)b(d.id),s.set({[d.id]:d.value});else if(d.id.indexOf("options.")>-1)b(d.id),s.set({"device.options":{...s.device.options||{},[d.id.replace("options.","")]:d.value}});else if(d.id.indexOf("state.")>-1)if(b(d.id),d.id==="state.newStateKey")s.changeStateKey({stateKey:d.stateKey,stateKeyModified:d.value});else if(d.id==="state.componentOptions"){b(d.id);const a=s.device.states[d.stateKey][d.component+"Config"]||{};s.editState({deviceId:s.device.id,stateKey:d.stateKey,key:d.component+"Config",val:{...a,...d.value}})}else s.editState({deviceId:s.device.id,stateKey:d.stateKey,key:d.id.replace("state.",""),val:d.value});else d.id==="newStateKey"&&(r.value=d.value)};return De(()=>s.device,()=>K()),{icon:be,...Ae(h,d=>h.value=d),errors:L,hasErrors:T,stateList:m,functions:c,addStateKey:v,addDefaultStates:g,compareStatesToDefaults:i,device:E(()=>s.device),deviceStates:h,component:Q(null),newStateKey:r,errorNewStateKey:C,onApply:A,onCancel:z,onChange:ie}}}),_t={class:"text-h6 row items-center"},jt={class:"text-h6 text-header primary"},Kt={class:"row"},Vt={class:"col-3"},Qt={class:"col-3"},Tt={class:"col-3"},At={class:"text-h6 text-header primary"},Ut={class:"row"},Pt={class:"col-3"},zt={class:"text-h6 text-header primary"},Mt={class:"row",style:{"margin-bottom":"16px"}},Nt={class:"col"},Ft={class:"col self-center"},Bt={class:"col self-center",style:{"text-align":"right"}},qt={class:"list-group",ref:"elDragDrop"};function Gt(e,s,m,c,r,C){const f=k("inputs"),n=k("device-state");return p(),D(pe,{"model-value":e.device!==null,"full-height":"",persistent:""},{default:l(()=>[e.device!==null?(p(),D(ue,{key:0,class:"column full-height",style:{width:"1000px","max-width":"80vw"}},{default:l(()=>[t(W,{class:"row items-center"},{default:l(()=>[o("div",_t,[w(u(e.$t("Device"))+": ",1),t(f,{dense:"",onOnChange:e.onChange,id:"device.name",label:e.$t("Name"),value:e.device.name||"",required:"",autofocus:"",style:{width:"230px","margin-right":"16px"}},null,8,["onOnChange","label","value"]),w(" ("+u(e.$t("Device ID")+": "+e.device.id)+") ",1)]),t(H),t(y,{flat:"",round:"",color:"grey",icon:"close",onClick:e.onCancel},null,8,["onClick"])]),_:1}),t(I),t(W,{class:"col defaultPadding-2 q-pt-none scroll body"},{default:l(()=>[o("div",jt,u(e.$t("General")),1),t(I,{style:{margin:"0 -16px"}}),o("div",Kt,[o("div",Vt,[t(f,{onOnChange:e.onChange,id:"device.label",label:e.$t("Label"),value:e.device.label||"",placeholder:e.device.name},null,8,["onOnChange","label","value","placeholder"])]),o("div",Qt,[t(f,{onOnSelect:e.onChange,id:"device.function",label:e.$t("Function"),value:e.device.function==="other"?"_defaults":e.device.function,type:"select",options:e.functions,"options-dense":"","use-input":""},null,8,["onOnSelect","label","value","options"])]),o("div",Tt,[t(f,{onOnChange:e.onChange,id:"device.icon",label:e.$t("Icon"),value:e.device.icon||"",icon:e.icon(e.device.icon)},null,8,["onOnChange","label","value","icon"])])]),o("div",At,u(e.$t("Options")),1),t(I,{style:{margin:"0 -16px"}}),o("div",Ut,[o("div",Pt,[t(f,{onOnChange:e.onChange,type:"switch",id:"options.suppressPopup",label:"Suppress Popup","indeterminate-value":"false",value:e.device.options.suppressPopup||!1},null,8,["onOnChange","value"])])]),o("div",zt,u(e.$t("States")),1),t(I,{style:{margin:"0 -16px"}}),o("div",Mt,[o("div",Nt,[t(f,{debounce:10,onOnChange:e.onChange,id:"newStateKey",value:e.newStateKey,label:"new state key",icon:"mdi-plus",onKeydown:Se(V(e.addStateKey,["stop"]),["enter"]),errorMessage:e.errorNewStateKey},null,8,["onOnChange","value","onKeydown","errorMessage"])]),o("div",Ft,[t(y,{color:"primary",label:e.$t("add state"),icon:"mdi-plus-circle",onClick:e.addStateKey},null,8,["label","onClick"])]),o("div",Bt,[e.device.function!=="_defaults"?(p(),D(y,{key:0,color:"secondary",label:e.$t("add default states"),icon:e.compareStatesToDefaults?"check":"mdi-playlist-plus",onClick:e.addDefaultStates,disable:e.compareStatesToDefaults},null,8,["label","icon","onClick","disable"])):O("",!0)])]),o("ul",qt,[(p(!0),S(P,null,N(e.deviceStates,i=>(p(),S("li",{key:i.stateKey,class:"list-group-item"},[t(n,{onOnChange:e.onChange,onSetComponentProps:s[0]||(s[0]=g=>e.component=arguments[0]),expanded:!1,device:e.device,stateKey:i.stateKey,stateList:e.stateList},null,8,["onOnChange","device","stateKey","stateList"])]))),128))],512)]),_:1}),t(I),t(ve,{align:"right"},{default:l(()=>[t(y,{flat:"",label:e.$t("Cancel"),color:"negative",onClick:e.onCancel},null,8,["label","onClick"]),t(y,{flat:"",label:e.$t("Apply"),color:"primary",onClick:e.onApply,disable:e.hasErrors},null,8,["label","onClick","disable"])]),_:1})]),_:1})):O("",!0)]),_:1},8,["model-value"])}var Rt=R(It,[["render",Gt]]);const Jt=G({name:"ImportDevices",props:["open"],emits:["onClose"],setup(){const e=ae(),s=te();return{i18n:e,editor:s}},data(){return this.ucFirst=we,{selectedAdapters:[],adapterStructure:"all",adapterStructureOptions:[{label:this.i18n.t("Search adapter structure for all devices"),value:"all"},{label:this.i18n.t("Search only for devices added to enums"),value:"enums"}],categories:{new:"New Devices",existing:"Devices that have been added already",incorrect:"Devices with incorrect configuration (states not found)",ignored:"Devices marked as ignored"},expanded:{_adapterList:!0,new:!0},importedDevices:{all:{},new:{},existing:{},incorrect:{},ignored:{},manufacturer:{}},selectedDevices:{new:[],existing:[],ignored:[]},showImportDevices:!1,state:null}},methods:{importDevices(){this.state=null,this.onClose();const e={},s=[...this.selectedDevices.new,...this.selectedDevices.existing];for(const c of s)e[c]=this.importedDevices.all[c];const m=Object.keys(this.importedDevices.ignored);for(const c of m)e[c]=this.importedDevices.ignored[c],e[c].attributes=e[c].attributes||{},e[c].attributes.ignore=!0;this.editor.addDevices({devices:e})},onClose(){this.expanded._adapterList=!0,this.showImportDevices=!1,this.$emit("onClose",this.showImportDevices)},readAdapters(){this.state="loading",this.adapterStructure==="all"?re.importDevices(this.selectedAdapters).then(this.setImportedDevices).catch(e=>{ee._("ImportDevicesPage","IMPORT_DEVICES: "+e.message,"error")}):re.importEnums("functions",this.selectedAdapters).then(this.setImportedDevices).catch(e=>{ee._("ImportDevicesPage","IMPORT_ENUMS: "+e.message,"error")})},setImportedDevices(e){this.expanded._adapterList=!1,this.importedDevices={all:{},new:{},existing:{},incorrect:{},ignored:{},manufacturer:{}};const s=this.editor.devices||{};e.forEach((m,c)=>{const r=m.value||m.reason;r.attributes=r.attributes||{};let C="new";m.status==="fulfilled"&&m.value&&m.value.states&&Object.keys(m.value.states).length>0?s[r.id]!==void 0&&(C="existing",s[r.id].attributes&&s[r.id].attributes.ignore===!0&&(C="ignored")):(C="incorrect",r.states=null,r.attributes.note=r.attributes.note||m.reason&&m.reason.error&&m.reason.error.message||this.i18n.t("No correct defined states found. The device may be unknown. Please help the developer to add support for this device and report to Github.")),this.importedDevices[C][r.id]=r,this.importedDevices.all[r.id]=r,r.attributes.manufacturer&&r.attributes.manufacturer.namespace&&(this.importedDevices.manufacturer[r.attributes.manufacturer.namespace]=this.importedDevices.manufacturer[r.attributes.manufacturer.namespace]||[],this.importedDevices.manufacturer[r.attributes.manufacturer.namespace].push(r.id))}),this.selectedDevices.new=Object.keys(this.importedDevices.new),this.state="loaded"},toggleAllAdapterListItems(){this.selectedAdapters.length>0?this.selectedAdapters=[]:this.selectedAdapters=Object.keys(fe)},toggleAllDevicesListItems(e){this.selectedDevices[e].length>0?this.selectedDevices[e]=[]:this.selectedDevices[e]=Object.keys(this.importedDevices[e])},ignoreDevice(e){this.importedDevices.ignored[e.id]=e,delete this.importedDevices.new[e.id],delete this.selectedDevices.new[this.selectedDevices.new.indexOf(e.id)]},restoreDevice(e){this.importedDevices.new[e.id]=e,this.selectedDevices.new.push(e.id),delete this.importedDevices.ignored[e.id]}},computed:{importDevicesLength(){return this.selectedDevices.new.length+this.selectedDevices.existing.length},importedDevicesLength(){return{all:Object.keys(this.importedDevices.all).length,new:Object.keys(this.importedDevices.new).length,existing:Object.keys(this.importedDevices.existing).length,incorrect:Object.keys(this.importedDevices.incorrect).length,ignored:Object.keys(this.importedDevices.ignored).length}},adapterList(){return Object.values(fe).map(e=>({...e,devices:this.importedDevices.manufacturer[e.namespace]?this.importedDevices.manufacturer[e.namespace].length:0,name:e.default}))}},watch:{open(e){this.showImportDevices=e}},created(){this.toggleAllAdapterListItems()}}),Ht={class:"text-h6"},Wt={class:"text-h6 text-header primary"},Yt={key:0,style:{"margin-bottom":"16px"}},Xt={class:"text-h6 text-header primary"},Zt={class:"q-pa-sm"},xt={key:0},es={key:1,style:{width:"40px"}},ts={style:{"padding-left":"72px"}},ss={class:"stateList"};function ls(e,s,m,c,r,C){const f=k("icon");return p(),D(pe,{modelValue:e.showImportDevices,"onUpdate:modelValue":s[3]||(s[3]=n=>e.showImportDevices=n),persistent:""},{default:l(()=>[t(ue,{class:"column full-height",style:{width:"1000px","max-width":"80vw"}},{default:l(()=>[t(W,{class:"row items-center"},{default:l(()=>[o("div",Ht,u(e.$t("Import Devices")),1),t(H),t(y,{flat:"",round:"",color:"grey",icon:"close",onClick:e.onClose},null,8,["onClick"])]),_:1}),t(I),t(W,{class:"col q-pa-sm scroll body"},{default:l(()=>[o("div",Wt,u(e.$t("Adapter")),1),t(I,{style:{margin:"0 -16px"}}),t($e,{label:e.$t("Search the adapter structure for all devices or only devices added to enums"),"stack-label":"",borderless:"",class:"q-pa-sm"},{control:l(()=>[t(Oe,{modelValue:e.adapterStructure,"onUpdate:modelValue":s[0]||(s[0]=n=>e.adapterStructure=n),options:e.adapterStructureOptions,color:"primary",inline:""},null,8,["modelValue","options"])]),_:1},8,["label"]),t(x,{modelValue:e.expanded._adapterList,"onUpdate:modelValue":s[2]||(s[2]=n=>e.expanded._adapterList=n),class:"paper shadow-1 rounded-borders full-width"},{header:l(()=>[t($,null,{default:l(()=>[w(u(e.$t("Adapter List")),1)]),_:1}),e.state==="loaded"?(p(),D($,{key:0,side:""},{default:l(()=>[t(le,{color:"secondary","text-color":"white"},{default:l(()=>[w(u(e.$t("Devices"))+": "+u(e.importedDevicesLength.all),1)]),_:1})]),_:1})):O("",!0)]),default:l(()=>[t(ce,{dense:"",style:{"margin-bottom":"16px"}},{default:l(()=>[_((p(),D(X,{tag:"label",onClick:V(e.toggleAllAdapterListItems,["prevent"])},{default:l(()=>[t($,{side:""},{default:l(()=>[t(ne,{size:"xs","onUpdate:modelValue":e.toggleAllAdapterListItems,"false-value":0,"true-value":e.adapterList.length,"model-value":e.selectedAdapters.length},null,8,["onUpdate:modelValue","true-value","model-value"])]),_:1}),t($,null,{default:l(()=>[t(B,null,{default:l(()=>[o("em",null,u(e.$t("(Un)Select all adapters"))+" ("+u(e.selectedAdapters.length)+")",1)]),_:1})]),_:1})]),_:1},8,["onClick"])),[[oe]]),(p(!0),S(P,null,N(e.adapterList,n=>_((p(),D(X,{tag:"label",key:n.namespace},{default:l(()=>[t($,{side:""},{default:l(()=>[t(ne,{size:"xs",modelValue:e.selectedAdapters,"onUpdate:modelValue":s[1]||(s[1]=i=>e.selectedAdapters=i),val:n.namespace},null,8,["modelValue","val"])]),_:2},1024),t($,null,{default:l(()=>[t(B,null,{default:l(()=>[w(u(n.name)+" ",1),t(f,{name:"information",color:"primary",class:"q-ma-xs",style:{"font-size":"1.2rem"}}),t(me,{"content-class":"bg-grey-8",offset:[4,4]},{default:l(()=>[w(u(e.$t("import#warning").replace("{deviceObjectType}",n.deviceObjectType||"device").replace("{devicePattern}",n.devicePattern)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t($,{side:""},{default:l(()=>[t(B,null,{default:l(()=>[e.state==="loaded"&&e.selectedAdapters.indexOf(n.namespace)>-1?(p(),D(le,{key:0,color:"primary","text-color":"white"},{default:l(()=>[w(u(e.$t("Devices"))+": "+u(n.devices),1)]),_:2},1024)):O("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[oe]])),128))]),_:1})]),_:1},8,["modelValue"]),e.state!==null?(p(),S("div",Yt,[o("div",Xt,u(e.$t("Devices")),1),t(I,{style:{margin:"0 -16px 16px -16px"}}),o("div",Zt,[e.state==="loading"?(p(),D(ke,{key:0,color:"primary",size:"md"})):O("",!0)]),e.state==="loaded"?(p(),S("div",xt,[(p(!0),S(P,null,N(e.categories,(n,i)=>(p(),D(x,{modelValue:e.expanded[i],"onUpdate:modelValue":g=>e.expanded[i]=g,class:"paper shadow-1 rounded-borders full-width",key:i,disable:e.importedDevicesLength[i]===0,style:{"margin-bottom":"8px"}},{header:l(()=>[t($,null,{default:l(()=>[w(u(e.$t(n)),1)]),_:2},1024),t($,{side:""},{default:l(()=>[t(le,{color:"secondary","text-color":"white"},{default:l(()=>[w(u(e.importedDevicesLength[i]),1)]),_:2},1024)]),_:2},1024)]),default:l(()=>[e.importedDevicesLength[i]>0?(p(),D(ce,{key:0,dense:""},{default:l(()=>[i==="new"||i==="existing"?_((p(),D(X,{key:0,tag:"label"},{default:l(()=>[t($,{side:""},{default:l(()=>[t(ne,{"model-value":e.selectedDevices[i].length!==0,onClick:V(g=>e.toggleAllDevicesListItems(i),["stop"])},null,8,["model-value","onClick"])]),_:2},1024),t($,null,{default:l(()=>[t(B,null,{default:l(()=>[o("em",null,u(e.$t("(Un)Select all devices"))+" ("+u(e.selectedDevices[i].length)+")",1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[oe]]):O("",!0),(p(!0),S(P,null,N(e.importedDevices[i],g=>(p(),D(x,{"expand-icon-toggle":"","expand-separator":"",dense:"",class:"full-width",key:g.id},{header:l(()=>[_((p(),D(X,{tag:"label",disable:i!=="new"&&i!=="existing",class:"full-width"},{default:l(()=>[t($,{side:""},{default:l(()=>[i==="new"||i==="existing"?(p(),D(ne,{key:0,modelValue:e.selectedDevices[i],"onUpdate:modelValue":v=>e.selectedDevices[i]=v,val:g.id},null,8,["modelValue","onUpdate:modelValue","val"])):(p(),S("div",es))]),_:2},1024),t($,null,{default:l(()=>[t(B,null,{default:l(()=>[w(u(g.name)+" ",1),g.attributes&&g.attributes.manufacturer?(p(),D(le,{key:0,color:"accent","text-color":"white"},{default:l(()=>[w(u(g.attributes.manufacturer.name),1)]),_:2},1024)):O("",!0)]),_:2},1024)]),_:2},1024),t($,{side:""},{default:l(()=>[t(B,null,{default:l(()=>[i==="new"?(p(),D(y,{key:0,flat:"",label:e.$t("ignore"),color:"negative",onClick:v=>e.ignoreDevice(g)},null,8,["label","onClick"])):O("",!0),i==="ignored"?(p(),D(y,{key:1,flat:"",label:e.$t("restore"),color:"positive",onClick:v=>e.restoreDevice(g)},null,8,["label","onClick"])):O("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"])),[[oe]])]),default:l(()=>[o("div",ts,[w(u(e.$t("Function"))+": "+u(e.$t(g.function))+" ",1),o("ul",ss,[(p(!0),S(P,null,N(g.states,(v,h)=>(p(),S("li",{key:h},[o("strong",null,u(h),1),(p(!0),S(P,null,N(v,(L,T)=>(p(),S("ul",{class:"stateKeyList",key:T},[o("li",null,[w(u(e.$t(e.ucFirst(T)))+": ",1),o("code",null,u(L),1)])]))),128))]))),128))])])]),_:2},1024))),128))]),_:2},1024)):O("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","disable"]))),128))])):O("",!0)])):O("",!0)]),_:1}),t(I),t(ve,{align:"right"},{default:l(()=>[t(y,{flat:"",label:e.$t("Cancel"),color:"negative",onClick:e.onClose},null,8,["label","onClick"]),t(y,{flat:"",label:e.$t("Read Adapters"),color:"secondary",onClick:e.readAdapters,loading:e.state==="loading",disable:e.selectedAdapters.length===0},null,8,["label","onClick","loading","disable"]),e.state==="loaded"?(p(),D(y,{key:0,flat:"",label:e.$t("Import selected devices")+" ("+e.importDevicesLength+")",color:"primary",onClick:e.importDevices,disable:e.importDevicesLength===0},null,8,["label","onClick","disable"])):O("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}var ns=R(Jt,[["render",ls]]);const os=G({name:"DevicesTable",props:["devices"],setup(){ee.dev("DEBUG","DevicesTable","setup()");const e=ae(),s=te(),m={sortBy:"name",rowsPerPage:15},c=[{name:"name",label:e.t("Name")+" ("+e.t("ID")+")",field:"name",align:"left",sortable:!0,style:{width:"20%"}},{name:"function",label:e.t("Function"),field:"function",align:"left",sortable:!0,format:v=>e.t(v),style:{width:"10%"}},{name:"manufacturer",label:e.t("Manufacturer"),field:"manufacturer",align:"left",sortable:!0,format:(v,h)=>h.attributes&&h.attributes.manufacturer?h.attributes.manufacturer.name:"",style:{width:"10%"}},{name:"states",label:e.t("States"),field:"states",align:"left",sortable:!0,format:v=>(v=Object.keys(v||"{}").join(", "),v.length>130?v.substr(0,128)+" ...":v),style:{width:"60%"}}],{copyToClipboard:r}=Pe();return{pagination:m,columns:c,copyClipboard:r,isDeleted:v=>v.attributes&&v.attributes.deleted===!0,onDeviceEdit:v=>s.editDevice(v),onDeviceCopy:v=>s.copyDevice(v),onDeviceRemove:v=>s.removeDevice(v),onDeviceRestore:v=>s.restoreDevice(v)}}}),as={class:"q-pa-md"},is={key:0},ds=["onClick"],rs={key:0};function cs(e,s,m,c,r,C){const f=k("icon");return p(),S("div",as,[t(Ue,{rows:e.devices,columns:e.columns,pagination:e.pagination,"rows-per-page-label":e.$t("Devices per page")},{header:l(n=>[t(ge,{props:n},{default:l(()=>[t(de,{"auto-width":""}),(p(!0),S(P,null,N(n.cols,i=>(p(),D(de,{key:i.name,props:n},{default:l(()=>[w(u(i.label),1)]),_:2},1032,["props"]))),128)),t(de,{"auto-width":""})]),_:2},1032,["props"])]),body:l(n=>[t(ge,{props:n,class:M({rowDeleted:e.isDeleted(n.row)})},{default:l(()=>[t(J,{"auto-width":""},{default:l(()=>[e.isDeleted(n.row)!==!0?(p(),S("div",is,[t(y,{size:"sm",flat:"",round:"",onClick:i=>e.onDeviceEdit(n.row),icon:"mdi-pencil"},null,8,["onClick"]),t(y,{size:"sm",flat:"",round:"",onClick:i=>e.onDeviceCopy(n.row),icon:"mdi-content-copy"},null,8,["onClick"])])):O("",!0)]),_:2},1024),t(J,{style:Z(n.cols[0].style||{})},{default:l(()=>[o("div",{class:M(["cursor-pointer",{itemDeleted:e.isDeleted(n.row)}]),onClick:i=>e.copyClipboard(n.row.id)},[t(me,null,{default:l(()=>[w(" ID: "+u(n.row.id)+" ("+u(e.$t("click to copy to clipboard"))+") ",1)]),_:2},1024),o("span",null,u(n.row.name),1),n.row.label?(p(),S("span",rs," ("+u(n.row.label)+")",1)):O("",!0),t(f,{name:"clipboard-text-multiple-outline",size:"xs",style:{"margin-left":"4px"}})],10,ds)]),_:2},1032,["style"]),t(J,{style:Z(n.cols[1].style||{})},{default:l(()=>[o("div",{class:M({itemDeleted:e.isDeleted(n.row)})},u(n.cols[1].value),3)]),_:2},1032,["style"]),t(J,{style:Z(n.cols[2].style||{})},{default:l(()=>[o("div",{class:M({itemDeleted:e.isDeleted(n.row)})},u(n.cols[2].value),3)]),_:2},1032,["style"]),t(J,{style:Z(n.cols[3].style||{})},{default:l(()=>[o("div",{class:M({itemDeleted:e.isDeleted(n.row)})},u(n.cols[3].value),3)]),_:2},1032,["style"]),t(J,{"auto-width":""},{default:l(()=>[e.isDeleted(n.row)!==!0?(p(),D(y,{key:0,size:"sm",flat:"",round:"",onClick:i=>e.onDeviceRemove(n.row),icon:"mdi-delete",color:"negative"},null,8,["onClick"])):O("",!0),e.isDeleted(n.row)?(p(),D(y,{key:1,size:"sm",flat:"",round:"",onClick:i=>e.onDeviceRestore(n.row),icon:"mdi-restore",color:"positive"},null,8,["onClick"])):O("",!0)]),_:2},1024)]),_:2},1032,["props","class"])]),_:1},8,["rows","columns","pagination","rows-per-page-label"])])}var us=R(os,[["render",cs]]);const vs=G({name:"DevicesPage",components:{DevicePage:Rt,DevicesTable:us,ImportDevices:ns,JsonEditor:ze},setup(){ee.dev("DEBUG","DevicesPage","setup()");const e=ae(),s=te(),m=Ee(),c=E(()=>s.getGroups(n.value.value,f.value)),r=[{label:e.t("Function"),value:"function"},{label:e.t("Manufacturer"),value:"manufacturer"}],C=E(()=>s.getDevicesWthoutDeletionsCount),f=E({get(){var b;return((b=s.settings)==null?void 0:b.configDevicesFilter)||""},set(b){s.set("settings.configDevicesFilter",b)}}),n=E({get(){var b;return((b=s.settings)==null?void 0:b.configDevicesGroupBy)&&r.find(K=>K.value===s.settings.configDevicesGroupBy)||r[0]},set({value:b}){s.set("settings.configDevicesGroupBy",b)}}),i=E(()=>m.pageHeight),g=E(()=>s.devices),v=E(()=>{var b;return(b=s.settings)==null?void 0:b.configExpertMode}),h=()=>s.actionSwapNameWithLabel(),L=()=>s.addDevice(),T=({id:b,error:K,value:A})=>{if(ee.dev("DEBUG","DevicesPage","onChange",b,K,A),K)s.addError("settings-"+b,K.message||K);else if(A){s.removeError("settings-"+b);for(const z in A)s.set({["settings."+z]:A[z]})}},Y=b=>{if(b._error){s.addError(b.id,b._error);return}s.removeError(b.id),b.value&&s.set({tmpJsonEditor:{key:b.id,json:JSON.parse(b.value)}})};return{expanded:Q({}),showImportDevices:Q(!1),devicesCount:C,devicesFilter:f,devicesGroupBy:n,groups:c,groupByOptions:r,json:g,expertMode:v,pageHeight:i,actionSwapNameWithLabel:h,addDevice:L,onChange:T,onJsonEditor:Y}}}),ps={class:"full-height DevicesPage"},ms={class:"row no-wrap"},hs={class:"row items-center"},fs={key:0},gs={key:1};function bs(e,s,m,c,r,C){const f=k("device-page"),n=k("import-devices"),i=k("devices-table"),g=k("json-editor"),v=k("paper");return p(),S("div",ps,[o("div",ms,[t(Ve,{class:"paper",style:{"min-height":"56px"}},{default:l(()=>[t(ye,{shrink:""},{default:l(()=>[w(u(e.$t("Devices List"))+" ("+u(e.devicesCount)+")",1)]),_:1}),t(Le,{dense:"",label:e.$t("Group by"),"stack-label":"",style:{width:"150px","margin-right":"8px"},modelValue:e.devicesGroupBy,"onUpdate:modelValue":s[0]||(s[0]=h=>e.devicesGroupBy=h),options:e.groupByOptions},null,8,["label","modelValue","options"]),t(Ie,{dense:"",label:e.$t("Filter"),"stack-label":"",clearable:"",modelValue:e.devicesFilter,"onUpdate:modelValue":s[1]||(s[1]=h=>e.devicesFilter=h),debounce:900,style:{width:"250px"}},null,8,["label","modelValue"]),t(H),t(Ke,{class:"q-mx-xs",icon:"mdi-hammer-screwdriver",color:"secondary",label:e.$t("Quick Actions")},{default:l(()=>[t(ce,null,{default:l(()=>[_((p(),D(X,{clickable:"",onClick:e.actionSwapNameWithLabel},{default:l(()=>[t($,{avatar:""},{default:l(()=>[t(_e,{name:"mdi-swap-horizontal"})]),_:1}),t($,null,{default:l(()=>[t(B,null,{default:l(()=>[w(u(e.$t("Swap Device Name and Label")),1)]),_:1})]),_:1})]),_:1},8,["onClick"])),[[je]])]),_:1})]),_:1},8,["label"]),t(y,{class:"q-mx-xs",color:"primary",icon:"mdi-cloud-download",label:e.$t("Import Devices"),onClick:s[2]||(s[2]=h=>e.showImportDevices=!0)},null,8,["label"]),t(y,{class:"q-mx-xs",color:"primary",icon:"mdi-plus-circle",label:e.$t("Add Device"),onClick:e.addDevice},null,8,["label","onClick"])]),_:1})]),t(f),t(n,{onOnClose:s[3]||(s[3]=h=>e.showImportDevices=!1),open:e.showImportDevices},null,8,["open"]),(p(!0),S(P,null,N(e.groups,h=>_((p(),S("div",{class:"row no-wrap paper",key:h.id},[t(x,{modelValue:e.expanded[h.id],"onUpdate:modelValue":L=>e.expanded[h.id]=L,icon:h.icon,label:(h.label||"(hi)")+" ("+h.devices.length+")",class:"full-width"},{header:l(()=>[o("div",hs,[h.label?(p(),S("span",gs,u(h.label),1)):(p(),S("em",fs,"("+u(e.$t("without label"))+")",1)),w(" \xA0("+u(h.devices.length)+") ",1)]),t(H)]),default:l(()=>[t(i,{devices:h.devices},null,8,["devices"])]),_:2},1032,["modelValue","onUpdate:modelValue","icon","label"])])),[[q,!e.expertMode&&h.devices.length>0]])),128)),_(t(v,{style:Z({height:e.pageHeight-66-16+"px"})},{default:l(()=>[t(g,{id:"devices",json:e.json,onOnChange:e.onJsonEditor},null,8,["json","onOnChange"])]),_:1},8,["style"]),[[q,e.expertMode]])])}var Vs=R(vs,[["render",bs]]);export{Vs as default};
