import{c as $,a3 as Q,w,z as P,d as C,e as u,a as D,l as E,C as N}from"./vendor.quasar-78ba37d9.js";import{d as B,u as j,p as v,q as A,w as V,o as n,a as L,b as z,v as q,h as s,f as c,i as l,e as O,j as h,t as d,g as k,n as T}from"./vendor.vue-1bbf3cb4.js";import{M as F}from"./modules-9c8c454f.js";import{C as H}from"./controllers-596cf83c.js";import{_ as K,f as R}from"./helpers-7b53fe93.js";import{b as Z}from"./stores-22cbae97.js";import{j as G,t as J,b as U,r as W}from"./assets.img-0106ff20.js";var X={"ScriptStatus#description":"Zeigt alle Skripte mit dem jeweiligen Status an.","config#ScriptStatus#switch#label":"Schalten erlauben","config#ScriptStatus#switch#description":"Das An- bzw. Abschalten von Skripten erlauben","config#ScriptStatus#expanded#label":"Ordner aufklappen","config#ScriptStatus#expanded#description":"Alle Ordner standardm\xE4\xDFig aufklappen","config#ScriptStatus#list#label":"Liste angezeigter Skripte","config#ScriptStatus#list#description":"Liste der Skripte, die angezeigt werden (leere Liste zeigt alle Skripte)","config#ScriptStatus#list#values":"Namen der Skripte mit Komma separiert","config#ScriptStatus#blacklist#label":"Liste nicht angezeigter Skripte","config#ScriptStatus#blacklist#description":"Zeigt alle Skripte, au\xDFer die hier angegebenen","config#ScriptStatus#blacklist#values":"Namen der Skripte mit Komma separiert"},me=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"})),Y={"ScriptStatus#description":"Displays a list of all scripts including their status","config#ScriptStatus#switch#label":"Enable Switch","config#ScriptStatus#switch#description":"Allow to switch scripts on / off","config#ScriptStatus#expanded#label":"Expand Tree","config#ScriptStatus#expanded#description":"Expand all folders by default","config#ScriptStatus#list#label":'List of Script"s',"config#ScriptStatus#list#description":"List of script to show (empty shows all scripts)","config#ScriptStatus#list#values":"Script names separated by comma","config#ScriptStatus#blacklist#label":'List of Script"s to hide',"config#ScriptStatus#blacklist#description":"Shows all scripts except the ones listed here","config#ScriptStatus#blacklist#values":"Script names separated by comma"},be=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"})),ee={"ScriptStatus#description":"\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043F\u0438\u0441\u043E\u043A \u0441\u043A\u0440\u0438\u043F\u0442\u043E\u0432 \u0438 \u0438\u0445 \u0441\u0442\u0430\u0442\u0443\u0441\u043E\u0432","config#ScriptStatus#switch#label":"\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044C \u043F\u0435\u0440\u0435\u043A\u043B\u044E\u0447\u0430\u0442\u0435\u043B\u044C","config#ScriptStatus#switch#description":"\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u044C \u0432\u043A\u043B\u044E\u0447\u0430\u0442\u044C / \u0432\u044B\u043A\u043B\u044E\u0447\u0430\u0442\u044C \u0441\u043A\u0440\u0438\u043F\u0442\u044B","config#ScriptStatus#expanded#label":"\u0420\u0430\u0437\u0432\u0435\u0440\u043D\u0443\u0442\u044C \u0434\u0435\u0440\u0435\u0432\u043E","config#ScriptStatus#expanded#description":"\u0420\u0430\u0437\u0432\u0435\u0440\u043D\u0443\u0442\u044C \u0432\u0441\u0435 \u043F\u0430\u043F\u043A\u0438 \u043F\u043E \u0443\u043C\u043E\u043B\u0447\u0430\u043D\u0438\u044E","config#ScriptStatus#list#label":"\u0421\u043F\u0438\u0441\u043E\u043A \u0441\u043A\u0440\u0438\u043F\u0442\u043E\u0432","config#ScriptStatus#list#description":"\u0421\u043F\u0438\u0441\u043E\u043A \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0435\u043C\u044B\u0445 \u0441\u043A\u0440\u0438\u043F\u0442\u043E\u0432 (\u0435\u0441\u043B\u0438 \u043F\u0443\u0441\u0442\u043E\u0439 - \u043E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u044E\u0442\u0441\u044F \u0432\u0441\u0435)","config#ScriptStatus#list#values":"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u044F \u0441\u043A\u0440\u0438\u043F\u0442\u043E\u0432 \u0440\u0430\u0437\u0434\u0435\u043B\u044F\u044E\u0442\u0441\u044F \u0437\u0430\u043F\u044F\u0442\u043E\u0439","config#ScriptStatus#blacklist#label":"\u0421\u043F\u0438\u0441\u043E\u043A \u0441\u043A\u0440\u044B\u0442\u044B\u0445 \u0441\u043A\u0440\u0438\u043F\u0442\u043E\u0432","config#ScriptStatus#blacklist#description":"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0432\u0441\u0435 \u0441\u043A\u0440\u0438\u043F\u0442\u044B \u0437\u0430 \u0438\u0441\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435\u043C \u043F\u0435\u0440\u0435\u0447\u0438\u0441\u043B\u0435\u043D\u043D\u044B\u0445 \u0437\u0434\u0435\u0441\u044C","config#ScriptStatus#blacklist#values":"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u044F \u0441\u043A\u0440\u0438\u043F\u0442\u043E\u0432 \u0440\u0430\u0437\u0434\u0435\u043B\u044F\u044E\u0442\u0441\u044F \u0437\u0430\u043F\u044F\u0442\u043E\u0439"},ve=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));const te={addGroup:!1,addDivider:!1,addDevice:!1};var x=[{columns:2,parameter:"switch",label:"config#ScriptStatus#switch#label",info:"config#ScriptStatus#switch#description",type:"Switch",value:!0},{columns:2,parameter:"expanded",label:"config#ScriptStatus#expanded#label",info:"config#ScriptStatus#expanded#description",type:"Switch",value:!0},{parameter:"list",label:"config#ScriptStatus#list#label",info:"config#ScriptStatus#list#description",placeholder:"config#ScriptStatus#list#values"},{parameter:"blacklist",label:"config#ScriptStatus#blacklist#label",info:"config#ScriptStatus#blacklist#description",placeholder:"config#ScriptStatus#blacklist#values"}],he=Object.freeze(Object.defineProperty({__proto__:null,Settings:te,default:x},Symbol.toStringTag,{value:"Module"}));const p={js:G,ts:J,blockly:U,rules:W},ie=B({name:"ModuleScriptStatus",props:["widget"],setup(t){const y=H.getConnection,_=Z(),r=j(()=>t.widget.config),o=j(()=>({...F.joinConfig(r.value,x),list:r.value.list?r.value.list.replace(/, /g,",").split(","):null,blacklist:r.value.blacklist?r.value.blacklist.replace(/, /g,",").split(","):null})),S=v(null),e=(i,a)=>!(o.value.list&&!o.value.list.some(b=>RegExp("^"+b.toLowerCase().replace(/\./g,".").replace(/\*/g,".*")+"$").test(i.id.toLowerCase()))||o.value.blacklist&&o.value.blacklist.some(b=>RegExp("^"+b.toLowerCase().replace(/\./g,".").replace(/\*/g,".*")+"$").test(i.id.toLowerCase())));A(()=>{S.value="*"});const f=v(null);V(()=>_.scripts,i=>{f.value=i&&i.val||null},{immediate:!0});const I=i=>{let a="mdi-help-box";switch(i&&i.toLowerCase()){case"javascript/js":a="img:"+p.js;break;case"blockly":a="img:"+p.blockly;break;case"rules":a="img:"+p.rules;break;case"typescript/ts":a="img:"+p.ts;break;default:a="mdi-help-box"}return a},g=v({});return{moduleConfig:o,format:R,getIcon:I,loading:g,scripts:f,set:(i,a)=>{g.value[i]=!0,y.setScript(i,a).catch(m=>{console.error(m)}).finally(()=>{g.value[i]=!1})},filter:S,onFilter:e}}}),ae={class:"jarvis-ScriptStatus"},se={class:"jarvis-ScriptStatus-Item-Title"},le={key:0,style:{"font-size":"70%"}};function ne(t,y,_,r,o,S){return n(),L("div",ae,[z(s($,{indeterminate:""},null,512),[[q,t.scripts===null]]),t.scripts!==null?(n(),c(E,{key:0,nodes:t.scripts,"node-key":"id","label-key":"id","default-expand-all":t.moduleConfig.expanded,"filter-method":t.onFilter,filter:t.filter,dense:""},{"default-header":l(e=>[O("div",{class:T(["jarvis-ScriptStatus-Item row items-center",{"cursor-pointer":t.moduleConfig.switch,folder:e.node.type==="folder",item:e.node.type==="file",disable:e.node.type==="file"&&!e.node.enabled,enable:e.node.type==="file"&&e.node.enabled}])},[t.loading[e.node.id]===!0?(n(),c(Q,{key:0,class:"q-mr-sm jarvis-ScriptStatus-Item-Loading",color:"primary",size:"21px"})):(n(),c(w,{key:1,class:"q-mr-sm jarvis-ScriptStatus-Item-Icon",name:e.node.engineType?t.getIcon(e.node.engineType):e.expanded?"mdi-folder-open":"mdi-folder",color:e.node.engineType?"secondary":"primary"},null,8,["name","color"])),O("div",se,[h(d(e.node.name||e.node.id.substr(e.node.id.lastIndexOf(".")+1))+" "+d(e.node.engineType?"":"("+e.node.children.length+")")+" ",1),e.node.type==="file"?(n(),L("span",le," ("+d(t.format(e.node.created,"dd.MM.yyyy HH:mm:ss"))+") ",1)):k("",!0)]),t.moduleConfig.switch&&t.loading[e.node.id]!==!0&&e.node.type==="file"?(n(),c(P,{key:2,ref:"menu",fit:""},{default:l(()=>[s(D,{style:{"min-width":"120px"},class:"full-width body"},{default:l(()=>[s(C,{class:T("bg-"+(e.node.enabled?"positive":"negative"))},{default:l(()=>[s(u,{avatar:""}),s(u,null,{default:l(()=>[h(d(t.$t(e.node.enabled?"Currently running":"Currently stopped")),1)]),_:2},1024)]),_:2},1032,["class"]),z((n(),c(C,{clickable:"",onClick:f=>t.set(e.node.id,!e.node.enabled)},{default:l(()=>[s(u,{avatar:""},{default:l(()=>[s(w,{color:e.node.enabled?"negative":"positive",name:e.node.enabled?"mdi-pause":"mdi-play"},null,8,["color","name"])]),_:2},1024),s(u,null,{default:l(()=>[h(d(t.$t(e.node.enabled?"Stop":"Start")+" "+t.$t("Script")),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[N]])]),_:2},1024)]),_:2},1536)):k("",!0)],2)]),_:1},8,["nodes","default-expand-all","filter-method","filter"])):k("",!0)])}var re=K(ie,[["render",ne]]),ke=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{ke as S,me as _,be as a,ve as b,he as c};
