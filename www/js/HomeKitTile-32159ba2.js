import{_ as L,q as M,Y as J,co as Q,I as R,c as m,d8 as U,dN as Y,ds as K,a4 as h,z as G,b8 as W,a5 as S,j as O,o as r,d as v,g as u,K as E,a2 as T,k as B,d0 as X,w as Z,i as _,t as x,F as D,l as q,f as k,n as ee,a as c,ag as b,dO as te}from"./index-52a12785.js";const{capitalize:ae}=te,ie=M({name:"ModuleHomeKitTile",props:["_containerSize","widget"],setup(e){const w=J(),H=Q(),I=R(),z=m(()=>e.widget.config),s=m(()=>({...U.joinConfig(z.value,Y)})),t=m(()=>e.widget.items&&e.widget.items[0]||{}),d=m(()=>K.get(t.value.deviceId)),a=h({}),i=h({}),f=m(()=>({on:"true",off:"false",...a.value&&a.value.properties||{}})),j=m(()=>a.value&&a.value.val!==void 0&&a.value.val.toString()===f.value.on.toString()),N=(o,n)=>{if(g.value=!0,o){y.value=o;return}a.value=n},V=(o,n)=>{if(g.value=!0,o){y.value=o;return}i.value=n},g=h(!1),y=h();let p=[];G(()=>{d.value?t.value.bodyStateKey||t.value.primaryStateKey?(t.value.primaryStateKey&&(p=p.concat(K.listen(d.value.id,t.value.primaryStateKey,N))),t.value.bodyStateKey&&(p=p.concat(K.listen(d.value.id,t.value.bodyStateKey,V)))):g.value=!0:(y.value="HomeKitTile: "+w.t("Device {deviceId} not found").replace("{deviceId}",t.value.deviceId),console.warn(y.value),g.value=!0)}),W(()=>K.unlisten(p));const F=(o,n,l)=>{if(Array.isArray(l))return l.some(A=>F(o,n,A));const C=s.value[o+ae(n)];return l==="secondaryStates"?C===l&&t.value.secondaryStatesKeys:l==="state"?C===l&&t.value.primaryStateKey:l==="bodyElement"?C===l&&t.value.bodyStateKey&&t.value.bodyElement:l==="actionElement"?C===l&&t.value.primaryStateKey&&t.value.actionElement:C===l},$=(o,n="action",l="State")=>S.Components[o]&&S.Components[o][n][l]||S.Components._defaults&&S.Components._defaults[n][l]||null,P=()=>{if(s.value.action==="website"&&(s.value.website.indexOf("http")>-1||s.value.website.indexOf("www")>-1))window.open((s.value.website.indexOf("http")===-1?"http://":"")+s.value.website,"_blank");else if(s.value.action==="page"&&s.value.jumper)H.push({params:{tabId:s.value.jumper}}).catch(o=>console.warn(o));else if(s.value.action==="popup"&&d.value)I.set({selectedDeviceId:d.value.id});else if(d.value&&s.value.action==="trigger"&&t.value.primaryStateKey){const o=j.value?f.value.setOff:f.value.setOn;let n=j.value?f.value.off:f.value.on;n=typeof n=="string"&&(n==="true"||n==="false")?n==="true":n,K.set(d.value.id,t.value.primaryStateKey,o!==void 0?o:n)}};return{FunctionsComponents:S.Components,horizontal:["left","center","right"],vertical:["top","middle","bottom"],moduleConfig:s,loaded:g,error:y,device:d,deviceConfig:t,primaryState:a,bodyState:i,getComponent:$,hasElement:F,jump:P}}}),ne=["v-ripple"],oe={key:0,class:"q-focus-helper"},le={key:1,class:"q-pa-sm full-height"};function se(e,w,H,I,z,s){const t=O("alert"),d=O("icon");return r(),v("div",{class:k(["HomeKitTile grid",{"cursor-pointer":e.moduleConfig.action&&e.moduleConfig.action!=="none","q-hoverable":e.moduleConfig.action&&e.moduleConfig.action!=="none"}]),style:ee({height:e._containerSize.height+"px",width:e._containerSize.width+"px"}),onClick:w[0]||(w[0]=(...a)=>e.jump&&e.jump(...a)),"v-ripple":e.moduleConfig.action&&e.moduleConfig.action!=="none"},[e.moduleConfig.action&&e.moduleConfig.action!=="none"?(r(),v("span",oe)):u("",!0),E(B(X,{indeterminate:""},null,512),[[T,!e.loaded&&!e.error]]),E(B(t,null,{default:Z(()=>[_(x(e.error),1)]),_:1},512),[[T,e.loaded&&e.error]]),e.device?E((r(),v("div",le,[(r(!0),v(D,null,q(e.vertical,a=>(r(),v("div",{key:a,class:k([a,"item row nowrap"])},[(r(!0),v(D,null,q(e.horizontal,i=>(r(),v("div",{key:i,class:k(["col-grow",i])},[e.hasElement(a,i,"icon")?(r(),c(d,{key:0,alignment:i,styles:e.primaryState.iconStyle||{},loading:!e.loaded,name:e.primaryState.icon,color:"primary",IconButton:""},null,8,["alignment","styles","loading","name"])):u("",!0),e.hasElement(a,i,"label")?(r(),c(b(e.FunctionsComponents._defaults.components.Title),{key:1,alignment:i,device:e.device,state:e.bodyState,stateKey:e.deviceConfig.bodyStateKey,deviceConfig:e.deviceConfig},null,8,["alignment","device","state","stateKey","deviceConfig"])):u("",!0),e.hasElement(a,i,"secondaryStates")?(r(),c(b(e.FunctionsComponents._defaults.components.SecondaryStates),{key:2,alignment:i,device:e.device,state:e.primaryState,stateKey:e.deviceConfig.primaryStateKey,deviceConfig:e.deviceConfig},null,8,["alignment","device","state","stateKey","deviceConfig"])):u("",!0),e.hasElement(a,i,"state")?(r(),c(b(e.FunctionsComponents._defaults.components.State),{key:3,alignment:i,device:e.device,state:e.primaryState,stateKey:e.deviceConfig.primaryStateKey,deviceConfig:e.deviceConfig},null,8,["alignment","device","state","stateKey","deviceConfig"])):u("",!0),e.hasElement(a,i,"bodyElement")?(r(),c(b(e.getComponent(e.device.function,"body",e.deviceConfig.bodyElement)),{key:4,alignment:i,device:e.device,state:e.bodyState,stateKey:e.deviceConfig.bodyStateKey,deviceConfig:e.deviceConfig},null,8,["alignment","device","state","stateKey","deviceConfig"])):u("",!0),e.hasElement(a,i,"actionElement")?(r(),c(b(e.getComponent(e.device.function,"action",e.deviceConfig.actionElement)),{key:5,alignment:i,device:e.device,state:e.primaryState,stateKey:e.deviceConfig.primaryStateKey,deviceConfig:e.deviceConfig},null,8,["alignment","device","state","stateKey","deviceConfig"])):u("",!0)],2))),128))],2))),128))],512)),[[T,e.loaded&&!e.error]]):u("",!0)],14,ne)}var de=L(ie,[["render",se],["__scopeId","data-v-9a4f7e1c"]]);export{de as default};
