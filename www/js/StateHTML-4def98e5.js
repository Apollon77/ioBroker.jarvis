import{bt as L,a4 as T,bM as w,Q as i,dc as H,eg as b,k as d,dw as c,ao as C,aG as I,ay as u,W as v,b3 as f,bn as p,a2 as S,d3 as k,b1 as D,a1 as B,D as $,X as z,C as K}from"./index-ba4a1ec8.js";const N=T({name:"ModuleStateHTML",props:["widget","_containerSize"],setup(e){const m=w(),g=i(()=>e.widget.config);i(()=>({...H.joinConfig(g.value,b)}));const a=d(!1),t=d(null),s=d(),r=(n,E,G,M)=>{if(a.value=!0,n)return t.value=n&&n.message||n,t.value;s.value=M},o=i(()=>s.value&&s.value.val||""),y=i(()=>o.value&&typeof o.value=="string"&&o.value.indexOf("<script")>-1),l=e.widget.items&&e.widget.items[0]||{},_=c.get(l.deviceId);let h=[];return _?h=c.listen(_.id,l.primaryStateKey,r):(t.value=m.t("Device {deviceId} not found").replace("{deviceId}",l.deviceId),console.warn("StateHTML",t.value),a.value=!0),C(()=>c.unlisten(h)),{loaded:a,error:t,html:o,hasScript:y}}}),V={class:"jarvis-StateHTML StateHTML"},j=["innerHTML"],F=["srcdoc"];function Q(e,m,g,a,t,s){const r=I("alert");return u(),v("div",V,[f(S(k,{indeterminate:""},null,512),[[p,!e.loaded&&!e.error]]),f(S(r,null,{default:D(()=>[B($(e.error),1)]),_:1},512),[[p,e.loaded&&e.error]]),f(z("div",null,[e.hasScript?(u(),v("iframe",{key:1,class:"StateHTML-iFrame",style:K({border:0,height:e._containerSize.height+"px"}),srcdoc:e.html},null,12,F)):(u(),v("div",{key:0,innerHTML:e.html},null,8,j))],512),[[p,e.loaded&&!e.error]])])}var P=L(N,[["render",Q],["__scopeId","data-v-e796cf42"]]);export{P as default};
