import{dj as de,a4 as K,bw as N,Q as m,dn as _e,dp as F,bt as Y,aG as O,ay as S,U as $,b1 as k,a2 as p,bS as Se,bT as ie,X as Q,D as x,bD as Le,bB as M,bU as oe,bV as Ae,A as R,bW as et,af as tt,cB as ve,cC as nt,a9 as st,ck as it,ac as Ee,bx as ot,co as ee,k as I,bQ as ue,cK as fe,cq as B,b3 as L,bn as A,aF as De,dq as at,aY as ke,r as ze,cS as rt,cG as Oe,V as z,W as H,I as U,aE as ae,C as q,bF as lt,bG as Ne,bH as ge,a1 as be,cu as ct,dr as dt,cs as We,u as ut,df as ft,ds as gt,bO as pt,aI as mt,bM as vt,cr as ht,di as qe,dh as Ve,bp as bt,ct as Fe,dt as wt,d8 as yt,du as we,as as St,d3 as kt,aZ as he}from"./index-28487aa9.js";import Ct from"./StateList-a10af2a7.js";import{b as Tt,c as $t,Q as Et,a as Dt}from"./QFooter-a4acf351.js";import{Q as jt}from"./QHeader-e0cf21a0.js";import{Q as Pt}from"./QBtnDropdown-fcce832c.js";import{Q as Ht}from"./QBadge-5ac7d98c.js";import{m as It}from"./marked.esm-6a2890cb.js";import"./StateListGroup-053cc99a.js";import"./StateListItem-4fb1ff9f.js";var Bt=`
body {
	scrollbar-width: none;
	-ms-overflow-style: none;
	overflow-y: scroll;
}

body::-webkit-scrollbar {
	width: 0px;
	background: transparent;
}`,Rt=`
@media (max-width: $breakpoint-md-min) {
	.container.desktop {
		padding: 0;
		/*grid-template-columns: none !important;*/
		grid-template-rows: none !important;
	}
	
	.container.desktop .widget-scaler {
		transform: none !important;
	}
}

/*
 * TWO COLUMNS
 */
@media (min-width: $breakpoint-sm-min) and (max-width: $breakpoint-md-min) {
	.container.desktop > .box:nth-child(odd) {
		grid-area: auto / auto / auto / auto !important;
		grid-column: 1 / span 6 !important;
	}
	
	.container.desktop > .box:nth-child(even) {
		grid-area: auto / auto / auto / auto !important;
		grid-column: 7 / span 6 !important;
	}
}

/*
 * ONE COLUMN
 */
@media (min-width: 0) and (max-width: $breakpoint-sm-min) {
	.container.desktop > .box {
		grid-area: auto / auto / auto / auto !important;
		grid-column: 1 / span 12 !important;
	}
}
`;function ne(e,t,n={}){if(n.id=n.id||"custom",n.onlyPro=n.onlyPro!==void 0?n.onlyPro:!0,n.onlyPro&&!de.isPro()&&t)de.warn("Custom Styles / Scripts are only available to Pro!");else if(e&&(!n.onlyPro||n.onlyPro&&de.isPro())){let s=document.getElementById(n.id);s?s.remove():(s=document.createElement(e),s.id=n.id),n.class&&s.classList.add(n.class);for(const a in n)s[a]=n[a];return s.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(s),s}return null}function je(e,t,n={}){document.querySelectorAll(".import_custom_"+e).forEach(l=>l.remove());const o=t.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1"),a=/@?import[ ]?\(?['"](?<url>.*)['"]\)?;?/ig,i=[...o.matchAll(a)].map((l,c)=>new Promise(b=>{t=t.replace(l[0],""),ne(n.tag||"link","",{[n.src||"src"]:l.groups.url+"?ts="+Date.now(),id:"import_custom_"+e+"-"+c,class:"import_custom_"+e,...n,defer:"defer",onload:()=>b(!0),onerror:()=>b(!1)})}));return Promise.allSettled(i).then(()=>t)}const Mt=K({name:"DeviceDetailsPopup",components:{StateList:Ct},setup(){const e=N(),t=m(()=>e.selectedDevice),n=m(()=>{const o=[];for(const a in t.value.states){const r=t.value.states[a];if(r.hide===!0||r.state===void 0&&r.action===void 0)continue;const{label:i,...l}=r;o.push({id:_e(t.value.id+":"+a,F.get("UUID")),type:"device",deviceId:t.value.id,bodyStateKey:a,primaryStateKey:a,...l,deviceStateDetails:!0})}return{items:o}});return{onClose:()=>e.set("selectedDeviceId",null),device:t,widget:n}}}),Lt={class:"text-h6"};function At(e,t,n,s,o,a){const r=O("state-list");return S(),$(et,{"model-value":!!e.device.id,onHide:e.onClose,class:R({"jarvis-popup-container":!0,["jarvis-device-"+e.device.id]:!0})},{default:k(()=>[p(Se,{class:"column jarvis-popup",style:{width:"800px","max-width":"95vw","flex-wrap":"nowrap"}},{default:k(()=>[p(ie,{class:"row items-center"},{default:k(()=>[Q("div",Lt,x(e.device.label||e.device.name),1),p(Le),p(M,{flat:"",round:"",color:"grey",icon:"close",onClick:e.onClose},null,8,["onClick"])]),_:1}),p(oe),p(ie,{class:"col q-pa-none scroll body",style:{"overflow-x":"hidden"}},{default:k(()=>[p(r,{openDeviceDetails:!1,widget:e.widget,isPopup:""},null,8,["widget"])]),_:1}),p(oe),p(Ae,{align:"right"},{default:k(()=>[p(M,{flat:"",label:e.$t("Close"),onClick:e.onClose,color:"primary"},null,8,["label","onClick"])]),_:1})]),_:1})]),_:1},8,["model-value","onHide","class"])}var zt=Y(Mt,[["render",At]]);const Ot={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function Nt(){const{props:e,proxy:{$q:t}}=st(),n=tt(nt,ve);if(n===ve)return console.error("QPageSticky needs to be child of QLayout"),ve;const s=m(()=>{const u=e.position;return{top:u.indexOf("top")>-1,right:u.indexOf("right")>-1,bottom:u.indexOf("bottom")>-1,left:u.indexOf("left")>-1,vertical:u==="top"||u==="bottom",horizontal:u==="left"||u==="right"}}),o=m(()=>n.header.offset),a=m(()=>n.right.offset),r=m(()=>n.footer.offset),i=m(()=>n.left.offset),l=m(()=>{let u=0,v=0;const h=s.value,f=t.lang.rtl===!0?-1:1;h.top===!0&&o.value!==0?v=`${o.value}px`:h.bottom===!0&&r.value!==0&&(v=`${-r.value}px`),h.left===!0&&i.value!==0?u=`${f*i.value}px`:h.right===!0&&a.value!==0&&(u=`${-f*a.value}px`);const w={transform:`translate(${u}, ${v})`};return e.offset&&(w.margin=`${e.offset[1]}px ${e.offset[0]}px`),h.vertical===!0?(i.value!==0&&(w[t.lang.rtl===!0?"right":"left"]=`${i.value}px`),a.value!==0&&(w[t.lang.rtl===!0?"left":"right"]=`${a.value}px`)):h.horizontal===!0&&(o.value!==0&&(w.top=`${o.value}px`),r.value!==0&&(w.bottom=`${r.value}px`)),w}),c=m(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function b(u){const v=it(u.default);return Ee("div",{class:c.value,style:l.value},e.expand===!0?v:[Ee("div",v)])}return{$layout:n,getStickyContent:b}}var Wt=ot({name:"QPageSticky",props:Ot,setup(e,{slots:t}){const{getStickyContent:n}=Nt();return()=>n(t)}});function qt(){const e=ee(),t=I(!1);return{jumperIsOpen:t,jumperOpen:(s,o={})=>{const a=ue(s);t.value=!0;const r=a.map(i=>new Promise(l=>{const c=b=>{i.icon=b.icon;const u=Iconify.getIcon(i.icon.indexOf(":")===-1?"mdi:"+i.icon:i.icon);if(u){const v=[],h=[];let f;const w=RegExp('(?<= (.+?)=\\")(.+?)(?=\\")',"g");for(;(f=w.exec(u.body))!==null;)if(f.index===w.lastIndex&&w.lastIndex++,f[1]==="d")v[v.length]=f[2];else{const C=h.length;h[C]=h[C]||[],h[C].push([f[1],f[2]])}i.icon=v.map((C,E)=>{const y=h[E].map(d=>d[0]+":"+d[1]);return C+"@@"+y.join("@@")}).join("&&")+"|"+u.left+" "+u.top+" "+u.width+" "+u.height}l(i)};i.icon&&typeof i.icon=="object"?fe.getBindings({config:{icon:i.icon}},c):i.icon&&c({icon:i.icon})}));Promise.allSettled(r).then(i=>{const l=i.map(c=>c.value);e.bottomSheet({...o,actions:l}).onOk(c=>o.onSuccess&&o.onSuccess(c)).onCancel(()=>o.onCancel&&o.onCancel()).onDismiss(()=>{t.value=!1})})}}}const Vt=K({name:"Container",props:["tabsCount"],setup(e){B.dev("DEBUG","Container","setup()");const t=N(),n=m(()=>t.drawerMiniMode);return{settings:m(()=>t.settings),drawerMiniMode:n,onHeaderReveals:a=>{B.dev("DEBUG","Container","onHeaderReveals()"),t.set("headerVisible",a)}}}});function Ft(e,t,n,s,o,a){return e.settings.tabsBottom!==!0?L((S(),$(jt,{key:0,class:"jarvis-header text-white",bordered:"",onReveal:e.onHeaderReveals,reveal:e.settings.tabsShow==="hide"},{default:k(()=>[De(e.$slots,"default")]),_:3},8,["onReveal","reveal"])),[[A,e.drawerMiniMode!==!0||e.drawerMiniMode===!0&&e.tabsCount>1]]):L((S(),$(Tt,{key:1,class:"jarvis-footer text-white",bordered:"",onReveal:e.onHeaderReveals,reveal:e.settings.tabsShow==="hide"},{default:k(()=>[De(e.$slots,"default")]),_:3},8,["onReveal","reveal"])),[[A,e.drawerMiniMode!==!0||e.drawerMiniMode===!0&&e.tabsCount>1]])}var Qt=Y(Vt,[["render",Ft]]);const Ut=K({name:"Tabs",props:["page","tabs"],setup(e){B.dev("DEBUG","Tabs","setup()");const t=ee(),n=N(),s=at(),o=de.isPro(),a=I([]),r=g=>{B.dev("DEBUG","Tabs","resolveBindings");const D=a.value.findIndex(j=>j.id===g.id);a.value[D]={...g,revision:rt().substr(0,5)}};ke(()=>e.tabs,()=>{B.dev("DEBUG","Tabs","tabsWithResolvedBindings()"),a.value=ue(e.tabs);for(const g of a.value)g.config=ue(g),fe.getBindings(g,r)},{immediate:!0});const i=m(()=>n.drawerMiniMode),l=m(()=>n.settings),c=m({get(){return n.getSelectedTabId},set(g){g&&n.set({selectedTabId:g})}}),b=I([]),u=I(!1),v=I(!1),h=()=>{B.dev("DEBUG","Tabs","tabsHiddenShow()"),v.value=!t.platform.is.mobile},f=ze([]),w=(g,D)=>{f[g]=D},C=g=>{const D=g&&g.width||t.screen.width;u.value=!1,b.value=[],f&&f.length&&l.value.tabsCollapse!==!1?f.forEach((j,P)=>{const T=j.$el;T.style.display="inherit",(T.offsetLeft+T.offsetWidth+220>D||u.value===!0)&&(T.style.display="none",u.value=!0,b.value.push(a.value[P]))}):f&&f.length&&l.value.tabsCollapse===!1&&f.forEach(j=>{const P=j.$el;P.style.display="inherit"})},E=g=>n.set("drawerSidebar",g),y=m(()=>s.getUnread.length);return{setRef:w,elTabs:f,tabsWithResolvedBindings:a,tabId:c,tabsHiddenDropdownEnabled:u,tabsHiddenDropdown:v,tabsHiddenShow:h,tabsHidden:b,toggleNotifications:g=>n.set("drawerNotifications",g),toggleSidebar:E,notificationsUnread:y,drawerMiniMode:i,settings:l,isPro:o,onResize:C}}}),Gt={class:"row nowrap",style:{margin:"2px 0"}},Jt={key:0,class:"q-tab__label"},Kt={class:"q-tab__label"};function Yt(e,t,n,s,o,a){const r=O("icon");return S(),$(ct,{modelValue:e.tabId,"onUpdate:modelValue":t[4]||(t[4]=i=>e.tabId=i),"inline-label":"",dense:"",align:"left",style:q({"padding-left":(e.drawerMiniMode!==!0?0:5)+"px","padding-right":"48px"}),id:"tabBar",class:R({"jarvis-tabs-container":!0,"jarvis-tabs-bottom":e.settings.tabsBottom===!0}),"content-class":"jarvis-tabs","indicator-color":"white"},{default:k(()=>[p(Oe,{onResize:e.onResize},null,8,["onResize"]),e.settings.drawerShowMenuButton!==!1?(S(),$(M,{key:0,flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:t[0]||(t[0]=i=>e.toggleSidebar(!0)),class:R(["q-ml-sm",{"lt-md":e.drawerMiniMode===!0}])},null,8,["class"])):z("",!0),Q("div",Gt,[(S(!0),H(U,null,ae(e.tabsWithResolvedBindings,(i,l)=>(S(),$($t,{key:i.revision,ref_for:!0,ref:c=>e.setRef(l,c),name:i.id,to:{params:{tabId:i.id}},style:q(e.isPro&&i.id===e.tabId&&i.bodySelectedStyle||e.isPro&&i.bodyStyle||{}),class:R(["jarvis-tab","jarvis-tab-"+i.id]),"content-class":e.settings.tabsDense?"dense":"normal"},{default:k(()=>[L(p(r,{name:i.icon,size:"xs",class:"tabIcon",style:q({margin:e.settings.tabsDense?"4px 4px 0 0":"0",...e.isPro&&i.id===e.tabId&&i.iconSelectedStyle||e.isPro&&i.iconStyle||{}})},null,8,["name","style"]),[[A,i.icon]]),e.page.hideLabels!==!0?(S(),H("div",Jt,x(i.title),1)):z("",!0)]),_:2},1032,["name","to","style","class","content-class"]))),128)),L(p(Pt,{modelValue:e.tabsHiddenDropdown,"onUpdate:modelValue":t[1]||(t[1]=i=>e.tabsHiddenDropdown=i),onMouseover:t[2]||(t[2]=i=>e.tabsHiddenDropdown=!0),"auto-close":"",stretch:"",flat:""},{label:k(()=>[Q("div",{class:R(e.settings.tabsDense?"dense":"normal")},[p(r,{name:"mdi-tab-unselected",size:"xs",class:"tabIcon",style:q({margin:e.settings.tabsDense?"1px 5px 0 0":"-1px 0 1px 0"})},null,8,["style"]),Q("div",Kt,x(e.$t("More")+"..."),1)],2)]),default:k(()=>[p(lt,null,{default:k(()=>[(S(!0),H(U,null,ae(e.tabsHidden,i=>(S(),$(Ne,{key:i.id,clickable:"",onClick:l=>e.tabId=i.id,class:R({"q-tab--active":i.id===e.tabId})},{default:k(()=>[p(ge,{avatar:""},{default:k(()=>[p(r,{name:i.icon},null,8,["name"])]),_:2},1024),p(ge,null,{default:k(()=>[be(x(i.title),1)]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1})]),_:1},8,["modelValue"]),[[A,e.tabsHiddenDropdownEnabled]])]),L(p(M,{flat:"",dense:"",round:"",icon:"mdi-bell","aria-label":"Notifications",onClick:t[3]||(t[3]=i=>e.toggleNotifications(!0)),class:"q-mr-sm notification-drawer-button"},{default:k(()=>[p(Ht,{color:"secondary",align:"middle",floating:""},{default:k(()=>[be(x(e.notificationsUnread),1)]),_:1})]),_:1},512),[[A,e.isPro]])]),_:1},8,["modelValue","style","class"])}var Xt=Y(Ut,[["render",Yt]]);function xt(e,t){const n=m(()=>typeof e.value!="object"?I({fullscreenSize:e.value}):e),s=I(),o=I(!1),a=()=>{o.value=!0;const l=s.value;l.classList.add("isFullscreen"),l.style.overflow="auto";const c=l.querySelector(".jarvis-widget-scaler");c.style.height="auto"},r=()=>{o.value=!1;const l=s.value;l.classList.remove("isFullscreen"),l.style.overflow="initial";const c=l.querySelector(".jarvis-widget-scaler");c.style.height=n.value.fullscreenSize+"px",document.exitFullscreen?document.exitFullscreen().catch(b=>{}):document.mozCancelFullScreen?document.mozCancelFullScreen().catch(b=>{}):document.webkitCancelFullScreen&&document.webkitCancelFullScreen().catch(b=>{})};return ke(()=>s.value,()=>{s.value.addEventListener("fullscreenchange",()=>{document.fullscreenElement===null&&r()})}),{fullscreenElement:s,fullscreenActive:o,fullscreenToggle:l=>{l=typeof l=="boolean"?l:!o.value,dt.toggle(s.value).then(()=>{l===!1?r():a()}).catch(c=>{console.error(c)})}}}const Zt=K({name:"Widget",props:["page","tab","widgets","config","layout","containerSize"],setup(e){const t=ee(),n=We(),s=N(),o=ut(e,"config")||{};I();const a=I(),r=m(()=>{const T=o.value.alignmentHorizontal||"center",ce=o.value.alignmentVertical||"top",te=o.value.scaleToFitContents!==void 0?o.value.scaleToFitContents:!0;return{h:T,v:ce,fit:te}}),i=m(()=>r.value.v!=="middle"?{}:{transform:"translateY(-50%)",position:"relative",top:"50%"}),l=ze({width:0,height:0}),c=m(()=>a.value&&a.value.$el.offsetHeight||0),b=m(()=>e.containerSize.height-c.value),u=m(()=>r.value.fit===!1||ft.includes(C.value.module)?{x:1,y:1}:{x:l?Math.min(1,e.containerSize.width/l.width):1,y:l?Math.min(1,b.value/l.height):1}),v=m(()=>{const T=[0,0];return T[0]=r.value.h==="center"?"50%":r.value.h==="right"?"100%":r.value.h,T[1]=r.value.v==="middle"?"50%":r.value.v==="bottom"?"100%":r.value.v,T}),h=m(()=>({width:r.value.h!=="fill-width"?"100%":Math.floor(1/(u.value.y<u.value.x?u.value.y:u.value.x)*100)+"% !important",height:b.value-1+"px"})),f=m(()=>D.value===!0?1:u.value.y<u.value.x?u.value.y:u.value.x),w=m(()=>{const T={"-webkit-transform":"scale("+f.value+")","-webkit-transform-origin":v.value.join(" "),transform:"scale("+f.value+")","transform-origin":v.value.join(" ")};return r.value.v==="middle"&&(T.margin="auto"),t.screen.lt.lg||e.layout==="desktop"&&t.platform.is.mobile?{}:T}),C=m(()=>{const T=e.widgets[0];return T&&s.widgets[T]||{}}),E=()=>{B.dev("DEBUG","Widget","jump"),C.value.link&&(C.value.link.indexOf("http")>-1||C.value.link.indexOf("www")>-1)?window.open((C.value.link.indexOf("http")===-1?"http://":"")+C.value.link,"_blank"):C.value.link&&n.push({params:{tabId:C.value.link}}).catch(T=>console.warn(T))};let y=null;const d=T=>{y&&clearTimeout(y),y=setTimeout(()=>{B.dev("DEBUG","Widget","onResize()"),Object.assign(l,T)},500)},{fullscreenElement:g,fullscreenActive:D,fullscreenToggle:j}=xt(b),P=I(o.value.allowFullscreen||!1);return{alignment:r,verticalAlignment:i,scaleSizes:h,scaleStyle:w,size:l,widget:C,widgetTitle:a,widgetTitleSize:c,jump:E,onResize:d,fullscreenEnabled:P,fullscreenElement:g,fullscreenActive:D,fullscreenToggle:j}}});function _t(e,t,n,s,o,a){const r=O("icon");return S(),H("div",{ref:"fullscreenElement",onDblclick:t[1]||(t[1]=i=>e.fullscreenEnabled&&e.fullscreenToggle()),class:R(["jarvis-widget-container bgcolor",{tile:e.tab.widgetEdges,paper:!e.tab.widgetEdges,fullscreenEnabled:e.fullscreenEnabled}])},[e.fullscreenEnabled?(S(),H("div",{key:0,class:R(["fullscreener",{close:e.fullscreenActive}]),onClick:t[0]||(t[0]=(...i)=>e.fullscreenToggle&&e.fullscreenToggle(...i))},null,2)):z("",!0),p(Se,{flat:"",class:R(["jarvis-widget full-width full-height",{["jarvis-widget-module-"+e.widget.module]:!0,["jarvis-widget-"+e.widget.id]:!0}])},{default:k(()=>[e.widget.hideTitle!==!0&&(e.widget.icon||e.widget.title)?(S(),$(Ne,{key:0,class:"jarvis-widget-header",ref:"widgetTitle"},{default:k(()=>[e.widget.icon?(S(),$(ge,{key:0,side:"",class:R({"cursor-pointer":e.widget.link}),onClick:e.jump},{default:k(()=>[p(gt,{square:e.tab.widgetEdges,rounded:!e.tab.widgetEdges,class:"jarvis-widget-icon","font-size":"24px"},{default:k(()=>[p(r,{name:e.widget.icon},null,8,["name"])]),_:1},8,["square","rounded"])]),_:1},8,["class","onClick"])):z("",!0),p(ge,null,{default:k(()=>[p(pt,{class:R(["text-h6",{"cursor-pointer":e.widget.link}]),onClick:e.jump},{default:k(()=>[be(x(e.widget.label||e.widget.title),1)]),_:1},8,["class","onClick"])]),_:1})]),_:1},512)):z("",!0),e.widget.hideSeparator!==!0&&e.widget.hideTitle!==!0&&(e.widget.icon||e.widget.title)?(S(),$(oe,{key:1})):z("",!0),p(ie,{horizontal:"",class:"jarvis-widget-content",style:q(e.alignment.fit===!1?{"overflow-y":"auto",...e.scaleSizes,...e.verticalAlignment}:e.verticalAlignment)},{default:k(()=>[p(Oe,{onResize:e.onResize},null,8,["onResize"]),Q("div",{class:"jarvis-widget-scaler full-width",style:q(e.scaleStyle)},[(S(),$(mt(e.widget.module),{key:e.widget.revision,class:"full-width",widget:e.widget,_alignment:e.alignment,_fullscreen:e.fullscreenActive,_containerSize:{width:e.containerSize.width,height:e.containerSize.height-e.widgetTitleSize},_widgetSize:{width:e.size.width,height:e.size.height}},null,8,["widget","_alignment","_fullscreen","_containerSize","_widgetSize"]))],4)]),_:1},8,["style"])]),_:1},8,["class"])],34)}var en=Y(Zt,[["render",_t]]);const tn=K({name:"TabPanel",props:["page","tab"],components:{Widget:en},setup(e){B.dev("DEBUG","TabPanel","setup()");const t=N(),n=ee(),s=n.platform.is.mobile,o=!1,a=m(()=>e.tab.widgetConfig),r=m(()=>Math.max(s&&a.value.smartphoneGapSize||o||a.value.desktopGapSize||5,0)),i=m(()=>{let f=[];return s&&a.value.smartphoneSameAs==="specific-layout"||o?f=e.tab.widgetsSmartphone||[]:s&&a.value.smartphoneSameAs==="tablet"?f=e.tab.widgetsTablet||[]:f=e.tab.widgetsDesktop||[],f}),l=m(()=>Math.max.apply(Math,i.value.map(f=>f.y+f.h))),c=m(()=>{var f;return((f=i.value)==null?void 0:f[0])||{}}),b=n.screen.width,u=m(()=>t.pageHeight),v=m(()=>{const f=(s?a.value.smartphoneFitPageHeight:a.value.desktopFitPageHeight)||!1,w=s&&a.value.smartphoneWidgetHeight||o||a.value.desktopWidgetHeight||50;return f===!0?(u.value-2*r.value)/l.value-r.value:w}),h=m(()=>s&&a.value.smartphoneSameAs==="specific-layout"||o?"smartphone":s&&a.value.smartphoneSameAs==="tablet"?"tablet":"desktop");return{containerRows:l,fullscreenContainer:c,pageWidth:b,pageHeight:u,widgetGap:r,widgetHeight:v,widgetLayout:h,widgetContainers:i}}});function nn(e,t,n,s,o,a){const r=O("widget");return S(),H("div",{class:R({["jarvis-page-"+e.page.id]:!0,["jarvis-tab-"+e.tab.id]:!0})},[e.tab.fullscreen!==!0?(S(),H("div",{key:0,class:R(["container",e.widgetLayout]),style:q({gridTemplateRows:"repeat("+e.containerRows+", "+e.widgetHeight+"px)",columnGap:e.widgetGap+"px",rowGap:e.widgetGap+"px",padding:e.widgetGap+"px"})},[(S(!0),H(U,null,ae(e.widgetContainers,i=>(S(),H(U,null,[i&&i.items&&i.items.length>0?(S(),H("div",{key:i.i,style:q({gridArea:i.y+1+" / "+(i.x+1)+" / span "+i.h+" / span "+i.w}),class:"box"},[p(r,{page:e.page,tab:e.tab,widgets:i.items||[],config:i,layout:e.widgetLayout,containerSize:{width:e.pageWidth/12*i.w,height:i.h*e.widgetHeight+(i.h-1)*e.widgetGap}},null,8,["page","tab","widgets","config","layout","containerSize"])],4)):z("",!0)],64))),256))],6)):(S(),H("div",{key:1,style:q({height:e.pageHeight+"px"})},[p(r,{fullscreen:"",page:e.page,tab:e.tab,widgets:e.fullscreenContainer.items||[],config:e.fullscreenContainer,layout:e.widgetLayout,containerSize:{width:e.pageWidth,height:e.pageHeight}},null,8,["page","tab","widgets","config","layout","containerSize"])],4))],2)}var sn=Y(tn,[["render",nn]]);const on=K({name:"Page",props:["page"],components:{Container:Qt,Tabs:Xt,TabPanel:sn},setup(e){B.dev("DEBUG","Page","setup()");const t=ee(),n=vt(),s=We(),o=ht(),a=N(),r=m(()=>t.platform.is.mobile),i=m(()=>a.drawerMiniMode),l=m(()=>a.settings),c=m(()=>Object.keys(e.page.tabs).length),b=m({get(){return"tab-"+a.getSelectedTabId},set(y){y&&s.push({params:{tabId:y.replace("tab-","")}})}}),u=(y,d)=>{const g=document.querySelector(".jarvis-header");y=g&&g.offsetHeight?g.offsetHeight:y;const D=d-y;return D!==a.pageHeight&&(B.dev("DEBUG","Page","setPageContainer",y,d,D,a.pageHeight),a.set("pageHeight",d-y)),{}},v=()=>a.set("selectedTabReady",!1),h=()=>a.set("selectedTabReady",!0),{jumperOpen:f}=qt(),w=(y,d,g)=>{const D=d.id;s.push({params:{...o.params,tabId:D}}).then(()=>{if(g.id!=="_root"){const j=r.value&&d.widgetConfig.smartphoneWidgetHeight||d.widgetConfig.desktopWidgetHeight||50,P=document.querySelector(".jarvis-header"),T=P&&P.offsetHeight?P.offsetHeight:0;setTimeout(()=>window.scrollTo(0,g.y*j+T+1),100)}}).catch(()=>{})},C=(y,d)=>{let g=t.platform.is.mobile?d.widgetsSmartphone:d.widgetsDesktop;g=a.getWidgets(g),g=g.concat([{},{color:"primary",icon:"mdi-tab",label:n.t("Jump directly to")+" "+d.label,id:"_root"}]),f(g,{class:"jarvis-quick-jumper",message:y.title+" / "+d.title+": "+n.t("Widgets"),onSuccess:D=>w(y,d,D)})},E=y=>{const d=a.getTabs(y);f(d,{class:"jarvis-quick-jumper",message:y.title+": "+n.t("Tabs"),onSuccess:g=>C(y,g)})};return{jumperOpen:()=>f(a.getPages,{class:"jarvis-quick-jumper",message:n.t("Pages"),onSuccess:E}),setPageContainer:u,onSelectedTabMoving:v,onSelectedTabReady:h,drawerMiniMode:i,isMobile:r,tabsCount:c,tabId:b,tabAnimated:m(()=>l.value.tabsSwipeAnimation==="always"||(!l.value.tabsSwipeAnimation||l.value.tabsSwipeAnimation==="mobile")&&r.value),tabSwipeable:m(()=>l.value.tabsSwipe==="always"||(!l.value.tabsSwipe||l.value.tabsSwipe==="mobile")&&r.value),settings:l}}});function an(e,t,n,s,o,a){const r=O("Tabs"),i=O("Container"),l=O("TabPanel");return S(),$(Dt,{style:{"padding-top":"0"}},{default:k(()=>[p(i,{tabsCount:e.tabsCount},{default:k(()=>[p(r,{page:e.page,tabs:e.page.tabs},null,8,["page","tabs"])]),_:1},8,["tabsCount"]),p(Et,{"style-fn":e.setPageContainer,class:"jarvis-page jarvis-body"},{default:k(()=>[p(qe,{modelValue:e.tabId,"onUpdate:modelValue":t[0]||(t[0]=c=>e.tabId=c),"keep-alive":!0,animated:e.tabAnimated,swipeable:e.tabSwipeable,style:{"background-color":"transparent"},onBeforeTransition:e.onSelectedTabMoving,onTransition:e.onSelectedTabReady},{default:k(()=>[(S(!0),H(U,null,ae(e.page.tabs,c=>(S(),$(Ve,{key:c.id,name:"tab-"+c.id,style:q({padding:0,"margin-top":e.drawerMiniMode&&(e.settings.tabsBottom||e.page.tabs.length<=1)?0:e.settings.tabsDense?"40px":"60px"})},{default:k(()=>[p(l,{page:e.page,tab:{widgetConfig:{},...c}},null,8,["page","tab"])]),_:2},1032,["name","style"]))),128))]),_:1},8,["modelValue","animated","swipeable","onBeforeTransition","onTransition"]),L(p(Wt,{position:"bottom-right",offset:[18,18],style:{"z-index":"5999"}},{default:k(()=>[p(M,{fab:"",icon:"mdi-tab-search",color:"accent",onClick:t[1]||(t[1]=bt(c=>e.jumperOpen(),["stop"]))})]),_:1},512),[[A,e.settings.quickJumper==="always"||e.isMobile&&e.settings.quickJumper==="mobile"]])]),_:1},8,["style-fn"])]),_:1})}var rn=Y(on,[["render",an],["__scopeId","data-v-1380b883"]]);function Qe(e){return e.split("-")[0]}function ln(e){return e.split("-")[1]}function cn(e){return["top","bottom"].includes(Qe(e))?"x":"y"}function dn(e){return e==="y"?"height":"width"}function Pe(e,t,n){let{reference:s,floating:o}=e;const a=s.x+s.width/2-o.width/2,r=s.y+s.height/2-o.height/2,i=cn(t),l=dn(i),c=s[l]/2-o[l]/2,b=Qe(t),u=i==="x";let v;switch(b){case"top":v={x:a,y:s.y-o.height};break;case"bottom":v={x:a,y:s.y+s.height};break;case"right":v={x:s.x+s.width,y:r};break;case"left":v={x:s.x-o.width,y:r};break;default:v={x:s.x,y:s.y}}switch(ln(t)){case"start":v[i]-=c*(n&&u?-1:1);break;case"end":v[i]+=c*(n&&u?-1:1);break}return v}const un=async(e,t,n)=>{const{placement:s="bottom",strategy:o="absolute",middleware:a=[],platform:r}=n,i=await(r.isRTL==null?void 0:r.isRTL(t));let l=await r.getElementRects({reference:e,floating:t,strategy:o}),{x:c,y:b}=Pe(l,s,i),u=s,v={},h=0;for(let f=0;f<a.length;f++){const{name:w,fn:C}=a[f],{x:E,y,data:d,reset:g}=await C({x:c,y:b,initialPlacement:s,placement:u,strategy:o,middlewareData:v,rects:l,platform:r,elements:{reference:e,floating:t}});if(c=E!=null?E:c,b=y!=null?y:b,v={...v,[w]:{...v[w],...d}},g&&h<=50){h++,typeof g=="object"&&(g.placement&&(u=g.placement),g.rects&&(l=g.rects===!0?await r.getElementRects({reference:e,floating:t,strategy:o}):g.rects),{x:c,y:b}=Pe(l,u,i)),f=-1;continue}}return{x:c,y:b,placement:u,strategy:o,middlewareData:v}};function He(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function Ue(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function V(e){if(e==null)return window;if(!Ue(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function G(e){return V(e).getComputedStyle(e)}function J(e){return Ue(e)?"":e?(e.nodeName||"").toLowerCase():""}function Ge(){const e=navigator.userAgentData;return e!=null&&e.brands?e.brands.map(t=>t.brand+"/"+t.version).join(" "):navigator.userAgent}function W(e){return e instanceof V(e).HTMLElement}function Z(e){return e instanceof V(e).Element}function fn(e){return e instanceof V(e).Node}function re(e){if(typeof ShadowRoot=="undefined")return!1;const t=V(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function le(e){const{overflow:t,overflowX:n,overflowY:s,display:o}=G(e);return/auto|scroll|overlay|hidden/.test(t+s+n)&&!["inline","contents"].includes(o)}function gn(e){return["table","td","th"].includes(J(e))}function Je(e){const t=/firefox/i.test(Ge()),n=G(e);return n.transform!=="none"||n.perspective!=="none"||t&&n.willChange==="filter"||t&&(n.filter?n.filter!=="none":!1)||["transform","perspective"].some(s=>n.willChange.includes(s))||["paint","layout","strict","content"].some(s=>{const o=n.contain;return o!=null?o.includes(s):!1})}function Ke(){return!/^((?!chrome|android).)*safari/i.test(Ge())}function Ce(e){return["html","body","#document"].includes(J(e))}const Ie=Math.min,se=Math.max,pe=Math.round;function _(e,t,n){var s,o,a,r;t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect();let l=1,c=1;t&&W(e)&&(l=e.offsetWidth>0&&pe(i.width)/e.offsetWidth||1,c=e.offsetHeight>0&&pe(i.height)/e.offsetHeight||1);const b=Z(e)?V(e):window,u=!Ke()&&n,v=(i.left+(u&&(s=(o=b.visualViewport)==null?void 0:o.offsetLeft)!=null?s:0))/l,h=(i.top+(u&&(a=(r=b.visualViewport)==null?void 0:r.offsetTop)!=null?a:0))/c,f=i.width/l,w=i.height/c;return{width:f,height:w,top:h,right:v+f,bottom:h+w,left:v,x:v,y:h}}function X(e){return((fn(e)?e.ownerDocument:e.document)||window.document).documentElement}function me(e){return Z(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ye(e){return _(X(e)).left+me(e).scrollLeft}function pn(e){const t=_(e);return pe(t.width)!==e.offsetWidth||pe(t.height)!==e.offsetHeight}function mn(e,t,n){const s=W(t),o=X(t),a=_(e,s&&pn(t),n==="fixed");let r={scrollLeft:0,scrollTop:0};const i={x:0,y:0};if(s||!s&&n!=="fixed")if((J(t)!=="body"||le(o))&&(r=me(t)),W(t)){const l=_(t,!0);i.x=l.x+t.clientLeft,i.y=l.y+t.clientTop}else o&&(i.x=Ye(o));return{x:a.left+r.scrollLeft-i.x,y:a.top+r.scrollTop-i.y,width:a.width,height:a.height}}function Te(e){return J(e)==="html"?e:e.assignedSlot||e.parentNode||(re(e)?e.host:null)||X(e)}function Be(e){return!W(e)||G(e).position==="fixed"?null:e.offsetParent}function vn(e){let t=Te(e);for(re(t)&&(t=t.host);W(t)&&!Ce(t);){if(Je(t))return t;{const n=t.parentNode;t=re(n)?n.host:n}}return null}function ye(e){const t=V(e);let n=Be(e);for(;n&&gn(n)&&G(n).position==="static";)n=Be(n);return n&&(J(n)==="html"||J(n)==="body"&&G(n).position==="static"&&!Je(n))?t:n||vn(e)||t}function Re(e){if(W(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=_(e);return{width:t.width,height:t.height}}function hn(e){let{rect:t,offsetParent:n,strategy:s}=e;const o=W(n),a=X(n);if(n===a)return t;let r={scrollLeft:0,scrollTop:0};const i={x:0,y:0};if((o||!o&&s!=="fixed")&&((J(n)!=="body"||le(a))&&(r=me(n)),W(n))){const l=_(n,!0);i.x=l.x+n.clientLeft,i.y=l.y+n.clientTop}return{...t,x:t.x-r.scrollLeft+i.x,y:t.y-r.scrollTop+i.y}}function bn(e,t){const n=V(e),s=X(e),o=n.visualViewport;let a=s.clientWidth,r=s.clientHeight,i=0,l=0;if(o){a=o.width,r=o.height;const c=Ke();(c||!c&&t==="fixed")&&(i=o.offsetLeft,l=o.offsetTop)}return{width:a,height:r,x:i,y:l}}function wn(e){var t;const n=X(e),s=me(e),o=(t=e.ownerDocument)==null?void 0:t.body,a=se(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),r=se(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0);let i=-s.scrollLeft+Ye(e);const l=-s.scrollTop;return G(o||n).direction==="rtl"&&(i+=se(n.clientWidth,o?o.clientWidth:0)-a),{width:a,height:r,x:i,y:l}}function Xe(e){const t=Te(e);return Ce(t)?e.ownerDocument.body:W(t)&&le(t)?t:Xe(t)}function xe(e,t){var n;t===void 0&&(t=[]);const s=Xe(e),o=s===((n=e.ownerDocument)==null?void 0:n.body),a=V(s),r=o?[a].concat(a.visualViewport||[],le(s)?s:[]):s,i=t.concat(r);return o?i:i.concat(xe(r))}function yn(e,t){const n=t.getRootNode==null?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&re(n)){let s=t;do{if(s&&e===s)return!0;s=s.parentNode||s.host}while(s)}return!1}function Sn(e,t){let n=e;for(;n&&!Ce(n)&&!t.includes(n)&&!(Z(n)&&["absolute","fixed"].includes(G(n).position));){const s=Te(n);n=re(s)?s.host:s}return n}function kn(e,t){const n=_(e,!1,t==="fixed"),s=n.top+e.clientTop,o=n.left+e.clientLeft;return{top:s,left:o,x:o,y:s,right:o+e.clientWidth,bottom:s+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}function Me(e,t,n){return t==="viewport"?He(bn(e,n)):Z(t)?kn(t,n):He(wn(X(e)))}function Cn(e){const t=xe(e),n=Sn(e,t);let s=null;if(n&&W(n)){const o=ye(n);le(n)?s=n:W(o)&&(s=o)}return Z(s)?t.filter(o=>s&&Z(o)&&yn(o,s)&&J(o)!=="body"):[]}function Tn(e){let{element:t,boundary:n,rootBoundary:s,strategy:o}=e;const r=[...n==="clippingAncestors"?Cn(t):[].concat(n),s],i=r[0],l=r.reduce((c,b)=>{const u=Me(t,b,o);return c.top=se(u.top,c.top),c.right=Ie(u.right,c.right),c.bottom=Ie(u.bottom,c.bottom),c.left=se(u.left,c.left),c},Me(t,i,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}const $n={getClippingRect:Tn,convertOffsetParentRelativeRectToViewportRelativeRect:hn,isElement:Z,getDimensions:Re,getOffsetParent:ye,getDocumentElement:X,getElementRects:e=>{let{reference:t,floating:n,strategy:s}=e;return{reference:mn(t,ye(n),s),floating:{...Re(n),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>G(e).direction==="rtl"},En=(e,t,n)=>un(e,t,{platform:$n,...n});var Dn=`[\r
   {\r
      "id":"cfbea70b-925b-40d1-9e8e-d0768336e3da",\r
      "title":"Main Site",\r
      "type":"page",\r
      "icon":"mdi-file",\r
      "tabs":[\r
         {\r
            "id":"0559b5e5-1c56-4ea4-8211-d51226417202",\r
            "title":"Dashboard",\r
            "icon":"mdi-monitor-dashboard",\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":8,\r
                  "i":"77ac22da-738d-4646-b0f5-940298bd6571",\r
                  "moved":false,\r
                  "items":[\r
                     "3958dfb0-83da-48ae-96f3-e66969a92cac"\r
                  ]\r
               },\r
               {\r
                  "x":4,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"28e602ec-4064-48d0-94d8-80e64fe37f87",\r
                  "moved":false,\r
                  "items":[\r
                     "be31acad-6bb4-40ed-a9cf-24cd981d8545"\r
                  ]\r
               },\r
               {\r
                  "x":4,\r
                  "y":4,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"0f1c06bc-f5c3-4e32-84e6-41fc0b4d05b5",\r
                  "moved":false,\r
                  "items":[\r
                     "b073226b-14d9-40e9-bbd7-4a54080cfa87"\r
                  ]\r
               },\r
               {\r
                  "x":8,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"a3c543c8-8135-47ef-905e-681982708764",\r
                  "moved":false,\r
                  "items":[\r
                     "99142690-4245-445b-bbc4-be8d09b93b83"\r
                  ]\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         },\r
         {\r
            "id":"e2055e5e-c0a8-46dc-8019-30c97e157d62",\r
            "title":"Map",\r
            "icon":"map",\r
            "fullscreen":true,\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"3587d28c-ffbe-4121-9e93-35cc52a5e947",\r
                  "moved":false,\r
                  "items":[\r
                     "232c9a69-1077-4b03-9c68-2d27eb148e6f"\r
                  ]\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         },\r
         {\r
            "id":"c9ae69c1-5c33-49bb-86e9-6ca2106cb9b7",\r
            "title":"Settings",\r
            "icon":"cog",\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":30,\r
                  "i":"252b1b88-f112-4095-aa75-a8f97fc6856b",\r
                  "moved":false,\r
                  "items":[\r
                     "dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937"\r
                  ],\r
                  "scaleToFitContents":false\r
               },\r
               {\r
                  "x":4,\r
                  "y":0,\r
                  "w":8,\r
                  "h":5,\r
                  "i":"6367c1cf-9e5d-4ec7-a383-f578e6dd0ea2",\r
                  "moved":false,\r
                  "items":[\r
                     "6fc7cca0-306e-40f6-a7c6-556ebd1fbd73"\r
                  ]\r
               },\r
               {\r
                  "x":8,\r
                  "y":5,\r
                  "w":4,\r
                  "h":25,\r
                  "i":"9f4dbd4d-cbe7-4dcd-94f3-c35850e28778",\r
                  "moved":false,\r
                  "items":[\r
                     "e90fd75a-f510-4481-845d-b2cdac5c4e2f"\r
                  ],\r
                  "scaleToFitContents":false\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         }\r
      ]\r
   }\r
]`,jn=`{\r
   "232c9a69-1077-4b03-9c68-2d27eb148e6f":{\r
      "id":"232c9a69-1077-4b03-9c68-2d27eb148e6f",\r
      "config":{\r
      },\r
      "module":"Map"\r
   }\r
}`,Pn=[{title:"#introduction.title",message:"#introduction.content",onEnter:({props:e})=>{const t=we.getConnection,n=N();t.setState(F.get("NODE_SETTINGS"),JSON.stringify({...n.settings,["tour"+Fe(e.tour)]:!0})).catch(s=>console.warn("Tours.Introduction",s.message||s))}},{target:"#SettingsButton",spotlight:".jarvis-sidebar-container",title:"#settings.title",message:"#settings.content",params:{placement:"right"},secondaryButton:"#settings.buttons.manually",secondaryAction:({finishTour:e,step:t})=>{document.querySelector("#SettingsButton").click(),e()},primaryButton:"#settings.buttons.automatically",primaryAction:({finishTour:e,nextStep:t,step:n})=>{t();const s={},o={};fe.importDevices(F.get("DEFAULT_ADAPTERIMPORT").concat(["daswetter"])).then(a=>{a.forEach(h=>{if(h.status==="fulfilled"){const f=h.value;s[f.function]=s[f.function]||[],s[f.function].push(f),o[f.id]=f}});const r=JSON.parse(Dn),i=JSON.parse(jn),l={config:{},items:[],module:"StateList",title:""},c=[{widgetId:"3958dfb0-83da-48ae-96f3-e66969a92cac",function:"light",icon:"mdi-lightbulb-on"},{widgetId:"be31acad-6bb4-40ed-a9cf-24cd981d8545",function:"blind",icon:"mdi-window-shutter-open"},{widgetId:"b073226b-14d9-40e9-bbd7-4a54080cfa87",function:"heating",icon:"mdi-radiator"},{widgetId:"99142690-4245-445b-bbc4-be8d09b93b83",function:"window",icon:"mdi-window-closed-variant"}];i["dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937"]={id:"dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937",config:{},items:[],module:"AdapterStatus",title:""},i["6fc7cca0-306e-40f6-a7c6-556ebd1fbd73"]={id:"6fc7cca0-306e-40f6-a7c6-556ebd1fbd73",config:{},items:[],module:"AdapterLogs",title:""},i["e90fd75a-f510-4481-845d-b2cdac5c4e2f"]={id:"e90fd75a-f510-4481-845d-b2cdac5c4e2f",config:{},items:[],module:"ScriptStatus",title:""},c.forEach((h,f)=>{const w=ue(l);w.id=h.widgetId,w.title=wt.global.t(h.function),w.icon=h.icon,s[h.function]=s[h.function]||[];for(const E of s[h.function]){if(!E.states)continue;const y=Object.keys(E.states);let d={id:yt(),type:"device",deviceId:E.id,showState:!0,primaryStateKey:y[0]||"",secondaryStatesKeys:[]};E.function==="light"&&(y.includes("power")||y.includes("level"))?d={...d,showState:!1,actionElement:"SwitchAction",primaryStateKey:y.includes("power")?"power":"level"}:E.function==="blind"&&y.includes("level")?d={...d,showState:!1,actionElement:"BlindLevelAction",primaryStateKey:"level"}:E.function==="heating"&&y.includes("temperature")?d={...d,showState:!0,primaryStateKey:"temperature",secondaryStatesKeys:y.filter(g=>["setTemperature","humidity"].includes(g))}:E.function==="window"&&y.includes("open")&&(d={...d,primaryStateKey:"open"}),w.items.push(d)}i[w.id]=w;const{height:C}=fe.getDefaultModuleHeight(w,w.items);r[0].tabs[0].widgetsDesktop[f].h=C,r[0].tabs[0].widgetsDesktop[f+1]&&r[0].tabs[0].widgetsDesktop[f].x===r[0].tabs[0].widgetsDesktop[f+1].x&&(r[0].tabs[0].widgetsDesktop[f+1].y=C)});const b=N(),u=we.getConnection,v=[u.setState(F.get("NODE_LAYOUT"),JSON.stringify({version:3,layout:r})),u.setState(F.get("NODE_DEVICES"),JSON.stringify({version:3,devices:o})),u.setState(F.get("NODE_WIDGETS"),JSON.stringify(i)),u.setState(F.get("NODE_SETTINGS"),JSON.stringify({...b.settings,tourInterface:!1}))];Promise.allSettled(v).then(()=>{e(),window.location.reload()}).catch(h=>console.warn("Tours.Introduction",h.message||h))}).catch(a=>{console.warn("Tours.Introduction",a.message||a)})}},{style:{"max-width":"450px"},title:"#jarvis.title",loading:!0,buttons:!1}],Hn=[{target:".jarvis-sidebar-container",title:"#drawer.title",message:"#drawer.content",params:{placement:"right"},onEnter:({props:e})=>{const t=we.getConnection,n=N();t.setState(F.get("NODE_SETTINGS"),JSON.stringify({...n.settings,["tour"+Fe(e.tour)]:!0})).catch(s=>console.warn("Tours.Interface",s.message||s))}},{target:".jarvis-tabs-container",title:"#tabs.title",message:"#tabs.content"},{spotlight:".q-page-container .jarvis-page",title:"#widgets.title",message:"#widgets.content"},{target:".jarvis-widget-container .jarvis-widget-module-StateList",title:"#modules.title",message:"#modules.content",params:{placement:"right-start"}},{target:".jarvis-widget-container .jarvis-widget-module-StateList .jarvis-widget-header",title:"#WidgetHeader.title",message:"#WidgetHeader.content",targetStyle:{}},{buttons:!1,onSpotlightClick:({nextStep:e})=>{e()},target:".jarvis-widget-container .jarvis-widget-module-StateList .jarvis-widget-content",title:"#WidgetContent.title",message:"#WidgetContent.content",targetStyle:{},params:{placement:"right-start"}},{target:".jarvis-popup",title:"#DeviceStateDetails.title",message:"#DeviceStateDetails.content",params:{placement:"top"}}],In={introduction:Pn,interface:Hn};const Bn=K({name:"Tours",props:{tour:{type:String},start:{type:Boolean,default:!1}},setup(e){const t=I(!1),n=I(null),s=In[e.tour],o=I(null),a=I(null);let r,i,l={};const c=(d,g)=>{i=g?d.style.position:i,d.style.position=g?d.style.position||"relative":i,d.style.zIndex=g?5001:null,d.style.border=g?"5px solid #fff":null,d.style.opacity=g?.7:"unset",r=g?d.parentElement.style.zIndex:r,d.parentElement.style.zIndex=g?5001:r},b=(d,g=!0)=>{const D=d.spotlight||d.target;if(t.value=!0,D){const j=document.querySelector(D);if(j){if(c(j,g),d.onSpotlightClick!==void 0&&(j.style.pointerEvents="all",j.onclick=()=>d.onSpotlightClick({props:e,step:d,nextStep:f,previousStep:h,skipStep:w,finishTour:C})),d.targetStyle&&g===!0){l={};for(const P in d.targetStyle)l[P]=j.style[P],j.style[P]=d.targetStyle[P]}else if(d.targetStyle&&g===!1)for(const P in d.targetStyle)j.style[P]=l[P]}}},u=d=>{const g=document.querySelector(d.value.target||"body"),D={...d.value.params||{},middleware:[]};return En(g,n.value,D).then(j=>{const{x:P,y:T}=j;n.value.firstChild&&(n.value.firstChild.style.display="block");const ce=n.value.offsetWidth,te=n.value.offsetHeight,$e=document.querySelector("body");$e.style.pointerEvents="none";const Ze=$e.offsetHeight-te;return n.value.style.left=(d.value.target?P+15:"calc(50% - "+ce/2)+"px",n.value.style.top=(d.value.target?Math.max(10,Math.min(Ze-10,T-te/2+10)):T/2-te/2)+"px",n.value.style.pointerEvents="all",!0})},v=d=>{a.value;const g=a.value===null||a.value===d-2;a.value=d-1,o.value=s[a.value],u(o).then(()=>{s[a.value-1]&&b(s[a.value-1],!1),s[a.value+1]&&b(s[a.value+1],!1),b(o.value)}),g&&o.value&&o.value.onEnter&&o.value.onEnter({props:e,step:o,previousStep:h,nextStep:f,finishTour:C,skipStep:w})},h=()=>v(a.value),f=()=>v(a.value+2),w=()=>{b(o.value,!1),o.value=null,t.value=!1;const d=document.querySelector("body");d.style.pointerEvents="all"},C=()=>{w()},E=m(()=>a.value<=0),y=m(()=>a.value===s.length-1);return N(),St(()=>{e.start&&v(1)}),{marked:It,tooltip:n,overlay:t,step:o,isFirst:E,isLast:y,previousStep:h,nextStep:f,skipStep:w,finishTour:C}}}),Rn={class:"tooltip",ref:"tooltip"},Mn={class:"text-h6"},Ln=["innerHTML"];function An(e,t,n,s,o,a){const r=O("q-overlay");return S(),H(U,null,[p(r,{modelValue:e.overlay,"onUpdate:modelValue":t[0]||(t[0]=i=>e.overlay=i),"no-scroll":!0,"z-index":5e3,opacity:.7},null,8,["modelValue","opacity"]),Q("div",Rn,[e.step?(S(),$(Se,{key:e.step.title,class:"step"},{default:k(()=>[p(ie,null,{default:k(()=>[Q("div",Mn,x(e.$t(e.step.title||"")),1)]),_:1}),p(oe),e.step.loading===!0?(S(),$(kt,{key:0,indeterminate:""})):z("",!0),p(ie,{style:{"max-height":"50vh"},class:"body scroll"},{default:k(()=>[Q("div",{innerHTML:e.marked.parse(e.$t(e.step.message||""))},null,8,Ln)]),_:1}),p(oe),e.step.buttons!==!1?(S(),$(Ae,{key:1,class:"nowrap"},{default:k(()=>[p(M,{onClick:e.skipStep,flat:"",label:e.$t("Skip"),color:"accent"},null,8,["onClick","label"]),p(Le),e.step.secondaryAction===void 0?L((S(),$(M,{key:0,onClick:e.previousStep,flat:"",label:e.$t("Previous"),color:"secondary"},null,8,["onClick","label"])),[[A,!e.isFirst]]):L((S(),$(M,{key:1,onClick:t[1]||(t[1]=i=>e.step.secondaryAction({step:e.step,previousStep:e.previousStep,nextStep:e.nextStep,finishTour:e.finishTour,skipStep:e.skipStep})),flat:"",label:e.$t(e.step.secondaryButton),color:"secondary"},null,8,["label"])),[[A,!e.isFirst]]),e.step.primaryButton===void 0?L((S(),$(M,{key:2,onClick:e.nextStep,flat:"",label:e.$t("Next"),color:"primary"},null,8,["onClick","label"])),[[A,!e.isLast]]):z("",!0),e.step.primaryButton===void 0?L((S(),$(M,{key:3,onClick:e.finishTour,label:e.$t("Finish"),color:"primary"},null,8,["onClick","label"])),[[A,e.isLast]]):L((S(),$(M,{key:4,onClick:t[2]||(t[2]=i=>e.step.primaryAction({step:e.step,previousStep:e.previousStep,nextStep:e.nextStep,finishTour:e.finishTour,skipStep:e.skipStep})),flat:"",label:e.$t(e.step.primaryButton),color:"primary"},null,8,["label"])),[[A,!e.isFirst]])]),_:1})):z("",!0)]),_:1})):z("",!0)],512)],64)}var zn=Y(Bn,[["render",An]]);const On=K({name:"Jarvis",components:{DeviceDetailsPopup:zt,Page:rn,tours:zn},setup(){B.dev("DEBUG","Jarvis","setup()");const e=ee(),t=N(),n=m(()=>t.settings);he(()=>{B.dev("DEBUG","Jarvis","watchEffect","scrollbar"),ne("style",n.value.scrollbars==="desktop"&&(e.platform.is.desktop||e.platform.is.mobile)||n.value.scrollbars==="mobile"&&e.platform.is.mobile?Bt:" ",{id:"scrollbar",type:"text/css",onlyPro:!1})}),ke(e.screen.sizes,()=>{ne("style",Rt.replace(/\$breakpoint-sm-min/g,e.screen.sizes.sm+"px").replace(/\$breakpoint-md-min/g,e.screen.sizes.md+"px"),{id:"responsive",type:"text/css",onlyPro:!1})},{immediate:!0});try{he(()=>{B.dev("DEBUG","Jarvis","watchEffect","styles"),je("styles",t.styles,{tag:"link",src:"href",rel:"stylesheet"}).then(a=>ne("style",a,{id:"css",type:"text/css"}))})}catch(a){console.warn("Jarvis-B7cq4T4m","Error injecting custom styles: "+a.message),console.debug("Jarvis-B7cq4T4m",t.styles)}try{he(()=>{B.dev("DEBUG","Jarvis","watchEffect","scripts"),je("script",t.scripts,{tag:"script"}).then(a=>ne("script",a,{id:"scripts"}))})}catch(a){console.warn("Jarvis-B7cq4T4m","Error injecting custom scripts: "+a.message),console.debug("Jarvis-B7cq4T4m",t.scripts)}const s=m(()=>t.layout||[]),o=m(()=>"page-"+t.getSelectedPageId);return{settings:n,pages:s,pageId:o}}});function Nn(e,t,n,s,o,a){const r=O("tours"),i=O("DeviceDetailsPopup"),l=O("Page");return S(),H(U,null,[p(r,{tour:"introduction",start:e.settings.tourIntroduction!==!0},null,8,["start"]),p(r,{tour:"interface",start:e.settings.tourIntroduction===!0&&e.settings.tourInterface!==!0},null,8,["start"]),p(i),p(qe,{"model-value":e.pageId,"keep-alive":!0,style:{"background-color":"transparent"},vertical:""},{default:k(()=>[(S(!0),H(U,null,ae(e.pages,c=>(S(),$(Ve,{key:c.id,name:"page-"+c.id,style:{padding:"0",margin:"0"}},{default:k(()=>[p(l,{page:c},null,8,["page"])]),_:2},1032,["name"]))),128))]),_:1},8,["model-value"])],64)}var Yn=Y(On,[["render",Nn]]);export{Yn as default};
