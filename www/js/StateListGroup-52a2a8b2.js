import{q as C,a4 as N,c as K,ds as p,b8 as I,a5 as k,_ as G,o as l,a as m,w as d,k as h,$ as L,i as $,t as O,N as v,d as V,ag as B,p as D,g as _,M as j}from"./index-52a12785.js";const w=C({name:"ModuleStateListGroup",props:["devices","deviceConfig"],setup(t){const u=N({}),g=K(()=>{const e=Object.values(u.value),n=e.filter(o=>o===!0),i=e.filter(o=>o===!1);return e.length===n.length?!0:e.length===i.length?!1:null}),y=(e,n,i)=>{if(e)return;const{item:o}=t.devices[i.id+"#"+n.key]||{},r=n&&n.val!==void 0?n.val:null;if(o&&o.useInGroup!==!1){let{on:s,off:a}=n&&n.properties||{};s=s!==void 0?s:!0,u.value[i.id+"-"+n.stateKey]=r!==null?r.toString()===s.toString()||typeof r=="number"&&r>0:a}},S=(e=!0)=>{for(const n in t.devices){const{device:i,item:o}=t.devices[n],r=o.primaryStateKey.toLowerCase(),s=i.states[r]&&i.states[r].properties||{},a=u.value[i.id+"-"+o.primaryStateKey],b=typeof a=="boolean"?!1:typeof a=="number"?!0:!Number.isNaN(parseFloat(a))&&a.toString().length===parseFloat(a).toString().length;e===!0&&s.setOn!==void 0?e=s.setOn:e===!1&&s.setOff!==void 0?e=s.setOff:e===!0&&s.on!==void 0||e===!1&&s.off!==void 0?e=e===!0?s.on:s.off:b&&typeof e=="boolean"&&(e=e===!0?parseInt(s.level)||100:0),e=typeof e=="string"&&(e==="true"||e==="false")?e==="true":e;const c=parseInt(e)||null;e=typeof e=="string"&&c!==null&&!Number.isNaN(c)&&c.toString().length===e.length?c:e,o.useInGroup!==!1&&p.set(i.id,o.primaryStateKey,e)}};let f=[];if(t.deviceConfig.actions)for(const e in t.devices)t.devices[e].item.primaryStateKey&&(f=f.concat(p.listen(t.devices[e].device.id,t.devices[e].item.primaryStateKey,y)));return I(()=>p.unlisten(f)),{components:k.Components._defaults.action,groupDevicesStates:u,groupState:g,set:S}}}),E={key:0};function F(t,u,g,y,S,f){return l(),m(j,{dense:"",class:"jarvis-StateListGroup"},{default:d(()=>[h(v,null,{default:d(()=>[h(L,{overline:""},{default:d(()=>[$(O(t.deviceConfig.name),1)]),_:1})]),_:1}),t.deviceConfig.actions===!0?(l(),m(v,{key:0,side:""},{default:d(()=>[t.deviceConfig.groupElement?(l(),V("div",E,[(l(),m(B(t.components[t.deviceConfig.groupElement]),D(t.$props,{onSet:t.set,stateKey:"group",state:{properties:{},stateStyle:{},val:t.groupState}}),null,16,["onSet","state"]))])):_("",!0)]),_:1})):_("",!0)]),_:1})}var M=G(w,[["render",F]]);export{M as default};
