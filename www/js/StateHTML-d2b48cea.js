import{bt as T,a4 as H,bM as b,Q as i,dc as k,ei as w,k as d,dk as c,dz as u,ao as C,aG as I,ay as v,W as p,b3 as f,bn as m,a2 as y,d3 as D,b1 as P,a1 as z,D as B,X as $,C as K}from"./index-7a578b83.js";const N=H({name:"ModuleStateHTML",props:["widget","_containerSize"],setup(e){const g=b(),_=i(()=>e.widget.config);i(()=>({...k.joinConfig(_.value,w)}));const s=d(!1),a=d(null),o=d(),r=(t,Q,E,L)=>{if(s.value=!0,t)return a.value=t&&t.message||t,a.value;o.value=L},n=i(()=>{let t=o.value&&o.value.val||"";return t=!c.isPro()&&t.indexOf("<link")!==-1?t.replace(/(<link(.*)>)/gi,""):t,t=!c.isPro()&&t.indexOf("<style")!==-1?t.replace(/(<style([\s\S]*?)<\/style>)/g,""):t,t}),M=i(()=>c.isPro()&&n.value&&typeof n.value=="string"&&n.value.indexOf("<script")!==-1),l=e.widget.items&&e.widget.items[0]||{},S=u.get(l.deviceId);let h=[];return S?h=u.listen(S.id,l.primaryStateKey,r):(a.value=g.t("Device {deviceId} not found").replace("{deviceId}",l.deviceId),console.warn("StateHTML",a.value),s.value=!0),C(()=>u.unlisten(h)),{loaded:s,error:a,html:n,hasScript:M}}}),O={class:"jarvis-StateHTML StateHTML"},V=["innerHTML"],j=["srcdoc"];function F(e,g,_,s,a,o){const r=I("alert");return v(),p("div",O,[f(y(D,{indeterminate:""},null,512),[[m,!e.loaded&&!e.error]]),f(y(r,null,{default:P(()=>[z(B(e.error),1)]),_:1},512),[[m,e.loaded&&e.error]]),f($("div",null,[e.hasScript?(v(),p("iframe",{key:1,class:"StateHTML-iFrame",style:K({border:0,height:e._containerSize.height+"px"}),srcdoc:e.html},null,12,j)):(v(),p("div",{key:0,innerHTML:e.html},null,8,V))],512),[[m,e.loaded&&!e.error]])])}var U=T(N,[["render",F],["__scopeId","data-v-01c14b25"]]);export{U as default};
