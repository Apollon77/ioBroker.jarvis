import{dj as re,a4 as K,bw as N,Q as h,dn as Ze,dp as Q,bt as Y,aG as O,ay as w,U as $,b1 as S,a2 as p,bS as ye,bT as se,X as G,D as x,bD as He,bB as M,bU as ie,bV as Re,A as B,bW as _e,af as et,cB as pe,cC as tt,a9 as nt,ck as st,ac as ke,bx as it,co as ee,k as H,bQ as Be,cq as R,b3 as A,bn as L,aF as Ce,dq as ot,aY as Me,cK as ve,r as Ae,cR as at,cG as Le,V as z,W as I,I as U,aE as oe,C as W,bF as rt,bG as ze,bH as de,a1 as he,cu as lt,dr as dt,cs as Oe,u as ct,df as ut,ds as ft,bO as gt,aI as pt,bM as mt,cr as vt,di as Ne,dh as We,bp as ht,ct as qe,dt as bt,d8 as wt,du as be,as as yt,d3 as St,aZ as me}from"./index-ba4a1ec8.js";import kt from"./StateList-85396cd1.js";import{b as Ct,c as Tt,Q as $t,a as Et}from"./QFooter-3d3dc986.js";import{Q as Dt}from"./QHeader-ad880a81.js";import{Q as jt}from"./QBtnDropdown-b9bcd50f.js";import{Q as Pt}from"./QBadge-26fc3e23.js";import{m as It}from"./marked.esm-4cbe47a7.js";import"./StateListGroup-728ebf59.js";import"./StateListItem-04ad6d0e.js";var Ht=`body {
	scrollbar-width: none;
	-ms-overflow-style: none;
	overflow-y: scroll;
}

body::-webkit-scrollbar {
	width: 0px;
	background: transparent;
}`;function le(e,t,n={}){if(n.id=n.id||"custom",n.onlyPro=n.onlyPro!==void 0?n.onlyPro:!0,n.onlyPro&&!re.isPro()&&t)re.warn("Custom Styles / Scripts are only available to Pro!");else if(e&&(!n.onlyPro||n.onlyPro&&re.isPro())){let i=document.getElementById(n.id);i?i.remove():(i=document.createElement(e),i.id=n.id),n.class&&i.classList.add(n.class);for(const a in n)i[a]=n[a];return i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}return null}function Te(e,t,n={}){document.querySelectorAll(".import_custom_"+e).forEach(s=>s.remove());const o=/@?import (?:url\()?['"](?<url>.*)['"]\)?;?/ig,r=[...t.matchAll(o)].map((s,l)=>new Promise(d=>{t=t.replace(s[0],""),le(n.tag||"link","",{[n.src||"src"]:s.groups.url+"?ts="+Date.now(),id:"import_custom_"+e+"-"+l,class:"import_custom_"+e,...n,onload:()=>d(!0),onerror:()=>d(!1)})}));return Promise.allSettled(r).then(()=>t)}const Rt=K({name:"DeviceDetailsPopup",components:{StateList:kt},setup(){const e=N(),t=h(()=>e.selectedDevice),n=h(()=>{const o=[];for(const a in t.value.states){const r=t.value.states[a];if(r.hide===!0||r.state===void 0&&r.action===void 0)continue;const{label:s,...l}=r;o.push({id:Ze(t.value.id+":"+a,Q.get("UUID")),type:"device",deviceId:t.value.id,bodyStateKey:a,primaryStateKey:a,...l,deviceStateDetails:!0})}return{items:o}});return{onClose:()=>e.set("selectedDeviceId",null),device:t,widget:n}}}),Bt={class:"text-h6"};function Mt(e,t,n,i,o,a){const r=O("state-list");return w(),$(_e,{"model-value":!!e.device.id,onHide:e.onClose,class:B({"jarvis-popup-container":!0,["jarvis-device-"+e.device.id]:!0})},{default:S(()=>[p(ye,{class:"column jarvis-popup",style:{width:"800px","max-width":"95vw","flex-wrap":"nowrap"}},{default:S(()=>[p(se,{class:"row items-center"},{default:S(()=>[G("div",Bt,x(e.device.label||e.device.name),1),p(He),p(M,{flat:"",round:"",color:"grey",icon:"close",onClick:e.onClose},null,8,["onClick"])]),_:1}),p(ie),p(se,{class:"col q-pa-none scroll body",style:{"overflow-x":"hidden"}},{default:S(()=>[p(r,{openDeviceDetails:!1,widget:e.widget,isPopup:""},null,8,["widget"])]),_:1}),p(ie),p(Re,{align:"right"},{default:S(()=>[p(M,{flat:"",label:e.$t("Close"),onClick:e.onClose,color:"primary"},null,8,["label","onClick"])]),_:1})]),_:1})]),_:1},8,["model-value","onHide","class"])}var At=Y(Rt,[["render",Mt]]);const Lt={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function zt(){const{props:e,proxy:{$q:t}}=nt(),n=et(tt,pe);if(n===pe)return console.error("QPageSticky needs to be child of QLayout"),pe;const i=h(()=>{const f=e.position;return{top:f.indexOf("top")>-1,right:f.indexOf("right")>-1,bottom:f.indexOf("bottom")>-1,left:f.indexOf("left")>-1,vertical:f==="top"||f==="bottom",horizontal:f==="left"||f==="right"}}),o=h(()=>n.header.offset),a=h(()=>n.right.offset),r=h(()=>n.footer.offset),s=h(()=>n.left.offset),l=h(()=>{let f=0,m=0;const g=i.value,v=t.lang.rtl===!0?-1:1;g.top===!0&&o.value!==0?m=`${o.value}px`:g.bottom===!0&&r.value!==0&&(m=`${-r.value}px`),g.left===!0&&s.value!==0?f=`${v*s.value}px`:g.right===!0&&a.value!==0&&(f=`${-v*a.value}px`);const k={transform:`translate(${f}, ${m})`};return e.offset&&(k.margin=`${e.offset[1]}px ${e.offset[0]}px`),g.vertical===!0?(s.value!==0&&(k[t.lang.rtl===!0?"right":"left"]=`${s.value}px`),a.value!==0&&(k[t.lang.rtl===!0?"left":"right"]=`${a.value}px`)):g.horizontal===!0&&(o.value!==0&&(k.top=`${o.value}px`),r.value!==0&&(k.bottom=`${r.value}px`)),k}),d=h(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function b(f){const m=st(f.default);return ke("div",{class:d.value,style:l.value},e.expand===!0?m:[ke("div",m)])}return{$layout:n,getStickyContent:b}}var Ot=it({name:"QPageSticky",props:Lt,setup(e,{slots:t}){const{getStickyContent:n}=zt();return()=>n(t)}});function Nt(){const e=ee(),t=H(!1);return{jumperIsOpen:t,jumperOpen:(i,o={})=>{const a=Be(i);t.value=!0,a.map(r=>{if(r.icon){const s=Iconify.getIcon(r.icon.indexOf(":")===-1?"mdi:"+r.icon:r.icon);if(s){const l=[],d=[];let b;const f=RegExp('(?<= (.+?)=\\")(.+?)(?=\\")',"g");for(;(b=f.exec(s.body))!==null;)if(b.index===f.lastIndex&&f.lastIndex++,b[1]==="d")l[l.length]=b[2];else{const m=d.length;d[m]=d[m]||[],d[m].push([b[1],b[2]])}r.icon=l.map((m,g)=>{const v=d[g].map(k=>k[0]+":"+k[1]);return m+"@@"+v.join("@@")}).join("&&")+"|"+s.left+" "+s.top+" "+s.width+" "+s.height}}return r}),e.bottomSheet({...o,actions:a}).onOk(r=>o.onSuccess&&o.onSuccess(r)).onCancel(()=>o.onCancel&&o.onCancel()).onDismiss(()=>{t.value=!1})}}}const Wt=K({name:"Container",props:["tabsCount"],setup(e){R.dev("DEBUG","Container","setup()");const t=N(),n=h(()=>t.drawerMiniMode);return{settings:h(()=>t.settings),drawerMiniMode:n,onHeaderReveals:a=>{R.dev("DEBUG","Container","onHeaderReveals()"),t.set("headerVisible",a)}}}});function qt(e,t,n,i,o,a){return e.settings.tabsBottom!==!0?A((w(),$(Dt,{key:0,class:"jarvis-header text-white",bordered:"",onReveal:e.onHeaderReveals,reveal:e.settings.tabsShow==="hide"},{default:S(()=>[Ce(e.$slots,"default")]),_:3},8,["onReveal","reveal"])),[[L,e.drawerMiniMode!==!0||e.drawerMiniMode===!0&&e.tabsCount>1]]):A((w(),$(Ct,{key:1,class:"jarvis-footer text-white",bordered:"",onReveal:e.onHeaderReveals,reveal:e.settings.tabsShow==="hide"},{default:S(()=>[Ce(e.$slots,"default")]),_:3},8,["onReveal","reveal"])),[[L,e.drawerMiniMode!==!0||e.drawerMiniMode===!0&&e.tabsCount>1]])}var Vt=Y(Wt,[["render",qt]]);const Ft=K({name:"Tabs",props:["page","tabs"],setup(e){R.dev("DEBUG","Tabs","setup()");const t=ee(),n=N(),i=ot(),o=re.isPro(),a=H(e.tabs),r=c=>{R.dev("DEBUG","Tabs","resolveBindings");const E=a.value.findIndex(D=>D.id===c.id);a.value[E]={...c,revision:at().substr(0,5)}};Me(()=>e.tabs,()=>{R.dev("DEBUG","Tabs","tabsWithResolvedBindings()"),a.value=e.tabs;for(const c of e.tabs)c.config={icon:c.icon,title:c.title},ve.getBindings(c,r)});const s=h(()=>n.drawerMiniMode),l=h(()=>n.settings),d=h({get(){return n.getSelectedTabId},set(c){c&&n.set({selectedTabId:c})}}),b=H([]),f=H(!1),m=H(!1),g=()=>{R.dev("DEBUG","Tabs","tabsHiddenShow()"),m.value=!t.platform.is.mobile},v=Ae([]),k=(c,E)=>{v[c]=E},T=c=>{const E=c&&c.width||t.screen.width;f.value=!1,b.value=[],v&&v.length&&l.value.tabsCollapse!==!1?v.forEach((D,j)=>{const C=D.$el;C.style.display="inherit",(C.offsetLeft+C.offsetWidth+220>E||f.value===!0)&&(C.style.display="none",f.value=!0,b.value.push(a.value[j]))}):v&&v.length&&l.value.tabsCollapse===!1&&v.forEach(D=>{const j=D.$el;j.style.display="inherit"})},P=c=>n.set("drawerSidebar",c),y=h(()=>i.getUnread.length);return{setRef:k,elTabs:v,tabsWithResolvedBindings:a,tabId:d,tabsHiddenDropdownEnabled:f,tabsHiddenDropdown:m,tabsHiddenShow:g,tabsHidden:b,toggleNotifications:c=>n.set("drawerNotifications",c),toggleSidebar:P,notificationsUnread:y,drawerMiniMode:s,settings:l,isPro:o,onResize:T}}}),Qt={class:"row nowrap",style:{margin:"2px 0"}},Gt={key:0,class:"q-tab__label"},Ut={class:"q-tab__label"};function Jt(e,t,n,i,o,a){const r=O("icon");return w(),$(lt,{modelValue:e.tabId,"onUpdate:modelValue":t[4]||(t[4]=s=>e.tabId=s),"inline-label":"",dense:"",align:"left",style:W({"padding-left":(e.drawerMiniMode!==!0?0:5)+"px","padding-right":"48px"}),id:"tabBar",class:B({"jarvis-tabs-container":!0,"jarvis-tabs-bottom":e.settings.tabsBottom===!0}),"content-class":"jarvis-tabs","indicator-color":"white"},{default:S(()=>[p(Le,{onResize:e.onResize},null,8,["onResize"]),e.settings.drawerShowMenuButton!==!1?(w(),$(M,{key:0,flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:t[0]||(t[0]=s=>e.toggleSidebar(!0)),class:B(["q-ml-sm",{"lt-md":e.drawerMiniMode===!0}])},null,8,["class"])):z("",!0),G("div",Qt,[(w(!0),I(U,null,oe(e.tabsWithResolvedBindings,(s,l)=>(w(),$(Tt,{key:s.revision,ref_for:!0,ref:d=>e.setRef(l,d),name:s.id,to:{params:{tabId:s.id}},style:W(e.isPro&&s.id===e.tabId&&s.bodySelectedStyle||e.isPro&&s.bodyStyle||{}),class:B(["jarvis-tab","jarvis-tab-"+s.id]),"content-class":e.settings.tabsDense?"dense":"normal"},{default:S(()=>[A(p(r,{name:s.icon,size:"xs",class:"tabIcon",style:W({margin:e.settings.tabsDense?"4px 4px 0 0":"0",...e.isPro&&s.id===e.tabId&&s.iconSelectedStyle||e.isPro&&s.iconStyle||{}})},null,8,["name","style"]),[[L,s.icon]]),e.page.hideLabels!==!0?(w(),I("div",Gt,x(s.title),1)):z("",!0)]),_:2},1032,["name","to","style","class","content-class"]))),128)),A(p(jt,{modelValue:e.tabsHiddenDropdown,"onUpdate:modelValue":t[1]||(t[1]=s=>e.tabsHiddenDropdown=s),onMouseover:t[2]||(t[2]=s=>e.tabsHiddenDropdown=!0),"auto-close":"",stretch:"",flat:""},{label:S(()=>[G("div",{class:B(e.settings.tabsDense?"dense":"normal")},[p(r,{name:"mdi-tab-unselected",size:"xs",class:"tabIcon",style:W({margin:e.settings.tabsDense?"1px 5px 0 0":"-1px 0 1px 0"})},null,8,["style"]),G("div",Ut,x(e.$t("More")+"..."),1)],2)]),default:S(()=>[p(rt,null,{default:S(()=>[(w(!0),I(U,null,oe(e.tabsHidden,s=>(w(),$(ze,{key:s.id,clickable:"",onClick:l=>e.tabId=s.id,class:B({"q-tab--active":s.id===e.tabId})},{default:S(()=>[p(de,{avatar:""},{default:S(()=>[p(r,{name:s.icon},null,8,["name"])]),_:2},1024),p(de,null,{default:S(()=>[he(x(s.title),1)]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1})]),_:1},8,["modelValue"]),[[L,e.tabsHiddenDropdownEnabled]])]),A(p(M,{flat:"",dense:"",round:"",icon:"mdi-bell","aria-label":"Notifications",onClick:t[3]||(t[3]=s=>e.toggleNotifications(!0)),class:"q-mr-sm notification-drawer-button"},{default:S(()=>[p(Pt,{color:"secondary",align:"middle",floating:""},{default:S(()=>[he(x(e.notificationsUnread),1)]),_:1})]),_:1},512),[[L,e.isPro]])]),_:1},8,["modelValue","style","class"])}var Kt=Y(Ft,[["render",Jt]]);function Yt(e,t){const n=h(()=>typeof e.value!="object"?H({fullscreenSize:e.value}):e),i=H(),o=H(!1),a=()=>{o.value=!0;const l=i.value;l.classList.add("isFullscreen"),l.style.overflow="auto";const d=l.querySelector(".jarvis-widget-scaler");d.style.height="auto"},r=()=>{o.value=!1;const l=i.value;l.classList.remove("isFullscreen"),l.style.overflow="initial";const d=l.querySelector(".jarvis-widget-scaler");d.style.height=n.value.fullscreenSize+"px",document.exitFullscreen?document.exitFullscreen().catch(b=>{}):document.mozCancelFullScreen?document.mozCancelFullScreen().catch(b=>{}):document.webkitCancelFullScreen&&document.webkitCancelFullScreen().catch(b=>{})};return Me(()=>i.value,()=>{i.value.addEventListener("fullscreenchange",()=>{document.fullscreenElement===null&&r()})}),{fullscreenElement:i,fullscreenActive:o,fullscreenToggle:l=>{l=typeof l=="boolean"?l:!o.value,dt.toggle(i.value).then(()=>{l===!1?r():a()}).catch(d=>{console.error(d)})}}}const Xt=K({name:"Widget",props:["page","tab","widgets","config","layout","containerSize"],setup(e){const t=ee(),n=Oe(),i=N(),o=ct(e,"config")||{};H();const a=H(),r=h(()=>{const C=o.value.alignmentHorizontal||"center",ae=o.value.alignmentVertical||"top",te=o.value.scaleToFitContents!==void 0?o.value.scaleToFitContents:!0;return{h:C,v:ae,fit:te}}),s=h(()=>r.value.v!=="middle"?{}:{transform:"translateY(-50%)",position:"relative",top:"50%"}),l=Ae({width:0,height:0}),d=h(()=>a.value&&a.value.$el.offsetHeight||0),b=h(()=>e.containerSize.height-d.value),f=h(()=>r.value.fit===!1||ut.includes(T.value.module)?{x:1,y:1}:{x:l?Math.min(1,e.containerSize.width/l.width):1,y:l?Math.min(1,b.value/l.height):1}),m=h(()=>{const C=[0,0];return C[0]=r.value.h==="center"?"50%":r.value.h==="right"?"100%":r.value.h,C[1]=r.value.v==="middle"?"50%":r.value.v==="bottom"?"100%":r.value.v,C}),g=h(()=>({width:r.value.h!=="fill-width"?"100%":Math.floor(1/(f.value.y<f.value.x?f.value.y:f.value.x)*100)+"% !important",height:b.value-1+"px"})),v=h(()=>E.value===!0?1:f.value.y<f.value.x?f.value.y:f.value.x),k=h(()=>{const C={"-webkit-transform":"scale("+v.value+")","-webkit-transform-origin":m.value.join(" "),transform:"scale("+v.value+")","transform-origin":m.value.join(" ")};return r.value.v==="middle"&&(C.margin="auto"),t.screen.lt.lg||e.layout==="desktop"&&t.platform.is.mobile?{}:C}),T=h(()=>{const C=e.widgets[0];return C&&i.widgets[C]||{}}),P=()=>{R.dev("DEBUG","Widget","jump"),T.value.link&&(T.value.link.indexOf("http")>-1||T.value.link.indexOf("www")>-1)?window.open((T.value.link.indexOf("http")===-1?"http://":"")+T.value.link,"_blank"):T.value.link&&n.push({params:{tabId:T.value.link}}).catch(C=>console.warn(C))};let y=null;const u=C=>{y&&clearTimeout(y),y=setTimeout(()=>{R.dev("DEBUG","Widget","onResize()"),Object.assign(l,C)},500)},{fullscreenElement:c,fullscreenActive:E,fullscreenToggle:D}=Yt(b),j=H(o.value.allowFullscreen||!1);return{alignment:r,verticalAlignment:s,scaleSizes:g,scaleStyle:k,size:l,widget:T,widgetTitle:a,widgetTitleSize:d,jump:P,onResize:u,fullscreenEnabled:j,fullscreenElement:c,fullscreenActive:E,fullscreenToggle:D}}});function xt(e,t,n,i,o,a){const r=O("icon");return w(),I("div",{ref:"fullscreenElement",onDblclick:t[1]||(t[1]=s=>e.fullscreenEnabled&&e.fullscreenToggle()),class:B(["jarvis-widget-container bgcolor",{tile:e.tab.widgetEdges,paper:!e.tab.widgetEdges,fullscreenEnabled:e.fullscreenEnabled}])},[e.fullscreenEnabled?(w(),I("div",{key:0,class:B(["fullscreener",{close:e.fullscreenActive}]),onClick:t[0]||(t[0]=(...s)=>e.fullscreenToggle&&e.fullscreenToggle(...s))},null,2)):z("",!0),p(ye,{flat:"",class:B(["jarvis-widget full-width full-height",{["jarvis-widget-module-"+e.widget.module]:!0,["jarvis-widget-"+e.widget.id]:!0}])},{default:S(()=>[e.widget.hideTitle!==!0&&(e.widget.icon||e.widget.title)?(w(),$(ze,{key:0,class:"jarvis-widget-header",ref:"widgetTitle"},{default:S(()=>[e.widget.icon?(w(),$(de,{key:0,side:"",class:B({"cursor-pointer":e.widget.link}),onClick:e.jump},{default:S(()=>[p(ft,{square:e.tab.widgetEdges,rounded:!e.tab.widgetEdges,class:"jarvis-widget-icon","font-size":"24px"},{default:S(()=>[p(r,{name:e.widget.icon},null,8,["name"])]),_:1},8,["square","rounded"])]),_:1},8,["class","onClick"])):z("",!0),p(de,null,{default:S(()=>[p(gt,{class:B(["text-h6",{"cursor-pointer":e.widget.link}]),onClick:e.jump},{default:S(()=>[he(x(e.widget.label||e.widget.title),1)]),_:1},8,["class","onClick"])]),_:1})]),_:1},512)):z("",!0),e.widget.hideSeparator!==!0&&e.widget.hideTitle!==!0&&(e.widget.icon||e.widget.title)?(w(),$(ie,{key:1})):z("",!0),p(se,{horizontal:"",class:"jarvis-widget-content",style:W(e.alignment.fit===!1?{"overflow-y":"auto",...e.scaleSizes,...e.verticalAlignment}:e.verticalAlignment)},{default:S(()=>[p(Le,{onResize:e.onResize},null,8,["onResize"]),G("div",{class:"jarvis-widget-scaler full-width",style:W(e.scaleStyle)},[(w(),$(pt(e.widget.module),{key:e.widget.revision,class:"full-width",widget:e.widget,_alignment:e.alignment,_fullscreen:e.fullscreenActive,_containerSize:{width:e.containerSize.width,height:e.containerSize.height-e.widgetTitleSize},_widgetSize:{width:e.size.width,height:e.size.height}},null,8,["widget","_alignment","_fullscreen","_containerSize","_widgetSize"]))],4)]),_:1},8,["style"])]),_:1},8,["class"])],34)}var Zt=Y(Xt,[["render",xt]]);const _t=K({name:"TabPanel",props:["page","tab"],components:{Widget:Zt},setup(e){R.dev("DEBUG","TabPanel","setup()");const t=N(),n=ee(),i=!1,o=h(()=>e.tab.widgetConfig),a=h(()=>Math.max(o.value.smartphoneGapSize||i||o.value.desktopGapSize||5,0)),r=h(()=>{let g=[];return o.value.smartphoneSameAs==="specific-layout"||i?g=e.tab.widgetsSmartphone||[]:o.value.smartphoneSameAs==="tablet"?g=e.tab.widgetsTablet||[]:g=e.tab.widgetsDesktop||[],g}),s=h(()=>Math.max.apply(Math,r.value.map(g=>g.y+g.h))),l=h(()=>{var g;return((g=r.value)==null?void 0:g[0])||{}}),d=n.screen.width,b=h(()=>t.pageHeight),f=h(()=>{const g=o.value.smartphoneFitPageHeight||!1,v=o.value.smartphoneWidgetHeight||i||o.value.desktopWidgetHeight||50;return g===!0?(b.value-2*a.value)/s.value-a.value:v}),m=h(()=>o.value.smartphoneSameAs==="specific-layout"||i?"smartphone":o.value.smartphoneSameAs==="tablet"?"tablet":"desktop");return{containerRows:s,fullscreenContainer:l,pageWidth:d,pageHeight:b,widgetGap:a,widgetHeight:f,widgetLayout:m,widgetContainers:r}}});function en(e,t,n,i,o,a){const r=O("widget");return w(),I("div",{class:B({["jarvis-page-"+e.page.id]:!0,["jarvis-tab-"+e.tab.id]:!0})},[e.tab.fullscreen!==!0?(w(),I("div",{key:0,class:B(["container",e.widgetLayout]),style:W({gridTemplateRows:"repeat("+e.containerRows+", "+e.widgetHeight+"px)",columnGap:e.widgetGap+"px",rowGap:e.widgetGap+"px",padding:e.widgetGap+"px"})},[(w(!0),I(U,null,oe(e.widgetContainers,s=>(w(),I(U,null,[s&&s.items&&s.items.length>0?(w(),I("div",{key:s.i,style:W({gridArea:s.y+1+" / "+(s.x+1)+" / span "+s.h+" / span "+s.w}),class:"box"},[p(r,{page:e.page,tab:e.tab,widgets:s.items||[],config:s,layout:e.widgetLayout,containerSize:{width:e.pageWidth/12*s.w,height:s.h*e.widgetHeight+(s.h-1)*e.widgetGap}},null,8,["page","tab","widgets","config","layout","containerSize"])],4)):z("",!0)],64))),256))],6)):(w(),I("div",{key:1,style:W({height:e.pageHeight+"px"})},[p(r,{fullscreen:"",page:e.page,tab:e.tab,widgets:e.fullscreenContainer.items||[],config:e.fullscreenContainer,layout:e.widgetLayout,containerSize:{width:e.pageWidth,height:e.pageHeight}},null,8,["page","tab","widgets","config","layout","containerSize"])],4))],2)}var tn=Y(_t,[["render",en]]);const nn=K({name:"Page",props:["page"],components:{Container:Vt,Tabs:Kt,TabPanel:tn},setup(e){R.dev("DEBUG","Page","setup()");const t=ee(),n=mt(),i=Oe(),o=vt(),a=N(),r=h(()=>t.platform.is.mobile),s=h(()=>a.drawerMiniMode),l=h(()=>a.settings),d=h(()=>Object.keys(e.page.tabs).length),b=h({get(){return"tab-"+a.getSelectedTabId},set(y){y&&i.push({params:{tabId:y.replace("tab-","")}})}}),f=(y,u)=>{const c=document.querySelector(".jarvis-header");y=c&&c.offsetHeight?c.offsetHeight:y;const E=u-y;return E!==a.pageHeight&&(R.dev("DEBUG","Page","setPageContainer",y,u,E,a.pageHeight),a.set("pageHeight",u-y)),{}},m=()=>a.set("selectedTabReady",!1),g=()=>a.set("selectedTabReady",!0),{jumperOpen:v}=Nt(),k=(y,u,c)=>{const E=u.id;i.push({params:{...o.params,tabId:E}}).then(()=>{if(c.id!=="_root"){const D=r.value&&u.widgetConfig.smartphoneWidgetHeight||u.widgetConfig.desktopWidgetHeight||50,j=document.querySelector(".jarvis-header"),C=j&&j.offsetHeight?j.offsetHeight:0;setTimeout(()=>window.scrollTo(0,c.y*D+C+1),100)}}).catch(()=>{})},T=(y,u)=>{let c=t.platform.is.mobile?u.widgetsSmartphone:u.widgetsDesktop;c=a.getWidgets(c),c=c.concat([{},{color:"primary",icon:"mdi-tab",label:n.t("Jump directly to")+" "+u.label,id:"_root"}]),v(c,{class:"jarvis-quick-jumper",message:y.title+" / "+u.title+": "+n.t("Widgets"),onSuccess:E=>k(y,u,E)})},P=y=>{const u=a.getTabs(y);v(u,{class:"jarvis-quick-jumper",message:y.title+": "+n.t("Tabs"),onSuccess:c=>T(y,c)})};return{jumperOpen:()=>v(a.getPages,{class:"jarvis-quick-jumper",message:n.t("Pages"),onSuccess:P}),setPageContainer:f,onSelectedTabMoving:m,onSelectedTabReady:g,drawerMiniMode:s,isMobile:r,tabsCount:d,tabId:b,tabAnimated:h(()=>l.value.tabsSwipeAnimation==="always"||(!l.value.tabsSwipeAnimation||l.value.tabsSwipeAnimation==="mobile")&&r.value),tabSwipeable:h(()=>l.value.tabsSwipe==="always"||(!l.value.tabsSwipe||l.value.tabsSwipe==="mobile")&&r.value),settings:l}}});function sn(e,t,n,i,o,a){const r=O("Tabs"),s=O("Container"),l=O("TabPanel");return w(),$(Et,{style:{"padding-top":"0"}},{default:S(()=>[p(s,{tabsCount:e.tabsCount},{default:S(()=>[p(r,{page:e.page,tabs:e.page.tabs},null,8,["page","tabs"])]),_:1},8,["tabsCount"]),p($t,{"style-fn":e.setPageContainer,class:"jarvis-page jarvis-body"},{default:S(()=>[p(Ne,{modelValue:e.tabId,"onUpdate:modelValue":t[0]||(t[0]=d=>e.tabId=d),"keep-alive":!0,animated:e.tabAnimated,swipeable:e.tabSwipeable,style:{"background-color":"transparent"},onBeforeTransition:e.onSelectedTabMoving,onTransition:e.onSelectedTabReady},{default:S(()=>[(w(!0),I(U,null,oe(e.page.tabs,d=>(w(),$(We,{key:d.id,name:"tab-"+d.id,style:W({padding:0,"margin-top":e.settings.tabsBottom||e.page.tabs.length===0?0:e.settings.tabsDense?"40px":"60px"})},{default:S(()=>[p(l,{page:e.page,tab:{widgetConfig:{},...d}},null,8,["page","tab"])]),_:2},1032,["name","style"]))),128))]),_:1},8,["modelValue","animated","swipeable","onBeforeTransition","onTransition"]),A(p(Ot,{position:"bottom-right",offset:[18,18],style:{"z-index":"5999"}},{default:S(()=>[p(M,{fab:"",icon:"mdi-tab-search",color:"accent",onClick:t[1]||(t[1]=ht(d=>e.jumperOpen(),["stop"]))})]),_:1},512),[[L,e.settings.quickJumper==="always"||e.isMobile&&e.settings.quickJumper==="mobile"]])]),_:1},8,["style-fn"])]),_:1})}var on=Y(nn,[["render",sn],["__scopeId","data-v-116d737e"]]);function Ve(e){return e.split("-")[0]}function an(e){return e.split("-")[1]}function rn(e){return["top","bottom"].includes(Ve(e))?"x":"y"}function ln(e){return e==="y"?"height":"width"}function $e(e,t,n){let{reference:i,floating:o}=e;const a=i.x+i.width/2-o.width/2,r=i.y+i.height/2-o.height/2,s=rn(t),l=ln(s),d=i[l]/2-o[l]/2,b=Ve(t),f=s==="x";let m;switch(b){case"top":m={x:a,y:i.y-o.height};break;case"bottom":m={x:a,y:i.y+i.height};break;case"right":m={x:i.x+i.width,y:r};break;case"left":m={x:i.x-o.width,y:r};break;default:m={x:i.x,y:i.y}}switch(an(t)){case"start":m[s]-=d*(n&&f?-1:1);break;case"end":m[s]+=d*(n&&f?-1:1);break}return m}const dn=async(e,t,n)=>{const{placement:i="bottom",strategy:o="absolute",middleware:a=[],platform:r}=n,s=await(r.isRTL==null?void 0:r.isRTL(t));let l=await r.getElementRects({reference:e,floating:t,strategy:o}),{x:d,y:b}=$e(l,i,s),f=i,m={},g=0;for(let v=0;v<a.length;v++){const{name:k,fn:T}=a[v],{x:P,y,data:u,reset:c}=await T({x:d,y:b,initialPlacement:i,placement:f,strategy:o,middlewareData:m,rects:l,platform:r,elements:{reference:e,floating:t}});if(d=P!=null?P:d,b=y!=null?y:b,m={...m,[k]:{...m[k],...u}},c&&g<=50){g++,typeof c=="object"&&(c.placement&&(f=c.placement),c.rects&&(l=c.rects===!0?await r.getElementRects({reference:e,floating:t,strategy:o}):c.rects),{x:d,y:b}=$e(l,f,s)),v=-1;continue}}return{x:d,y:b,placement:f,strategy:o,middlewareData:m}};function Ee(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function Fe(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function F(e){if(e==null)return window;if(!Fe(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function J(e){return F(e).getComputedStyle(e)}function V(e){return Fe(e)?"":e?(e.nodeName||"").toLowerCase():""}function Qe(){const e=navigator.userAgentData;return e!=null&&e.brands?e.brands.map(t=>t.brand+"/"+t.version).join(" "):navigator.userAgent}function q(e){return e instanceof F(e).HTMLElement}function _(e){return e instanceof F(e).Element}function cn(e){return e instanceof F(e).Node}function ce(e){if(typeof ShadowRoot=="undefined")return!1;const t=F(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function fe(e){const{overflow:t,overflowX:n,overflowY:i}=J(e);return/auto|scroll|overlay|hidden/.test(t+i+n)}function un(e){return["table","td","th"].includes(V(e))}function Ge(e){const t=/firefox/i.test(Qe()),n=J(e);return n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].includes(n.willChange)||t&&n.willChange==="filter"||t&&(n.filter?n.filter!=="none":!1)}function Ue(){return!/^((?!chrome|android).)*safari/i.test(Qe())}const De=Math.min,ne=Math.max,ue=Math.round;function Z(e,t,n){var i,o,a,r;t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect();let l=1,d=1;t&&q(e)&&(l=e.offsetWidth>0&&ue(s.width)/e.offsetWidth||1,d=e.offsetHeight>0&&ue(s.height)/e.offsetHeight||1);const b=_(e)?F(e):window,f=!Ue()&&n,m=(s.left+(f&&(i=(o=b.visualViewport)==null?void 0:o.offsetLeft)!=null?i:0))/l,g=(s.top+(f&&(a=(r=b.visualViewport)==null?void 0:r.offsetTop)!=null?a:0))/d,v=s.width/l,k=s.height/d;return{width:v,height:k,top:g,right:m+v,bottom:g+k,left:m,x:m,y:g}}function X(e){return((cn(e)?e.ownerDocument:e.document)||window.document).documentElement}function ge(e){return _(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Je(e){return Z(X(e)).left+ge(e).scrollLeft}function fn(e){const t=Z(e);return ue(t.width)!==e.offsetWidth||ue(t.height)!==e.offsetHeight}function gn(e,t,n){const i=q(t),o=X(t),a=Z(e,i&&fn(t),n==="fixed");let r={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if(i||!i&&n!=="fixed")if((V(t)!=="body"||fe(o))&&(r=ge(t)),q(t)){const l=Z(t,!0);s.x=l.x+t.clientLeft,s.y=l.y+t.clientTop}else o&&(s.x=Je(o));return{x:a.left+r.scrollLeft-s.x,y:a.top+r.scrollTop-s.y,width:a.width,height:a.height}}function Ke(e){return V(e)==="html"?e:e.assignedSlot||e.parentNode||(ce(e)?e.host:null)||X(e)}function je(e){return!q(e)||J(e).position==="fixed"?null:e.offsetParent}function pn(e){let t=Ke(e);for(ce(t)&&(t=t.host);q(t)&&!["html","body"].includes(V(t));){if(Ge(t))return t;{const n=t.parentNode;t=ce(n)?n.host:n}}return null}function we(e){const t=F(e);let n=je(e);for(;n&&un(n)&&J(n).position==="static";)n=je(n);return n&&(V(n)==="html"||V(n)==="body"&&J(n).position==="static"&&!Ge(n))?t:n||pn(e)||t}function Pe(e){if(q(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=Z(e);return{width:t.width,height:t.height}}function mn(e){let{rect:t,offsetParent:n,strategy:i}=e;const o=q(n),a=X(n);if(n===a)return t;let r={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if((o||!o&&i!=="fixed")&&((V(n)!=="body"||fe(a))&&(r=ge(n)),q(n))){const l=Z(n,!0);s.x=l.x+n.clientLeft,s.y=l.y+n.clientTop}return{...t,x:t.x-r.scrollLeft+s.x,y:t.y-r.scrollTop+s.y}}function vn(e,t){const n=F(e),i=X(e),o=n.visualViewport;let a=i.clientWidth,r=i.clientHeight,s=0,l=0;if(o){a=o.width,r=o.height;const d=Ue();(d||!d&&t==="fixed")&&(s=o.offsetLeft,l=o.offsetTop)}return{width:a,height:r,x:s,y:l}}function hn(e){var t;const n=X(e),i=ge(e),o=(t=e.ownerDocument)==null?void 0:t.body,a=ne(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),r=ne(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0);let s=-i.scrollLeft+Je(e);const l=-i.scrollTop;return J(o||n).direction==="rtl"&&(s+=ne(n.clientWidth,o?o.clientWidth:0)-a),{width:a,height:r,x:s,y:l}}function Ye(e){const t=Ke(e);return["html","body","#document"].includes(V(t))?e.ownerDocument.body:q(t)&&fe(t)?t:Ye(t)}function Xe(e,t){var n;t===void 0&&(t=[]);const i=Ye(e),o=i===((n=e.ownerDocument)==null?void 0:n.body),a=F(i),r=o?[a].concat(a.visualViewport||[],fe(i)?i:[]):i,s=t.concat(r);return o?s:s.concat(Xe(r))}function bn(e,t){const n=t.getRootNode==null?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&ce(n)){let i=t;do{if(i&&e===i)return!0;i=i.parentNode||i.host}while(i)}return!1}function wn(e,t){const n=Z(e,!1,t==="fixed"),i=n.top+e.clientTop,o=n.left+e.clientLeft;return{top:i,left:o,x:o,y:i,right:o+e.clientWidth,bottom:i+e.clientHeight,width:e.clientWidth,height:e.clientHeight}}function Ie(e,t,n){return t==="viewport"?Ee(vn(e,n)):_(t)?wn(t,n):Ee(hn(X(e)))}function yn(e){const t=Xe(e),i=["absolute","fixed"].includes(J(e).position)&&q(e)?we(e):e;return _(i)?t.filter(o=>_(o)&&bn(o,i)&&V(o)!=="body"):[]}function Sn(e){let{element:t,boundary:n,rootBoundary:i,strategy:o}=e;const r=[...n==="clippingAncestors"?yn(t):[].concat(n),i],s=r[0],l=r.reduce((d,b)=>{const f=Ie(t,b,o);return d.top=ne(f.top,d.top),d.right=De(f.right,d.right),d.bottom=De(f.bottom,d.bottom),d.left=ne(f.left,d.left),d},Ie(t,s,o));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}const kn={getClippingRect:Sn,convertOffsetParentRelativeRectToViewportRelativeRect:mn,isElement:_,getDimensions:Pe,getOffsetParent:we,getDocumentElement:X,getElementRects:e=>{let{reference:t,floating:n,strategy:i}=e;return{reference:gn(t,we(n),i),floating:{...Pe(n),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>J(e).direction==="rtl"},Cn=(e,t,n)=>dn(e,t,{platform:kn,...n});var Tn=`[\r
   {\r
      "id":"cfbea70b-925b-40d1-9e8e-d0768336e3da",\r
      "title":"Main Site",\r
      "type":"page",\r
      "icon":"mdi-file",\r
      "tabs":[\r
         {\r
            "id":"0559b5e5-1c56-4ea4-8211-d51226417202",\r
            "title":"Dashboard",\r
            "icon":"mdi-monitor-dashboard",\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":8,\r
                  "i":"77ac22da-738d-4646-b0f5-940298bd6571",\r
                  "moved":false,\r
                  "items":[\r
                     "3958dfb0-83da-48ae-96f3-e66969a92cac"\r
                  ]\r
               },\r
               {\r
                  "x":4,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"28e602ec-4064-48d0-94d8-80e64fe37f87",\r
                  "moved":false,\r
                  "items":[\r
                     "be31acad-6bb4-40ed-a9cf-24cd981d8545"\r
                  ]\r
               },\r
               {\r
                  "x":4,\r
                  "y":4,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"0f1c06bc-f5c3-4e32-84e6-41fc0b4d05b5",\r
                  "moved":false,\r
                  "items":[\r
                     "b073226b-14d9-40e9-bbd7-4a54080cfa87"\r
                  ]\r
               },\r
               {\r
                  "x":8,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"a3c543c8-8135-47ef-905e-681982708764",\r
                  "moved":false,\r
                  "items":[\r
                     "99142690-4245-445b-bbc4-be8d09b93b83"\r
                  ]\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         },\r
         {\r
            "id":"e2055e5e-c0a8-46dc-8019-30c97e157d62",\r
            "title":"Map",\r
            "icon":"map",\r
            "fullscreen":true,\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"3587d28c-ffbe-4121-9e93-35cc52a5e947",\r
                  "moved":false,\r
                  "items":[\r
                     "232c9a69-1077-4b03-9c68-2d27eb148e6f"\r
                  ]\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         },\r
         {\r
            "id":"c9ae69c1-5c33-49bb-86e9-6ca2106cb9b7",\r
            "title":"Settings",\r
            "icon":"cog",\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":30,\r
                  "i":"252b1b88-f112-4095-aa75-a8f97fc6856b",\r
                  "moved":false,\r
                  "items":[\r
                     "dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937"\r
                  ],\r
                  "scaleToFitContents":false\r
               },\r
               {\r
                  "x":4,\r
                  "y":0,\r
                  "w":8,\r
                  "h":5,\r
                  "i":"6367c1cf-9e5d-4ec7-a383-f578e6dd0ea2",\r
                  "moved":false,\r
                  "items":[\r
                     "6fc7cca0-306e-40f6-a7c6-556ebd1fbd73"\r
                  ]\r
               },\r
               {\r
                  "x":8,\r
                  "y":5,\r
                  "w":4,\r
                  "h":25,\r
                  "i":"9f4dbd4d-cbe7-4dcd-94f3-c35850e28778",\r
                  "moved":false,\r
                  "items":[\r
                     "e90fd75a-f510-4481-845d-b2cdac5c4e2f"\r
                  ],\r
                  "scaleToFitContents":false\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         }\r
      ]\r
   }\r
]`,$n=`{\r
   "232c9a69-1077-4b03-9c68-2d27eb148e6f":{\r
      "id":"232c9a69-1077-4b03-9c68-2d27eb148e6f",\r
      "config":{\r
      },\r
      "module":"Map"\r
   }\r
}`,En=[{title:"#introduction.title",message:"#introduction.content",onEnter:({props:e})=>{const t=be.getConnection,n=N();t.setState(Q.get("NODE_SETTINGS"),JSON.stringify({...n.settings,["tour"+qe(e.tour)]:!0})).catch(i=>console.warn("Tours.Introduction",i.message||i))}},{target:"#SettingsButton",spotlight:".jarvis-sidebar-container",title:"#settings.title",message:"#settings.content",params:{placement:"right"},secondaryButton:"#settings.buttons.manually",secondaryAction:({finishTour:e,step:t})=>{document.querySelector("#SettingsButton").click(),e()},primaryButton:"#settings.buttons.automatically",primaryAction:({finishTour:e,nextStep:t,step:n})=>{t();const i={},o={};ve.importDevices(Q.get("DEFAULT_ADAPTERIMPORT").concat(["daswetter"])).then(a=>{a.forEach(g=>{if(g.status==="fulfilled"){const v=g.value;i[v.function]=i[v.function]||[],i[v.function].push(v),o[v.id]=v}});const r=JSON.parse(Tn),s=JSON.parse($n),l={config:{},items:[],module:"StateList",title:""},d=[{widgetId:"3958dfb0-83da-48ae-96f3-e66969a92cac",function:"light",icon:"mdi-lightbulb-on"},{widgetId:"be31acad-6bb4-40ed-a9cf-24cd981d8545",function:"blind",icon:"mdi-window-shutter-open"},{widgetId:"b073226b-14d9-40e9-bbd7-4a54080cfa87",function:"heating",icon:"mdi-radiator"},{widgetId:"99142690-4245-445b-bbc4-be8d09b93b83",function:"window",icon:"mdi-window-closed-variant"}];s["dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937"]={id:"dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937",config:{},items:[],module:"AdapterStatus",title:""},s["6fc7cca0-306e-40f6-a7c6-556ebd1fbd73"]={id:"6fc7cca0-306e-40f6-a7c6-556ebd1fbd73",config:{},items:[],module:"AdapterLogs",title:""},s["e90fd75a-f510-4481-845d-b2cdac5c4e2f"]={id:"e90fd75a-f510-4481-845d-b2cdac5c4e2f",config:{},items:[],module:"ScriptStatus",title:""},d.forEach((g,v)=>{const k=Be(l);k.id=g.widgetId,k.title=bt.global.t(g.function),k.icon=g.icon,i[g.function]=i[g.function]||[];for(const P of i[g.function]){if(!P.states)continue;const y=Object.keys(P.states);let u={id:wt(),type:"device",deviceId:P.id,showState:!0,primaryStateKey:y[0]||"",secondaryStatesKeys:[]};P.function==="light"&&(y.includes("power")||y.includes("level"))?u={...u,showState:!1,actionElement:"SwitchAction",primaryStateKey:y.includes("power")?"power":"level"}:P.function==="blind"&&y.includes("level")?u={...u,showState:!1,actionElement:"BlindLevelAction",primaryStateKey:"level"}:P.function==="heating"&&y.includes("temperature")?u={...u,showState:!0,primaryStateKey:"temperature",secondaryStatesKeys:y.filter(c=>["setTemperature","humidity"].includes(c))}:P.function==="window"&&y.includes("open")&&(u={...u,primaryStateKey:"open"}),k.items.push(u)}s[k.id]=k;const{height:T}=ve.getDefaultModuleHeight(k,k.items);r[0].tabs[0].widgetsDesktop[v].h=T,r[0].tabs[0].widgetsDesktop[v+1]&&r[0].tabs[0].widgetsDesktop[v].x===r[0].tabs[0].widgetsDesktop[v+1].x&&(r[0].tabs[0].widgetsDesktop[v+1].y=T)});const b=N(),f=be.getConnection,m=[f.setState(Q.get("NODE_LAYOUT"),JSON.stringify({version:3,layout:r})),f.setState(Q.get("NODE_DEVICES"),JSON.stringify({version:3,devices:o})),f.setState(Q.get("NODE_WIDGETS"),JSON.stringify(s)),f.setState(Q.get("NODE_SETTINGS"),JSON.stringify({...b.settings,tourInterface:!1}))];Promise.allSettled(m).then(()=>{e(),window.location.reload()}).catch(g=>console.warn("Tours.Introduction",g.message||g))}).catch(a=>{console.warn("Tours.Introduction",a.message||a)})}},{style:{"max-width":"450px"},title:"#jarvis.title",loading:!0,buttons:!1}],Dn=[{target:".jarvis-sidebar-container",title:"#drawer.title",message:"#drawer.content",params:{placement:"right"},onEnter:({props:e})=>{const t=be.getConnection,n=N();t.setState(Q.get("NODE_SETTINGS"),JSON.stringify({...n.settings,["tour"+qe(e.tour)]:!0})).catch(i=>console.warn("Tours.Interface",i.message||i))}},{target:".jarvis-tabs-container",title:"#tabs.title",message:"#tabs.content"},{spotlight:".q-page-container .jarvis-page",title:"#widgets.title",message:"#widgets.content"},{target:".jarvis-widget-container .jarvis-widget-module-StateList",title:"#modules.title",message:"#modules.content",params:{placement:"right-start"}},{target:".jarvis-widget-container .jarvis-widget-module-StateList .jarvis-widget-header",title:"#WidgetHeader.title",message:"#WidgetHeader.content",targetStyle:{}},{buttons:!1,onSpotlightClick:({nextStep:e})=>{e()},target:".jarvis-widget-container .jarvis-widget-module-StateList .jarvis-widget-content",title:"#WidgetContent.title",message:"#WidgetContent.content",targetStyle:{},params:{placement:"right-start"}},{target:".jarvis-popup",title:"#DeviceStateDetails.title",message:"#DeviceStateDetails.content",params:{placement:"top"}}],jn={introduction:En,interface:Dn};const Pn=K({name:"Tours",props:{tour:{type:String},start:{type:Boolean,default:!1}},setup(e){const t=H(!1),n=H(null),i=jn[e.tour],o=H(null),a=H(null);let r,s,l={};const d=(u,c)=>{s=c?u.style.position:s,u.style.position=c?u.style.position||"relative":s,u.style.zIndex=c?5001:null,u.style.border=c?"5px solid #fff":null,u.style.opacity=c?.7:"unset",r=c?u.parentElement.style.zIndex:r,u.parentElement.style.zIndex=c?5001:r},b=(u,c=!0)=>{const E=u.spotlight||u.target;if(t.value=!0,E){const D=document.querySelector(E);if(D){if(d(D,c),u.onSpotlightClick!==void 0&&(D.style.pointerEvents="all",D.onclick=()=>u.onSpotlightClick({props:e,step:u,nextStep:v,previousStep:g,skipStep:k,finishTour:T})),u.targetStyle&&c===!0){l={};for(const j in u.targetStyle)l[j]=D.style[j],D.style[j]=u.targetStyle[j]}else if(u.targetStyle&&c===!1)for(const j in u.targetStyle)D.style[j]=l[j]}}},f=u=>{const c=document.querySelector(u.value.target||"body"),E={...u.value.params||{},middleware:[]};return Cn(c,n.value,E).then(D=>{const{x:j,y:C}=D;n.value.firstChild&&(n.value.firstChild.style.display="block");const ae=n.value.offsetWidth,te=n.value.offsetHeight,Se=document.querySelector("body");Se.style.pointerEvents="none";const xe=Se.offsetHeight-te;return n.value.style.left=(u.value.target?j+15:"calc(50% - "+ae/2)+"px",n.value.style.top=(u.value.target?Math.max(10,Math.min(xe-10,C-te/2+10)):C/2-te/2)+"px",n.value.style.pointerEvents="all",!0})},m=u=>{a.value;const c=a.value===null||a.value===u-2;a.value=u-1,o.value=i[a.value],f(o).then(()=>{i[a.value-1]&&b(i[a.value-1],!1),i[a.value+1]&&b(i[a.value+1],!1),b(o.value)}),c&&o.value&&o.value.onEnter&&o.value.onEnter({props:e,step:o,previousStep:g,nextStep:v,finishTour:T,skipStep:k})},g=()=>m(a.value),v=()=>m(a.value+2),k=()=>{b(o.value,!1),o.value=null,t.value=!1;const u=document.querySelector("body");u.style.pointerEvents="all"},T=()=>{k()},P=h(()=>a.value<=0),y=h(()=>a.value===i.length-1);return N(),yt(()=>{e.start&&m(1)}),{marked:It,tooltip:n,overlay:t,step:o,isFirst:P,isLast:y,previousStep:g,nextStep:v,skipStep:k,finishTour:T}}}),In={class:"tooltip",ref:"tooltip"},Hn={class:"text-h6"},Rn=["innerHTML"];function Bn(e,t,n,i,o,a){const r=O("q-overlay");return w(),I(U,null,[p(r,{modelValue:e.overlay,"onUpdate:modelValue":t[0]||(t[0]=s=>e.overlay=s),"no-scroll":!0,"z-index":5e3,opacity:.7},null,8,["modelValue","opacity"]),G("div",In,[e.step?(w(),$(ye,{key:e.step.title,class:"step"},{default:S(()=>[p(se,null,{default:S(()=>[G("div",Hn,x(e.$t(e.step.title||"")),1)]),_:1}),p(ie),e.step.loading===!0?(w(),$(St,{key:0,indeterminate:""})):z("",!0),p(se,{style:{"max-height":"50vh"},class:"body scroll"},{default:S(()=>[G("div",{innerHTML:e.marked.parse(e.$t(e.step.message||""))},null,8,Rn)]),_:1}),p(ie),e.step.buttons!==!1?(w(),$(Re,{key:1,class:"nowrap"},{default:S(()=>[p(M,{onClick:e.skipStep,flat:"",label:e.$t("Skip"),color:"accent"},null,8,["onClick","label"]),p(He),e.step.secondaryAction===void 0?A((w(),$(M,{key:0,onClick:e.previousStep,flat:"",label:e.$t("Previous"),color:"secondary"},null,8,["onClick","label"])),[[L,!e.isFirst]]):A((w(),$(M,{key:1,onClick:t[1]||(t[1]=s=>e.step.secondaryAction({step:e.step,previousStep:e.previousStep,nextStep:e.nextStep,finishTour:e.finishTour,skipStep:e.skipStep})),flat:"",label:e.$t(e.step.secondaryButton),color:"secondary"},null,8,["label"])),[[L,!e.isFirst]]),e.step.primaryButton===void 0?A((w(),$(M,{key:2,onClick:e.nextStep,flat:"",label:e.$t("Next"),color:"primary"},null,8,["onClick","label"])),[[L,!e.isLast]]):z("",!0),e.step.primaryButton===void 0?A((w(),$(M,{key:3,onClick:e.finishTour,label:e.$t("Finish"),color:"primary"},null,8,["onClick","label"])),[[L,e.isLast]]):A((w(),$(M,{key:4,onClick:t[2]||(t[2]=s=>e.step.primaryAction({step:e.step,previousStep:e.previousStep,nextStep:e.nextStep,finishTour:e.finishTour,skipStep:e.skipStep})),flat:"",label:e.$t(e.step.primaryButton),color:"primary"},null,8,["label"])),[[L,!e.isFirst]])]),_:1})):z("",!0)]),_:1})):z("",!0)],512)],64)}var Mn=Y(Pn,[["render",Bn]]);const An=K({name:"Jarvis",components:{DeviceDetailsPopup:At,Page:on,tours:Mn},setup(){R.dev("DEBUG","Jarvis","setup()");const e=ee(),t=N(),n=h(()=>t.settings);me(()=>{R.dev("DEBUG","Jarvis","watchEffect","scrollbar"),le("style",n.value.scrollbars==="desktop"&&(e.platform.is.desktop||e.platform.is.mobile)||n.value.scrollbars==="mobile"&&e.platform.is.mobile?Ht:" ",{id:"scrollbar",type:"text/css",onlyPro:!1})});try{me(()=>{R.dev("DEBUG","Jarvis","watchEffect","styles"),Te("styles",t.styles,{tag:"link",src:"href",rel:"stylesheet"}).then(a=>le("style",a,{id:"css",type:"text/css"}))})}catch(a){console.warn("Jarvis-B7cq4T4m","Error injecting custom styles: "+a.message),console.debug("Jarvis-B7cq4T4m",t.styles)}try{me(()=>{R.dev("DEBUG","Jarvis","watchEffect","scripts"),Te("script",t.scripts,{tag:"script"}).then(a=>le("script",a,{id:"scripts"}))})}catch(a){console.warn("Jarvis-B7cq4T4m","Error injecting custom scripts: "+a.message),console.debug("Jarvis-B7cq4T4m",t.scripts)}const i=h(()=>t.layout||[]),o=h(()=>"page-"+t.getSelectedPageId);return{settings:n,pages:i,pageId:o}}});function Ln(e,t,n,i,o,a){const r=O("tours"),s=O("DeviceDetailsPopup"),l=O("Page");return w(),I(U,null,[p(r,{tour:"introduction",start:e.settings.tourIntroduction!==!0},null,8,["start"]),p(r,{tour:"interface",start:e.settings.tourIntroduction===!0&&e.settings.tourInterface!==!0},null,8,["start"]),p(s),p(Ne,{"model-value":e.pageId,"keep-alive":!0,style:{"background-color":"transparent"},vertical:""},{default:S(()=>[(w(!0),I(U,null,oe(e.pages,d=>(w(),$(We,{key:d.id,name:"page-"+d.id,style:{padding:"0",margin:"0"}},{default:S(()=>[p(l,{page:d},null,8,["page"])]),_:2},1032,["name"]))),128))]),_:1},8,["model-value"])],64)}var Un=Y(An,[["render",Ln]]);export{Un as default};
