import{bt as V,a4 as Y,dg as $,Q as k,d7 as b,dH as x,k as p,aY as Q,am as R,aq as W,aZ as G,aG as Z,ay as c,W as _,X as u,a2 as j,U as w,cM as C,V as m,D as y,a1 as q,cF as f,dI as X}from"./index-b364605d.js";var P={};Object.defineProperty(P,"__esModule",{value:!0});const L=90.8333,H=360/24,J=60*60*1e3;function K(e){return Math.ceil((e.getTime()-new Date(e.getFullYear(),0,1).getTime())/864e5)}function S(e){return Math.sin(e*2*Math.PI/360)}function A(e){return Math.acos(e)*360/(2*Math.PI)}function ee(e){return Math.asin(e)*360/(2*Math.PI)}function te(e){return Math.tan(e*2*Math.PI/360)}function z(e){return Math.cos(e*2*Math.PI/360)}function O(e,a){const s=e%a;return s<0?s+a:s}function F(e,a,s,n,l){const d=K(l),r=a/H,g=s?d+(6-r)/24:d+(18-r)/24,v=.9856*g-3.289,T=O(v+1.916*S(v)+.02*S(2*v)+282.634,360),D=.91764*te(T);let i;i=360/(2*Math.PI)*Math.atan(D),i=O(i,360);const I=Math.floor(T/90)*90,o=Math.floor(i/90)*90;i=i+(I-o),i/=H;const h=.39782*S(T),M=z(ee(h)),t=(z(n)-h*S(e))/(M*z(e)),N=(s?360-A(t):A(t))/H+i-.06571*g-6.622,B=O(N-a/H,24),U=Date.UTC(l.getFullYear(),l.getMonth(),l.getDate());return new Date(U+B*J)}function ae(e,a,s=new Date){return F(e,a,!0,L,s)}function se(e,a,s=new Date){return F(e,a,!1,L,s)}var ne=P.getSunrise=ae,ie=P.getSunset=se;const oe=Y({name:"ModuleDateTime",props:["widget","_containerSize","_widgetSize"],setup(e){const a=$(),s=k(()=>e.widget.config),n=k(()=>{const t=b.joinConfig(s.value,x);return{...t,refresh:t.formatTime.indexOf("s")>-1?1:t.formatTime.indexOf("m")>-1?10:60}}),l=p(),d=p(),r=p(),g=p(),v=p(),T=k(()=>a.meta.city),D=k(()=>{const{latitude:t,longitude:E}=a.meta;return!t||!E?null:[t,E]}),i=()=>{if(n.value.sun!==!1&&D.value!==null)try{r.value=f(ne(...D.value),"HH:mm"),g.value=f(ie(...D.value),"HH:mm")}catch(t){console.warn("DateTime",t.message||t)}},I=()=>{try{const t=new Date;l.value=f(t,n.value.formatDate.replace(/(?:\r|\n|\r\n)/g,"'<br />'")),d.value=f(t,n.value.formatTime.replace(/(?:\r|\n|\r\n)/g,"'<br />'")),v.value=X(t)}catch(t){console.log(t.message||t),l.value=f(new Date,n.value._defaults.formatDate),d.value=f(new Date,n.value._defaults.formatTime)}};Q(D,()=>i());let o=null;const h=()=>{n.value.refresh&&n.value.refresh>0&&(o&&clearInterval(o),o=setInterval(()=>{I(),i()},n.value.refresh*1e3))};R(()=>{!o&&h()}),W(()=>{o&&clearInterval(o),o=null});let M=null;return G(()=>{e.widget.revision!==M&&(M=e.widget.revision,o&&clearInterval(o),h(),I())}),{moduleConfig:n,date:l,time:d,sunrise:r,sunset:g,week:v,city:T}}}),re={class:"jarvis-DateTime-Clock"},le=["innerHTML"],ce=["innerHTML"],ue={class:"row jarvis-DateTime-Details"},me={key:0,class:"jarvis-DateTime-Details-Item"},de={class:"jarvis-DateTime-Details-Item-City"},ve={key:1,class:"jarvis-DateTime-Details-Item"},De={class:"jarvis-DateTime-Details-Item-Sunrise"},fe={key:2,class:"jarvis-DateTime-Details-Item"},ge={class:"jarvis-DateTime-Details-Item-Sunset"},Te={key:3,class:"jarvis-DateTime-Details-Item"},he={class:"jarvis-DateTime-Details-Item-Week"};function pe(e,a,s,n,l,d){const r=Z("icon");return c(),_("div",{key:e.widget.revision,class:"jarvis-DateTime-Container"},[u("div",re,[u("span",{class:"jarvis-DateTime-Clock-Date",innerHTML:e.date},null,8,le),u("span",{class:"jarvis-DateTime-Clock-Time",innerHTML:e.time},null,8,ce)]),u("div",ue,[e.moduleConfig.city!==!1?(c(),_("div",me,[j(r,{size:"xs",name:"mdi-city-variant-outline",class:"jarvis-DateTime-Details-Icon"}),e.city?m("",!0):(c(),w(C,{key:0,color:"primary"})),u("span",de,y(e.city),1)])):m("",!0),e.moduleConfig.sun!==!1?(c(),_("div",ve,[j(r,{size:"xs",name:"mdi-weather-sunset-up",class:"jarvis-DateTime-Details-Icon"}),e.sunrise?m("",!0):(c(),w(C,{key:0,color:"primary"})),u("span",De,y(e.sunrise),1)])):m("",!0),e.moduleConfig.sun!==!1?(c(),_("div",fe,[j(r,{size:"xs",name:"mdi-weather-sunset-down",class:"jarvis-DateTime-Details-Icon"}),e.sunset?m("",!0):(c(),w(C,{key:0,color:"primary"})),u("span",ge,y(e.sunset),1)])):m("",!0),e.moduleConfig.calendarweek!==!1?(c(),_("div",Te,[j(r,{size:"xs",name:"mdi-calendar-week",class:"jarvis-DateTime-Details-Icon"}),e.week?m("",!0):(c(),w(C,{key:0,color:"primary"})),u("span",he,[u("span",null,y(e.$t("CW")),1),q(" "+y(e.week),1)])])):m("",!0)])])}var Ie=V(oe,[["render",pe]]);export{Ie as default};
