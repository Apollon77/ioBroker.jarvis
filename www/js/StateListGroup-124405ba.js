import{_ as h,q as K,a2 as N,c as b,dp as m,A as I,a3 as k,o as c,a as p,w as f,k as S,Z as L,i as G,t as O,M as v,d as V,ad as D,g as C,L as $}from"./index-10e282a0.js";const w=K({name:"ModuleStateListGroup",props:["devices","deviceConfig"],setup(t){const u=N({}),g=b(()=>{const e=Object.values(u.value),s=e.filter(o=>o===!0),i=e.filter(o=>o===!1);return e.length===s.length?!0:e.length===i.length?!1:null}),l=(e,s,i)=>{if(e)return;const{item:o}=t.devices[i.id+"#"+s.key]||{},r=s&&s.val!==void 0?s.val:null;if(o&&o.useInGroup!==!1){let{on:n,off:a}=s&&s.properties||{};n=n!==void 0?n:!0,u.value[i.id+"-"+s.stateKey]=r!==null?r.toString()===n.toString()||typeof r=="number"&&r>0:a}},y=(e=!0)=>{for(const s in t.devices){const{device:i,item:o}=t.devices[s],r=o.primaryStateKey.toLowerCase(),n=i.states[r]&&i.states[r].properties||{},a=u.value[i.id+"-"+o.primaryStateKey],_=typeof a=="boolean"?!1:typeof a=="number"?!0:!Number.isNaN(parseFloat(a))&&a.toString().length===parseFloat(a).toString().length;e===!0&&n.setOn!==void 0?e=n.setOn:e===!1&&n.setOff!==void 0?e=n.setOff:e===!0&&n.on!==void 0||e===!1&&n.off!==void 0?e=e===!0?n.on:n.off:_&&typeof e=="boolean"&&(e=e===!0?parseInt(n.level)||100:0),e=typeof e=="string"&&(e==="true"||e==="false")?e==="true":e;const d=parseInt(e)||null;e=typeof e=="string"&&d!==null&&!Number.isNaN(d)&&d.toString().length===e.length?d:e,o.useInGroup!==!1&&m.set(i.id,o.primaryStateKey,e)}};if(t.deviceConfig.actions)for(const e in t.devices)t.devices[e].item.primaryStateKey&&m.listen(t.devices[e].device.id,t.devices[e].item.primaryStateKey,l);return I(()=>{for(const e in t.devices){const{device:s,item:i}=t.devices[e];i.primaryStateKey&&m.unlisten(s.id,i.primaryStateKey,l)}}),{components:k.Components._defaults.action,groupDevicesStates:u,groupState:g,set:y}}}),B={key:0};function E(t,u,g,l,y,e){return c(),p($,{dense:"",class:"jarvis-StateListGroup"},{default:f(()=>[S(v,null,{default:f(()=>[S(L,{overline:""},{default:f(()=>[G(O(t.deviceConfig.name),1)]),_:1})]),_:1}),t.deviceConfig.actions===!0?(c(),p(v,{key:0,side:""},{default:f(()=>[t.deviceConfig.groupElement?(c(),V("div",B,[(c(),p(D(t.components[t.deviceConfig.groupElement]),{onSet:t.set,deviceConfig:t.deviceConfig,stateKey:"group",state:{properties:{},stateStyle:{},val:t.groupState}},null,40,["onSet","deviceConfig","state"]))])):C("",!0)]),_:1})):C("",!0)]),_:1})}var Q=h(w,[["render",E]]);export{Q as default};
