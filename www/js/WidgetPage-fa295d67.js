import{bx as fe,k as U,aA as me,d7 as be,aq as Se,am as Ce,as as we,ac as Ie,ck as De,a9 as Oe,d8 as ke,cm as ae,al as $e,d9 as Ee,a4 as de,cq as N,bM as Ke,cn as ue,Q as H,da as Y,bQ as ee,bR as Le,bt as re,db as Be,d6 as Ve,aG as Z,ay as l,W as w,X as v,b3 as h,bn as m,a2 as o,b1 as d,I as q,aE as ne,U as y,bG as k,bO as Ge,A as ce,D as I,a1 as J,V as f,bF as Q,cN as X,bP as le,bB as R,bo as Ae,dc as _,bU as A,bp as x,aI as te,ak as ve,by as Me,bH as se,bw as We,aY as Fe,bS as Qe,bD as Ue,bT as ie,bV as qe,bW as Pe}from"./index-2f9ee6b2.js";import{Q as je}from"./QExpansionItem-d67e7a8e.js";import{a as Ne,u as Re}from"./useDragDrop-23657718.js";var Te=fe({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validation-success","validation-error"],setup(e,{slots:D,emit:B}){const E=Oe(),b=U(null);let S=0;const u=[];function K(g){const L=typeof g=="boolean"?g:e.noErrorFocus!==!0,V=++S,F=(s,c)=>{B("validation-"+(s===!0?"success":"error"),c)},G=s=>{const c=s.validate();return typeof c.then=="function"?c.then(C=>({valid:C,comp:s}),C=>({valid:!1,comp:s,err:C})):Promise.resolve({valid:c,comp:s})};return(e.greedy===!0?Promise.all(u.map(G)).then(s=>s.filter(c=>c.valid!==!0)):u.reduce((s,c)=>s.then(()=>G(c).then(C=>{if(C.valid===!1)return Promise.reject(C)})),Promise.resolve()).catch(s=>[s])).then(s=>{if(s===void 0||s.length===0)return V===S&&F(!0),!0;if(V===S){const{comp:c,err:C}=s[0];if(C!==void 0&&console.error(C),F(!1,c),L===!0){const P=s.find(({comp:T})=>typeof T.focus=="function"&&ke(T.$)===!1);P!==void 0&&P.comp.focus()}}return!1})}function n(){S++,u.forEach(g=>{typeof g.resetValidation=="function"&&g.resetValidation()})}function i(g){g!==void 0&&ae(g);const L=S+1;K().then(V=>{L===S&&V===!0&&(e.onSubmit!==void 0?B("submit",g):g!==void 0&&g.target!==void 0&&typeof g.target.submit=="function"&&g.target.submit())})}function O(g){g!==void 0&&ae(g),B("reset"),$e(()=>{n(),e.autofocus===!0&&e.noResetFocus!==!0&&$()})}function $(){Ee(()=>{if(b.value===null)return;const g=b.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(b.value.querySelectorAll("[tabindex]"),L=>L.tabIndex>-1);g!=null&&g.focus({preventScroll:!0})})}me(be,{bindComponent(g){u.push(g)},unbindComponent(g){const L=u.indexOf(g);L>-1&&u.splice(L,1)}});let W=!1;return Se(()=>{W=!0}),Ce(()=>{W===!0&&e.autofocus===!0&&$()}),we(()=>{e.autofocus===!0&&$()}),Object.assign(E.proxy,{validate:K,resetValidation:n,submit:i,reset:O,focus:$,getValidationComponents:()=>u}),()=>Ie("form",{class:"q-form",ref:b,onSubmit:i,onReset:O},De(D.default))}});const ze=de({name:"WidgetDevicesSection",props:["module","itemList"],emits:["onChange"],setup(e,{emit:D}){N.dev("DEBUG","WidgetDevicesSection","setup()");const B=Ke(),E=ue(),b=H(()=>{const t=Y.Settings[e.module]||{};return console.warn(t,t.addDevice),{addDevices:!t.addDevice||t.addDevice&&t.addDevice.max===void 0,...t}}),S=H(()=>E.devices),u=t=>S.value[t],K=t=>S.value[t.deviceId].function==="other"?"_defaults":S.value[t.deviceId].function,n=t=>Object.keys(S.value[t].states)||[],i=t=>n(t).map(r=>({label:r,value:r})),O=t=>$[t].devices.length!==0,$=E.getGroups("function"),W=U(Object.values($)),g={},L=t=>(g[t]||(N.dev("DEBUG","WidgetDevicesSection","shallBeShown",t),g[t]=!b.value.addDevice||b.value.addDevice&&(!b.value.addDevice.fields||b.value.addDevice.fields&&b.value.addDevice.fields.includes(t))),g[t]),V=(t,r)=>{N.dev("DEBUG","WidgetDevicesSection","onFilter",t);const p=Object.values(t?E.getGroups("function",t):$);r(()=>{W.value=p})},F=(t,r,p)=>{const M=S.value[t.deviceId]&&S.value[t.deviceId].states[t[p+"StateKey"]]||{},j=t[r+"Element"];return Be(M[j+"Config"]||{},t[j+"Config"]&&t[j+"Config"][p]||{})},G=t=>{let r=!1;return t.map(p=>(r=p.type==="device"?r:p.type==="divider"?!1:p.type==="group"&&p.actions===!0,p.isInGroup=r,p))},a=U(G(ee(e.itemList))),s=U(a.value.length),c=(t,r=null)=>{N.dev("DEBUG","WidgetDevicesSection","addItem",t,r);const p=Ve(),M={...t,id:p};if(t.type==="device"){const j=n(t.deviceId)[0]||null;M.primaryStateKey=M.primaryStateKey||j,M.bodyStateKey=M.bodyStateKey||j}r===null?a.value.push(M):a.value.splice(r,0,M),document.getElementById("WidgetDialogBody"),a.value=G(a.value),D("onChange",{id:"items",value:a.value})},C=t=>{const r=ee(a.value.find(p=>p.id===t));c(r,a.value.findIndex(p=>p.id===r.id)+1)},P=t=>{confirm(B.t("Really delete item?"))&&(a.value.splice(a.value.findIndex(p=>p.id===t),1),a.value=G(a.value),D("onChange",{id:"items",value:a.value}))},T=U(),ge=t=>{(!t.attributes||t.attributes&&t.attributes.deleted!==!0)&&(c({type:"device",deviceId:t.id},s.value),b.value.addDevice&&b.value.addDevice.max!==void 0&&b.value.addDevice.max<=a.value.length&&T.value.hidePopup())},z=U({}),pe=()=>{z.value.value&&c({type:"group",name:z.value.value}),z.value={}},he=()=>c({type:"divider"}),oe=t=>{if(N.dev("DEBUG","WidgetDevicesSection","onChange",t),t.id&&t.itemId){const r=a.value.findIndex(p=>p.id===t.itemId);if(r>-1){if(t.id.indexOf("moduleConfig.")>-1)a.value[r].moduleConfig={...a.value[r].moduleConfig||{},[t.id.replace("moduleConfig.","")]:t.value};else if(t.id.indexOf("secondaryStatesConfig.")>-1)a.value[r].secondaryStatesConfig={...a.value[r].secondaryStatesConfig||{},[t.id.replace("secondaryStatesConfig.","")]:t.value};else if(t.id==="componentOptions"){const p=t.stateKey||a.value[r].primaryStateKey;a.value[r][t.component+"Config"]={...a.value[r][t.component+"Config"]||{},[p]:{...a.value[r][t.component+"Config"]&&a.value[r][t.component+"Config"][p]||{},...t.value}}}else a.value[r][t.id]=t.value;a.value=G(a.value),D("onChange",{id:"items",value:a.value})}}},ye=(t,r)=>{N.dev("DEBUG","WidgetDevicesSection","onChangeSecondaryStatesKeys",t,r),oe({value:r.map(p=>p.value||p),itemId:t,id:"secondaryStatesKeys"})};return{...Ne(a,t=>D("onChange",{id:"items",value:G(t)})),FunctionsComponentsList:Le.ComponentsListAsOptions,ModuleSettings:b,onFilter:V,shallBeShown:L,deviceList:S,getDevice:u,getDeviceFunction:K,getDeviceStates:n,getDeviceStatesOptions:i,hasDevices:O,onChange:oe,onChangeSecondaryStatesKeys:ye,setGroup:t=>{z.value=t},group:z,addGroup:pe,addDivider:he,addDevice:ge,insert:s,items:a,addItem:c,copyItem:C,deleteItem:P,componentValues:F,addDeviceElement:T,optionsAddDevice:$,optionGroupsAddDevice:W}}}),He={class:"full-width"},Je={class:"row sticky body"},Xe={class:"col-4"},Ye={key:0},Ze={class:"col-3"},_e={class:"col-3",style:{"line-height":"70px"}},xe={class:"row"},en={class:"row items-center"},nn={key:0},tn={key:1},on={key:2},an={key:3,class:"row nowrap"},ln={key:0,class:"row nowrap"},sn={key:1,class:"row nowrap"},dn={key:2,class:"row nowrap"};function un(e,D,B,E,b,S){const u=Z("inputs"),K=Z("icon");return l(),w("div",He,[v("div",Je,[v("div",Xe,[h(o(le,{onFilter:e.onFilter,ref:"addDeviceElement",label:e.$t("Add Device"),options:e.optionGroupsAddDevice,"model-value":"","use-input":"","input-debounce":750,"stack-label":"",style:{margin:"0 8px"}},{option:d(n=>[o(je,{"expand-separator":"","header-class":"text-weight-bold",label:n.opt.label,icon:n.opt.icon},{default:d(()=>[(l(!0),w(q,null,ne(n.opt.devices,i=>h((l(),y(Q,{key:i.id,clickable:"",onClick:O=>e.addDevice(i)},{default:d(()=>[o(k,null,{default:d(()=>[o(Ge,{class:"q-ml-md"},{default:d(()=>[v("span",{class:ce({"text-strike":i.attributes&&i.attributes.deleted===!0})},I(i.label?i.label+" ("+i.name+")":i.name),3),J("\xA0"),i.attributes&&i.attributes.deleted===!0?(l(),w("em",Ye,"[ "+I(e.$t("deleted"))+" ]",1)):f("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[X]])),128))]),_:2},1032,["label","icon"])]),_:1},8,["onFilter","label","options"]),[[m,e.ModuleSettings.addDevice!==!1&&(!e.ModuleSettings.addDevice||e.ModuleSettings.addDevice&&(e.ModuleSettings.addDevice.max===void 0||e.ModuleSettings.addDevice.max>e.items.length))]])]),h(v("div",{class:"col-1",style:{"text-align":"center","line-height":"70px"}},I(e.$t("or")),513),[[m,e.ModuleSettings.addGroup!==!1]]),h(v("div",Ze,[o(u,{label:"Add Group",onOnChange:e.setGroup,onKeyup:Ae(e.addGroup,["enter"]),value:e.group.value||""},{end:d(()=>[h(o(R,{flat:"",size:"sm",dense:"",icon:"mdi-check",label:e.$t("add"),style:{height:"32px","min-width":"100px","margin-top":"16px"},onClick:e.addGroup},null,8,["label","onClick"]),[[m,!!e.group.value]])]),_:1},8,["onOnChange","onKeyup","value"])],512),[[m,e.ModuleSettings.addGroup!==!1]]),h(v("div",{class:"col-1",style:{"text-align":"center","line-height":"70px"}},I(e.$t("or")),513),[[m,e.ModuleSettings.addDivider!==!1]]),h(v("div",_e,[o(R,{icon:"mdi-minus",label:e.$t("Add Divider"),color:"primary",onClick:e.addDivider},null,8,["label","onClick"])],512),[[m,e.ModuleSettings.addDivider!==!1]])]),v("div",xe,[o(se,{ref:"elDragDrop",class:"full-width"},{default:d(()=>[h((l(),y(Q,{style:{"min-height":"auto",padding:"0"},clickable:"",tag:"label"},{default:d(()=>[o(k,{side:"",class:"q-ml-md text-caption"},{default:d(()=>[o(_,{modelValue:e.insert,"onUpdate:modelValue":D[0]||(D[0]=n=>e.insert=n),val:0,label:e.$t("insert on top"),dense:"",size:"xs"},null,8,["modelValue","label"])]),_:1}),o(k,null,{default:d(()=>[o(A,{class:"full-width"})]),_:1})]),_:1})),[[m,e.ModuleSettings.addDevices&&e.items.length>1],[X]]),(l(!0),w(q,null,ne(e.items,(n,i)=>(l(),w(q,{key:n.id},[i>0?h((l(),y(Q,{key:0,style:{"min-height":"auto",padding:"0"},clickable:"",tag:"label"},{default:d(()=>[o(k,{side:"",class:"q-ml-md text-caption"},{default:d(()=>[o(_,{modelValue:e.insert,"onUpdate:modelValue":D[1]||(D[1]=O=>e.insert=O),val:i,label:e.$t("insert after position")+": "+i,dense:"",size:"xs"},null,8,["modelValue","val","label"])]),_:2},1024),o(k,null,{default:d(()=>[o(A,{class:"full-width"})]),_:1})]),_:2},1024)),[[X]]):f("",!0),o(Q,{class:"paper",style:{padding:"8px 12px 8px 8px !important"}},{default:d(()=>[o(k,{avatar:""},{default:d(()=>[v("div",en,[h(o(K,{name:"mdi-drag-horizontal",class:"dragndrop",style:{"padding-right":"16px"}},null,512),[[m,e.items.length>1]]),o(u,{type:"button",dense:"",icon:"mdi-content-copy",tooltip:e.$t("copy"),onClick:x(O=>e.copyItem(n.id),["stop"])},null,8,["tooltip","onClick"]),h(o(u,{type:"button",dense:"",icon:"mdi-delete",tooltip:e.$t("delete"),color:"negative",onClick:x(O=>e.deleteItem(n.id),["stop"])},null,8,["tooltip","onClick"]),[[m,n._deleted!==!0]]),h(o(u,{type:"button",dense:"",icon:"mdi-restore",tooltip:e.$t("restore"),color:"positive",onClick:x(O=>e.restoreItem(n.id),["stop"]),class:"restore"},null,8,["tooltip","onClick"]),[[m,n._deleted===!0]])])]),_:2},1024),n.type!=="device"||n.type==="device"&&e.deviceList[n.deviceId]!==void 0?(l(),w(q,{key:0},[e.ModuleSettings.customBodySection?(l(),y(k,{key:0},{default:d(()=>[(l(),y(te(e.ModuleSettings.customBodySection),ve({...e.$props,...e.$attrs},{onOnChange:e.onChange,item:n,device:e.deviceList[n.deviceId]}),null,16,["onOnChange","item","device"]))]),_:2},1024)):(l(),y(k,{key:1},{default:d(()=>[n.type==="divider"?(l(),w("span",nn,[v("em",null,I("("+e.$t("divider")+")"),1)])):f("",!0),n.type==="group"?(l(),w("span",tn,[v("strong",null,I(n.name),1)])):f("",!0),n.type==="device"?(l(),w("span",on,[v("strong",null,I(e.deviceList[n.deviceId].name),1),J(" ("+I(e.deviceList[n.deviceId].function+", #"+n.deviceId)+")",1)])):f("",!0),n.type==="device"?(l(),w("div",an,[e.shallBeShown("label")?(l(),y(u,{key:0,dense:"",onOnChange:e.onChange,label:"Label",itemId:n.id,id:"label",json:"",value:n.label||"",placeholder:e.deviceList[n.deviceId].states[n.bodyStateKey]&&e.deviceList[n.deviceId].states[n.bodyStateKey].label?JSON.stringify(e.deviceList[n.deviceId].states[n.bodyStateKey].label):e.deviceList[n.deviceId].name},null,8,["onOnChange","itemId","value","placeholder"])):f("",!0),e.shallBeShown("bodyStateKey")?(l(),y(u,{key:1,dense:"",style:{width:"130px"},onOnSelect:e.onChange,label:"Body State",itemId:n.id,id:"bodyStateKey",value:n.bodyStateKey,type:"select",options:e.getDeviceStatesOptions(n.deviceId)},null,8,["onOnSelect","itemId","value","options"])):f("",!0),e.shallBeShown("bodyElement")?h((l(),y(u,{key:2,dense:"",style:{width:"230px"},onOnSelect:e.onChange,onOnOptions:e.onChange,id:"bodyElement",label:"Body Element",state:e.deviceList[n.deviceId].states[n.bodyStateKey],stateKey:n.bodyStateKey,itemId:n.id,placeholder:n.bodyElement===void 0&&(e.deviceList[n.deviceId].states[n.bodyStateKey]&&e.deviceList[n.deviceId].states[n.bodyStateKey].bodyElement||"LastChangeBody"),value:n.bodyElement,type:"select.components",components:e.FunctionsComponentsList.bodyElements[e.getDeviceFunction(n)],componentValues:e.componentValues(n,"body",n.bodyStateKey)},null,8,["onOnSelect","onOnOptions","state","stateKey","itemId","placeholder","value","components","componentValues"])),[[m,n.bodyStateKey]]):f("",!0)])):f("",!0)]),_:2},1024)),e.ModuleSettings.customActionSection?(l(),y(k,{key:2,side:""},{default:d(()=>[(l(),y(te(e.ModuleSettings.customActionSection),{onOnChange:e.onChange,item:n,device:e.deviceList[n.deviceId]},null,40,["onOnChange","item","device"]))]),_:2},1024)):(l(),y(k,{key:3,side:""},{default:d(()=>[n.type==="group"?(l(),w("div",ln,[o(u,{dense:"",style:{width:"100px"},onOnChange:e.onChange,label:e.$t("Group Actions"),itemId:n.id,id:"actions",value:n.actions||!1,type:"switch"},null,8,["onOnChange","label","itemId","value"]),e.shallBeShown("groupElement")?h((l(),y(u,{key:0,dense:"",style:{width:"200px"},onOnSelect:e.onChange,onOnOptions:e.onChange,id:"groupElement",label:"Group Element",stateKey:"group",itemId:n.id,value:n.groupElement,type:"select.components",components:e.FunctionsComponentsList.actionElements._defaults.filter(O=>!["DatePickerAction","TimePickerAction","InputAction","DropdownAction"].includes(O.value)),componentValues:e.componentValues(n,"group","group")},null,8,["onOnSelect","onOnOptions","itemId","value","components","componentValues"])),[[m,n.actions===!0]]):f("",!0)])):f("",!0),n.type==="device"?(l(),w("div",sn,[e.shallBeShown("primaryStateKey")?(l(),y(u,{key:0,dense:"",style:{width:"130px"},onOnSelect:e.onChange,label:"Action State",itemId:n.id,id:"primaryStateKey",value:n.primaryStateKey,type:"select",options:e.getDeviceStatesOptions(n.deviceId)},null,8,["onOnSelect","itemId","value","options"])):f("",!0),e.shallBeShown("showState")?h((l(),y(u,{key:1,dense:"",style:{width:"100px"},onOnChange:e.onChange,label:"Show State",itemId:n.id,id:"showState",value:n.showState!==void 0?n.showState:!0,type:"switch"},null,8,["onOnChange","itemId","value"])),[[m,n.primaryStateKey]]):f("",!0),e.shallBeShown("showGroupAction")?h((l(),y(u,{key:2,dense:"",style:{width:"100px"},onOnChange:e.onChange,label:"Use in Actions",itemId:n.id,id:"useInGroup",value:n.useInGroup!==void 0?n.useInGroup:!0,type:"switch"},null,8,["onOnChange","itemId","value"])),[[m,n.primaryStateKey&&n.isInGroup===!0]]):f("",!0),e.shallBeShown("actionElement")?h((l(),y(u,{key:3,dense:"",style:{width:"200px"},onOnSelect:e.onChange,onOnOptions:e.onChange,id:"actionElement",label:"Action Element",state:e.deviceList[n.deviceId].states[n.primaryStateKey],stateKey:n.primaryStateKey,itemId:n.id,placeholder:n.actionElement===void 0&&e.deviceList[n.deviceId].states[n.primaryStateKey]&&e.deviceList[n.deviceId].states[n.primaryStateKey].actionElement,value:n.actionElement,type:"select.components",components:e.FunctionsComponentsList.actionElements[e.getDeviceFunction(n)],componentValues:e.componentValues(n,"action",n.primaryStateKey)},null,8,["onOnSelect","onOnOptions","state","stateKey","itemId","placeholder","value","components","componentValues"])),[[m,n.primaryStateKey]]):f("",!0)])):f("",!0),n.type==="device"?(l(),w("div",dn,[e.shallBeShown("secondaryStatesKeys")?(l(),y(le,{key:0,"stack-label":"",dense:"",style:{width:"430px"},"onUpdate:modelValue":O=>e.onChangeSecondaryStatesKeys(n.id,O),label:e.$t("Secondary State"),"model-value":n.secondaryStatesKeys,options:e.getDeviceStatesOptions(n.deviceId),"use-chips":"",multiple:""},{after:d(()=>[o(R,{flat:"",dense:"",icon:"mdi-dots-vertical","click.prevent":""},{default:d(()=>[o(Me,null,{default:d(()=>[o(se,{style:{"min-width":"100px"}},{default:d(()=>[o(Q,null,{default:d(()=>[o(k,null,{default:d(()=>[o(u,{dense:"",onOnChange:e.onChange,itemId:n.id,label:"Use Labels",id:"secondaryStatesConfig.useLabel",value:n.secondaryStatesConfig&&n.secondaryStatesConfig.useLabel||!1,type:"switch",inline:""},null,8,["onOnChange","itemId","value"])]),_:2},1024)]),_:2},1024),o(Q,null,{default:d(()=>[o(k,null,{default:d(()=>[o(u,{dense:"",onOnChange:e.onChange,itemId:n.id,label:"Use Colors",id:"secondaryStatesConfig.useColor",value:n.secondaryStatesConfig&&n.secondaryStatesConfig.useColor||!0,type:"switch",inline:""},null,8,["onOnChange","itemId","value"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onUpdate:modelValue","label","model-value","options"])):f("",!0)])):f("",!0)]),_:2},1024))],64)):(l(),y(k,{key:1},{default:d(()=>[J(I(e.$t("Device not found")+" ("+e.$t("Device ID")+": "+n.deviceId+")"),1)]),_:2},1024))]),_:2},1024)],64))),128)),h((l(),y(Q,{style:{"min-height":"auto",padding:"0"},clickable:"",tag:"label"},{default:d(()=>[o(k,{side:"",class:"q-ml-md text-caption"},{default:d(()=>[o(_,{modelValue:e.insert,"onUpdate:modelValue":D[2]||(D[2]=n=>e.insert=n),val:e.items.length,label:e.$t("insert at the end"),dense:"",size:"xs"},null,8,["modelValue","val","label"])]),_:1}),o(k,null,{default:d(()=>[o(A,{class:"full-width"})]),_:1})]),_:1})),[[m,e.ModuleSettings.addDevices&&e.items.length>1],[X]])]),_:1},512)])])}var rn=re(ze,[["render",un],["__scopeId","data-v-7d02d9c3"]]);const cn=de({name:"WidgetPage",props:["widgetId"],emits:["onClose"],components:{WidgetDevicesSection:rn},setup(e,{emit:D}){const B=We(),E=ue(),{errors:b,hasErrors:S,addError:u,removeError:K,resetErrors:n}=Re({module:"Empty"}),i=U(null);Fe(()=>e.widgetId,a=>{a?(i.value=E.widgets[a]?ee(E.widgets[a]):{id:a,config:{}},i.value.module&&K("module")):i.value=null});const O=Y.ModuleList.map(a=>({label:a,value:a})),$=H(()=>Y.Configurations[i.value.module]||[]),W=H(()=>Y.Settings[i.value.module]||{}),g=H(()=>{const a={};return $.value.forEach(s=>{if(i.value.config[s.parameter]===void 0){const c=typeof s.value=="function"?s.value(i.value):s.value;V({id:"config."+s.parameter,value:c}),a[s.parameter]=c}else a[s.parameter]=i.value.config[s.parameter]}),a}),L=a=>a?Object.keys(a).some(s=>{const c=Array.isArray(a[s])?a[s]:[a[s]],C=i.value.config[s]===void 0?$.value.find(P=>P.parameter===s).value:i.value.config[s];return c.includes(C)}):!0,V=a=>{const{_error:s,id:c,value:C}=a;s?u(c,s):c!==void 0&&C!==void 0&&c.indexOf("config.")!==-1?(i.value.config[c.replace("config.","")]=C,K(c)):c!==void 0&&C!==void 0&&(i.value[c]=C,K(c),c==="module"&&(n(),i.value.config={}))},F=(a=null)=>{D("onClose",a),i.value=null,n()};return{jarvis:B,editor:E,ModuleList:O,ModuleConfigurations:$,ModuleSettings:W,ModuleConfigValues:g,errors:b,hasErrors:S,dependencies:L,widget:i,onChange:V,onCancel:F,onSave:()=>{E.addWidget({widget:i.value}),F(i.value)}}}}),vn={class:"text-h6 row items-center"},gn={class:"text-h6 primary q-ma-sm"},pn={class:"row"},hn={class:"col"},yn={class:"col"},fn={class:"col"},mn={class:"col-2"},bn={class:"col-1"},Sn={class:"text-h6 primary q-ma-sm"},Cn={class:"row"},wn={class:"col-3"},In={class:"col-9"},Dn={class:"text-h7 primary q-ma-sm"},On={class:"row"},kn={class:"row"},$n={class:"q-pa-sm"},En={key:0,class:"row"},Kn={class:"text-h7 primary q-ma-sm"},Ln={class:"row"};function Bn(e,D,B,E,b,S){const u=Z("inputs"),K=Z("widget-devices-section");return l(),y(Pe,{"model-value":e.widget!==null,"full-height":"",persistent:""},{default:d(()=>[e.widget!==null?(l(),y(Qe,{key:0,class:"column full-height",style:{width:"1400px","max-width":"90vw"}},{default:d(()=>[o(ie,{class:"row items-center"},{default:d(()=>[v("div",vn,[J(I(e.$t("Widget"))+": ",1),o(u,{dense:"",onOnChange:e.onChange,id:"title",label:e.$t("Name"),value:e.widget.title||"",autofocus:"",style:{width:"230px","margin-right":"16px"}},null,8,["onOnChange","label","value"]),J(" ("+I(e.$t("Widget ID")+": "+e.widget.id)+") ",1)]),o(Ue),o(R,{flat:"",round:"",color:"grey",icon:"close",onClick:e.onCancel},null,8,["onClick"])]),_:1}),o(A),o(ie,{id:"WidgetDialogBody",class:"col scroll body"},{default:d(()=>[o(Te,null,{default:d(()=>[v("div",gn,I(e.$t("Widget-Box")),1),o(A,{style:{margin:"0 -16px"}}),v("div",pn,[v("div",hn,[o(u,{onOnChange:e.onChange,id:"icon",label:e.$t("Widget")+" "+e.$t("Icon"),value:e.widget.icon||e.ModuleSettings.icon||"",icon:e.widget.icon},null,8,["onOnChange","label","value","icon"])]),v("div",yn,[o(u,{onOnChange:e.onChange,id:"label",label:e.$t("Widget")+" "+e.$t("Label"),value:e.widget.label||"",placeholder:e.widget.title},null,8,["onOnChange","label","value","placeholder"])]),v("div",fn,[o(u,{onOnChange:e.onChange,id:"link",label:e.$t("Widget")+" "+e.$t("Link"),value:e.widget.link||"",info:"config#HomeKitTile#jumper#info"},null,8,["onOnChange","label","value"])]),v("div",mn,[o(u,{type:"switch",onOnChange:e.onChange,id:"hideTitle",label:e.$t("Hide Widget Label and Icon"),value:e.widget.hideTitle||!1},null,8,["onOnChange","label","value"])]),v("div",bn,[h(o(u,{type:"switch",onOnChange:e.onChange,id:"hideSeparator",label:e.$t("Hide Separator"),value:e.widget.hideSeparator||!1},null,8,["onOnChange","label","value"]),[[m,e.widget.hideTitle!==!0]])])]),v("div",Sn,I(e.$t("Module")),1),o(A,{style:{margin:"0 -16px"}}),v("div",Cn,[v("div",wn,[o(u,{onOnSelect:e.onChange,id:"module",label:e.$t("Module"),type:"select",options:e.ModuleList,value:e.widget.module,"options-dense":"","use-input":"",required:"",error:e.errors.module!==void 0,"error-message":e.errors.module},null,8,["onOnSelect","label","options","value","error","error-message"])]),v("div",In,[h(v("div",{class:"centered"},I(e.$t(e.widget.module+"#description")),513),[[m,e.widget.module]])])]),h(v("div",null,[v("div",Dn,I(e.$t("Module Configuration")),1),o(A,{style:{margin:"0 0 8px 0"}}),h(v("div",On,[(l(!0),w(q,null,ne(e.ModuleConfigurations,n=>(l(),w(q,null,[n.hide!==!0?h((l(),w("div",{class:ce("col-"+(n.columns||4)),key:n.parameter},[o(u,ve(n,{onOnChange:e.onChange,onOnSelect:e.onChange,id:"config."+n.parameter,options:n.options?typeof n.options=="function"?n.options(e.widget.items,{jarvis:e.jarvis,editor:e.editor}):n.options:void 0,value:e.ModuleConfigValues[n.parameter],errorMessage:e.errors["config."+n.parameter]}),null,16,["onOnChange","onOnSelect","id","options","value","errorMessage"])],2)),[[m,e.dependencies(n.dependencies)]]):f("",!0)],64))),256))],512),[[m,e.ModuleConfigurations.length>0]]),h(v("div",kn,[v("p",$n,I(e.$t("No configuration options for this module")),1)],512),[[m,e.ModuleConfigurations.length===0]]),e.ModuleSettings&&e.ModuleSettings.customConfiguration?(l(),w("div",En,[(l(),y(te(e.ModuleSettings.customConfiguration),{config:e.widget.config,onOnChange:e.onChange},null,40,["config","onOnChange"]))])):f("",!0),e.ModuleSettings.addDevice!==!1?(l(),w(q,{key:1},[v("div",Kn,I(e.$t("Module Devices")),1),o(A,{style:{margin:"0 -0 8px 0"}}),v("div",Ln,[o(K,{onOnChange:e.onChange,ModuleConfigValues:e.ModuleConfigValues,itemList:e.widget.items||[],module:e.widget.module},null,8,["onOnChange","ModuleConfigValues","itemList","module"])])],64)):f("",!0)],512),[[m,e.widget.module]])]),_:1})]),_:1}),o(A),o(qe,{align:"right"},{default:d(()=>[o(R,{flat:"",label:e.$t("Cancel"),color:"negative",onClick:e.onCancel},null,8,["label","onClick"]),o(R,{flat:"",label:e.$t("Apply"),color:"primary",onClick:e.onSave,disable:e.hasErrors},null,8,["label","onClick","disable"])]),_:1})]),_:1})):f("",!0)]),_:1},8,["model-value"])}var Mn=re(cn,[["render",Bn],["__scopeId","data-v-43a16fdb"]]);export{Mn as W};
