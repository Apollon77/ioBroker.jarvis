import{a4 as N,k as I,Q as D,dr as y,ao as k,bN as G,bt as L,ay as p,U as g,b1 as m,a2 as _,bK as V,a1 as O,D as $,bA as h,W as B,aI as Q,ak as E,V as K,bz as F}from"./index-e89a99fa.js";const W=N({name:"ModuleStateListGroup",props:["devices","deviceConfig"],setup(t){const u=I({}),S=D(()=>{const s=Object.values(u.value),n=s.filter(a=>a===!0),e=s.filter(a=>a===!1);return s.length===n.length?!0:s.length===e.length?!1:null}),v=(s,n,e)=>{if(s)return;const{item:a}=t.devices[e.id+"#"+n.key]||{},o=n&&n.val!==void 0?n.val:null;if(a&&a.useInGroup!==!1){let{on:i,off:d}=n&&n.properties||{};i=i!==void 0?i:!0,u.value[e.id+"-"+n.stateKey]=o!==null?o.toString()===i.toString()||typeof o=="number"&&o>0:d}},b=(s,n,e=!0)=>{for(const a in t.devices){const{device:o,item:i}=t.devices[a],d=i.primaryStateKey.toLowerCase(),r=o.states[d]&&o.states[d].properties||{},c=u.value[o.id+"-"+i.primaryStateKey],C=typeof c=="boolean"?!1:typeof c=="number"?!0:!Number.isNaN(parseFloat(c))&&c.toString().length===parseFloat(c).toString().length;e===!0&&r.setOn!==void 0?e=r.setOn:e===!1&&r.setOff!==void 0?e=r.setOff:e===!0&&r.on!==void 0||e===!1&&r.off!==void 0?e=e===!0?r.on:r.off:C&&typeof e=="boolean"&&(e=e===!0?parseInt(r.level)||100:0),e=typeof e=="string"&&(e==="true"||e==="false")?e==="true":e;const l=parseInt(e)||null;e=typeof e=="string"&&l!==null&&!Number.isNaN(l)&&l.toString().length===e.length?l:e,i.useInGroup!==!1&&y.set(o.id,i.primaryStateKey,e)}};let f=[];if(t.deviceConfig.actions)for(const s in t.devices)t.devices[s].item.primaryStateKey&&(f=f.concat(y.listen(t.devices[s].device.id,t.devices[s].item.primaryStateKey,v)));return k(()=>y.unlisten(f)),{components:G.Components._defaults.action,groupDevicesStates:u,groupState:S,setDevice:b}}}),j={key:0};function w(t,u,S,v,b,f){return p(),g(F,{dense:"",class:"jarvis-StateListGroup"},{default:m(()=>[_(h,null,{default:m(()=>[_(V,{overline:""},{default:m(()=>[O($(t.deviceConfig.name),1)]),_:1})]),_:1}),t.deviceConfig.actions===!0?(p(),g(h,{key:0,side:""},{default:m(()=>[t.deviceConfig.groupElement?(p(),B("div",j,[(p(),g(Q(t.components[t.deviceConfig.groupElement]),E(t.$props,{onSetDevice:t.setDevice,device:{id:"group"},stateKey:"group",state:{properties:{},stateStyle:{},val:t.groupState}}),null,16,["onSetDevice","state"]))])):K("",!0)]),_:1})):K("",!0)]),_:1})}var P=L(W,[["render",w]]);export{P as default};
