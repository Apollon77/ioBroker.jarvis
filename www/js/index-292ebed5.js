var U=Object.defineProperty,K=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var B=(e,t,r)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,M=(e,t)=>{for(var r in t||(t={}))Z.call(t,r)&&B(e,r,t[r]);if(q)for(var r of q(t))G.call(t,r)&&B(e,r,t[r]);return e},P=(e,t)=>K(e,X(t));import{Q as Y}from"./QToolbarTitle-2372e735.js";import{Q as x}from"./QTooltip-e6256c69.js";import{bX as _,u as ee,cl as te,a3 as V,cm as ie,c as v,x as S,b7 as se,cn as oe,h as J,co as ne,aZ as ae,_ as re,q as le,cp as ue,cq as de,H as ce,cr as fe,cs as ge,ct as ve,cu as me,j as H,o as h,a as k,w as g,k as u,i as z,t as L,O as N,d as D,l as pe,F as R,cv as ye,cw as he,g as T,ac as be,cx as we,cy as W}from"./index-29fd0eef.js";import{Q as I}from"./QToolbar-2276168b.js";import{Q as Ce,a as Se,b as ke}from"./QPageContainer-6d7cce70.js";import{Q as Qe}from"./QHeader-69b318ea.js";var $e=_({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:t,emit:r}){const{proxy:{$q:b}}=ae(),n=ee(te,()=>{console.error("QFooter needs to be child of QLayout")}),p=V(parseInt(e.heightHint,10)),c=V(!0),C=V(ie.value===!0||n.isContainer.value===!0?0:window.innerHeight),w=v(()=>e.reveal===!0||n.view.value.indexOf("F")>-1||b.platform.is.ios&&n.isContainer.value===!0),a=v(()=>n.isContainer.value===!0?n.containerHeight.value:C.value),Q=v(()=>{if(e.modelValue!==!0)return 0;if(w.value===!0)return c.value===!0?p.value:0;const s=n.scroll.value.position+a.value+p.value-n.height.value;return s>0?s:0}),$=v(()=>e.modelValue!==!0||w.value===!0&&c.value!==!0),O=v(()=>e.modelValue===!0&&$.value===!0&&e.reveal===!0),F=v(()=>"q-footer q-layout__section--marginal "+(w.value===!0?"fixed":"absolute")+"-bottom"+(e.bordered===!0?" q-footer--bordered":"")+($.value===!0?" q-footer--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus"+(w.value!==!0?" hidden":""):"")),E=v(()=>{const s=n.rows.value.bottom,f={};return s[0]==="l"&&n.left.space===!0&&(f[b.lang.rtl===!0?"right":"left"]=`${n.left.size}px`),s[2]==="r"&&n.right.space===!0&&(f[b.lang.rtl===!0?"left":"right"]=`${n.right.size}px`),f});function o(s,f){n.update("footer",s,f)}function i(s,f){s.value!==f&&(s.value=f)}function y({height:s}){i(p,s),o("size",s)}function m(){if(e.reveal!==!0)return;const{direction:s,position:f,inflectionPoint:A}=n.scroll.value;i(c,s==="up"||f-A<100||n.height.value-a.value-f-p.value<300)}function l(s){O.value===!0&&i(c,!0),r("focusin",s)}S(()=>e.modelValue,s=>{o("space",s),i(c,!0),n.animate()}),S(Q,s=>{o("offset",s)}),S(()=>e.reveal,s=>{s===!1&&i(c,e.modelValue)}),S(c,s=>{n.animate(),r("reveal",s)}),S([p,n.scroll,n.height],m),S(()=>b.screen.height,s=>{n.isContainer.value!==!0&&i(C,s)});const d={};return n.instances.footer=d,e.modelValue===!0&&o("size",p.value),o("space",e.modelValue),o("offset",Q.value),se(()=>{n.instances.footer===d&&(n.instances.footer=void 0,o("size",0),o("offset",0),o("space",!1))}),()=>{const s=oe(t.default,[J(ne,{debounce:0,onResize:y})]);return e.elevated===!0&&s.push(J("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),J("footer",{class:F.value,style:E.value,onFocusin:l},s)}}});const j=[{id:"devices",title:"Devices",icon:"mdi-devices"},{id:"widgets",title:"Widgets",icon:"mdi-view-grid"},{id:"layout",title:"Layout",icon:"mdi-file"},{id:"styles",title:"Styles",icon:"mdi-code-tags",pro:!0},{id:"scripts",title:"scripts",icon:"mdi-language-javascript",pro:!0},{id:"settings",title:"Settings",icon:"mdi-cog"},{id:"account",title:"Pro-Account",icon:"mdi-star"},{id:"help",title:"Help",icon:"mdi-help-box"}],Oe=le({name:"ConfigurationLayout",components:{Login:ue},setup(){var E;const e=de(),t=ce(),r=fe(),b=ge();if(e.init({devices:t.devices,layout:Array.isArray(t.layout)&&t.layout.length>0?t.layout:[{id:"2bbbe067-7506-4fac-8a1f-bfbf9f48a9e7",type:"page",icon:"mdi-view-dashboard-variant",title:"Overview",tabs:[{icon:"mdi-desktop-mac-dashboard",title:"Dashboard",id:"674d30a6-83d8-4876-9135-55791d7dfec9",widgetsDesktop:[],widgetsSmartphone:[]}]}],styles:t.styles,scripts:t.scripts,settings:t.settings,widgets:t.widgets}),r.name==="Configuration"){const o=ve(((E=e.settings)==null?void 0:E.configTab)||j[0].id)+"Page";setTimeout(()=>{b.replace({name:o,params:r.params}).catch(i=>console.error(i))},500)}const n=V(me.get("secureConfiguration")),p=v(()=>t.settings),c=v(()=>e.hasErrors),C=v({get(){var o;return(o=e.settings)==null?void 0:o.configExpertMode},set(o){e.set("settings.configExpertMode",o)}}),w=v({get(){var o;return(o=e.settings)==null?void 0:o.configTab},set(o){o&&e.set("settings.configTab",o)}}),a=window.open,Q=o=>window.location.href.endsWith("configuration")||window.location.href.endsWith("configuration/")?"/configuration/"+o:o,$=(o,i)=>(t.set("pageHeight",i-o),{"min-height":i-o+"px"}),O=()=>{t.set("drawerSidebar",!1),b.push({name:"home",params:P(M({},r.params),{tabId:t.getSelectedTabId})}).catch(()=>{})};return{hasErrors:c,settings:p,login:n,version:"3.1.0-alpha.9",configTab:w,expertMode:C,tabs:j,setPageContainer:$,to:Q,onOpen:a,onCancel:O,onSave:o=>{const i={devices:e.devices,widgets:W(e.widgets),layout:W(e.getLayoutWithoutDeletions)||[],styles:e.styles,scripts:e.scripts,settings:e.settings};for(const m in i.widgets)i.widgets[m].items=i.widgets[m].items||[],i.widgets[m].items=i.widgets[m].items.filter(l=>i.devices[l.deviceId]&&(!i.devices[l.deviceId].attributes||i.devices[l.deviceId].attributes&&i.devices[l.deviceId].attributes.deleted!==!0));i.layout.forEach(m=>{m.tabs=m.tabs||[],m.tabs.forEach(l=>{delete l.widgets,l.widgetsDesktop=l.widgetsDesktop||[],l.widgetsDesktop.forEach(d=>{d.items=d.items||[],d.items=d.items.filter(s=>i.widgets[s]&&i.widgets[s]._deleted!==!0)}),l.widgetsSmartphone=l.widgetsSmartphone||[],l.widgetsSmartphone.forEach(d=>{d.items=d.items||[],d.items=d.items.filter(s=>i.widgets[s]&&i.widgets[s]._deleted!==!0)})})}),i.devices=e.getDevicesWithoutDeletions,i.widgets=e.getWidgetsWithoutDeletions;const y={};JSON.stringify(t.widgets)!==JSON.stringify(i.widgets)&&(y.widgets=i.widgets),JSON.stringify(t.devices)!==JSON.stringify(i.devices)&&(y.devices=i.devices),JSON.stringify(t.layout)!==JSON.stringify(i.layout)&&(y.layout=i.layout),JSON.stringify(t.settings)!==JSON.stringify(i.settings)&&(y.settings=i.settings),JSON.stringify(t.styles)!==JSON.stringify(i.styles)&&(y.styles=i.styles),JSON.stringify(t.scripts)!==JSON.stringify(i.scripts)&&(y.scripts=i.scripts),e.save(y),o?O():e.init(i)}}}}),Ee={key:1};function Ne(e,t,r,b,n,p){const c=H("icon"),C=H("Login"),w=H("router-view");return h(),k(we,{view:"hHh lpR fFf"},{default:g(()=>[!e.settings.secureConfiguration||e.settings.secureConfiguration&&e.login?(h(),k(Qe,{key:0},{default:g(()=>[u(I,null,{default:g(()=>[u(Y,null,{default:g(()=>[u(c,{name:"mdi-cog",vAlign:"middle"}),z(" "+L(e.$t("Configuration"))+" (v"+L(e.version)+") ",1)]),_:1}),u(N,{flat:"",dense:"",round:"",icon:e.expertMode?"mdi-code-tags-check":"mdi-code-tags","aria-label":"$t('Expert Mode')",onClick:t[0]||(t[0]=a=>e.expertMode=!e.expertMode)},{default:g(()=>[u(x,null,{default:g(()=>[z(L(e.$t("Expert Mode")),1)]),_:1})]),_:1},8,["icon"])]),_:1}),u(he,{modelValue:e.configTab,"onUpdate:modelValue":t[1]||(t[1]=a=>e.configTab=a),"inline-label":"",dense:"","outside-arrows":"","mobile-arrows":"",align:"left"},{default:g(()=>[(h(!0),D(R,null,pe(e.tabs,a=>(h(),D(R,null,[a.link?(h(),k(ye,{key:a.id,name:a.id,label:e.$t(a.title),icon:a.icon,onClick:Q=>e.onOpen(a.link,"_blank")},null,8,["name","label","icon","onClick"])):(h(),k(Ce,{key:a.id,name:a.id,label:e.$t(a.title),icon:a.icon,to:e.to(a.id)},null,8,["name","label","icon","to"]))],64))),256))]),_:1},8,["modelValue"])]),_:1})):T("",!0),u(ke,{class:"ConfigurationPage body"},{default:g(()=>[u(Se,{"style-fn":e.setPageContainer},{default:g(()=>[e.settings.secureConfiguration!==void 0&&e.settings.secureConfiguration!==!1&&!e.login?(h(),k(C,{key:0,ns:"secureConfiguration",code:e.settings.secureConfiguration,onOnSuccess:t[2]||(t[2]=a=>e.login=!0)},null,8,["code"])):T("",!0),!e.settings.secureConfiguration||e.settings.secureConfiguration&&e.login?(h(),D("div",Ee,[u(w)])):T("",!0)]),_:1},8,["style-fn"])]),_:1}),!e.settings.secureConfiguration||e.settings.secureConfiguration&&e.login?(h(),k($e,{key:1},{default:g(()=>[u(I,null,{default:g(()=>[u(N,{flat:"",icon:"mdi-window-close","aria-label":"Cancel",label:e.$t("Cancel"),class:"text-red",onClick:e.onCancel},null,8,["label","onClick"]),u(be),u(N,{disable:e.hasErrors,icon:"mdi-content-save","aria-label":"Save",label:e.$t("Save"),flat:"",color:"primary",onClick:t[3]||(t[3]=a=>e.onSave(!1)),style:{"margin-right":"8px"}},null,8,["disable","label"]),u(N,{disable:e.hasErrors,icon:"mdi-content-save","aria-label":"Save & Exit",label:e.$t("Save")+" & "+e.$t("Exit"),color:"primary",onClick:t[4]||(t[4]=a=>e.onSave(!0))},null,8,["disable","label"])]),_:1})]),_:1})):T("",!0)]),_:1})}var qe=re(Oe,[["render",Ne]]);export{qe as default};
