import{a4 as defineComponent,co as useQuasar,bw as useJarvis,Q as computed,dk as Pro,dz as Devices,bt as _export_sfc,bR as Functions,aG as resolveComponent,b3 as withDirectives,bn as vShow,ay as openBlock,U as createBlock,b1 as withCtx,a2 as createVNode,bH as QItemSection,aI as resolveDynamicComponent,V as createCommentVNode,W as createElementBlock,X as createBaseVNode,A as normalizeClass,C as normalizeStyle,bG as QItem}from"./index-0fd6d9d5.js";var StateListItem_vue_vue_type_style_index_0_scoped_true_lang="";const _sfc_main=defineComponent({name:"ModuleStateListItem",props:["device","deviceConfig","moduleConfig","primaryState","bodyState","openDeviceDetails","isPopup","isFirstItem","error"],setup(props){const $q=useQuasar(),jarvis=useJarvis(),bodyStyle=computed(()=>{let e=props.primaryState&&props.primaryState.bodyStyle;if(!e)return"";if(typeof e=="string"){e.indexOf("{")!==-1&&e.indexOf("}")!==-1&&(e=e.replace("{","").replace("}",""));const o={};return e.split(";").forEach(i=>{const[n,t]=i.split(":");o[n.trim()]=t.trim()}),o}try{return e}catch{return""}});let filterWarning=!1;const shallBeShown=computed(()=>{if(Pro.isPro()&&props.moduleConfig.filter)try{const filter=props.moduleConfig.filter.startsWith('"')&&props.moduleConfig.filter.endsWith('"')?props.moduleConfig.filter.substr(1,props.moduleConfig.filter.length-2):props.moduleConfig.filter;return eval(filter)(props.primaryState.value,props.primaryState.val,props.primaryState,props.device,props.widget)}catch(e){console.warn("StateList","Filter incorrect",props.moduleConfig.filter,e.message||e),filterWarning===!1&&(filterWarning=!0,$q.notify({type:"negative",icon:"mdi-alert",message:"StateList: Filter incorrect ("+e.message+")"}))}else!Pro.isPro()&&props.moduleConfig.filter&&Pro.warn("StateList: Filter is only available to Pro!");return!bodyStyle.value||!bodyStyle.value.display||bodyStyle.value.display&&!bodyStyle.value.display.startsWith("none")}),getComponent=(e,o,i)=>{const n=e&&Functions.Configurations[props.device.function]&&Functions.Configurations[props.device.function][e.toLowerCase()]||{},t=props.deviceConfig[o+"Element"]||props.isPopup===void 0&&i||props.isPopup!==void 0&&n[o+"Element"]||null;return Functions.Components[props.device.function]&&Functions.Components[props.device.function][o]&&Functions.Components[props.device.function][o][t]||Functions.Components._defaults&&Functions.Components._defaults[o]&&Functions.Components._defaults[o][t]||Functions.Components._defaults&&Functions.Components._defaults[o]&&Functions.Components._defaults[o][e]||null},onDevice=()=>{props.openDeviceDetails!==!1&&props.device.options&&props.device.options.suppressPopup!==!0&&jarvis.set({selectedDeviceId:props.device.id})};return{shallBeShown,bodyStyle,getComponent,onDevice,setDevice:Devices.set}}}),_hoisted_1={key:0,class:"jarvis-StateListItem-Action-primaryStateKey"},_hoisted_2={class:"jarvis-StateListItem-Action-secondaryStatesKeys"};function _sfc_render(e,o,i,n,t,a){const s=resolveComponent("icon");return withDirectives((openBlock(),createBlock(QItem,{key:e.device.id+"-"+e.device.revision+"-"+(e.isPopup!==void 0?"v":"x"),clickable:e.openDeviceDetails!==!1&&e.device.options&&e.device.options.suppressPopup!==!0,"v-ripple":e.openDeviceDetails!==!1&&e.device.options&&e.device.options.suppressPopup!==!0,onClick:e.onDevice,class:normalizeClass(["jarvis-StateListItem",{"jarvis-StateListItem-Popup":e.isPopup!==void 0,"jarvis-StateListItem-Separator":!e.isFirstItem&&e.isPopup!==void 0}]),style:normalizeStyle(e.bodyStyle)},{default:withCtx(()=>[createVNode(QItemSection,{avatar:"",class:"jarvis-StateListItem-Icon"},{default:withCtx(()=>[e.error?(openBlock(),createBlock(s,{key:1,name:"mdi:alert",color:"warning",tooltip:e.error},null,8,["tooltip"])):(openBlock(),createBlock(s,{key:0,styles:(e.primaryState.icon?e.primaryState.iconStyle:e.bodyState.iconStyle)||{},name:e.primaryState.icon||e.bodyState.icon||e.device.icon||e.device.functionIcon,color:"primary"},null,8,["styles","name"]))]),_:1}),createVNode(QItemSection,{class:"jarvis-StateListItem-Body"},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(e.getComponent("Title","components")),{stateKey:e.deviceConfig.bodyStateKey,state:e.bodyState,device:e.device,deviceConfig:e.deviceConfig,isPopup:e.isPopup},null,8,["stateKey","state","device","deviceConfig","isPopup"])),e.deviceConfig.bodyStateKey&&e.deviceConfig.bodyElement!==null?(openBlock(),createBlock(resolveDynamicComponent(e.getComponent(e.deviceConfig.bodyStateKey,"body",e.bodyState.bodyElement)),{key:0,stateKey:e.deviceConfig.bodyStateKey,state:e.bodyState,device:e.device,deviceConfig:e.deviceConfig.bodyElement===void 0?e.bodyState.config:e.deviceConfig,onSetDevice:e.setDevice},null,40,["stateKey","state","device","deviceConfig","onSetDevice"])):createCommentVNode("",!0)]),_:1}),createVNode(QItemSection,{side:"",class:"jarvis-StateListItem-Action"},{default:withCtx(()=>[e.deviceConfig.primaryStateKey?(openBlock(),createElementBlock("div",_hoisted_1,[e.deviceConfig.showState!==!1?(openBlock(),createBlock(resolveDynamicComponent(e.getComponent("State","components")),{key:0,stateKey:e.deviceConfig.primaryStateKey,state:e.primaryState,device:e.device,deviceConfig:e.deviceConfig},null,8,["stateKey","state","device","deviceConfig"])):createCommentVNode("",!0),e.deviceConfig.actionElement!==null?(openBlock(),createBlock(resolveDynamicComponent(e.getComponent(e.deviceConfig.primaryStateKey,"action",e.primaryState.actionElement)),{key:1,stateKey:e.deviceConfig.primaryStateKey,state:e.primaryState,device:e.device,deviceConfig:e.deviceConfig.actionElement===void 0?e.primaryState.config:e.deviceConfig,onSetDevice:e.setDevice},null,40,["stateKey","state","device","deviceConfig","onSetDevice"])):createCommentVNode("",!0)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_2,[e.deviceConfig.secondaryStatesKeys?(openBlock(),createBlock(resolveDynamicComponent(e.getComponent("SecondaryStates","components")),{key:0,stateKey:e.deviceConfig.primaryStateKey,state:e.primaryState,device:e.device,deviceConfig:e.deviceConfig,onSetDevice:e.setDevice},null,40,["stateKey","state","device","deviceConfig","onSetDevice"])):createCommentVNode("",!0)])]),_:1})]),_:1},8,["clickable","v-ripple","onClick","class","style"])),[[vShow,e.shallBeShown]])}var StateListItem=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-2e2121f8"]]);export{StateListItem as default};
