var j=Object.defineProperty,G=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var B=(e,t,r)=>t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,M=(e,t)=>{for(var r in t||(t={}))X.call(t,r)&&B(e,r,t[r]);if(z)for(var r of z(t))Y.call(t,r)&&B(e,r,t[r]);return e},P=(e,t)=>G(e,K(t));import{Q as Z}from"./QToolbarTitle-de3db92f.js";import{Q as x}from"./QTooltip-4c8e0ced.js";import{W as _,z as ee,cw as te,a0 as N,cx as ie,a as m,C as S,bi as oe,cy as se,h as L,cz as ne,a2 as ae,_ as re,x as le,cA as ue,cB as de,L as ce,cC as fe,cD as ge,cE as me,cF as ve,m as D,o as p,b as k,w as g,q as u,l as q,t as H,U as T,f as J,s as ye,F as R,cG as pe,cH as he,k as V,cI as be,cJ as W}from"./index-edd2d6c0.js";import{Q as I}from"./QToolbar-31b942b4.js";import{Q as we,a as Ce,b as Se}from"./QPageContainer-7e10d68c.js";import{Q as ke}from"./QHeader-0348e0c3.js";import{Q as Qe}from"./QSpace-8bb7ea50.js";var $e=_({name:"QFooter",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:t,emit:r}){const{proxy:{$q:h}}=ae(),n=ee(te,()=>{console.error("QFooter needs to be child of QLayout")}),y=N(parseInt(e.heightHint,10)),c=N(!0),C=N(ie.value===!0||n.isContainer.value===!0?0:window.innerHeight),b=m(()=>e.reveal===!0||n.view.value.indexOf("F")>-1||h.platform.is.ios&&n.isContainer.value===!0),a=m(()=>n.isContainer.value===!0?n.containerHeight.value:C.value),Q=m(()=>{if(e.modelValue!==!0)return 0;if(b.value===!0)return c.value===!0?y.value:0;const o=n.scroll.value.position+a.value+y.value-n.height.value;return o>0?o:0}),$=m(()=>e.modelValue!==!0||b.value===!0&&c.value!==!0),E=m(()=>e.modelValue===!0&&$.value===!0&&e.reveal===!0),F=m(()=>"q-footer q-layout__section--marginal "+(b.value===!0?"fixed":"absolute")+"-bottom"+(e.bordered===!0?" q-footer--bordered":"")+($.value===!0?" q-footer--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus"+(b.value!==!0?" hidden":""):"")),O=m(()=>{const o=n.rows.value.bottom,f={};return o[0]==="l"&&n.left.space===!0&&(f[h.lang.rtl===!0?"right":"left"]=`${n.left.size}px`),o[2]==="r"&&n.right.space===!0&&(f[h.lang.rtl===!0?"left":"right"]=`${n.right.size}px`),f});function s(o,f){n.update("footer",o,f)}function i(o,f){o.value!==f&&(o.value=f)}function w({height:o}){i(y,o),s("size",o)}function v(){if(e.reveal!==!0)return;const{direction:o,position:f,inflectionPoint:U}=n.scroll.value;i(c,o==="up"||f-U<100||n.height.value-a.value-f-y.value<300)}function l(o){E.value===!0&&i(c,!0),r("focusin",o)}S(()=>e.modelValue,o=>{s("space",o),i(c,!0),n.animate()}),S(Q,o=>{s("offset",o)}),S(()=>e.reveal,o=>{o===!1&&i(c,e.modelValue)}),S(c,o=>{n.animate(),r("reveal",o)}),S([y,n.scroll,n.height],v),S(()=>h.screen.height,o=>{n.isContainer.value!==!0&&i(C,o)});const d={};return n.instances.footer=d,e.modelValue===!0&&s("size",y.value),s("space",e.modelValue),s("offset",Q.value),oe(()=>{n.instances.footer===d&&(n.instances.footer=void 0,s("size",0),s("offset",0),s("space",!1))}),()=>{const o=se(t.default,[L(ne,{debounce:0,onResize:w})]);return e.elevated===!0&&o.push(L("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),L("footer",{class:F.value,style:O.value,onFocusin:l},o)}}});const A=[{id:"devices",title:"Devices",icon:"mdi-devices"},{id:"widgets",title:"Widgets",icon:"mdi-view-grid"},{id:"layout",title:"Layout",icon:"mdi-file"},{id:"styles",title:"Styles",icon:"mdi-code-tags",pro:!0},{id:"settings",title:"Settings",icon:"mdi-cog"},{id:"account",title:"Pro-Account",icon:"mdi-star"},{id:"help",title:"Help",icon:"mdi-help-box"}],Ee=le({name:"ConfigurationLayout",components:{Login:ue},setup(){var O;const e=de(),t=ce(),r=fe(),h=ge();if(e.init({devices:t.devices,layout:Array.isArray(t.layout)&&t.layout.length>0?t.layout:[{id:"2bbbe067-7506-4fac-8a1f-bfbf9f48a9e7",type:"page",icon:"mdi-view-dashboard-variant",title:"Overview",tabs:[{icon:"mdi-desktop-mac-dashboard",title:"Dashboard",id:"674d30a6-83d8-4876-9135-55791d7dfec9",widgetsDesktop:[],widgetsSmartphone:[]}]}],styles:t.styles,settings:t.settings,widgets:t.widgets}),r.name==="Configuration"){const s=me(((O=e.settings)==null?void 0:O.configTab)||A[0].id)+"Page";setTimeout(()=>{h.replace({name:s,params:r.params}).catch(i=>console.error(i))},500)}const n=N(ve.get("secureConfiguration")),y=m(()=>t.settings),c=m(()=>e.hasErrors),C=m({get(){var s;return(s=e.settings)==null?void 0:s.configExpertMode},set(s){e.set("settings.configExpertMode",s)}}),b=m({get(){var s;return(s=e.settings)==null?void 0:s.configTab},set(s){s&&e.set("settings.configTab",s)}}),a=window.open,Q=s=>window.location.href.endsWith("configuration")||window.location.href.endsWith("configuration/")?"/configuration/"+s:s,$=(s,i)=>(t.set("pageHeight",i-s),{"min-height":i-s+"px"}),E=()=>{t.set("drawerSidebar",!1),h.push({name:"home",params:P(M({},r.params),{tabId:t.getSelectedTabId})}).catch(()=>{})};return{hasErrors:c,settings:y,login:n,version:"3.1.0-alpha.2",configTab:b,expertMode:C,tabs:A,setPageContainer:$,to:Q,onOpen:a,onCancel:E,onSave:s=>{const i={devices:e.devices,widgets:W(e.widgets),layout:W(e.getLayoutWithoutDeletions)||[],styles:e.styles,settings:e.settings};for(const v in i.widgets)i.widgets[v].items=i.widgets[v].items||[],i.widgets[v].items=i.widgets[v].items.filter(l=>i.devices[l.deviceId]&&(!i.devices[l.deviceId].attributes||i.devices[l.deviceId].attributes&&i.devices[l.deviceId].attributes.deleted!==!0));i.layout.forEach(v=>{v.tabs=v.tabs||[],v.tabs.forEach(l=>{delete l.widgets,l.widgetsDesktop=l.widgetsDesktop||[],l.widgetsDesktop.forEach(d=>{d.items=d.items||[],d.items=d.items.filter(o=>i.widgets[o]&&i.widgets[o]._deleted!==!0)}),l.widgetsSmartphone=l.widgetsSmartphone||[],l.widgetsSmartphone.forEach(d=>{d.items=d.items||[],d.items=d.items.filter(o=>i.widgets[o]&&i.widgets[o]._deleted!==!0)})})}),i.devices=e.getDevicesWithoutDeletions,i.widgets=e.getWidgetsWithoutDeletions;const w={};JSON.stringify(t.widgets)!==JSON.stringify(i.widgets)&&(w.widgets=i.widgets),JSON.stringify(t.devices)!==JSON.stringify(i.devices)&&(w.devices=i.devices),JSON.stringify(t.layout)!==JSON.stringify(i.layout)&&(w.layout=i.layout),JSON.stringify(t.settings)!==JSON.stringify(i.settings)&&(w.settings=i.settings),JSON.stringify(t.styles)!==JSON.stringify(i.styles)&&(w.styles=i.styles),e.save(w),s?E():e.init(i)}}}}),Oe={key:1};function Te(e,t,r,h,n,y){const c=D("icon"),C=D("Login"),b=D("router-view");return p(),k(be,{view:"hHh lpR fFf"},{default:g(()=>[!e.settings.secureConfiguration||e.settings.secureConfiguration&&e.login?(p(),k(ke,{key:0},{default:g(()=>[u(I,null,{default:g(()=>[u(Z,null,{default:g(()=>[u(c,{name:"mdi-cog",vAlign:"middle"}),q(" "+H(e.$t("Configuration"))+" (v"+H(e.version)+") ",1)]),_:1}),u(T,{flat:"",dense:"",round:"",icon:e.expertMode?"mdi-code-tags-check":"mdi-code-tags","aria-label":"$t('Expert Mode')",onClick:t[0]||(t[0]=a=>e.expertMode=!e.expertMode)},{default:g(()=>[u(x,null,{default:g(()=>[q(H(e.$t("Expert Mode")),1)]),_:1})]),_:1},8,["icon"])]),_:1}),u(he,{modelValue:e.configTab,"onUpdate:modelValue":t[1]||(t[1]=a=>e.configTab=a),"inline-label":"",dense:"","outside-arrows":"","mobile-arrows":"",align:"left"},{default:g(()=>[(p(!0),J(R,null,ye(e.tabs,a=>(p(),J(R,null,[a.link?(p(),k(pe,{key:a.id,name:a.id,label:e.$t(a.title),icon:a.icon,onClick:Q=>e.onOpen(a.link,"_blank")},null,8,["name","label","icon","onClick"])):(p(),k(we,{key:a.id,name:a.id,label:e.$t(a.title),icon:a.icon,to:e.to(a.id)},null,8,["name","label","icon","to"]))],64))),256))]),_:1},8,["modelValue"])]),_:1})):V("",!0),u(Se,{class:"ConfigurationPage body"},{default:g(()=>[u(Ce,{"style-fn":e.setPageContainer},{default:g(()=>[e.settings.secureConfiguration!==void 0&&e.settings.secureConfiguration!==!1&&!e.login?(p(),k(C,{key:0,ns:"secureConfiguration",code:e.settings.secureConfiguration,onOnSuccess:t[2]||(t[2]=a=>e.login=!0)},null,8,["code"])):V("",!0),!e.settings.secureConfiguration||e.settings.secureConfiguration&&e.login?(p(),J("div",Oe,[u(b)])):V("",!0)]),_:1},8,["style-fn"])]),_:1}),!e.settings.secureConfiguration||e.settings.secureConfiguration&&e.login?(p(),k($e,{key:1},{default:g(()=>[u(I,null,{default:g(()=>[u(T,{flat:"",icon:"mdi-window-close","aria-label":"Cancel",label:e.$t("Cancel"),class:"text-red",onClick:e.onCancel},null,8,["label","onClick"]),u(Qe),u(T,{disable:e.hasErrors,icon:"mdi-content-save","aria-label":"Save",label:e.$t("Save"),flat:"",color:"primary",onClick:t[3]||(t[3]=a=>e.onSave(!1)),style:{"margin-right":"8px"}},null,8,["disable","label"]),u(T,{disable:e.hasErrors,icon:"mdi-content-save","aria-label":"Save & Exit",label:e.$t("Save")+" & "+e.$t("Exit"),color:"primary",onClick:t[4]||(t[4]=a=>e.onSave(!0))},null,8,["disable","label"])]),_:1})]),_:1})):V("",!0)]),_:1})}var Be=re(Ee,[["render",Te]]);export{Be as default};
