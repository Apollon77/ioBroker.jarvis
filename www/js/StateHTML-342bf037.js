import{bt as T,a4 as w,bM as H,Q as i,dc as b,eg as k,k as d,dj as S,dw as c,ao as C,aG as I,ay as u,W as v,b3 as f,bn as p,a2 as y,d3 as D,b1 as B,a1 as P,D as $,X as j,C as z}from"./index-e4fcd5f5.js";const K=w({name:"ModuleStateHTML",props:["widget","_containerSize"],setup(e){const m=H(),g=i(()=>e.widget.config);i(()=>({...b.joinConfig(g.value,k)}));const s=d(!1),a=d(null),o=d(),r=(t,Q,E,L)=>{if(s.value=!0,t)return a.value=t&&t.message||t,a.value;o.value=L},n=i(()=>{let t=o.value&&o.value.val||"";return t=!S.isPro()&&t.indexOf("<link")!==-1?t.replace(/(<link(.*)>)/g,""):t,t}),M=i(()=>S.isPro()&&n.value&&typeof n.value=="string"&&n.value.indexOf("<script")!==-1),l=e.widget.items&&e.widget.items[0]||{},_=c.get(l.deviceId);let h=[];return _?h=c.listen(_.id,l.primaryStateKey,r):(a.value=m.t("Device {deviceId} not found").replace("{deviceId}",l.deviceId),console.warn("StateHTML",a.value),s.value=!0),C(()=>c.unlisten(h)),{loaded:s,error:a,html:n,hasScript:M}}}),N={class:"jarvis-StateHTML StateHTML"},V=["innerHTML"],F=["srcdoc"];function O(e,m,g,s,a,o){const r=I("alert");return u(),v("div",N,[f(y(D,{indeterminate:""},null,512),[[p,!e.loaded&&!e.error]]),f(y(r,null,{default:B(()=>[P($(e.error),1)]),_:1},512),[[p,e.loaded&&e.error]]),f(j("div",null,[e.hasScript?(u(),v("iframe",{key:1,class:"StateHTML-iFrame",style:z({border:0,height:e._containerSize.height+"px"}),srcdoc:e.html},null,12,F)):(u(),v("div",{key:0,innerHTML:e.html},null,8,V))],512),[[p,e.loaded&&!e.error]])])}var U=T(K,[["render",O],["__scopeId","data-v-4be3016f"]]);export{U as default};
