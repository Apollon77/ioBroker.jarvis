import{bt as V,a4 as Y,dg as $,Q as k,d7 as b,dH as Q,k as _,aY as R,am as W,aq as G,aZ as Z,aG as q,ay as c,W as p,X as u,a2 as w,U as j,cM as C,V as m,D as y,a1 as X,cF as f,dI as J}from"./index-01ea8b75.js";var A={};Object.defineProperty(A,"__esModule",{value:!0});const z=90.8333,H=360/24,K=60*60*1e3;function x(e){return Math.ceil((e.getTime()-new Date(e.getFullYear(),0,1).getTime())/864e5)}function S(e){return Math.sin(e*2*Math.PI/360)}function L(e){return Math.acos(e)*360/(2*Math.PI)}function ee(e){return Math.asin(e)*360/(2*Math.PI)}function te(e){return Math.tan(e*2*Math.PI/360)}function O(e){return Math.cos(e*2*Math.PI/360)}function P(e,a){const s=e%a;return s<0?s+a:s}function F(e,a,s,n,l){const d=x(l),r=a/H,g=s?d+(6-r)/24:d+(18-r)/24,v=.9856*g-3.289,h=P(v+1.916*S(v)+.02*S(2*v)+282.634,360),D=.91764*te(h);let o;o=360/(2*Math.PI)*Math.atan(D),o=P(o,360);const I=Math.floor(h/90)*90,i=Math.floor(o/90)*90;o=o+(I-i),o/=H;const T=.39782*S(h),M=O(ee(T)),t=(O(n)-T*S(e))/(M*O(e)),N=(s?360-L(t):L(t))/H+o-.06571*g-6.622,B=P(N-a/H,24),U=Date.UTC(l.getFullYear(),l.getMonth(),l.getDate());return new Date(U+B*K)}function ae(e,a,s=new Date){return F(e,a,!0,z,s)}function se(e,a,s=new Date){return F(e,a,!1,z,s)}var ne=A.getSunrise=ae,oe=A.getSunset=se;const ie=Y({name:"ModuleDateTime",props:["widget","_containerSize","_widgetSize"],setup(e){const a=$(),s=k(()=>e.widget.config),n=k(()=>{const t=b.joinConfig(s.value,Q);return{...t,refresh:t.formatTime.indexOf("s")>-1?1:t.formatTime.indexOf("m")>-1?10:60}}),l=_(),d=_(),r=_(),g=_(),v=_(),h=k(()=>a.meta.city),D=k(()=>{const{latitude:t,longitude:E}=a.meta;return!t||!E?null:[t,E]}),o=()=>{if(n.value.sun!==!1&&D.value!==null)try{r.value=f(ne(...D.value),"HH:mm"),g.value=f(oe(...D.value),"HH:mm")}catch(t){console.warn("DateTime",t.message||t)}},I=()=>{try{const t=new Date;l.value=f(t,n.value.formatDate.replace(/(?:\r|\n|\r\n)/g,"'<br />'")),d.value=f(t,n.value.formatTime.replace(/(?:\r|\n|\r\n)/g,"'<br />'")),v.value=J(t)}catch(t){console.log(t.message||t),l.value=f(new Date,n.value._defaults.formatDate),d.value=f(new Date,n.value._defaults.formatTime)}};R(D,()=>o());let i=null;const T=()=>{n.value.refresh&&n.value.refresh>0&&(i&&clearInterval(i),i=setInterval(()=>{I(),o()},n.value.refresh*1e3))};W(()=>{!i&&T()}),G(()=>{i&&clearInterval(i),i=null});let M=null;return Z(()=>{e.widget.revision!==M&&(M=e.widget.revision,i&&clearInterval(i),T(),I())}),{moduleConfig:n,date:l,time:d,sunrise:r,sunset:g,week:v,city:h}}}),re={class:"jarvis-DateTime-Clock"},le=["innerHTML"],ce=["innerHTML"],ue={class:"row jarvis-DateTime-Details"},me={key:0,class:"jarvis-DateTime-Details-Item"},de={class:"jarvis-DateTime-Details-Item-City"},ve={key:1,class:"jarvis-DateTime-Details-Item"},De={class:"jarvis-DateTime-Details-Item-Sunrise"},fe={key:2,class:"jarvis-DateTime-Details-Item"},ge={class:"jarvis-DateTime-Details-Item-Sunset"},he={key:3,class:"jarvis-DateTime-Details-Item"},Te={class:"jarvis-DateTime-Details-Item-Week"};function _e(e,a,s,n,l,d){const r=q("icon");return c(),p("div",{key:e.widget.revision,class:"jarvis-DateTime-Container"},[u("div",re,[u("span",{class:"jarvis-DateTime-Clock-Date",innerHTML:e.date},null,8,le),u("span",{class:"jarvis-DateTime-Clock-Time",innerHTML:e.time},null,8,ce)]),u("div",ue,[e.moduleConfig.city!==!1?(c(),p("div",me,[w(r,{size:"xs",name:"mdi-city-variant-outline",class:"jarvis-DateTime-Details-Icon"}),e.city?m("",!0):(c(),j(C,{key:0,color:"primary"})),u("span",de,y(e.city),1)])):m("",!0),e.moduleConfig.sun!==!1?(c(),p("div",ve,[w(r,{size:"xs",name:"mdi-weather-sunset-up",class:"jarvis-DateTime-Details-Icon"}),e.sunrise?m("",!0):(c(),j(C,{key:0,color:"primary"})),u("span",De,y(e.sunrise),1)])):m("",!0),e.moduleConfig.sun!==!1?(c(),p("div",fe,[w(r,{size:"xs",name:"mdi-weather-sunset-down",class:"jarvis-DateTime-Details-Icon"}),e.sunset?m("",!0):(c(),j(C,{key:0,color:"primary"})),u("span",ge,y(e.sunset),1)])):m("",!0),e.moduleConfig.calendarweek!==!1?(c(),p("div",he,[w(r,{size:"xs",name:"mdi-calendar-week",class:"jarvis-DateTime-Details-Icon"}),e.week?m("",!0):(c(),j(C,{key:0,color:"primary"})),u("span",Te,[u("span",null,y(e.$t("CW")),1),X(" "+y(e.week),1)])])):m("",!0)])])}var Ie=V(ie,[["render",_e]]);export{Ie as default};
