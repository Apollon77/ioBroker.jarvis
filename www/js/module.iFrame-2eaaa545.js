import{c as p,am as b}from"./vendor.quasar-78ba37d9.js";import{d as v,r as w,o,a as h,b as n,v as r,h as f,i as F,j as y,t as k,e as S,f as z,g as _,y as s}from"./vendor.vue-1bbf3cb4.js";import{u as m}from"./stores-22cbae97.js";import{M as j}from"./modules-9c8c454f.js";import{D as c,L as x}from"./controllers-596cf83c.js";import{_ as I}from"./helpers-7b53fe93.js";var O={"iFrame#description":"Zeigt Inhalte anderer Seiten in einem iFrame an.","config#iFrame#url#label":"URL","config#iFrame#sandbox#label":"Sandbox aktiv","config#iFrame#sandbox#info":"Aktiviert bestimmte Sicherheitseinstellungen f\xFCr das iFrame","config#iFrame#sandboxOptions#label":"Sandbox Optionen","config#iFrame#keepalive#label":"Aufrechterhalten","config#iFrame#keepalive#info":"H\xE4lt das iFrame im Hintergrund ge\xF6ffnet, wenn der Tab / die Registerkarte nicht aktiv ist (true). Andernfalls wird das iFrame neu aufgebaut (false).","config#iFrame#interaction#label":"Interaktion erlauben","config#iFrame#interaction#info":"Interaktion mit den Inhalten des iFrames erlauben","config#iFrame#refresh#label":"Aktualisierungsintervall","config#iFrame#refresh#info":"Intervall (in Sekunden) nach dem das iFrame aktualisiert wird. Der Wert 0 deaktiviert die Aktualisierung (empfohlen bei statischen Inhalten)."},N=Object.freeze(Object.defineProperty({__proto__:null,default:O},Symbol.toStringTag,{value:"Module"})),T={"iFrame#description":"Displays contents from another website as iFrame.","config#iFrame#url#label":"URL","config#iFrame#sandbox#label":"Enable Sandbox","config#iFrame#sandbox#info":"The sandbox attribute enables an extra set of restrictions for the content in the iframe","config#iFrame#sandboxOptions#label":"Sandbox options","config#iFrame#keepalive#label":"Keep Alive","config#iFrame#keepalive#info":"Whether to keep iFrame opened in the background when the tab is not active (true). Otherwise the iFrame will be re-rendered (false).","config#iFrame#interaction#label":"Allow Interaction","config#iFrame#interaction#info":"Allow Interaction with the iFrame","config#iFrame#refresh#label":"Refresh Interval","config#iFrame#refresh#info":"Interval (in seconds) the iFrame will be refreshed. The value 0 turns this off (recommended with static contents)."},K=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"})),A={"iFrame#description":"\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0430\u0435\u0442 \u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\u043E\u0435 \u0434\u0440\u0443\u0433\u043E\u0433\u043E \u0441\u0430\u0439\u0442\u0430 \u043A\u0430\u043A iFrame","config#iFrame#url#label":"URL","config#iFrame#sandbox#label":"\u0412\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u043F\u0435\u0441\u043E\u0447\u043D\u0438\u0446\u0443","config#iFrame#sandbox#info":"\u0410\u0442\u0440\u0438\u0431\u0443\u0442\u044B \u043F\u0435\u0441\u043E\u0447\u043D\u0438\u0446\u044B \u0432\u043A\u043B\u044E\u0447\u0430\u044E\u0442 \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439 \u043D\u0430\u0431\u043E\u0440 \u043E\u0433\u0440\u0430\u043D\u0438\u0447\u0435\u043D\u0438\u0439 \u0434\u043B\u044F \u043A\u043E\u043D\u0442\u0435\u043D\u0442\u0430 \u0444\u0440\u0435\u0439\u043C\u0430","config#iFrame#sandboxOptions#label":"\u041E\u043F\u0446\u0438\u0438 \u043F\u0435\u0441\u043E\u0447\u043D\u0438\u0446\u044B","config#iFrame#keepalive#label":"\u041F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044C \u0441\u043E\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u0435","config#iFrame#keepalive#info":"\u0421\u043E\u0445\u0440\u0430\u043D\u044F\u0442\u044C \u0444\u0440\u0435\u0439\u043C \u043E\u0442\u043A\u0440\u044B\u0442\u044B\u043C \u0432 \u0444\u043E\u043D\u0435 \u0435\u0441\u043B\u0438 \u0432\u043A\u043B\u0430\u0434\u043A\u0430 \u043D\u0435 \u0430\u043A\u0442\u0438\u0432\u043D\u0430 (true). \u0412 \u043F\u0440\u043E\u0442\u0438\u0432\u043D\u043E\u043C \u0441\u043B\u0443\u0447\u0430\u0435 \u0444\u0440\u0435\u0439\u043C \u0431\u0443\u0434\u0435\u0442 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D (false).","config#iFrame#interaction#label":"","config#iFrame#interaction#info":"","config#iFrame#refresh#label":"\u0418\u043D\u0442\u0435\u0440\u0432\u0430\u043B \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F","config#iFrame#refresh#info":"\u0418\u043D\u0442\u0435\u0440\u0432\u0430\u043B \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0444\u0440\u0435\u0439\u043C\u0430 \u0432 \u0441\u0435\u043A\u0443\u043D\u0434\u0430\u0445. \u0417\u043D\u0430\u0447\u0435\u043D\u0438\u0435 0 \u043E\u0442\u043A\u043B\u044E\u0447\u0430\u0435\u0442 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 (\u0440\u0435\u043A\u0443\u043C\u0435\u043D\u0434\u0443\u0435\u0442\u0441\u044F \u0434\u043B\u044F \u0441\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043A\u043E\u0433\u043E \u043A\u043E\u043D\u0442\u0435\u043D\u0442\u0430"},H=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));const P={addGroup:!1,addDivider:!1,addDevice:{max:1,fields:["primaryStateKey"]}};var u=[{columns:12,parameter:"url",label:"config#iFrame#url#label",placeholder:"http://"},{columns:2,parameter:"keepalive",label:"config#iFrame#keepalive#label",info:"config#iFrame#keepalive#info",type:"Switch",value:!1},{columns:2,parameter:"interaction",label:"config#iFrame#interaction#label",info:"config#iFrame#interaction#info",type:"Switch",value:!0},{columns:2,parameter:"refresh",label:"config#iFrame#refresh#label",info:"config#iFrame#refresh#info",type:"Number",value:0,min:0},{columns:2,parameter:"sandbox",label:"config#iFrame#sandbox#label",info:"config#iFrame#sandbox#info",type:"Switch",value:!0},{columns:12,parameter:"sandboxOptions",label:"config#iFrame#sandboxOptions#label",type:"Select",multiple:!0,options:[{value:"allow-downloads",label:"Allows downloads"},{value:"allow-forms",label:"Allows form submission"},{value:"allow-modals",label:"Allows to open modal windows"},{value:"allow-orientation-lock",label:"Allows to lock the screen orientation"},{value:"allow-pointer-lock",label:"Allows to use the Pointer Lock API"},{value:"allow-popups",label:"Allows popups"},{value:"allow-popups-to-escape-sandbox",label:"Allows popups to open new windows without inheriting the sandboxing"},{value:"allow-presentation",label:"Allows to start a presentation session"},{value:"allow-same-origin",label:"Allows the iframe content to be treated as being from the same origin"},{value:"allow-scripts",label:"Allows to run scripts"},{value:"allow-top-navigation",label:"Allows the iframe content to navigate its top-level browsing context"},{value:"allow-top-navigation-by-user-activation",label:"Allows the iframe content to navigate its top-level browsing context, but only if initiated by user"}],value:["allow-forms","allow-modals","allow-popups","allow-same-origin","allow-scripts","allow-top-navigation"],dependencies:{sandbox:!0}}],Q=Object.freeze(Object.defineProperty({__proto__:null,Settings:P,default:u},Symbol.toStringTag,{value:"Module"}));const R=v({name:"ModuleiFrame",props:["tab","widget","_containerSize","_widgetSize"],data(){return this.adjustPositionTimer=null,{size:{width:this._widgetSize.width||this._containerSize.width,height:this._containerSize.height},url:null,loaded:!1,error:!1}},computed:{config(){return j.joinConfig(this.widget.config,u)},deviceConfig(){return this.widget.items&&this.widget.items[0]||{}},sandbox(){return this.config.sandbox!==!0?void 0:this.config.sandboxOptions.join(" ")}},methods:{gotState(e,i,t,a){e||(this.url!==a.val&&this.setUrl(a.val||""),this.loaded=!0)},runInterval(){this.config.refresh&&this.config.refresh>0&&(this.setRefreshInterval=setInterval(()=>{this.url!==null&&this.setUrl(this.url+" ")},this.config.refresh*1e3))},setUrl(e){const i=m();e.indexOf("{")>-1&&e.indexOf("}")>-1&&Object.keys(i.settings).forEach(t=>{e=e.replace(RegExp("{"+t+"}","g"),i.settings[t])}),this.url=e},onViewChange(e){if(this.config.keepalive){const i=this.$refs.iFrame;i?this.tab&&this.tab.id===e?(i.style.zIndex=9,i.style.visibility="visible",this.adjustPosition(i)):(i.style.zIndex=-1,i.style.visibility="hidden"):setTimeout(()=>this.onViewChange(e),500)}},onResize(){if(this.config.keepalive){const e=this.$refs.iFrame;this.adjustPosition(e)}},moveiFrame(){if(this.config.keepalive){const e=this.$refs.iFrame;e&&this.size.width>0&&this.size.height>0?(this.adjustPosition(e),document.querySelector("#iframes").append(e)):setTimeout(()=>this.moveiFrame(),500)}},adjustPosition(e){const i=this.$refs.iFrameContainer;i?(clearTimeout(this.adjustPositionTimer),this.adjustPositionTimer=setTimeout(()=>{const{top:t,left:a}=i.getBoundingClientRect(),l=window.pageYOffset||document.documentElement.scrollTop,d=window.pageXOffset||document.documentElement.scrollLeft;t&&a&&(e.style.zIndex=9,e.style.visibility="visible",e.style.top=t+l+"px",e.style.left=a+d+"px",e.style.position="absolute"),setTimeout(()=>{this.adjustPosition(e)},500)},50)):setTimeout(()=>this.adjustPosition(e),500)}},watch:{_widgetSize(e){this.size.width=e.width>0?e.width:this.size.width},_containerSize(e){this.size.width=this.size.width||e.width,this.size.height=e.height>0?e.height:this.size.height;const i=m();this.onViewChange(i.selectedTabId)},deviceConfig:{immediate:!0,handler:function(e){this.config.url?(this.setUrl(this.config.url),this.loaded=!0):(this.device=c.get(e.deviceId),this.device?c.listen(this.device.id,e.primaryStateKey,this.gotState):(this.error="iFrame: "+this.$i18n.t("Device {deviceId} not found").replace("{deviceId}",e.deviceId),x.warn(this.error),this.loaded=!0))}}},mounted(){this.runInterval(),this.moveiFrame()},beforeUnmount(){this.config.keepalive&&this.$refs.iFrame.remove(),this.setRefreshInterval&&clearInterval(this.setRefreshInterval),this.adjustPositionTimer&&clearInterval(this.adjustPositionTimer),this.device&&this.config.url}}),C=["src","title","sandbox","width","height"];function $(e,i,t,a,l,d){const g=w("alert");return o(),h("div",{key:e.widget.revision,class:"jarvis-iFrame-Container",style:s({width:e.size.width+"px",height:e.size.height+"px"})},[n(f(p,{indeterminate:""},null,512),[[r,!e.loaded&&!e.error]]),n(f(g,null,{default:F(()=>[y(k(e.error),1)]),_:1},512),[[r,e.loaded&&e.error]]),S("div",{ref:"iFrameContainer",style:s({width:e.size.width+"px",height:e.size.height+"px"})},[e.config.keepalive===!0?(o(),z(b,{key:0,onResize:e.onResize},null,8,["onResize"])):_("",!0),n((o(),h("iframe",{ref:"iFrame",key:e.widget.id,class:"jarvis-iFrame iFrame",src:e.url,style:s({"pointer-events":e.config.interaction?"auto":"none",width:e.size.width+"px",height:e.size.height+"px"}),title:e.widget.title,sandbox:e.sandbox,width:e.size.width,height:e.size.height},null,12,C)),[[r,e.loaded&&!e.error]])],4)],4)}var D=I(R,[["render",$]]),W=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));export{N as _,K as a,H as b,Q as c,W as i};
