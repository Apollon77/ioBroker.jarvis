import{bt as U,a4 as V,bN as Y,Q as k,da as $,dL as Q,k as y,aY as R,am as W,aq as G,aZ as Z,aG as q,ay as r,W as d,X as v,V as c,a2 as w,U as j,cP as C,D as p,a1 as X,cH as g,dM as J}from"./index-11c4bfce.js";var O={};Object.defineProperty(O,"__esModule",{value:!0});const N=90.8333,H=360/24,K=60*60*1e3;function x(e){return Math.ceil((e.getTime()-new Date(e.getFullYear(),0,1).getTime())/864e5)}function S(e){return Math.sin(e*2*Math.PI/360)}function A(e){return Math.acos(e)*360/(2*Math.PI)}function ee(e){return Math.asin(e)*360/(2*Math.PI)}function te(e){return Math.tan(e*2*Math.PI/360)}function P(e){return Math.cos(e*2*Math.PI/360)}function L(e,s){const n=e%s;return n<0?n+s:n}function z(e,s,n,a,u){const m=x(u),l=s/H,T=n?m+(6-l)/24:m+(18-l)/24,f=.9856*T-3.289,h=L(f+1.916*S(f)+.02*S(2*f)+282.634,360),D=.91764*te(h);let o;o=360/(2*Math.PI)*Math.atan(D),o=L(o,360);const M=Math.floor(h/90)*90,i=Math.floor(o/90)*90;o=o+(M-i),o/=H;const _=.39782*S(h),I=P(ee(_)),t=(P(a)-_*S(e))/(I*P(e)),b=(n?360-A(t):A(t))/H+o-.06571*T-6.622,B=L(b-s/H,24),F=Date.UTC(u.getFullYear(),u.getMonth(),u.getDate());return new Date(F+B*K)}function ae(e,s,n=new Date){return z(e,s,!0,N,n)}function se(e,s,n=new Date){return z(e,s,!1,N,n)}var ne=O.getSunrise=ae,oe=O.getSunset=se;const ie=V({name:"ModuleDateTime",props:["widget","_containerSize","_widgetSize"],setup(e){const s=Y(),n=k(()=>e.widget.config),a=k(()=>{const t=$.joinConfig(n.value,Q);return{...t,refresh:t.formatTime.indexOf("s")>-1?1:t.formatTime.indexOf("m")>-1?10:60}}),u=y(null),m=y(null),l=y(null),T=y(null),f=y(null),h=k(()=>s.meta.city),D=k(()=>{const{latitude:t,longitude:E}=s.meta;return!t||!E?null:[t,E]}),o=()=>{if(a.value.sun!==!1&&D.value!==null)try{l.value=g(ne(...D.value),"HH:mm"),T.value=g(oe(...D.value),"HH:mm")}catch(t){console.warn("DateTime",t.message||t)}},M=()=>{try{const t=new Date;u.value=a.value.formatDate?g(t,a.value.formatDate.replace(/(?:\r|\n|\r\n)/g,"'<br />'")):null,m.value=a.value.formatTime?g(t,a.value.formatTime.replace(/(?:\r|\n|\r\n)/g,"'<br />'")):null,f.value=J(t)}catch(t){console.log(t.message||t),u.value=a.value._defaults.formatDate?g(new Date,a.value._defaults.formatDate):null,m.value=a.value._defaults.formatTime?g(new Date,a.value._defaults.formatTime):null}};R(D,()=>o());let i=null;const _=()=>{a.value.refresh&&a.value.refresh>0&&(i&&clearInterval(i),i=setInterval(()=>{M(),o()},a.value.refresh*1e3))};W(()=>{!i&&_()}),G(()=>{i&&clearInterval(i),i=null});let I=null;return Z(()=>{e.widget.revision!==I&&(I=e.widget.revision,i&&clearInterval(i),_(),M())}),{moduleConfig:a,date:u,time:m,sunrise:l,sunset:T,week:f,city:h}}}),re={class:"jarvis-DateTime-Clock"},le=["innerHTML"],ce=["innerHTML"],ue={class:"row jarvis-DateTime-Details"},me={key:0,class:"jarvis-DateTime-Details-Item"},de={class:"jarvis-DateTime-Details-Item-City"},ve={key:1,class:"jarvis-DateTime-Details-Item"},fe={class:"jarvis-DateTime-Details-Item-Sunrise"},De={key:2,class:"jarvis-DateTime-Details-Item"},ge={class:"jarvis-DateTime-Details-Item-Sunset"},Te={key:3,class:"jarvis-DateTime-Details-Item"},he={class:"jarvis-DateTime-Details-Item-Week"};function _e(e,s,n,a,u,m){const l=q("icon");return r(),d("div",{key:e.widget.revision,class:"jarvis-DateTime-Container"},[v("div",re,[e.date?(r(),d("span",{key:0,class:"jarvis-DateTime-Clock-Date",innerHTML:e.date},null,8,le)):c("",!0),e.time?(r(),d("span",{key:1,class:"jarvis-DateTime-Clock-Time",innerHTML:e.time},null,8,ce)):c("",!0)]),v("div",ue,[e.moduleConfig.city!==!1?(r(),d("div",me,[w(l,{size:"xs",name:"mdi-city-variant-outline",class:"jarvis-DateTime-Details-Icon"}),e.city?c("",!0):(r(),j(C,{key:0,color:"primary"})),v("span",de,p(e.city),1)])):c("",!0),e.moduleConfig.sun!==!1?(r(),d("div",ve,[w(l,{size:"xs",name:"mdi-weather-sunset-up",class:"jarvis-DateTime-Details-Icon"}),e.sunrise?c("",!0):(r(),j(C,{key:0,color:"primary"})),v("span",fe,p(e.sunrise),1)])):c("",!0),e.moduleConfig.sun!==!1?(r(),d("div",De,[w(l,{size:"xs",name:"mdi-weather-sunset-down",class:"jarvis-DateTime-Details-Icon"}),e.sunset?c("",!0):(r(),j(C,{key:0,color:"primary"})),v("span",ge,p(e.sunset),1)])):c("",!0),e.moduleConfig.calendarweek!==!1?(r(),d("div",Te,[w(l,{size:"xs",name:"mdi-calendar-week",class:"jarvis-DateTime-Details-Icon"}),e.week?c("",!0):(r(),j(C,{key:0,color:"primary"})),v("span",he,[v("span",null,p(e.$t("CW")),1),X(" "+p(e.week),1)])])):c("",!0)])])}var Me=U(ie,[["render",_e]]);export{Me as default};
