import{bt as U,a4 as V,bN as Y,Q as k,da as $,dL as Q,k as _,aY as R,am as W,aq as G,aZ as Z,aG as q,ay as c,W as p,X as u,a2 as w,U as j,cP as C,V as m,D as y,a1 as X,cH as f,dM as J}from"./index-2f9ee6b2.js";var O={};Object.defineProperty(O,"__esModule",{value:!0});const N=90.8333,H=360/24,K=60*60*1e3;function x(e){return Math.ceil((e.getTime()-new Date(e.getFullYear(),0,1).getTime())/864e5)}function S(e){return Math.sin(e*2*Math.PI/360)}function A(e){return Math.acos(e)*360/(2*Math.PI)}function ee(e){return Math.asin(e)*360/(2*Math.PI)}function te(e){return Math.tan(e*2*Math.PI/360)}function P(e){return Math.cos(e*2*Math.PI/360)}function L(e,a){const s=e%a;return s<0?s+a:s}function z(e,a,s,n,l){const d=x(l),r=a/H,g=s?d+(6-r)/24:d+(18-r)/24,v=.9856*g-3.289,h=L(v+1.916*S(v)+.02*S(2*v)+282.634,360),D=.91764*te(h);let o;o=360/(2*Math.PI)*Math.atan(D),o=L(o,360);const M=Math.floor(h/90)*90,i=Math.floor(o/90)*90;o=o+(M-i),o/=H;const T=.39782*S(h),I=P(ee(T)),t=(P(n)-T*S(e))/(I*P(e)),b=(s?360-A(t):A(t))/H+o-.06571*g-6.622,B=L(b-a/H,24),F=Date.UTC(l.getFullYear(),l.getMonth(),l.getDate());return new Date(F+B*K)}function ae(e,a,s=new Date){return z(e,a,!0,N,s)}function se(e,a,s=new Date){return z(e,a,!1,N,s)}var ne=O.getSunrise=ae,oe=O.getSunset=se;const ie=V({name:"ModuleDateTime",props:["widget","_containerSize","_widgetSize"],setup(e){const a=Y(),s=k(()=>e.widget.config),n=k(()=>{const t=$.joinConfig(s.value,Q);return{...t,refresh:t.formatTime.indexOf("s")>-1?1:t.formatTime.indexOf("m")>-1?10:60}}),l=_(),d=_(),r=_(),g=_(),v=_(),h=k(()=>a.meta.city),D=k(()=>{const{latitude:t,longitude:E}=a.meta;return!t||!E?null:[t,E]}),o=()=>{if(n.value.sun!==!1&&D.value!==null)try{r.value=f(ne(...D.value),"HH:mm"),g.value=f(oe(...D.value),"HH:mm")}catch(t){console.warn("DateTime",t.message||t)}},M=()=>{try{const t=new Date;l.value=f(t,n.value.formatDate.replace(/(?:\r|\n|\r\n)/g,"'<br />'")),d.value=f(t,n.value.formatTime.replace(/(?:\r|\n|\r\n)/g,"'<br />'")),v.value=J(t)}catch(t){console.log(t.message||t),l.value=f(new Date,n.value._defaults.formatDate),d.value=f(new Date,n.value._defaults.formatTime)}};R(D,()=>o());let i=null;const T=()=>{n.value.refresh&&n.value.refresh>0&&(i&&clearInterval(i),i=setInterval(()=>{M(),o()},n.value.refresh*1e3))};W(()=>{!i&&T()}),G(()=>{i&&clearInterval(i),i=null});let I=null;return Z(()=>{e.widget.revision!==I&&(I=e.widget.revision,i&&clearInterval(i),T(),M())}),{moduleConfig:n,date:l,time:d,sunrise:r,sunset:g,week:v,city:h}}}),re={class:"jarvis-DateTime-Clock"},le=["innerHTML"],ce=["innerHTML"],ue={class:"row jarvis-DateTime-Details"},me={key:0,class:"jarvis-DateTime-Details-Item"},de={class:"jarvis-DateTime-Details-Item-City"},ve={key:1,class:"jarvis-DateTime-Details-Item"},De={class:"jarvis-DateTime-Details-Item-Sunrise"},fe={key:2,class:"jarvis-DateTime-Details-Item"},ge={class:"jarvis-DateTime-Details-Item-Sunset"},he={key:3,class:"jarvis-DateTime-Details-Item"},Te={class:"jarvis-DateTime-Details-Item-Week"};function _e(e,a,s,n,l,d){const r=q("icon");return c(),p("div",{key:e.widget.revision,class:"jarvis-DateTime-Container"},[u("div",re,[u("span",{class:"jarvis-DateTime-Clock-Date",innerHTML:e.date},null,8,le),u("span",{class:"jarvis-DateTime-Clock-Time",innerHTML:e.time},null,8,ce)]),u("div",ue,[e.moduleConfig.city!==!1?(c(),p("div",me,[w(r,{size:"xs",name:"mdi-city-variant-outline",class:"jarvis-DateTime-Details-Icon"}),e.city?m("",!0):(c(),j(C,{key:0,color:"primary"})),u("span",de,y(e.city),1)])):m("",!0),e.moduleConfig.sun!==!1?(c(),p("div",ve,[w(r,{size:"xs",name:"mdi-weather-sunset-up",class:"jarvis-DateTime-Details-Icon"}),e.sunrise?m("",!0):(c(),j(C,{key:0,color:"primary"})),u("span",De,y(e.sunrise),1)])):m("",!0),e.moduleConfig.sun!==!1?(c(),p("div",fe,[w(r,{size:"xs",name:"mdi-weather-sunset-down",class:"jarvis-DateTime-Details-Icon"}),e.sunset?m("",!0):(c(),j(C,{key:0,color:"primary"})),u("span",ge,y(e.sunset),1)])):m("",!0),e.moduleConfig.calendarweek!==!1?(c(),p("div",he,[w(r,{size:"xs",name:"mdi-calendar-week",class:"jarvis-DateTime-Details-Icon"}),e.week?m("",!0):(c(),j(C,{key:0,color:"primary"})),u("span",Te,[u("span",null,y(e.$t("CW")),1),X(" "+y(e.week),1)])])):m("",!0)])])}var Me=U(ie,[["render",_e]]);export{Me as default};
