import{_ as b,q as R,dg as V,c as y,a2 as h,x as Y,b6 as Q,y as W,j as q,o as T,d as _,e as l,k as c,J as j,a1 as k,t as p,g as C,i as G,cM as H,d7 as J,dH as Z,cF as D,dI as K}from"./index-80522cd8.js";var z={};Object.defineProperty(z,"__esModule",{value:!0});const F=90.8333,S=360/24,X=60*60*1e3;function x(e){return Math.ceil((e.getTime()-new Date(e.getFullYear(),0,1).getTime())/864e5)}function E(e){return Math.sin(e*2*Math.PI/360)}function A(e){return Math.acos(e)*360/(2*Math.PI)}function ee(e){return Math.asin(e)*360/(2*Math.PI)}function te(e){return Math.tan(e*2*Math.PI/360)}function P(e){return Math.cos(e*2*Math.PI/360)}function L(e,s){const a=e%s;return a<0?a+s:a}function N(e,s,a,n,r){const u=x(r),i=s/S,f=a?u+(6-i)/24:u+(18-i)/24,d=.9856*f-3.289,g=L(d+1.916*E(d)+.02*E(2*d)+282.634,360),v=.91764*te(g);let o;o=360/(2*Math.PI)*Math.atan(v),o=L(o,360);const M=Math.floor(g/90)*90,m=Math.floor(o/90)*90;o=o+(M-m),o/=S;const I=.39782*E(g),w=P(ee(I)),t=(P(n)-I*E(e))/(w*P(e)),B=(a?360-A(t):A(t))/S+o-.06571*f-6.622,U=L(B-s/S,24),$=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate());return new Date($+U*X)}function se(e,s,a=new Date){return N(e,s,!0,F,a)}function ae(e,s,a=new Date){return N(e,s,!1,F,a)}var ne=z.getSunrise=se,oe=z.getSunset=ae;const ie=R({name:"ModuleDateTime",props:["widget","_containerSize","_widgetSize"],setup(e){const s=V(),a=y(()=>e.widget.config),n=y(()=>{const t=J.joinConfig(a.value,Z);return{...t,refresh:t.formatTime.indexOf("s")>-1?1:t.formatTime.indexOf("m")>-1?10:60}}),r=h(),u=h(),i=h(),f=h(),d=h(),g=y(()=>s.meta.city),v=y(()=>{const{latitude:t,longitude:O}=s.meta;return!t||!O?null:[t,O]}),o=()=>{if(n.value.sun!==!1&&v.value!==null)try{i.value=D(ne(...v.value),"HH:mm"),f.value=D(oe(...v.value),"HH:mm")}catch(t){console.warn("DateTime",t.message||t)}},M=()=>{try{const t=new Date;r.value=D(t,n.value.formatDate.replace(/(?:\r|\n|\r\n)/g,"'<br />'")),u.value=D(t,n.value.formatTime.replace(/(?:\r|\n|\r\n)/g,"'<br />'")),d.value=K(t)}catch(t){console.log(t.message||t),r.value=D(new Date,n.value._defaults.formatDate),u.value=D(new Date,n.value._defaults.formatTime)}};Y(v,()=>o());let m=null;const I=()=>{n.value.refresh&&n.value.refresh>0&&(m=setInterval(()=>{M(),o()},n.value.refresh*1e3))};Q(()=>m&&clearInterval(m));let w=null;return W(()=>{e.widget.revision!==w&&(w=e.widget.revision,m&&clearInterval(m),I(),M())}),{moduleConfig:n,date:r,time:u,sunrise:i,sunset:f,week:d,city:g}}}),re={class:"jarvis-DateTime-Clock"},le=["innerHTML"],ce=["innerHTML"],ue={class:"row jarvis-DateTime-Details"},me={key:0,class:"jarvis-DateTime-Details-Item"},de={class:"jarvis-DateTime-Details-Item-City"},ve={key:1,class:"jarvis-DateTime-Details-Item"},De={class:"jarvis-DateTime-Details-Item-Sunrise"},fe={key:2,class:"jarvis-DateTime-Details-Item"},ge={class:"jarvis-DateTime-Details-Item-Sunset"},he={key:3,class:"jarvis-DateTime-Details-Item"},Te={class:"jarvis-DateTime-Details-Item-Week"};function _e(e,s,a,n,r,u){const i=q("icon");return T(),_("div",{key:e.widget.revision,class:"jarvis-DateTime-Container"},[l("div",re,[l("span",{class:"jarvis-DateTime-Clock-Date",innerHTML:e.date},null,8,le),l("span",{class:"jarvis-DateTime-Clock-Time",innerHTML:e.time},null,8,ce)]),l("div",ue,[e.moduleConfig.city!==!1?(T(),_("div",me,[c(i,{size:"xs",name:"mdi-city-variant-outline",class:"jarvis-DateTime-Details-Icon"}),j(c(H,{color:"primary"},null,512),[[k,!e.city]]),l("span",de,p(e.city),1)])):C("",!0),e.moduleConfig.sun!==!1?(T(),_("div",ve,[c(i,{size:"xs",name:"mdi-weather-sunset-up",class:"jarvis-DateTime-Details-Icon"}),j(c(H,{color:"primary"},null,512),[[k,!e.sunrise]]),l("span",De,p(e.sunrise),1)])):C("",!0),e.moduleConfig.sun!==!1?(T(),_("div",fe,[c(i,{size:"xs",name:"mdi-weather-sunset-down",class:"jarvis-DateTime-Details-Icon"}),j(c(H,{color:"primary"},null,512),[[k,!e.sunset]]),l("span",ge,p(e.sunset),1)])):C("",!0),e.moduleConfig.calendarweek!==!1?(T(),_("div",he,[c(i,{size:"xs",name:"mdi-calendar-week",class:"jarvis-DateTime-Details-Icon"}),j(c(H,{color:"primary"},null,512),[[k,!e.week]]),l("span",Te,[l("span",null,p(e.$t("CW")),1),G(" "+p(e.week),1)])])):C("",!0)])])}var Ie=b(ie,[["render",_e]]);export{Ie as default};
