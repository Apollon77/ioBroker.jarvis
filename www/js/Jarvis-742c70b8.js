import{a4 as K,bw as W,Q as h,dp as et,dq as Q,bt as Y,aG as F,ay as S,U as E,b1 as k,a2 as g,bS as Se,bT as ie,X as U,D as Z,bD as Pe,bB as L,bU as oe,bV as Le,A as H,bW as tt,af as nt,cB as he,cC as st,a9 as it,ck as ot,ac as $e,bx as at,co as ee,k as B,bQ as ue,cK as fe,cq as M,b3 as A,bn as O,aF as De,dr as lt,dk as rt,aY as ne,r as Ae,cS as dt,cG as Oe,V as z,W as R,I as G,aE as ae,C as N,bF as ct,bG as ze,bH as pe,a1 as ye,cu as ut,ds as ft,cs as Fe,u as pt,df as gt,dt as mt,bO as vt,aI as ht,bM as bt,cr as yt,dj as We,di as Ne,bp as wt,ct as qe,du as St,d8 as kt,dv as we,as as Ct,d3 as Tt,dw as be,dx as $t}from"./index-1747645b.js";import Dt from"./StateList-33344130.js";import{b as Et,c as jt,Q as It,a as Rt}from"./QFooter-29ecddaa.js";import{Q as Bt}from"./QHeader-3342203d.js";import{Q as Mt}from"./QBtnDropdown-1740b7ba.js";import{Q as Ht}from"./QBadge-e0983cbe.js";import{m as Pt}from"./marked.esm-fcfdccc1.js";import"./StateListGroup-e0e19432.js";import"./StateListItem-820c0c87.js";var Lt=`
body {
	scrollbar-width: none;
	-ms-overflow-style: none;
	overflow-y: scroll;
}

body::-webkit-scrollbar {
	width: 0px;
	background: transparent;
}`,At=`
@media (max-width: $breakpoint-md-min) {
	.container.desktop {
		padding: 0;
		/*grid-template-columns: none !important;*/
		grid-template-rows: none !important;
	}
	
	.container.desktop .widget-scaler {
		transform: none !important;
	}
}

/*
 * TWO COLUMNS
 */
@media (min-width: $breakpoint-sm-min) and (max-width: $breakpoint-md-min) {
	.container.desktop > .box:nth-child(odd) {
		grid-area: auto / auto / auto / auto !important;
		grid-column: 1 / span 6 !important;
	}
	
	.container.desktop > .box:nth-child(even) {
		grid-area: auto / auto / auto / auto !important;
		grid-column: 7 / span 6 !important;
	}
}

/*
 * ONE COLUMN
 */
@media (min-width: 0) and (max-width: $breakpoint-sm-min) {
	.container.desktop > .box {
		grid-area: auto / auto / auto / auto !important;
		grid-column: 1 / span 12 !important;
	}
}
`;const Ot=K({name:"DeviceDetailsPopup",components:{StateList:Dt},setup(){const e=W(),t=h(()=>e.selectedDevice),s=h(()=>{const a=[];for(const i in t.value.states){const l=t.value.states[i];if(l.hide===!0||l.state===void 0&&l.action===void 0)continue;const{label:n,...r}=l;a.push({id:et(t.value.id+":"+i,Q.get("UUID")),type:"device",deviceId:t.value.id,bodyStateKey:i,primaryStateKey:i,...r,deviceStateDetails:!0})}return{items:a}});return{onClose:()=>e.set("selectedDeviceId",null),device:t,widget:s}}}),zt={class:"text-h6"};function Ft(e,t,s,o,a,i){const l=F("state-list");return S(),E(tt,{"model-value":!!e.device.id,onHide:e.onClose,class:H({"jarvis-popup-container":!0,["jarvis-device-"+e.device.id]:!0})},{default:k(()=>[g(Se,{class:"column jarvis-popup",style:{width:"800px","max-width":"95vw","flex-wrap":"nowrap"}},{default:k(()=>[g(ie,{class:"row items-center"},{default:k(()=>[U("div",zt,Z(e.device.label||e.device.name),1),g(Pe),g(L,{flat:"",round:"",color:"grey",icon:"close",onClick:e.onClose},null,8,["onClick"])]),_:1}),g(oe),g(ie,{class:"col q-pa-none scroll body",style:{"overflow-x":"hidden"}},{default:k(()=>[g(l,{openDeviceDetails:!1,widget:e.widget,isPopup:""},null,8,["widget"])]),_:1}),g(oe),g(Le,{align:"right"},{default:k(()=>[g(L,{flat:"",label:e.$t("Close"),onClick:e.onClose,color:"primary"},null,8,["label","onClick"])]),_:1})]),_:1})]),_:1},8,["model-value","onHide","class"])}var Wt=Y(Ot,[["render",Ft]]);const Nt={position:{type:String,default:"bottom-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(e)},offset:{type:Array,validator:e=>e.length===2},expand:Boolean};function qt(){const{props:e,proxy:{$q:t}}=it(),s=nt(st,he);if(s===he)return console.error("QPageSticky needs to be child of QLayout"),he;const o=h(()=>{const u=e.position;return{top:u.indexOf("top")>-1,right:u.indexOf("right")>-1,bottom:u.indexOf("bottom")>-1,left:u.indexOf("left")>-1,vertical:u==="top"||u==="bottom",horizontal:u==="left"||u==="right"}}),a=h(()=>s.header.offset),i=h(()=>s.right.offset),l=h(()=>s.footer.offset),n=h(()=>s.left.offset),r=h(()=>{let u=0,v=0;const m=o.value,f=t.lang.rtl===!0?-1:1;m.top===!0&&a.value!==0?v=`${a.value}px`:m.bottom===!0&&l.value!==0&&(v=`${-l.value}px`),m.left===!0&&n.value!==0?u=`${f*n.value}px`:m.right===!0&&i.value!==0&&(u=`${-f*i.value}px`);const w={transform:`translate(${u}, ${v})`};return e.offset&&(w.margin=`${e.offset[1]}px ${e.offset[0]}px`),m.vertical===!0?(n.value!==0&&(w[t.lang.rtl===!0?"right":"left"]=`${n.value}px`),i.value!==0&&(w[t.lang.rtl===!0?"left":"right"]=`${i.value}px`)):m.horizontal===!0&&(a.value!==0&&(w.top=`${a.value}px`),l.value!==0&&(w.bottom=`${l.value}px`)),w}),d=h(()=>`q-page-sticky row flex-center fixed-${e.position} q-page-sticky--${e.expand===!0?"expand":"shrink"}`);function y(u){const v=ot(u.default);return $e("div",{class:d.value,style:r.value},e.expand===!0?v:[$e("div",v)])}return{$layout:s,getStickyContent:y}}var Vt=at({name:"QPageSticky",props:Nt,setup(e,{slots:t}){const{getStickyContent:s}=qt();return()=>s(t)}});function Qt(){const e=ee(),t=B(!1);return{jumperIsOpen:t,jumperOpen:(o,a={})=>{const i=ue(o);t.value=!0;const l=i.map(n=>new Promise(r=>{const d=y=>{n.icon=y.icon;const u=Iconify.getIcon(n.icon.indexOf(":")===-1?"mdi:"+n.icon:n.icon);if(u){const v=[],m=[];let f;const w=RegExp('(?<= (.+?)=\\")(.+?)(?=\\")',"g");for(;(f=w.exec(u.body))!==null;)if(f.index===w.lastIndex&&w.lastIndex++,f[1]==="d")v[v.length]=f[2];else{const C=m.length;m[C]=m[C]||[],m[C].push([f[1],f[2]])}n.icon=v.map((C,T)=>{const b=m[T].map(c=>c[0]+":"+c[1]);return C+"@@"+b.join("@@")}).join("&&")+"|"+u.left+" "+u.top+" "+u.width+" "+u.height}r(n)};return n.icon&&typeof n.icon=="object"?fe.getBindings({config:{icon:n.icon}},d):n.icon?d({icon:n.icon}):r(n)}));Promise.allSettled(l).then(n=>{const r=[];n.forEach(d=>{d.status==="fulfilled"&&r.push(d.value)}),e.bottomSheet({...a,actions:r}).onOk(d=>a.onSuccess&&a.onSuccess(d)).onCancel(()=>a.onCancel&&a.onCancel()).onDismiss(()=>{t.value=!1})})}}}const Ut=K({name:"Container",props:["tabsCount"],setup(e){M.dev("DEBUG","Container","setup()");const t=W(),s=h(()=>t.drawerMiniMode);return{settings:h(()=>t.settings),drawerMiniMode:s,onHeaderReveals:i=>{M.dev("DEBUG","Container","onHeaderReveals()"),t.set("headerVisible",i)}}}});function Gt(e,t,s,o,a,i){return e.settings.tabsBottom!==!0?A((S(),E(Bt,{key:0,class:"jarvis-header text-white",bordered:"",onReveal:e.onHeaderReveals,reveal:e.settings.tabsShow==="hide"},{default:k(()=>[De(e.$slots,"default")]),_:3},8,["onReveal","reveal"])),[[O,e.drawerMiniMode!==!0||e.drawerMiniMode===!0&&e.tabsCount>1]]):A((S(),E(Et,{key:1,class:"jarvis-footer text-white",bordered:"",onReveal:e.onHeaderReveals,reveal:e.settings.tabsShow==="hide"},{default:k(()=>[De(e.$slots,"default")]),_:3},8,["onReveal","reveal"])),[[O,e.drawerMiniMode!==!0||e.drawerMiniMode===!0&&e.tabsCount>1]])}var Jt=Y(Ut,[["render",Gt]]);const xt=K({name:"Tabs",props:["page","tabs"],setup(e){M.dev("DEBUG","Tabs","setup()");const t=ee(),s=W(),o=lt(),a=rt.isPro(),i=B([]),l=p=>{const $=i.value.findIndex(j=>j.id===p.id);i.value[$]={...p,revision:dt().substr(0,5)}};ne(()=>e.tabs,()=>{M.dev("DEBUG","Tabs","tabsWithResolvedBindings()"),i.value=ue(e.tabs);for(const p of i.value)p.config=ue(p),fe.getBindings(p,l)},{immediate:!0});const n=h(()=>s.drawerMiniMode),r=h(()=>s.settings),d=h({get(){return s.getSelectedTabId},set(p){p&&s.set({selectedTabId:p})}}),y=B([]),u=B(!1),v=B(!1),m=()=>{M.dev("DEBUG","Tabs","tabsHiddenShow()"),v.value=!t.platform.is.mobile},f=Ae([]),w=(p,$)=>{f[p]=$},C=p=>{M.dev("DEBUG","Tabs","onResize");const $=p&&p.width||t.screen.width;u.value=!1,y.value=[],f&&f.length&&r.value.tabsCollapse!==!1?f.forEach((j,I)=>{const D=j.$el;D.style.display="inherit",(D.offsetLeft+D.offsetWidth+220>$||u.value===!0)&&(D.style.display="none",u.value=!0,y.value.push(i.value[I]))}):f&&f.length&&r.value.tabsCollapse===!1&&f.forEach(j=>{const I=j.$el;I.style.display="inherit"})},T=p=>s.set("drawerSidebar",p),b=h(()=>o.getUnread.length);return{setRef:w,elTabs:f,tabsWithResolvedBindings:i,tabId:d,tabsHiddenDropdownEnabled:u,tabsHiddenDropdown:v,tabsHiddenShow:m,tabsHidden:y,toggleNotifications:p=>s.set("drawerNotifications",p),toggleSidebar:T,notificationsUnread:b,drawerMiniMode:n,settings:r,isPro:a,isMobile:t.platform.is.mobile===!0,onResize:C}}}),Kt={class:"row nowrap",style:{margin:"2px 0"}},Yt={key:0,class:"q-tab__label"},Xt={class:"q-tab__label"};function Zt(e,t,s,o,a,i){const l=F("icon");return S(),E(ut,{modelValue:e.tabId,"onUpdate:modelValue":t[4]||(t[4]=n=>e.tabId=n),"inline-label":"",dense:"",align:"left",style:N({"padding-left":(e.drawerMiniMode!==!0?0:5)+"px","padding-right":"48px"}),id:"tabBar",class:H({"jarvis-tabs-container":!0,"jarvis-tabs-bottom":e.settings.tabsBottom===!0}),"content-class":"jarvis-tabs","indicator-color":"white"},{default:k(()=>[g(Oe,{onResize:e.onResize},null,8,["onResize"]),e.settings.drawerShowMenuButton!==!1?(S(),E(L,{key:0,flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:t[0]||(t[0]=n=>e.toggleSidebar(!0)),class:H(["q-ml-sm",{"lt-md":e.drawerMiniMode===!0}])},null,8,["class"])):z("",!0),U("div",Kt,[(S(!0),R(G,null,ae(e.tabsWithResolvedBindings,(n,r)=>(S(),E(jt,{key:n.id+"-"+n.revision,ref_for:!0,ref:d=>e.setRef(r,d),name:n.id,to:{params:{tabId:n.id}},style:N(e.isPro&&n.id===e.tabId&&n.bodySelectedStyle||e.isPro&&n.bodyStyle||{}),class:H(["jarvis-tab",["jarvis-tab-"+n.id,e.isPro&&n.id===e.tabId&&n.bodySelectedStyle&&n.bodySelectedStyle.display&&n.bodySelectedStyle.display.startsWith("none")?"hidden":"",e.isPro&&n.bodyStyle&&n.bodyStyle.display&&n.bodyStyle.display.startsWith("none")?"hidden":""]]),"content-class":e.settings.tabsDense?"dense":"normal"},{default:k(()=>[A(g(l,{name:n.icon,size:"xs",class:"tabIcon",style:N({margin:e.settings.tabsDense?"4px 4px 0 0":"0",...e.isPro&&n.id===e.tabId&&n.iconSelectedStyle||e.isPro&&n.iconStyle||{}})},null,8,["name","style"]),[[O,n.icon]]),e.page.hideLabels!==!0?(S(),R("div",Yt,Z(n.title),1)):z("",!0)]),_:2},1032,["name","to","style","class","content-class"]))),128)),A(g(Mt,{modelValue:e.tabsHiddenDropdown,"onUpdate:modelValue":t[1]||(t[1]=n=>e.tabsHiddenDropdown=n),onMouseover:t[2]||(t[2]=n=>e.tabsHiddenDropdown=e.isMobile?e.tabsHiddenDropdown:!0),stretch:"",flat:""},{label:k(()=>[U("div",{class:H(e.settings.tabsDense?"dense":"normal")},[g(l,{name:"mdi-tab-unselected",size:"xs",class:"tabIcon",style:N({margin:e.settings.tabsDense?"1px 5px 0 0":"-1px 0 1px 0"})},null,8,["style"]),U("div",Xt,Z(e.$t("More")+"..."),1)],2)]),default:k(()=>[g(ct,null,{default:k(()=>[(S(!0),R(G,null,ae(e.tabsHidden,n=>(S(),E(ze,{key:n.id,clickable:"",onClick:r=>e.tabId=n.id,class:H({"q-tab--active":n.id===e.tabId})},{default:k(()=>[g(pe,{avatar:""},{default:k(()=>[g(l,{name:n.icon},null,8,["name"])]),_:2},1024),g(pe,null,{default:k(()=>[ye(Z(n.title),1)]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1})]),_:1},8,["modelValue"]),[[O,e.tabsHiddenDropdownEnabled]])]),A(g(L,{flat:"",dense:"",round:"",icon:"mdi-bell","aria-label":"Notifications",onClick:t[3]||(t[3]=n=>e.toggleNotifications(!0)),class:"q-mr-sm notification-drawer-button"},{default:k(()=>[g(Ht,{color:"secondary",align:"middle",floating:""},{default:k(()=>[ye(Z(e.notificationsUnread),1)]),_:1})]),_:1},512),[[O,e.isPro]])]),_:1},8,["modelValue","style","class"])}var _t=Y(xt,[["render",Zt]]);function en(e,t){const s=h(()=>typeof e.value!="object"?B({fullscreenSize:e.value}):e),o=B(),a=B(!1),i=()=>{a.value=!0;const r=o.value;r.classList.add("isFullscreen"),r.style.overflow="auto";const d=r.querySelector(".jarvis-widget-scaler");d.style.height="auto"},l=()=>{a.value=!1;const r=o.value;r.classList.remove("isFullscreen"),r.style.overflow="initial";const d=r.querySelector(".jarvis-widget-scaler");d.style.height=s.value.fullscreenSize+"px",document.exitFullscreen?document.exitFullscreen().catch(y=>{}):document.mozCancelFullScreen?document.mozCancelFullScreen().catch(y=>{}):document.webkitCancelFullScreen&&document.webkitCancelFullScreen().catch(y=>{})};return ne(()=>o.value,()=>{o.value.addEventListener("fullscreenchange",()=>{document.fullscreenElement===null&&l()})}),{fullscreenElement:o,fullscreenActive:a,fullscreenToggle:r=>{r=typeof r=="boolean"?r:!a.value,ft.toggle(o.value).then(()=>{r===!1?l():i()}).catch(d=>{console.error(d)})}}}const tn=K({name:"Widget",props:["page","tab","widgets","config","layout","containerSize"],setup(e){const t=ee(),s=Fe(),o=W(),a=pt(e,"config")||{};B();const i=B(),l=h(()=>{const D=a.value.alignmentHorizontal||"center",de=a.value.alignmentVertical||"top",te=a.value.scaleToFitContents!==void 0?a.value.scaleToFitContents:!0;return{h:D,v:de,fit:te}}),n=h(()=>l.value.v!=="middle"?{}:{transform:"translateY(-50%)",position:"relative",top:"50%"}),r=Ae({width:0,height:0}),d=h(()=>i.value&&i.value.$el.offsetHeight||0),y=h(()=>e.containerSize.height-d.value),u=h(()=>l.value.fit===!1||gt.includes(C.value.module)?{x:1,y:1}:{x:r?Math.min(1,e.containerSize.width/r.width):1,y:r?Math.min(1,y.value/r.height):1}),v=h(()=>{const D=[0,0];return D[0]=l.value.h==="center"?"50%":l.value.h==="right"?"100%":l.value.h,D[1]=l.value.v==="middle"?"50%":l.value.v==="bottom"?"100%":l.value.v,D}),m=h(()=>({width:l.value.h!=="fill-width"?"100%":Math.floor(1/(u.value.y<u.value.x?u.value.y:u.value.x)*100)+"% !important",height:y.value-1+"px"})),f=h(()=>$.value===!0?1:u.value.y<u.value.x?u.value.y:u.value.x),w=h(()=>{const D={"-webkit-transform":"scale("+f.value+")","-webkit-transform-origin":v.value.join(" "),transform:"scale("+f.value+")","transform-origin":v.value.join(" ")};return l.value.v==="middle"&&(D.margin="auto"),t.screen.lt.lg||e.layout==="desktop"&&t.platform.is.mobile?{}:D}),C=h(()=>{const D=e.widgets[0];return D&&o.widgets[D]||{}}),T=()=>{M.dev("DEBUG","Widget","jump"),C.value.link&&(C.value.link.indexOf("http")>-1||C.value.link.indexOf("www")>-1)?window.open((C.value.link.indexOf("http")===-1?"http://":"")+C.value.link,"_blank"):C.value.link&&s.push({params:{tabId:C.value.link}}).catch(D=>console.warn(D))};let b=null;const c=D=>{b&&clearTimeout(b),b=setTimeout(()=>{M.dev("DEBUG","Widget","onResize()"),Object.assign(r,D)},500)},{fullscreenElement:p,fullscreenActive:$,fullscreenToggle:j}=en(y),I=B(a.value.allowFullscreen||!1);return{alignment:l,verticalAlignment:n,scaleSizes:m,scaleStyle:w,size:r,widget:C,widgetTitle:i,widgetTitleSize:d,jump:T,onResize:c,fullscreenEnabled:I,fullscreenElement:p,fullscreenActive:$,fullscreenToggle:j}}});function nn(e,t,s,o,a,i){const l=F("icon");return S(),R("div",{ref:"fullscreenElement",onDblclick:t[1]||(t[1]=n=>e.fullscreenEnabled&&e.fullscreenToggle()),class:H(["jarvis-widget-container bgcolor",{tile:e.tab.widgetEdges,paper:!e.tab.widgetEdges,fullscreenEnabled:e.fullscreenEnabled}])},[e.fullscreenEnabled?(S(),R("div",{key:0,class:H(["fullscreener",{close:e.fullscreenActive}]),onClick:t[0]||(t[0]=(...n)=>e.fullscreenToggle&&e.fullscreenToggle(...n))},null,2)):z("",!0),g(Se,{flat:"",class:H(["jarvis-widget full-width full-height",{["jarvis-widget-module-"+e.widget.module]:!0,["jarvis-widget-"+e.widget.id]:!0}])},{default:k(()=>[e.widget.hideTitle!==!0&&(e.widget.icon||e.widget.title)?(S(),E(ze,{key:0,class:"jarvis-widget-header",ref:"widgetTitle"},{default:k(()=>[e.widget.icon?(S(),E(pe,{key:0,side:"",class:H({"cursor-pointer":e.widget.link}),onClick:e.jump},{default:k(()=>[g(mt,{square:e.tab.widgetEdges,rounded:!e.tab.widgetEdges,class:"jarvis-widget-icon","font-size":"24px"},{default:k(()=>[g(l,{name:e.widget.icon},null,8,["name"])]),_:1},8,["square","rounded"])]),_:1},8,["class","onClick"])):z("",!0),g(pe,null,{default:k(()=>[g(vt,{class:H(["text-h6",{"cursor-pointer":e.widget.link}]),onClick:e.jump},{default:k(()=>[ye(Z(e.widget.label||e.widget.title),1)]),_:1},8,["class","onClick"])]),_:1})]),_:1},512)):z("",!0),e.widget.hideSeparator!==!0&&e.widget.hideTitle!==!0&&(e.widget.icon||e.widget.title)?(S(),E(oe,{key:1})):z("",!0),g(ie,{horizontal:"",class:"jarvis-widget-content",style:N(e.alignment.fit===!1?{"overflow-y":"auto",...e.scaleSizes,...e.verticalAlignment}:e.verticalAlignment)},{default:k(()=>[g(Oe,{onResize:e.onResize},null,8,["onResize"]),U("div",{class:"jarvis-widget-scaler full-width",style:N(e.scaleStyle)},[(S(),E(ht(e.widget.module),{key:e.widget.revision,class:"full-width",widget:e.widget,_alignment:e.alignment,_fullscreen:e.fullscreenActive,_containerSize:{width:e.containerSize.width,height:e.containerSize.height-e.widgetTitleSize},_widgetSize:{width:e.size.width,height:e.size.height}},null,8,["widget","_alignment","_fullscreen","_containerSize","_widgetSize"]))],4)]),_:1},8,["style"])]),_:1},8,["class"])],34)}var sn=Y(tn,[["render",nn]]);const on=K({name:"TabPanel",props:["page","tab"],components:{Widget:sn},setup(e){M.dev("DEBUG","TabPanel","setup()");const t=W(),s=ee(),o=s.platform.is.mobile,a=!1,i=h(()=>e.tab.widgetConfig),l=h(()=>Math.max(o&&i.value.smartphoneGapSize||a||i.value.desktopGapSize||5,0)),n=h(()=>{let f=[];return o&&i.value.smartphoneSameAs==="specific-layout"||a?f=e.tab.widgetsSmartphone||[]:o&&i.value.smartphoneSameAs==="tablet"?f=e.tab.widgetsTablet||[]:f=e.tab.widgetsDesktop||[],f}),r=h(()=>Math.max.apply(Math,n.value.map(f=>f.y+f.h))),d=h(()=>{var f;return((f=n.value)==null?void 0:f[0])||{}}),y=s.screen.width,u=h(()=>t.pageHeight),v=h(()=>{const f=(o?i.value.smartphoneFitPageHeight:i.value.desktopFitPageHeight)||!1,w=o&&i.value.smartphoneWidgetHeight||a||i.value.desktopWidgetHeight||50;return f===!0?(u.value-2*l.value)/r.value-l.value:w}),m=h(()=>o&&i.value.smartphoneSameAs==="specific-layout"||a?"smartphone":o&&i.value.smartphoneSameAs==="tablet"?"tablet":"desktop");return{containerRows:r,fullscreenContainer:d,pageWidth:y,pageHeight:u,widgetGap:l,widgetHeight:v,widgetLayout:m,widgetContainers:n}}});function an(e,t,s,o,a,i){const l=F("widget");return S(),R("div",{class:H({["jarvis-page-"+e.page.id]:!0,["jarvis-tab-"+e.tab.id]:!0})},[e.tab.fullscreen!==!0?(S(),R("div",{key:0,class:H(["container",e.widgetLayout]),style:N({gridTemplateRows:"repeat("+e.containerRows+", "+e.widgetHeight+"px)",columnGap:e.widgetGap+"px",rowGap:e.widgetGap+"px",padding:e.widgetGap+"px"})},[(S(!0),R(G,null,ae(e.widgetContainers,n=>(S(),R(G,null,[n&&n.items&&n.items.length>0?(S(),R("div",{key:n.i,style:N({gridArea:n.y+1+" / "+(n.x+1)+" / span "+n.h+" / span "+n.w}),class:"box"},[g(l,{page:e.page,tab:e.tab,widgets:n.items||[],config:n,layout:e.widgetLayout,containerSize:{width:e.pageWidth/12*n.w,height:n.h*e.widgetHeight+(n.h-1)*e.widgetGap}},null,8,["page","tab","widgets","config","layout","containerSize"])],4)):z("",!0)],64))),256))],6)):(S(),R("div",{key:1,style:N({height:e.pageHeight+"px"})},[g(l,{fullscreen:"",page:e.page,tab:e.tab,widgets:e.fullscreenContainer.items||[],config:e.fullscreenContainer,layout:e.widgetLayout,containerSize:{width:e.pageWidth,height:e.pageHeight}},null,8,["page","tab","widgets","config","layout","containerSize"])],4))],2)}var ln=Y(on,[["render",an]]);const rn=K({name:"Page",props:["page"],components:{Container:Jt,Tabs:_t,TabPanel:ln},setup(e){M.dev("DEBUG","Page","setup()");const t=ee(),s=bt(),o=Fe(),a=yt(),i=W(),l=h(()=>t.platform.is.mobile),n=h(()=>i.drawerMiniMode),r=h(()=>i.settings),d=h(()=>Object.keys(e.page.tabs).length),y=h({get(){return"tab-"+i.getSelectedTabId},set(b){b&&o.push({params:{tabId:b.replace("tab-","")}})}}),u=(b,c)=>{const p=document.querySelector(".jarvis-header");b=p&&p.offsetHeight?p.offsetHeight:b;const $=c-b;return $!==i.pageHeight&&(M.dev("DEBUG","Page","setPageContainer",b,c,$,i.pageHeight),i.set("pageHeight",c-b)),{}},v=()=>i.set("selectedTabReady",!1),m=()=>i.set("selectedTabReady",!0),{jumperOpen:f}=Qt(),w=(b,c,p)=>{const $=c.id;o.push({params:{...a.params,tabId:$}}).then(()=>{if(p.id!=="_root"){const j=l.value&&c.widgetConfig.smartphoneWidgetHeight||c.widgetConfig.desktopWidgetHeight||50,I=document.querySelector(".jarvis-header"),D=I&&I.offsetHeight?I.offsetHeight:0;setTimeout(()=>window.scrollTo(0,p.y*j+D+1),100)}}).catch(j=>{console.warn("Page",j.message)})},C=(b,c)=>{let p=t.platform.is.mobile?c.widgetsSmartphone:c.widgetsDesktop;p=i.getWidgets(p),p=p.concat([{},{color:"primary",icon:"mdi-tab",label:s.t("Jump directly to")+" "+c.label,id:"_root"}]),f(p,{class:"jarvis-quick-jumper",message:b.title+" / "+c.title+": "+s.t("Widgets"),onSuccess:$=>w(b,c,$)})},T=b=>{const c=i.getTabs(b);f(c,{class:"jarvis-quick-jumper",message:b.title+": "+s.t("Tabs"),onSuccess:p=>C(b,p)})};return{jumperOpen:()=>f(i.getPages,{class:"jarvis-quick-jumper",message:s.t("Pages"),onSuccess:T}),setPageContainer:u,onSelectedTabMoving:v,onSelectedTabReady:m,drawerMiniMode:n,isMobile:l,tabsCount:d,tabId:y,tabAnimated:h(()=>r.value.tabsSwipeAnimation==="always"||(!r.value.tabsSwipeAnimation||r.value.tabsSwipeAnimation==="mobile")&&l.value),tabSwipeable:h(()=>r.value.tabsSwipe==="always"||(!r.value.tabsSwipe||r.value.tabsSwipe==="mobile")&&l.value),settings:r}}});function dn(e,t,s,o,a,i){const l=F("Tabs"),n=F("Container"),r=F("TabPanel");return S(),E(Rt,{style:{"padding-top":"0"}},{default:k(()=>[g(n,{tabsCount:e.tabsCount},{default:k(()=>[g(l,{page:e.page,tabs:e.page.tabs},null,8,["page","tabs"])]),_:1},8,["tabsCount"]),g(It,{"style-fn":e.setPageContainer,class:"jarvis-page jarvis-body"},{default:k(()=>[g(We,{modelValue:e.tabId,"onUpdate:modelValue":t[0]||(t[0]=d=>e.tabId=d),"keep-alive":!0,animated:e.tabAnimated,swipeable:e.tabSwipeable,style:{"background-color":"transparent"},onBeforeTransition:e.onSelectedTabMoving,onTransition:e.onSelectedTabReady},{default:k(()=>[(S(!0),R(G,null,ae(e.page.tabs,d=>(S(),E(Ne,{key:d.id,name:"tab-"+d.id,style:N({padding:0,"margin-top":e.drawerMiniMode&&(e.settings.tabsBottom||e.page.tabs.length<=1)?0:e.settings.tabsDense?"40px":"60px"})},{default:k(()=>[g(r,{page:e.page,tab:{widgetConfig:{},...d}},null,8,["page","tab"])]),_:2},1032,["name","style"]))),128))]),_:1},8,["modelValue","animated","swipeable","onBeforeTransition","onTransition"]),A(g(Vt,{position:"bottom-right",offset:[18,18],style:{"z-index":"5999"}},{default:k(()=>[g(L,{fab:"",icon:"mdi-tab-search",color:"accent",onClick:t[1]||(t[1]=wt(d=>e.jumperOpen(),["stop"]))})]),_:1},512),[[O,e.settings.quickJumper==="always"||e.isMobile&&e.settings.quickJumper==="mobile"]])]),_:1},8,["style-fn"])]),_:1})}var cn=Y(rn,[["render",dn],["__scopeId","data-v-3c02f346"]]);function un(e){return e.split("-")[1]}function fn(e){return e==="y"?"height":"width"}function Ve(e){return e.split("-")[0]}function pn(e){return["top","bottom"].includes(Ve(e))?"x":"y"}function Ee(e,t,s){let{reference:o,floating:a}=e;const i=o.x+o.width/2-a.width/2,l=o.y+o.height/2-a.height/2,n=pn(t),r=fn(n),d=o[r]/2-a[r]/2,y=Ve(t),u=n==="x";let v;switch(y){case"top":v={x:i,y:o.y-a.height};break;case"bottom":v={x:i,y:o.y+o.height};break;case"right":v={x:o.x+o.width,y:l};break;case"left":v={x:o.x-a.width,y:l};break;default:v={x:o.x,y:o.y}}switch(un(t)){case"start":v[n]-=d*(s&&u?-1:1);break;case"end":v[n]+=d*(s&&u?-1:1);break}return v}const gn=async(e,t,s)=>{const{placement:o="bottom",strategy:a="absolute",middleware:i=[],platform:l}=s,n=i.filter(Boolean),r=await(l.isRTL==null?void 0:l.isRTL(t));let d=await l.getElementRects({reference:e,floating:t,strategy:a}),{x:y,y:u}=Ee(d,o,r),v=o,m={},f=0;for(let w=0;w<n.length;w++){const{name:C,fn:T}=n[w],{x:b,y:c,data:p,reset:$}=await T({x:y,y:u,initialPlacement:o,placement:v,strategy:a,middlewareData:m,rects:d,platform:l,elements:{reference:e,floating:t}});if(y=b!=null?b:y,u=c!=null?c:u,m={...m,[C]:{...m[C],...p}},$&&f<=50){f++,typeof $=="object"&&($.placement&&(v=$.placement),$.rects&&(d=$.rects===!0?await l.getElementRects({reference:e,floating:t,strategy:a}):$.rects),{x:y,y:u}=Ee(d,v,r)),w=-1;continue}}return{x:y,y:u,placement:v,strategy:a,middlewareData:m}};function je(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function P(e){var t;return((t=e.ownerDocument)==null?void 0:t.defaultView)||window}function q(e){return P(e).getComputedStyle(e)}function J(e){return Ue(e)?(e.nodeName||"").toLowerCase():""}let ce;function Qe(){if(ce)return ce;const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?(ce=e.brands.map(t=>t.brand+"/"+t.version).join(" "),ce):navigator.userAgent}function V(e){return e instanceof P(e).HTMLElement}function x(e){return e instanceof P(e).Element}function Ue(e){return e instanceof P(e).Node}function Ie(e){if(typeof ShadowRoot=="undefined")return!1;const t=P(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function me(e){const{overflow:t,overflowX:s,overflowY:o,display:a}=q(e);return/auto|scroll|overlay|hidden|clip/.test(t+o+s)&&!["inline","contents"].includes(a)}function mn(e){return["table","td","th"].includes(J(e))}function ke(e){const t=/firefox/i.test(Qe()),s=q(e),o=s.backdropFilter||s.WebkitBackdropFilter;return s.transform!=="none"||s.perspective!=="none"||(o?o!=="none":!1)||t&&s.willChange==="filter"||t&&(s.filter?s.filter!=="none":!1)||["transform","perspective"].some(a=>s.willChange.includes(a))||["paint","layout","strict","content"].some(a=>{const i=s.contain;return i!=null?i.includes(a):!1})}function Ge(){return!/^((?!chrome|android).)*safari/i.test(Qe())}function Ce(e){return["html","body","#document"].includes(J(e))}const Re=Math.min,se=Math.max,ge=Math.round;function Je(e){const t=q(e);let s=parseFloat(t.width),o=parseFloat(t.height);const a=e.offsetWidth,i=e.offsetHeight,l=ge(s)!==a||ge(o)!==i;return l&&(s=a,o=i),{width:s,height:o,fallback:l}}function xe(e){return x(e)?e:e.contextElement}const Ke={x:1,y:1};function _(e){const t=xe(e);if(!V(t))return Ke;const s=t.getBoundingClientRect(),{width:o,height:a,fallback:i}=Je(t);let l=(i?ge(s.width):s.width)/o,n=(i?ge(s.height):s.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!n||!Number.isFinite(n))&&(n=1),{x:l,y:n}}function le(e,t,s,o){var a,i;t===void 0&&(t=!1),s===void 0&&(s=!1);const l=e.getBoundingClientRect(),n=xe(e);let r=Ke;t&&(o?x(o)&&(r=_(o)):r=_(e));const d=n?P(n):window,y=!Ge()&&s;let u=(l.left+(y&&((a=d.visualViewport)==null?void 0:a.offsetLeft)||0))/r.x,v=(l.top+(y&&((i=d.visualViewport)==null?void 0:i.offsetTop)||0))/r.y,m=l.width/r.x,f=l.height/r.y;if(n){const w=P(n),C=o&&x(o)?P(o):o;let T=w.frameElement;for(;T&&o&&C!==w;){const b=_(T),c=T.getBoundingClientRect(),p=getComputedStyle(T);c.x+=(T.clientLeft+parseFloat(p.paddingLeft))*b.x,c.y+=(T.clientTop+parseFloat(p.paddingTop))*b.y,u*=b.x,v*=b.y,m*=b.x,f*=b.y,u+=c.x,v+=c.y,T=P(T).frameElement}}return{width:m,height:f,top:v,right:u+m,bottom:v+f,left:u,x:u,y:v}}function X(e){return((Ue(e)?e.ownerDocument:e.document)||window.document).documentElement}function ve(e){return x(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Ye(e){return le(X(e)).left+ve(e).scrollLeft}function vn(e,t,s){const o=V(t),a=X(t),i=le(e,!0,s==="fixed",t);let l={scrollLeft:0,scrollTop:0};const n={x:0,y:0};if(o||!o&&s!=="fixed")if((J(t)!=="body"||me(a))&&(l=ve(t)),V(t)){const r=le(t,!0);n.x=r.x+t.clientLeft,n.y=r.y+t.clientTop}else a&&(n.x=Ye(a));return{x:i.left+l.scrollLeft-n.x,y:i.top+l.scrollTop-n.y,width:i.width,height:i.height}}function re(e){if(J(e)==="html")return e;const t=e.assignedSlot||e.parentNode||(Ie(e)?e.host:null)||X(e);return Ie(t)?t.host:t}function Be(e){return!V(e)||q(e).position==="fixed"?null:e.offsetParent}function hn(e){let t=re(e);for(;V(t)&&!Ce(t);){if(ke(t))return t;t=re(t)}return null}function Me(e){const t=P(e);let s=Be(e);for(;s&&mn(s)&&q(s).position==="static";)s=Be(s);return s&&(J(s)==="html"||J(s)==="body"&&q(s).position==="static"&&!ke(s))?t:s||hn(e)||t}function bn(e){return Je(e)}function yn(e){let{rect:t,offsetParent:s,strategy:o}=e;const a=V(s),i=X(s);if(s===i)return t;let l={scrollLeft:0,scrollTop:0},n={x:1,y:1};const r={x:0,y:0};if((a||!a&&o!=="fixed")&&((J(s)!=="body"||me(i))&&(l=ve(s)),V(s))){const d=le(s);n=_(s),r.x=d.x+s.clientLeft,r.y=d.y+s.clientTop}return{width:t.width*n.x,height:t.height*n.y,x:t.x*n.x-l.scrollLeft*n.x+r.x,y:t.y*n.y-l.scrollTop*n.y+r.y}}function wn(e,t){const s=P(e),o=X(e),a=s.visualViewport;let i=o.clientWidth,l=o.clientHeight,n=0,r=0;if(a){i=a.width,l=a.height;const d=Ge();(d||!d&&t==="fixed")&&(n=a.offsetLeft,r=a.offsetTop)}return{width:i,height:l,x:n,y:r}}function Sn(e){var t;const s=X(e),o=ve(e),a=(t=e.ownerDocument)==null?void 0:t.body,i=se(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),l=se(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0);let n=-o.scrollLeft+Ye(e);const r=-o.scrollTop;return q(a||s).direction==="rtl"&&(n+=se(s.clientWidth,a?a.clientWidth:0)-i),{width:i,height:l,x:n,y:r}}function Xe(e){const t=re(e);return Ce(t)?e.ownerDocument.body:V(t)&&me(t)?t:Xe(t)}function Ze(e,t){var s;t===void 0&&(t=[]);const o=Xe(e),a=o===((s=e.ownerDocument)==null?void 0:s.body),i=P(o);return a?t.concat(i,i.visualViewport||[],me(o)?o:[]):t.concat(o,Ze(o))}function kn(e,t){const s=le(e,!0,t==="fixed"),o=s.top+e.clientTop,a=s.left+e.clientLeft,i=V(e)?_(e):{x:1,y:1},l=e.clientWidth*i.x,n=e.clientHeight*i.y,r=a*i.x,d=o*i.y;return{top:d,left:r,right:r+l,bottom:d+n,x:r,y:d,width:l,height:n}}function He(e,t,s){return t==="viewport"?je(wn(e,s)):x(t)?kn(t,s):je(Sn(X(e)))}function Cn(e,t){const s=t.get(e);if(s)return s;let o=Ze(e).filter(n=>x(n)&&J(n)!=="body"),a=null;const i=q(e).position==="fixed";let l=i?re(e):e;for(;x(l)&&!Ce(l);){const n=q(l),r=ke(l);(i?!r&&!a:!r&&n.position==="static"&&!!a&&["absolute","fixed"].includes(a.position))?o=o.filter(y=>y!==l):a=n,l=re(l)}return t.set(e,o),o}function Tn(e){let{element:t,boundary:s,rootBoundary:o,strategy:a}=e;const l=[...s==="clippingAncestors"?Cn(t,this._c):[].concat(s),o],n=l[0],r=l.reduce((d,y)=>{const u=He(t,y,a);return d.top=se(u.top,d.top),d.right=Re(u.right,d.right),d.bottom=Re(u.bottom,d.bottom),d.left=se(u.left,d.left),d},He(t,n,a));return{width:r.right-r.left,height:r.bottom-r.top,x:r.left,y:r.top}}const $n={getClippingRect:Tn,convertOffsetParentRelativeRectToViewportRelativeRect:yn,isElement:x,getDimensions:bn,getOffsetParent:Me,getDocumentElement:X,getScale:_,async getElementRects(e){let{reference:t,floating:s,strategy:o}=e;const a=this.getOffsetParent||Me,i=this.getDimensions;return{reference:vn(t,await a(s),o),floating:{x:0,y:0,...await i(s)}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>q(e).direction==="rtl"},Dn=(e,t,s)=>{const o=new Map,a={platform:$n,...s},i={...a.platform,_c:o};return gn(e,t,{...a,platform:i})};var En=`[\r
   {\r
      "id":"cfbea70b-925b-40d1-9e8e-d0768336e3da",\r
      "title":"Main Site",\r
      "type":"page",\r
      "icon":"mdi-file",\r
      "tabs":[\r
         {\r
            "id":"0559b5e5-1c56-4ea4-8211-d51226417202",\r
            "title":"Dashboard",\r
            "icon":"mdi-monitor-dashboard",\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":8,\r
                  "i":"77ac22da-738d-4646-b0f5-940298bd6571",\r
                  "moved":false,\r
                  "items":[\r
                     "3958dfb0-83da-48ae-96f3-e66969a92cac"\r
                  ]\r
               },\r
               {\r
                  "x":4,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"28e602ec-4064-48d0-94d8-80e64fe37f87",\r
                  "moved":false,\r
                  "items":[\r
                     "be31acad-6bb4-40ed-a9cf-24cd981d8545"\r
                  ]\r
               },\r
               {\r
                  "x":4,\r
                  "y":4,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"0f1c06bc-f5c3-4e32-84e6-41fc0b4d05b5",\r
                  "moved":false,\r
                  "items":[\r
                     "b073226b-14d9-40e9-bbd7-4a54080cfa87"\r
                  ]\r
               },\r
               {\r
                  "x":8,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"a3c543c8-8135-47ef-905e-681982708764",\r
                  "moved":false,\r
                  "items":[\r
                     "99142690-4245-445b-bbc4-be8d09b93b83"\r
                  ]\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         },\r
         {\r
            "id":"e2055e5e-c0a8-46dc-8019-30c97e157d62",\r
            "title":"Map",\r
            "icon":"map",\r
            "fullscreen":true,\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":4,\r
                  "i":"3587d28c-ffbe-4121-9e93-35cc52a5e947",\r
                  "moved":false,\r
                  "items":[\r
                     "232c9a69-1077-4b03-9c68-2d27eb148e6f"\r
                  ]\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         },\r
         {\r
            "id":"c9ae69c1-5c33-49bb-86e9-6ca2106cb9b7",\r
            "title":"Settings",\r
            "icon":"cog",\r
            "widgetsDesktop":[\r
               {\r
                  "x":0,\r
                  "y":0,\r
                  "w":4,\r
                  "h":30,\r
                  "i":"252b1b88-f112-4095-aa75-a8f97fc6856b",\r
                  "moved":false,\r
                  "items":[\r
                     "dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937"\r
                  ],\r
                  "scaleToFitContents":false\r
               },\r
               {\r
                  "x":4,\r
                  "y":0,\r
                  "w":8,\r
                  "h":5,\r
                  "i":"6367c1cf-9e5d-4ec7-a383-f578e6dd0ea2",\r
                  "moved":false,\r
                  "items":[\r
                     "6fc7cca0-306e-40f6-a7c6-556ebd1fbd73"\r
                  ]\r
               },\r
               {\r
                  "x":8,\r
                  "y":5,\r
                  "w":4,\r
                  "h":25,\r
                  "i":"9f4dbd4d-cbe7-4dcd-94f3-c35850e28778",\r
                  "moved":false,\r
                  "items":[\r
                     "e90fd75a-f510-4481-845d-b2cdac5c4e2f"\r
                  ],\r
                  "scaleToFitContents":false\r
               }\r
            ],\r
            "widgetsSmartphone":[\r
               \r
            ]\r
         }\r
      ]\r
   }\r
]`,jn=`{\r
   "232c9a69-1077-4b03-9c68-2d27eb148e6f":{\r
      "id":"232c9a69-1077-4b03-9c68-2d27eb148e6f",\r
      "config":{\r
      },\r
      "module":"Map"\r
   }\r
}`,In=[{title:"#introduction.title",message:"#introduction.content",onEnter:({props:e})=>{const t=we.getConnection,s=W();t.setState(Q.get("NODE_SETTINGS"),JSON.stringify({...s.settings,["tour"+qe(e.tour)]:!0})).catch(o=>console.warn("Tours.Introduction",o.message||o))}},{target:"#SettingsButton",spotlight:".jarvis-sidebar-container",title:"#settings.title",message:"#settings.content",params:{placement:"right"},secondaryButton:"#settings.buttons.manually",secondaryAction:({finishTour:e,step:t})=>{document.querySelector("#SettingsButton").click(),e()},primaryButton:"#settings.buttons.automatically",primaryAction:({finishTour:e,nextStep:t,step:s})=>{t();const o={},a={};fe.importDevices(Q.get("DEFAULT_ADAPTERIMPORT").concat(["daswetter"])).then(i=>{i.forEach(m=>{if(m.status==="fulfilled"){const f=m.value;o[f.function]=o[f.function]||[],o[f.function].push(f),a[f.id]=f}});const l=JSON.parse(En),n=JSON.parse(jn),r={config:{},items:[],module:"StateList",title:""},d=[{widgetId:"3958dfb0-83da-48ae-96f3-e66969a92cac",function:"light",icon:"mdi-lightbulb-on"},{widgetId:"be31acad-6bb4-40ed-a9cf-24cd981d8545",function:"blind",icon:"mdi-window-shutter-open"},{widgetId:"b073226b-14d9-40e9-bbd7-4a54080cfa87",function:"heating",icon:"mdi-radiator"},{widgetId:"99142690-4245-445b-bbc4-be8d09b93b83",function:"window",icon:"mdi-window-closed-variant"}];n["dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937"]={id:"dc0d5c0e-d82d-41a9-8f55-6d6ce9b94937",config:{},items:[],module:"AdapterStatus",title:""},n["6fc7cca0-306e-40f6-a7c6-556ebd1fbd73"]={id:"6fc7cca0-306e-40f6-a7c6-556ebd1fbd73",config:{},items:[],module:"AdapterLogs",title:""},n["e90fd75a-f510-4481-845d-b2cdac5c4e2f"]={id:"e90fd75a-f510-4481-845d-b2cdac5c4e2f",config:{},items:[],module:"ScriptStatus",title:""},d.forEach((m,f)=>{const w=ue(r);w.id=m.widgetId,w.title=St.global.t(m.function),w.icon=m.icon,o[m.function]=o[m.function]||[];for(const T of o[m.function]){if(!T.states)continue;const b=Object.keys(T.states);let c={id:kt(),type:"device",deviceId:T.id,showState:!0,primaryStateKey:b[0]||"",secondaryStatesKeys:[]};T.function==="light"&&(b.includes("power")||b.includes("level"))?c={...c,showState:!1,actionElement:"SwitchAction",primaryStateKey:b.includes("power")?"power":"level"}:T.function==="blind"&&b.includes("level")?c={...c,showState:!1,actionElement:"BlindLevelAction",primaryStateKey:"level"}:T.function==="heating"&&b.includes("temperature")?c={...c,showState:!0,primaryStateKey:"temperature",secondaryStatesKeys:b.filter(p=>["setTemperature","humidity"].includes(p))}:T.function==="window"&&b.includes("open")&&(c={...c,primaryStateKey:"open"}),w.items.push(c)}n[w.id]=w;const{height:C}=fe.getDefaultModuleHeight(w,w.items);l[0].tabs[0].widgetsDesktop[f].h=C,l[0].tabs[0].widgetsDesktop[f+1]&&l[0].tabs[0].widgetsDesktop[f].x===l[0].tabs[0].widgetsDesktop[f+1].x&&(l[0].tabs[0].widgetsDesktop[f+1].y=C)});const y=W(),u=we.getConnection,v=[u.setState(Q.get("NODE_LAYOUT"),JSON.stringify({version:3,layout:l})),u.setState(Q.get("NODE_DEVICES"),JSON.stringify({version:3,devices:a})),u.setState(Q.get("NODE_WIDGETS"),JSON.stringify(n)),u.setState(Q.get("NODE_SETTINGS"),JSON.stringify({...y.settings,tourInterface:!1}))];Promise.allSettled(v).then(()=>{e(),window.location.reload()}).catch(m=>console.warn("Tours.Introduction",m.message||m))}).catch(i=>{console.warn("Tours.Introduction",i.message||i)})}},{style:{"max-width":"450px"},title:"#jarvis.title",loading:!0,buttons:!1}],Rn=[{target:".jarvis-sidebar-container",title:"#drawer.title",message:"#drawer.content",params:{placement:"right"},onEnter:({props:e})=>{const t=we.getConnection,s=W();t.setState(Q.get("NODE_SETTINGS"),JSON.stringify({...s.settings,["tour"+qe(e.tour)]:!0})).catch(o=>console.warn("Tours.Interface",o.message||o))}},{target:".jarvis-tabs-container",title:"#tabs.title",message:"#tabs.content"},{spotlight:".q-page-container .jarvis-page",title:"#widgets.title",message:"#widgets.content"},{target:".jarvis-widget-container .jarvis-widget-module-StateList",title:"#modules.title",message:"#modules.content",params:{placement:"right-start"}},{target:".jarvis-widget-container .jarvis-widget-module-StateList .jarvis-widget-header",title:"#WidgetHeader.title",message:"#WidgetHeader.content",targetStyle:{}},{buttons:!1,onSpotlightClick:({nextStep:e})=>{e()},target:".jarvis-widget-container .jarvis-widget-module-StateList .jarvis-widget-content",title:"#WidgetContent.title",message:"#WidgetContent.content",targetStyle:{},params:{placement:"right-start"}},{target:".jarvis-popup",title:"#DeviceStateDetails.title",message:"#DeviceStateDetails.content",params:{placement:"top"}}],Bn={introduction:In,interface:Rn};const Mn=K({name:"Tours",props:{tour:{type:String},start:{type:Boolean,default:!1}},setup(e){const t=B(!1),s=B(null),o=Bn[e.tour],a=B(null),i=B(null);let l,n,r={};const d=(c,p)=>{n=p?c.style.position:n,c.style.position=p?c.style.position||"relative":n,c.style.zIndex=p?5001:null,c.style.border=p?"5px solid #fff":null,c.style.opacity=p?.7:"unset",l=p?c.parentElement.style.zIndex:l,c.parentElement.style.zIndex=p?5001:l},y=(c,p=!0)=>{const $=c.spotlight||c.target;if(t.value=!0,$){const j=document.querySelector($);if(j){if(d(j,p),c.onSpotlightClick!==void 0&&(j.style.pointerEvents="all",j.onclick=()=>c.onSpotlightClick({props:e,step:c,nextStep:f,previousStep:m,skipStep:w,finishTour:C})),c.targetStyle&&p===!0){r={};for(const I in c.targetStyle)r[I]=j.style[I],j.style[I]=c.targetStyle[I]}else if(c.targetStyle&&p===!1)for(const I in c.targetStyle)j.style[I]=r[I]}}},u=c=>{const p=document.querySelector(c.value.target||"body"),$={...c.value.params||{},middleware:[]};return Dn(p,s.value,$).then(j=>{const{x:I,y:D}=j;s.value.firstChild&&(s.value.firstChild.style.display="block");const de=s.value.offsetWidth,te=s.value.offsetHeight,Te=document.querySelector("body");Te.style.pointerEvents="none";const _e=Te.offsetHeight-te;return s.value.style.left=(c.value.target?I+15:"calc(50% - "+de/2)+"px",s.value.style.top=(c.value.target?Math.max(10,Math.min(_e-10,D-te/2+10)):D/2-te/2)+"px",s.value.style.pointerEvents="all",!0})},v=c=>{i.value;const p=i.value===null||i.value===c-2;i.value=c-1,a.value=o[i.value],u(a).then(()=>{o[i.value-1]&&y(o[i.value-1],!1),o[i.value+1]&&y(o[i.value+1],!1),y(a.value)}),p&&a.value&&a.value.onEnter&&a.value.onEnter({props:e,step:a,previousStep:m,nextStep:f,finishTour:C,skipStep:w})},m=()=>v(i.value),f=()=>v(i.value+2),w=()=>{y(a.value,!1),a.value=null,t.value=!1;const c=document.querySelector("body");c.style.pointerEvents="all"},C=()=>{w()},T=h(()=>i.value<=0),b=h(()=>i.value===o.length-1);return W(),Ct(()=>{e.start&&v(1)}),{marked:Pt,tooltip:s,overlay:t,step:a,isFirst:T,isLast:b,previousStep:m,nextStep:f,skipStep:w,finishTour:C}}}),Hn={class:"tooltip",ref:"tooltip"},Pn={class:"text-h6"},Ln=["innerHTML"];function An(e,t,s,o,a,i){const l=F("q-overlay");return S(),R(G,null,[g(l,{modelValue:e.overlay,"onUpdate:modelValue":t[0]||(t[0]=n=>e.overlay=n),"no-scroll":!0,"z-index":5e3,opacity:.7},null,8,["modelValue","opacity"]),U("div",Hn,[e.step?(S(),E(Se,{key:e.step.title,class:"step"},{default:k(()=>[g(ie,null,{default:k(()=>[U("div",Pn,Z(e.$t(e.step.title||"")),1)]),_:1}),g(oe),e.step.loading===!0?(S(),E(Tt,{key:0,indeterminate:""})):z("",!0),g(ie,{style:{"max-height":"50vh"},class:"body scroll"},{default:k(()=>[U("div",{innerHTML:e.marked.parse(e.$t(e.step.message||""))},null,8,Ln)]),_:1}),g(oe),e.step.buttons!==!1?(S(),E(Le,{key:1,class:"nowrap"},{default:k(()=>[g(L,{onClick:e.skipStep,flat:"",label:e.$t("Skip"),color:"accent"},null,8,["onClick","label"]),g(Pe),e.step.secondaryAction===void 0?A((S(),E(L,{key:0,onClick:e.previousStep,flat:"",label:e.$t("Previous"),color:"secondary"},null,8,["onClick","label"])),[[O,!e.isFirst]]):A((S(),E(L,{key:1,onClick:t[1]||(t[1]=n=>e.step.secondaryAction({step:e.step,previousStep:e.previousStep,nextStep:e.nextStep,finishTour:e.finishTour,skipStep:e.skipStep})),flat:"",label:e.$t(e.step.secondaryButton),color:"secondary"},null,8,["label"])),[[O,!e.isFirst]]),e.step.primaryButton===void 0?A((S(),E(L,{key:2,onClick:e.nextStep,flat:"",label:e.$t("Next"),color:"primary"},null,8,["onClick","label"])),[[O,!e.isLast]]):z("",!0),e.step.primaryButton===void 0?A((S(),E(L,{key:3,onClick:e.finishTour,label:e.$t("Finish"),color:"primary"},null,8,["onClick","label"])),[[O,e.isLast]]):A((S(),E(L,{key:4,onClick:t[2]||(t[2]=n=>e.step.primaryAction({step:e.step,previousStep:e.previousStep,nextStep:e.nextStep,finishTour:e.finishTour,skipStep:e.skipStep})),flat:"",label:e.$t(e.step.primaryButton),color:"primary"},null,8,["label"])),[[O,!e.isFirst]])]),_:1})):z("",!0)]),_:1})):z("",!0)],512)],64)}var On=Y(Mn,[["render",An]]);const zn=K({name:"Jarvis",components:{DeviceDetailsPopup:Wt,Page:cn,tours:On},setup(){M.dev("DEBUG","Jarvis","setup()");const e=ee(),t=W(),s=h(()=>t.settings);e.iconMapFn=i=>{if(!i.startsWith("img:")&&!i.startsWith("mdi")&&i.indexOf(":")!==-1&&!i.startsWith("M"))return{cls:"iconify","data-icon":i}},ne(()=>s.value.scrollbars,()=>{M.dev("DEBUG","Jarvis","watch","scrollbar"),be("style",s.value.scrollbars==="desktop"&&(e.platform.is.desktop||e.platform.is.mobile)||s.value.scrollbars==="mobile"&&e.platform.is.mobile?Lt:" ",{id:"scrollbar",type:"text/css",onlyPro:!1})},{immediate:!0}),ne(e.screen.sizes,()=>{be("style",At.replace(/\$breakpoint-sm-min/g,e.screen.sizes.sm+"px").replace(/\$breakpoint-md-min/g,e.screen.sizes.md+"px"),{id:"responsive",type:"text/css",onlyPro:!1})},{immediate:!0});try{ne(()=>t.styles,()=>{M.dev("DEBUG","Jarvis","watch","styles"),$t("styles",t.styles,{tag:"link",src:"href",rel:"stylesheet"}).then(i=>be("style",i,{id:"css",type:"text/css"}))},{immediate:!0})}catch(i){console.warn("Jarvis-B7cq4T4m","Error injecting custom styles: "+i.message),console.debug("Jarvis-B7cq4T4m",t.styles)}const o=h(()=>t.layout||[]),a=h(()=>"page-"+t.getSelectedPageId);return{settings:s,pages:o,pageId:a}}});function Fn(e,t,s,o,a,i){const l=F("tours"),n=F("DeviceDetailsPopup"),r=F("Page");return S(),R(G,null,[g(l,{tour:"introduction",start:e.settings.tourIntroduction!==!0},null,8,["start"]),g(l,{tour:"interface",start:e.settings.tourIntroduction===!0&&e.settings.tourInterface!==!0},null,8,["start"]),g(n),g(We,{"model-value":e.pageId,"keep-alive":!0,style:{"background-color":"transparent"},vertical:""},{default:k(()=>[(S(!0),R(G,null,ae(e.pages,d=>(S(),E(Ne,{key:d.id,name:"page-"+d.id,style:{padding:"0",margin:"0"}},{default:k(()=>[g(r,{page:d},null,8,["page"])]),_:2},1032,["name"]))),128))]),_:1},8,["model-value"])],64)}var Kn=Y(zn,[["render",Fn]]);export{Kn as default};
