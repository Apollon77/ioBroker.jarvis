import{c as V,ak as q}from"./vendor.quasar-78ba37d9.js";import{d as G,u as f,p as h,z as Q,J as Z,r as I,o as r,a as p,g as u,b as w,v as k,h as P,i as X,j as Y,t as _,y as M,F as A,k as F,n as O,f as g,G as H}from"./vendor.vue-1bbf3cb4.js";import{M as x}from"./modules-9c8c454f.js";import{D as b}from"./controllers-596cf83c.js";import{F as y}from"./functions-9f904a0e.js";import{u as ee}from"./vendor.vue-i18n-e0977824.js";import{b as te}from"./vendor.vue-router-7a2a9812.js";import{u as ie}from"./stores-22cbae97.js";import{_ as oe}from"./helpers-7b53fe93.js";var le={"HomeKitTile#description":"Zeigt einen Datenpunkt-Wert im HomeKit-Kachel-Stil.","config#HomeKitTile#topLeft#label":"Oben links","config#HomeKitTile#topCenter#label":"Oben zentriert","config#HomeKitTile#topRight#label":"Oben rechts","config#HomeKitTile#middleLeft#label":"Mittig links","config#HomeKitTile#middleCenter#label":"Mittig zentriert","config#HomeKitTile#middleRight#label":"Mittig rechts","config#HomeKitTile#bottomLeft#label":"Unten links","config#HomeKitTile#bottomCenter#label":"Unten zentriert","config#HomeKitTile#bottomRight#label":"Unten rechts","config#HomeKitTile#action#label":"Aktion bei Klick","config#HomeKitTile#action#info":"F\xFChre die Aktion bei einem Klick auf die gesamte Fl\xE4che aus","Open Device Details (Popup)":"\xD6ffne Ger\xE4te-Details (Popup)","Open Page / Tab":"\xD6ffne Seite / Registerkarte","Open external Website":"\xD6ffne externe Webseite","Trigger Element":"F\xFChre Trigger Element Aktion aus","No Action":"Keine Aktion","Secondary States":"Sekund\xE4re States","config#HomeKitTile#website#label":"Webseite","config#HomeKitTile#jumper#label":"Springe zu Seite","config#HomeKitTile#jumper#info":"Springe zu einer Seite (bei Angabe der Tab-ID) oder zu einer spezifischen URL"},He=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"})),ne={"HomeKitTile#description":"Displays a state value in HomeKit tile style.","config#HomeKitTile#topLeft#label":"Top Left","config#HomeKitTile#topCenter#label":"Top Center","config#HomeKitTile#topRight#label":"Top Right","config#HomeKitTile#middleLeft#label":"Middle Left","config#HomeKitTile#middleCenter#label":"Middle Center","config#HomeKitTile#middleRight#label":"Middle Right","config#HomeKitTile#bottomLeft#label":"Bottom Left","config#HomeKitTile#bottomCenter#label":"Bottom Center","config#HomeKitTile#bottomRight#label":"Bottom Right","config#HomeKitTile#action#label":"Action on Click","config#HomeKitTile#action#info":"Apply action when clicking the tile","config#HomeKitTile#website#label":"Website","config#HomeKitTile#jumper#label":"Jump to page","config#HomeKitTile#jumper#info":"Jump to a page (by giving a tab ID) or to a specific URL"},he=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"})),ae={"HomeKitTile#description":"\u041E\u0442\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0432 \u0441\u0442\u0438\u043B\u0435 HomeKit","config#HomeKitTile#topLeft#label":"\u0421\u0432\u0435\u0440\u0445\u0443 \u0441\u043B\u0435\u0432\u0430","config#HomeKitTile#topCenter#label":"\u0421\u0432\u0435\u0440\u0445\u0443 \u043F\u043E \u0446\u0435\u043D\u0442\u0440\u0443","config#HomeKitTile#topRight#label":"\u0421\u0432\u0435\u0440\u0445\u0443 \u0441\u043F\u0440\u0430\u0432\u0430","config#HomeKitTile#middleLeft#label":"\u0412 \u0441\u0435\u0440\u0435\u0434\u0438\u043D\u0435 \u0441\u043B\u0435\u0432\u0430","config#HomeKitTile#middleCenter#label":"\u0412 \u0441\u0435\u0440\u0435\u0434\u0438\u043D\u0435 \u043F\u043E \u0446\u0435\u043D\u0442\u0440\u0443","config#HomeKitTile#middleRight#label":"\u0412 \u0441\u0435\u0440\u0435\u0434\u0438\u043D\u0435 \u0441\u043F\u0440\u0430\u0432\u0430","config#HomeKitTile#bottomLeft#label":"\u0421\u043D\u0438\u0437\u0443 \u0441\u043B\u0435\u0432\u0430","config#HomeKitTile#bottomCenter#label":"\u0421\u043D\u0438\u0437\u0443 \u043F\u043E \u0446\u0435\u043D\u0442\u0440\u0443","config#HomeKitTile#bottomRight#label":"\u0421\u043D\u0438\u0437\u0443 \u0441\u043F\u0440\u0430\u0432\u0430","config#HomeKitTile#action#label":"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043F\u043E \u043A\u043B\u0438\u043A\u0443","config#HomeKitTile#action#info":"\u0412\u044B\u043F\u043E\u043B\u043D\u0438\u0442\u044C \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043F\u043E \u043A\u043B\u0438\u043A\u0443 \u043D\u0430 \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u0435","Open Device Details (Popup)":"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u0443\u0441\u0442\u0440\u043E\u0439\u0441\u0442\u0432\u0430 (Popup)","Open Page / Tab":"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443 / \u0432\u043A\u043B\u0430\u0434\u043A\u0443","Open external Website":"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0432\u043D\u0435\u0448\u043D\u0438\u0439 \u0441\u0430\u0439\u0442","Trigger Element":"\u0422\u0440\u0438\u0433\u0433\u0435\u0440","No Action":"\u041D\u0435\u0442 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F","Secondary States":"\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u044B","config#HomeKitTile#website#label":"\u0421\u0430\u0439\u0442","config#HomeKitTile#jumper#label":"\u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u043D\u0430 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443","config#HomeKitTile#jumper#info":"\u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u043D\u0430 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0443 (\u043F\u043E \u0435\u0435 \u0438\u0434\u0435\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u043E\u0440\u0443) \u0438\u043B\u0438 \u043D\u0430 \u0443\u043A\u0430\u0437\u0430\u043D\u043D\u044B\u0439 URL"},De=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));const re={addGroup:!1,addDivider:!1,addDevice:{max:1,fields:["label","bodyStateKey","bodyElement","primaryStateKey","actionElement","secondaryStatesKeys"]}},d=[{value:"",label:""},{value:"icon",label:"Icon (State)"},{value:"deviceIcon",label:"Icon (Device)"},{value:"label",label:"Label"},{value:"state",label:"State"},{value:"bodyElement",label:"Body Element"},{value:"actionElement",label:"Trigger Element"},{value:"secondaryStates",label:"Secondary States"}];var B=[{columns:2,parameter:"topLeft",label:"config#HomeKitTile#topLeft#label",type:"Select",options:d,value:"icon"},{columns:2,parameter:"topCenter",label:"config#HomeKitTile#topCenter#label",type:"Select",options:d},{columns:2,parameter:"topRight",label:"config#HomeKitTile#topRight#label",type:"Select",options:d},{columns:1,type:"placeholder"},{columns:5,parameter:"action",label:"config#HomeKitTile#action#label",type:"Select",options:[{translate:"Open Device Details (Popup)",value:"popup"},{translate:"Trigger Action",value:"trigger"},{translate:"Open Page / Tab",value:"page"},{translate:"Open external Website",value:"website"},{translate:"No Action",value:"none"}],value:"popup"},{columns:2,parameter:"middleLeft",label:"config#HomeKitTile#middleLeft#label",type:"Select",options:d,value:"label"},{columns:2,parameter:"middleCenter",label:"config#HomeKitTile#middleCenter#label",type:"Select",options:d},{columns:2,parameter:"middleRight",label:"config#HomeKitTile#middleRight#label",type:"Select",options:d},{columns:1,type:"placeholder"},{columns:5,parameter:"jumper",label:"config#HomeKitTile#jumper#label",info:"config#HomeKitTile#jumper#info",type:"Select",options:(e,{jarvis:v})=>v.getPagesWithTabs,value:"",dependencies:{action:"page"}},{columns:5,parameter:"website",label:"config#HomeKitTile#website#label",value:"",dependencies:{action:"website"}},{columns:5,type:"placeholder",dependencies:{action:[void 0,null,"","none","popup","trigger"]}},{columns:2,parameter:"bottomLeft",label:"config#HomeKitTile#bottomLeft#label",type:"Select",options:d,value:"actionElement"},{columns:2,parameter:"bottomCenter",label:"config#HomeKitTile#bottomCenter#label",type:"Select",options:d},{columns:2,parameter:"bottomRight",label:"config#HomeKitTile#bottomRight#label",type:"Select",options:d},{columns:6,type:"placeholder"}],we=Object.freeze(Object.defineProperty({__proto__:null,Settings:re,default:B},Symbol.toStringTag,{value:"Module"}));const{capitalize:se}=q,me=G({name:"ModuleHomeKitTile",props:["_containerSize","widget"],setup(e){const v=ee(),E=te(),j=ie(),L=f(()=>e.widget.config),s=f(()=>({...x.joinConfig(L.value,B)})),o=f(()=>e.widget.items&&e.widget.items[0]||{}),c=f(()=>b.get(o.value.deviceId)),i=h({}),l=h({}),K=f(()=>({on:"true",off:"false",...i.value&&i.value.properties||{}})),R=f(()=>i.value&&i.value.val!==void 0&&i.value.val.toString()===K.value.on.toString()),W=(t,n,a,m)=>{if(S.value=!0,t){T.value=t;return}i.value=m},U=(t,n,a,m)=>{if(S.value=!0,t){T.value=t;return}l.value=m},N=f(()=>{let t=i.value&&i.value.bodyStyle;if(!t)return"";if(typeof t=="string"){t.indexOf("{")!==-1&&t.indexOf("}")!==-1&&(t=t.replace("{","").replace("}",""));const n={};return t.split(";").forEach(a=>{const[m,D]=a.split(":");n[m.trim()]=D.trim()}),n}try{return t}catch{return""}}),S=h(!1),T=h();let C=[];Q(()=>{c.value?o.value.bodyStateKey||o.value.primaryStateKey?(o.value.primaryStateKey&&(C=C.concat(b.listen(c.value.id,o.value.primaryStateKey,W))),o.value.bodyStateKey&&(C=C.concat(b.listen(c.value.id,o.value.bodyStateKey,U)))):S.value=!0:(T.value="HomeKitTile: "+v.t("Device {deviceId} not found").replace("{deviceId}",o.value.deviceId),console.warn(T.value),S.value=!0)}),Z(()=>b.unlisten(C));const z=(t,n,a)=>{if(Array.isArray(a))return a.some(D=>z(t,n,D));const m=s.value[t+se(n)];return m===null?!1:a==="secondaryStates"?m===a&&o.value.secondaryStatesKeys:a==="state"?m===a&&o.value.primaryStateKey:a==="bodyElement"?m===a&&o.value.bodyStateKey&&o.value.bodyElement:a==="actionElement"?m===a&&o.value.primaryStateKey&&o.value.actionElement:m===a},$=(t,n="action",a="State")=>y.Components[t]&&y.Components[t][n][a]||y.Components._defaults&&y.Components._defaults[n][a]||null,J=()=>{if(s.value.action==="website"&&(s.value.website.indexOf("http")>-1||s.value.website.indexOf("www")>-1))window.open((s.value.website.indexOf("http")===-1?"http://":"")+s.value.website,"_blank");else if(s.value.action==="page"&&s.value.jumper)E.push({params:{tabId:s.value.jumper}}).catch(t=>console.warn(t));else if(s.value.action==="popup"&&c.value)j.set({selectedDeviceId:c.value.id});else if(c.value&&s.value.action==="trigger"&&o.value.primaryStateKey){const t=R.value?K.value.setOff:K.value.setOn;let n=R.value?K.value.off:K.value.on;n=typeof n=="string"&&(n==="true"||n==="false")?n==="true":n,b.set(c.value.id,o.value.primaryStateKey,t!==void 0?t:n)}};return{FunctionsComponents:y.Components,FunctionsIcons:y.Icons,horizontal:["left","center","right"],vertical:["top","middle","bottom"],moduleConfig:s,loaded:S,error:T,device:c,deviceConfig:o,primaryState:i,bodyState:l,bodyStyle:N,setDevice:b.set,getComponent:$,hasElement:z,jump:J}}}),ce=["v-ripple"],ue={key:0,class:"q-focus-helper"};function de(e,v,E,j,L,s){const o=I("alert"),c=I("icon");return r(),p("div",{class:O(["HomeKitTile grid",{"cursor-pointer":e.moduleConfig.action&&e.moduleConfig.action!=="none","q-hoverable":e.moduleConfig.action&&e.moduleConfig.action!=="none"}]),style:M({height:e._containerSize.height+"px",width:e._containerSize.width+"px"}),onClick:v[0]||(v[0]=(...i)=>e.jump&&e.jump(...i)),"v-ripple":e.moduleConfig.action&&e.moduleConfig.action!=="none"},[e.moduleConfig.action&&e.moduleConfig.action!=="none"?(r(),p("span",ue)):u("",!0),w(P(V,{indeterminate:""},null,512),[[k,!e.loaded&&!e.error]]),w(P(o,null,{default:X(()=>[Y(_(e.error),1)]),_:1},512),[[k,e.loaded&&e.error]]),e.device?w((r(),p("div",{key:1,class:"q-pa-sm full-height",style:M(e.bodyStyle)},[(r(!0),p(A,null,F(e.vertical,i=>(r(),p("div",{key:i,class:O([i,"item row nowrap"])},[(r(!0),p(A,null,F(e.horizontal,l=>(r(),p("div",{key:l,class:O(["col-grow",l])},[e.hasElement(i,l,"icon")?(r(),g(c,{key:0,alignment:l,styles:e.primaryState.iconStyle||{},loading:!e.loaded,name:e.primaryState.icon,color:"primary",IconButton:""},null,8,["alignment","styles","loading","name"])):u("",!0),e.hasElement(i,l,"deviceIcon")?(r(),g(c,{key:1,alignment:l,styles:e.primaryState.iconStyle||{},loading:!e.loaded,name:e.device.icon||e.FunctionsIcons[e.device.function],color:"primary",IconButton:""},null,8,["alignment","styles","loading","name"])):u("",!0),e.hasElement(i,l,"label")?(r(),g(H(e.FunctionsComponents._defaults.components.Title),{key:2,alignment:l,device:e.device,state:e.bodyState,stateKey:e.deviceConfig.bodyStateKey,deviceConfig:e.deviceConfig,onSetDevice:e.setDevice},null,40,["alignment","device","state","stateKey","deviceConfig","onSetDevice"])):u("",!0),e.hasElement(i,l,"secondaryStates")?(r(),g(H(e.FunctionsComponents._defaults.components.SecondaryStates),{key:3,alignment:l,device:e.device,state:e.primaryState,stateKey:e.deviceConfig.primaryStateKey,deviceConfig:e.deviceConfig,onSetDevice:e.setDevice},null,40,["alignment","device","state","stateKey","deviceConfig","onSetDevice"])):u("",!0),e.hasElement(i,l,"state")?(r(),g(H(e.FunctionsComponents._defaults.components.State),{key:4,alignment:l,device:e.device,state:e.primaryState,stateKey:e.deviceConfig.primaryStateKey,deviceConfig:e.deviceConfig,onSetDevice:e.setDevice},null,40,["alignment","device","state","stateKey","deviceConfig","onSetDevice"])):u("",!0),e.hasElement(i,l,"bodyElement")?(r(),g(H(e.getComponent(e.device.function,"body",e.deviceConfig.bodyElement)),{key:5,alignment:l,device:e.device,state:e.bodyState,stateKey:e.deviceConfig.bodyStateKey,deviceConfig:e.deviceConfig,onSetDevice:e.setDevice},null,40,["alignment","device","state","stateKey","deviceConfig","onSetDevice"])):u("",!0),e.hasElement(i,l,"actionElement")?(r(),g(H(e.getComponent(e.device.function,"action",e.deviceConfig.actionElement)),{key:6,alignment:l,device:e.device,state:e.primaryState,stateKey:e.deviceConfig.primaryStateKey,deviceConfig:e.deviceConfig,onSetDevice:e.setDevice},null,40,["alignment","device","state","stateKey","deviceConfig","onSetDevice"])):u("",!0)],2))),128))],2))),128))],4)),[[k,e.loaded&&!e.error]]):u("",!0)],14,ce)}var fe=oe(me,[["render",de],["__scopeId","data-v-7ef281c9"]]),ke=Object.freeze(Object.defineProperty({__proto__:null,default:fe},Symbol.toStringTag,{value:"Module"}));export{ke as H,He as _,he as a,De as b,we as c};
