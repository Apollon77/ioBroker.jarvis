var we=Object.defineProperty,ke=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var ve=(e,o,i)=>o in e?we(e,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[o]=i,X=(e,o)=>{for(var i in o||(o={}))Oe.call(o,i)&&ve(e,i,o[i]);if(me)for(var i of me(o))Se.call(o,i)&&ve(e,i,o[i]);return e},oe=(e,o)=>ke(e,Ie(o));import{Q as We}from"./QToolbarTitle-222a6e76.js";import{Q as Te}from"./QToolbar-5d8fb732.js";import{x as le,ab as ce,cB as te,a0 as B,C as ge,cJ as ue,a as L,dg as _e,dh as ze,_ as ne,dd as ae,m as P,o as g,f as O,q as l,w as t,b as T,ak as fe,g as s,t as r,U as Q,al as M,N as S,ah as W,ad as Pe,F as N,s as U,O as F,R as $,ag as j,l as w,cX as De,S as ee,k as H,am as Le,aj as Ee,a8 as je,cE as qe,u as K,j as J,n as Z,v as ye,M as he,cG as Ae,cH as Qe,di as Fe,dj as He,L as Ve,dk as Be,c$ as Re}from"./index-c6b5b085.js";import{Q as ie}from"./QBtnDropdown-21168549.js";import{D as be,a as Ce}from"./useDragDrop-1248b66d.js";import{J as Me}from"./json-editor-3f4e3b09.js";import{Q as re}from"./QTooltip-2f29a30f.js";import{Q as $e}from"./QExpansionItem-eb8b2646.js";import{Q as Ne}from"./QSpace-5beab9c3.js";import{W as Ue}from"./WidgetPage-36ae8861.js";import"./_commonjsHelpers-45ea234c.js";import"./vue.runtime.esm-bundler-5c684e22.js";import"./QSlideTransition-467c1fee.js";const Je=le({name:"WidgetPopup",props:["widget"],emits:["onClose","onSave"],components:{WidgetPage:Ue},setup(e,{emit:o}){const i=ce(),q=te(),D=[{label:i.t("top aligned"),value:"top"},{label:i.t("middle aligned"),value:"middle"},{label:i.t("bottom aligned"),value:"bottom"}],I=[{label:i.t("left aligned"),value:"left"},{label:i.t("center aligned"),value:"center"},{label:i.t("right aligned"),value:"right"},{label:i.t("fill full width"),value:"fill-width"}];let u={};Object.values(q.widgets).forEach(y=>{u[y.module]=u[y.module]||{label:y.module,widgets:[]},y._deleted!==!0&&u[y.module].widgets.push(oe(X({},y),{value:y.id,label:y.label?y.label+" "+(y.title?"("+y.title+")":""):y.title||""}))}),u=Object.values(u);const c=B(u),p=B(null);ge(()=>e.widget,y=>{p.value=y?ue(X({items:[]},y)):null});const k=L(()=>p.value.scaleToFitContents!==void 0?p.value.scaleToFitContents:!0),n=L(()=>p.value.alignmentVertical||"top"),d=L(()=>p.value.alignmentHorizontal||"center"),b=L(()=>p.value.allowFullscreen||!1),a=L(()=>p.value.items?p.value.items.map(y=>q.widgets[y]||{}):[]),_=(y,pe)=>{let de=u;y&&(y=y.toLowerCase(),de=[],u.forEach(Y=>{const R=[];Y.widgets.forEach(x=>{(x.module&&x.module.toLowerCase().indexOf(y)!==-1||x.title&&x.title.toLowerCase().indexOf(y)!==-1||x.label&&x.label.toLowerCase().indexOf(y)!==-1)&&R.push(x)}),R.length>0&&de.push({label:Y.label+" ("+R.length+")",widgets:R})})),pe(()=>{c.value=de.sort((Y,R)=>(Y=Y.label?Y.label.toLowerCase():"",R=R.label?R.label.toLowerCase():"",Y===R?0:Y>R?1:-1))})},m=B(null);let z=!1;const V=y=>{p.value[y.id]=y.value},v=y=>{y&&z===!0&&h({id:m.value}),z=!1,m.value=null},C=()=>{p.value=null,o("onClose")},f=()=>{o("onSave",p.value),C()},A=B(),h=y=>{p.value.items.push(y.id),A.value.hidePopup()};return{ScaleExceptions:_e,AlignmentExceptions:ze,alignmentHorizontal:I,alignmentVertical:D,inputValueAlignmentHorizontal:d,inputValueAlignmentVertical:n,inputScaleToFitContents:k,inputValueAllowFullscreen:b,onChange:V,onClose:v,onCancel:C,onSave:f,onFilter:_,itemList:a,widgetListFiltered:c,selectedWidgetId:m,container:p,addWidgetElement:A,assignWidget:h,addWidget:()=>{z=!0,m.value=ae()},editWidget:y=>{m.value=y},deleteWidget:y=>{confirm(i.t("Really delete item?"))&&p.value.items.splice(p.value.items.indexOf(y),1)}}}}),Ge={class:"text-h6"},Ye={class:"text-h7 primary q-ma-sm"},Xe={class:"row"},Ke={class:"col"},Ze={class:"col-1",style:{"text-align":"center","line-height":"56px"}},xe={class:"col-3",style:{"text-align":"center","line-height":"56px"}},el={key:0},ll={class:"row items-center"},tl={class:"text-h7 primary q-ma-sm",style:{"margin-top":"16px"}},nl={class:"row q-pb-xs"},ol={class:"col"},al={class:"col"},il={class:"col"},sl={class:"col"};function dl(e,o,i,q,D,I){const u=P("widget-page"),c=P("icon"),p=P("inputs");return g(),O("div",null,[l(u,{onOnClose:e.onClose,widgetId:e.selectedWidgetId},null,8,["onOnClose","widgetId"]),l(je,{"model-value":e.container!==null,persistent:""},{default:t(()=>[e.container?(g(),T(Ee,{key:0,class:"column",style:{width:"1200px","max-width":"90vw"}},{default:t(()=>[l(fe,{class:"row items-center"},{default:t(()=>[s("div",Ge,r(e.$t("Assign Widget to Box")),1),l(Ne),l(Q,{flat:"",round:"",color:"grey",icon:"close",onClick:e.onCancel},null,8,["onClick"])]),_:1}),l(M),l(fe,{class:"col defaultPadding-2 q-pt-none scroll body"},{default:t(()=>[s("div",Ye,r(e.$t("Widget")),1),l(M,{style:{margin:"0 0 8px 0"}}),S(s("div",Xe,[s("div",Ke,[l(Pe,{onFilter:e.onFilter,ref:"addWidgetElement",label:e.$t("Assign Widget"),options:e.widgetListFiltered,"model-value":"","use-input":"","stack-label":"",style:{margin:"0 8px"}},{option:t(k=>[l($e,{"expand-separator":"","header-class":"text-weight-bold",label:k.opt.label},{default:t(()=>[(g(!0),O(N,null,U(k.opt.widgets,n=>S((g(),T(F,{key:n.id,clickable:"",onClick:d=>e.assignWidget(n)},{default:t(()=>[l($,null,{default:t(()=>[n.label?(g(),T(j,{key:0,class:"q-ml-md"},{default:t(()=>[w(r(n.label),1)]),_:2},1024)):(g(),T(j,{key:1,class:"q-ml-md"},{default:t(()=>[s("em",null,"("+r(e.$t("no title"))+")",1)]),_:1})),l(j,{class:"q-ml-md",caption:""},{default:t(()=>[w(r(n.id),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[De]])),128))]),_:2},1032,["label"])]),_:1},8,["onFilter","label","options"])]),s("div",Ze,r(e.$t("or")),1),s("div",xe,[l(Q,{color:"primary",icon:"mdi-plus-circle",label:e.$t("Add Widget"),onClick:e.addWidget},null,8,["label","onClick"])])],512),[[W,e.itemList.length===0]]),l(ee,null,{default:t(()=>[(g(!0),O(N,null,U(e.itemList,(k,n)=>(g(),T(F,{key:k.id+"-"+n,class:"list-group-item"},{default:t(()=>[k.icon?(g(),T($,{key:0,avatar:""},{default:t(()=>[l(c,{color:"primary",name:k.icon},null,8,["name"])]),_:2},1024)):H("",!0),l($,null,{default:t(()=>[l(j,null,{default:t(()=>[w(r(k.label||k.title||e.$t("no title"))+" ",1),k._deleted?(g(),O("em",el,"[ "+r(e.$t("deleted"))+" ]",1)):H("",!0)]),_:2},1024),l(j,{caption:""},{default:t(()=>[w("Widget ID: "+r(k.id)+", Module: "+r(k.module),1)]),_:2},1024)]),_:2},1024),l($,{side:""},{default:t(()=>[s("div",ll,[k._deleted!==!0?(g(),T(Q,{key:0,size:"sm",flat:"",round:"",onClick:d=>e.editWidget(k.id),icon:"mdi-pencil"},null,8,["onClick"])):H("",!0),l(Q,{size:"sm",flat:"",round:"",onClick:d=>e.deleteWidget(k.id),icon:"mdi-delete",color:"negative"},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),s("div",tl,r(e.$t("Options")),1),l(M,{style:{margin:"0 0 8px 0"}}),s("div",nl,[s("div",ol,[S(l(p,{icon:"mdi-fit-to-page",onOnChange:e.onChange,id:"scaleToFitContents",label:"Scale contents to fit widget",type:"switch",value:e.inputScaleToFitContents},null,8,["onOnChange","value"]),[[W,e.itemList[0]&&e.ScaleExceptions.includes(e.itemList[0].module)===!1]]),S(s("em",{class:"q-mx-md"},r(e.$t("No Options")),513),[[W,!(e.itemList[0]&&e.ScaleExceptions.includes(e.itemList[0].module)===!1&&e.AlignmentExceptions.includes(e.itemList[0].module)===!1)]])]),s("div",al,[l(p,{icon:"mdi-resize",onOnChange:e.onChange,id:"allowFullscreen",label:"Allow fullscreen",type:"switch",value:e.inputValueAllowFullscreen},null,8,["onOnChange","value"])]),s("div",il,[S(l(p,{icon:"mdi-arrow-split-horizontal",onOnSelect:e.onChange,id:"alignmentVertical",label:"Vertical alignment",type:"select",options:e.alignmentVertical,value:e.inputValueAlignmentVertical},null,8,["onOnSelect","options","value"]),[[W,e.itemList[0]&&e.AlignmentExceptions.includes(e.itemList[0].module)===!1]])]),s("div",sl,[S(l(p,{icon:"mdi-arrow-split-vertical",onOnSelect:e.onChange,id:"alignmentHorizontal",label:"Horizontal alignment",type:"select",options:e.alignmentHorizontal,value:e.inputValueAlignmentHorizontal},null,8,["onOnSelect","options","value"]),[[W,e.itemList[0]&&e.AlignmentExceptions.includes(e.itemList[0].module)===!1]])])])]),_:1}),l(M),l(Le,{align:"right"},{default:t(()=>[l(Q,{flat:"",label:e.$t("Cancel"),color:"negative",onClick:e.onCancel},null,8,["label","onClick"]),l(Q,{flat:"",label:e.$t("Apply"),color:"primary",onClick:e.onSave},null,8,["label","onClick"])]),_:1})]),_:1})):H("",!0)]),_:1},8,["model-value"])])}var rl=ne(Je,[["render",dl]]);const ul=le({name:"WidgetSection",props:["pageId","tabId","id","label","icon","fullscreen","widgetEdges","widgetConfig","items"],components:{WidgetPopup:rl},setup(e){const o=ce(),i=te(),q=[{id:"copy",icon:"mdi-content-copy",label:o.t("copy")},{id:"duplicate",icon:"mdi-content-duplicate",label:o.t("duplicate")}],D=L(()=>e.id!=="desktop"&&e.widgetConfig[e.id+"SameAs"]!=="specific-layout"),I=L(()=>[{label:o.t("wie Desktop"),value:"desktop"},{label:o.t("wie Smartphone"),value:"smartphone"},{label:o.t("eigenes Layout"),value:"specific-layout"}].filter(f=>f.value!==e.id));ge(()=>e.fullscreen,f=>f===!0&&b.value.length===0&&m());const u=f=>{i.setWidgetConfig({pageId:e.pageId,tabId:e.tabId,key:f.id,val:f.value})},c=B({}),p=(f,A,h,E,G)=>{c.value[f]=c.value[f]||{width:(100/(12/h)).toFixed(2),height:E}},k=(f,A,h,E,G)=>{c.value[f]={width:(100/(12/h)).toFixed(2),height:E}},n=f=>i.widgets[f]||{items:[]},d=f=>!f||f.length===0?o.t("No widgets assigned"):f.map(A=>{const h=n(A);h.items=h.items||[];const E=h.items.filter(G=>G.type==="divider").length;return h.module+(!h.label&&!h.title?"":" ("+(h.label||h.title)+(h.module!=="StateList"?"":", "+h.items.length+" "+o.t("items")+" "+o.t("apprx.")+" "+((h.hideTitle!==!0?56:0)+E+(h.items.length-E)*46)+"px "+o.t("in height"))+")")}).join(", "),b=B(ue(e.items)||[]),a=f=>{i.setWidgets({pageId:e.pageId,tabId:e.tabId,key:"widgets"+qe(e.id),val:f})},_=B(),m=()=>{let f=0,A=0;for(const h of b.value){const E=h.y+h.h;E>A&&(A=E,f=h.x)}if(b.value.push({x:f,y:A,w:4,h:4,i:ae()}),_.value&&_.value[_.value.length-1]){const h=_.value[_.value.length-1].$el,{top:E,height:G}=h.getBoundingClientRect();h.parentElement.parentElement.scrollTo(0,E+G+1e3)}a(b.value)},z=f=>{const A=f.id,h=ue(b.value.find(E=>E.i===A));h.i=ae(),f.val==="copy"&&(h.items=h.items||[],h.items=h.items.map(E=>{const G=n(E),se=ae();return i.copyWidget({id:se,widget:G}),se})),b.value.push(h),a(b.value)},V=f=>{confirm(o.t("Really delete item?"))&&(b.value.splice(b.value.findIndex(h=>h.i===f),1),a(b.value))},v=B(null),C=f=>{b.value.splice(b.value.findIndex(A=>A.i===v.value.i),1,X(X({},v.value),f)),v.value=null,a(b.value)};return{gridItemElements:_,expanded:e.id==="desktop",copyMenu:q,onChange:u,onResize:p,onResized:k,widgets:b,widgetSizes:c,setWidgets:a,getWidgetsData:d,selectedWidget:v,addWidget:m,copyWidget:z,deleteWidget:V,saveWidgetAssignments:C,disabled:D,options:I}}}),cl={style:{padding:"0 16px 8px 16px","min-height":"64px"},class:"row"},gl={class:"grid-item tooltip-widget"},pl={class:"row justify-between"},ml={class:"row items-center",style:{"padding-left":"8px"}},vl={class:"row"},fl={style:{padding:"0 16px 8px 16px","min-height":"64px"},class:"row"},hl={class:"grid-layout-container",style:{height:"800px","overflow-y":"scroll"}},yl={class:"row justify-between"},bl={class:"row items-center",style:{"padding-left":"8px"}},Cl=w("\xA0 "),$l={key:0},wl={class:"row"},kl={class:"row q-pa-sm tooltip-widget",style:{overflow:"hidden"}};function Il(e,o,i,q,D,I){const u=P("widget-popup"),c=P("icon"),p=P("inputs"),k=P("grid-item"),n=P("grid-layout");return g(),O("div",null,[l(u,{onOnClose:o[0]||(o[0]=d=>e.selectedWidget=null),onOnSave:e.saveWidgetAssignments,widget:e.selectedWidget},null,8,["onOnSave","widget"]),l($e,{"onUpdate:modelValue":o[5]||(o[5]=d=>e.expanded=!e.expanded),"model-value":e.disabled!==!0?e.expanded:!1,class:"full-width paper",disable:e.disabled},{header:t(()=>[l($,{avatar:""},{default:t(()=>[l(c,{name:e.icon},null,8,["name"])]),_:1}),l($,{style:{height:"40px"}},{default:t(()=>[w(r(e.label),1)]),_:1}),e.id!=="desktop"?(g(),T($,{key:0,side:"",class:"notDisabled"},{default:t(()=>[l(p,{onOnSelect:e.onChange,type:"select",options:e.options,dense:"",label:e.$t("Use same layout as"),id:e.id+"SameAs",onClick:o[1]||(o[1]=K(()=>{},["prevent"])),value:e.widgetConfig[e.id+"SameAs"]||"desktop",style:{width:"150px"}},null,8,["onOnSelect","options","label","id","value"])]),_:1})):H("",!0)]),default:t(()=>[s("div",null,[S(s("div",null,[S(s("div",cl,[l(Q,{color:"secondary",icon:"mdi-plus-circle",label:e.$t("Add Widget"),onClick:e.addWidget,style:{margin:"auto 0"}},null,8,["label","onClick"])],512),[[W,e.widgets.length===0]]),l(M),S(s("div",gl,[s("div",pl,[s("div",ml,r(e.$t("Fullscreen")),1),s("div",vl,[l(Q,{size:"sm",flat:"",round:"",icon:"mdi-pencil",onClick:o[2]||(o[2]=d=>e.selectedWidget=e.widgets[0])})])])],512),[[W,e.widgets[0]!==void 0]])],512),[[W,e.fullscreen===!0]]),S(s("div",null,[s("div",fl,[l(Q,{color:"secondary",icon:"mdi-plus-circle",label:e.$t("Add Widget"),onClick:e.addWidget,style:{margin:"auto 0"}},null,8,["label","onClick"]),l(p,{dense:"",type:"switch",inline:"",label:e.$t("Height of all widgets equal to page height (no scrollbars)"),id:e.id+"FitPageHeight",onOnChange:e.onChange,value:e.widgetConfig[e.id+"FitPageHeight"]||!1,style:{margin:"auto 0 auto 16px"}},null,8,["label","id","onOnChange","value"]),S(l(p,{set:e.rowHeight=parseInt(e.widgetConfig[e.id+"FitPageHeight"]!==!0&&e.widgetConfig[e.id+"WidgetHeight"])||50,dense:"",type:"number",min:10,label:e.$t("Widget height")+" ("+e.$t("in pixels")+")",id:e.id+"WidgetHeight",onOnChange:e.onChange,value:e.widgetConfig[e.id+"WidgetHeight"]||50,style:{margin:"auto 0 auto 16px"}},null,8,["set","label","id","onOnChange","value"]),[[W,e.widgetConfig[e.id+"FitPageHeight"]!==!0]]),l(p,{set:e.gapSize=parseInt(e.widgetConfig[e.id+"GapSize"]||5),dense:"",type:"number",min:0,label:e.$t("Widget gaps")+" ("+e.$t("in pixels")+")",id:e.id+"GapSize",onOnChange:e.onChange,value:e.widgetConfig[e.id+"GapSize"]||5,style:{margin:"auto 0 auto 16px"}},null,8,["set","label","id","onOnChange","value"])]),l(M),s("div",hl,[l(n,{onLayoutUpdated:e.setWidgets,layout:e.widgets,"onUpdate:layout":o[4]||(o[4]=d=>e.widgets=d),"row-height":e.rowHeight,margin:[e.gapSize,e.gapSize],"use-css-transforms":!0,responsive:!1,preventCollision:!1,style:{"min-height":"50px"}},{default:t(()=>[(g(!0),O(N,null,U(e.widgets,(d,b)=>(g(),T(k,{key:d.i,ref_for:!0,ref:"gridItemElements",x:d.x,y:d.y,w:d.w,h:d.h,i:d.i,class:J(["grid-item tooltip-widget",{"rounded-borders":e.widgetEdges!==!0}]),onResized:e.onResized,onResize:e.onResize,onContainerResized:e.onResized},{default:t(()=>[l(re,{target:".tooltip-widget"},{default:t(()=>[w(r(e.getWidgetsData(d.items)),1)]),_:2},1024),s("div",yl,[s("div",bl,[s("span",{class:J("sort-"+b)},"[ "+r(b)+" ]",3),Cl,l(re,{target:".sort-"+b},{default:t(()=>[w(r(e.$t("Responsive Position"))+": "+r(b),1)]),_:2},1032,["target"]),w(" "+r(e.$t("Position")+": "+d.x+"x * "+d.y+"y")+" ",1),e.widgetSizes[d.i]?(g(),O("span",$l,"\xA0- "+r(e.$t("Size")+": "+d.w+"w ("+e.widgetSizes[d.i].width+"%) * "+d.h+"h ("+e.widgetSizes[d.i].height+"px)"),1)):H("",!0)]),s("div",wl,[l(p,{class:"q-ma-none",type:"button",round:"",icon:"mdi-pencil",tooltip:e.$t("edit"),onClick:K(a=>e.selectedWidget=d,["stop"])},null,8,["tooltip","onClick"]),l(p,{class:"q-ma-none",type:"button",round:"",icon:"mdi-content-copy",tooltip:e.$t("copy"),onClick:o[3]||(o[3]=K(()=>{},["stop"])),items:e.copyMenu,onOnSelect:e.copyWidget,id:d.i,denseMenu:""},null,8,["tooltip","items","onOnSelect","id"]),l(p,{class:"q-ma-none",type:"button",round:"",icon:"mdi-delete",tooltip:e.$t("delete"),color:"negative",onClick:K(a=>e.deleteWidget(d.i),["stop"])},null,8,["tooltip","onClick"])])]),s("div",kl,[w(r(e.getWidgetsData(d.items))+" ",1),l(re,null,{default:t(()=>[w(r(e.getWidgetsData(d.items)),1)]),_:2},1024)])]),_:2},1032,["x","y","w","h","i","class","onResized","onResize","onContainerResized"]))),128)),s("div",{class:"grid-spacer",style:Z({bottom:-3*e.rowHeight+"px",height:3*e.rowHeight+"px"})},null,4)]),_:1},8,["onLayoutUpdated","layout","row-height","margin"])])],512),[[W,e.fullscreen!==!0]])])]),_:1},8,["model-value","disable"])])}var Ol=ne(ul,[["render",Il]]);const Sl=le({name:"TabPage",props:["pageId","tabId"],components:{WidgetSection:Ol},setup(e){const o=te(),i=D=>{let I=D.value;try{I=I&&D.json!==void 0&&I.indexOf("{")>-1&&I.indexOf("}")>-1?JSON.parse(I):I}catch(u){console.warn(D.value,u)}o.editTab({pageId:e.pageId,tabId:e.tabId,key:D.id,val:I})},q=L(()=>(o.layout.find(u=>u.id===e.pageId)||{}).tabs.find(u=>u.id===e.tabId)||{});return{onChange:i,tab:q}}}),Wl={style:{padding:"0 8px"}},Tl={class:"text-h6 primary q-ma-sm"},_l={class:"row"},zl={class:"col"},Pl={class:"col"},Dl={class:"row"},Ll={class:"col"},El={class:"col"},jl={class:"col"},ql={class:"row"},Al={class:"col-2"},Ql={class:"col"},Fl={class:"text-h6 primary q-ma-sm",style:{"margin-top":"24px"}};function Hl(e,o,i,q,D,I){const u=P("inputs"),c=P("widget-section");return g(),O("div",Wl,[s("div",Tl,r(e.$t("Tab"))+": "+r(e.tab.title.default||Object.values(e.tab.title)[0])+" ("+r(e.$t("ID")+": "+e.tab.id)+")",1),s("div",_l,[s("div",zl,[l(u,{json:"",onOnChange:e.onChange,id:"icon",label:e.$t("Tab")+" "+e.$t("Icon"),value:e.tab.icon||"",icon:e.tab.icon},null,8,["onOnChange","label","value","icon"])]),s("div",Pl,[l(u,{json:"",onOnChange:e.onChange,id:"title",label:e.$t("Tab")+" "+e.$t("Title"),value:e.tab.title||""},null,8,["onOnChange","label","value"])])]),s("div",Dl,[s("div",Ll,[l(u,{type:"color",onOnChange:e.onChange,id:"iconColor",label:e.$t("Icon Color"),value:e.tab.iconColor||""},null,8,["onOnChange","label","value"])]),s("div",El,[l(u,{type:"color",onOnChange:e.onChange,id:"color",label:e.$t("Font Color"),value:e.tab.color||""},null,8,["onOnChange","label","value"])]),s("div",jl,[l(u,{type:"color",onOnChange:e.onChange,id:"backgroundColor",label:e.$t("Background Color"),value:e.tab.backgroundColor||""},null,8,["onOnChange","label","value"])])]),s("div",ql,[s("div",Al,[l(u,{type:"switch",inline:"",label:e.$t("Tab")+" "+e.$t("Fullscreen"),id:"fullscreen",onOnChange:e.onChange,value:e.tab.fullscreen||!1,style:{margin:"auto 0 auto 16px"}},null,8,["label","onOnChange","value"])]),s("div",Ql,[l(u,{type:"switch",inline:"",label:e.$t("Widgets edges (round or angled)"),id:"widgetEdges",onOnChange:e.onChange,value:e.tab.widgetEdges||!1,style:{margin:"auto 0 auto 16px"}},null,8,["label","onOnChange","value"])])]),s("div",Fl,r(e.$t("Widgets of tab"))+": "+r(e.tab.title.default||Object.values(e.tab.title)[0]),1),l(c,{pageId:e.pageId,tabId:e.tabId,id:"desktop",label:"Desktop",icon:"mdi-monitor",fullscreen:e.tab.fullscreen||!1,widgetEdges:e.tab.widgetEdges||!1,widgetConfig:e.tab.widgetConfig||{},items:e.tab.widgetsDesktop},null,8,["pageId","tabId","fullscreen","widgetEdges","widgetConfig","items"]),l(c,{pageId:e.pageId,tabId:e.tabId,id:"smartphone",label:"Smartphone",icon:"mdi-cellphone",fullscreen:e.tab.fullscreen||!1,widgetEdges:e.tab.widgetEdges||!1,widgetConfig:e.tab.widgetConfig||{},items:e.tab.widgetsSmartphone},null,8,["pageId","tabId","fullscreen","widgetEdges","widgetConfig","items"])])}var Vl=ne(Sl,[["render",Hl]]);const Bl=le({name:"DrawerPage",props:["pageId"],components:{Draggable:be,TabSection:Vl},setup(e,{emit:o}){var V;const i=te(),q=L(()=>{const v=[];return i.getPagesWithoutDeletions.forEach(C=>{C.id!==e.pageId&&v.push(X({id:C.id,label:C.title},C))}),v}),D=L(()=>i.layout.find(v=>v.id===e.pageId)||{}),I=L({get(){return(D.value.tabs||[]).map(C=>(C._hasIconBinding=typeof C.icon=="object",C._hasTitleBinding=typeof C.title=="object",C))},set(v){i.setTabs({pageId:e.pageId,tabs:v})}}),u=i.selectedTab?i.selectedTab:((V=D.value.tabs)==null?void 0:V[0])||{},c=B(u.id||null),p=B({}),k=(v,C)=>{console.warn(v,C),p.value[".tabOptions-move-"+v.id]=C};let n=null;ge(()=>e.pageId,()=>{var v,C;c.value=n||((C=(v=I.value)==null?void 0:v[0])==null?void 0:C.id)||null,n=null});const d=()=>{i.addTab({pageId:e.pageId}),c.value=I.value[I.value.length-1].id},b=(v,C=!1)=>{i.addTab({pageId:e.pageId,tabId:v,copyWidgets:C}),c.value=I.value[I.value.length-1].id},a=(v,C)=>{i.moveTab({pageId:e.pageId,tabId:v,destinationPageId:C}),c.value=v,n=v,o("onSelectPage",i.layout.find(f=>f.id===C)||{})},_=v=>{if(i.deleteTab({pageId:e.pageId,tabId:v}),c.value===v){const C=I.value.find(f=>f._deleted!==!0);c.value=C?C.id:null}},m=v=>{i.restoreTab({pageId:e.pageId,tabId:v}),c.value=v},z=v=>{let C=v.value;try{C=C&&v.json!==void 0&&v.value.indexOf("{")>-1&&v.value.indexOf("}")>-1?JSON.parse(v.value):v.value}catch(f){console.warn(v.value,f)}i.editDrawerItem({itemId:e.pageId,key:v.id,val:C})};return oe(X({},Ce()),{onChange:z,setRef:k,pages:q,page:D,tabs:I,tabOptions:p,selectedTab:c,addTab:d,copyTab:b,moveTab:a,deleteTab:_,restoreTab:m})}}),Rl={class:"text-h6 primary q-ma-sm"},Ml={class:"row"},Nl={key:0,class:"col"},Ul={class:"col"},Jl={class:"row"},Gl={key:0,class:"col"},Yl={class:"col"},Xl={class:"col"},Kl={key:0},Zl={class:"text-h6 primary q-ma-sm"},xl={class:"q-ma-sm row"},et={key:0},lt={key:1},tt={key:2},nt={key:3};function ot(e,o,i,q,D,I){const u=P("inputs"),c=P("icon"),p=P("draggable"),k=P("tab-section");return g(),O("div",{key:e.page.id},[s("div",Rl,r(e.$t("Page"))+": "+r(e.page.title.default||Object.values(e.page.title)[0])+" (ID: "+r(e.page.id)+")",1),s("div",Ml,[!e.page.type||e.page.type==="page"?(g(),O("div",Nl,[l(u,{json:"",onOnChange:e.onChange,id:"icon",label:e.$t("Icon"),value:e.page.icon||"",icon:e.page.icon},null,8,["onOnChange","label","value","icon"])])):H("",!0),s("div",Ul,[l(u,{json:"",onOnChange:e.onChange,id:"title",label:e.$t("Title"),value:e.page.title||""},null,8,["onOnChange","label","value"])])]),s("div",Jl,[!e.page.type||e.page.type==="page"?(g(),O("div",Gl,[l(u,{type:"color",onOnChange:e.onChange,id:"iconColor",label:e.$t("Icon Color"),value:e.page.iconColor||""},null,8,["onOnChange","label","value"])])):H("",!0),s("div",Yl,[l(u,{type:"color",onOnChange:e.onChange,id:"color",label:e.$t("Font Color"),value:e.page.color||""},null,8,["onOnChange","label","value"])]),s("div",Xl,[l(u,{type:"color",onOnChange:e.onChange,id:"backgroundColor",label:e.$t("Background Color"),value:e.page.backgroundColor||""},null,8,["onOnChange","label","value"])])]),!e.page.type||e.page.type==="page"?(g(),O("div",Kl,[s("div",Zl,r(e.$t("Tabs of page"))+": "+r(e.page.title.default||Object.values(e.page.title)[0]),1),s("div",xl,[l(Q,{color:"secondary",icon:"mdi-plus-circle",label:e.$t("Add Tab"),onClick:e.addTab},null,8,["label","onClick"]),l(u,{type:"switch",inline:"",label:e.$t("Do not show Tab Labels (only Icons)"),id:"hideLabels",onOnChange:e.onChange,value:e.page.hideLabels||!1,style:{margin:"auto 0 auto 16px"}},null,8,["label","onOnChange","value"])]),l(Qe,{modelValue:e.selectedTab,"onUpdate:modelValue":o[3]||(o[3]=n=>e.selectedTab=n),"inline-label":"","outside-arrows":"","mobile-arrows":"",class:"bg-primary text-white full-width",align:"left"},{default:t(()=>[l(p,ye({class:"list-group",tag:"div","component-data":{style:"display: flex; flex-wrap: wrap",tag:"div",type:"transition",name:e.drag?null:"flip-list"},modelValue:e.tabs,"onUpdate:modelValue":o[0]||(o[0]=n=>e.tabs=n)},e.dragOptions,{onStart:o[1]||(o[1]=n=>e.drag=!0),onEnd:o[2]||(o[2]=n=>e.drag=!1),"item-key":"id",handle:".dragndrop"}),{item:t(({element:n})=>[(g(),T(Ae,{key:n.id,name:n.id,style:Z({backgroundColor:n.backgroundColor}),class:J({"q-px-xs":!0,rowDeleted:n._deleted===!0}),disable:n._deleted===!0},{default:t(()=>[l(c,{size:"sm",name:"mdi-drag-vertical",class:"dragndrop",color:n.color},null,8,["color"]),n._hasIconBinding?(g(),O("div",et,[l(ie,{flat:"",dense:""},{label:t(()=>[l(c,{size:"xs",name:n.icon.default||Object.values(n.icon)[0],class:"tabIcon q-mr-xs",color:n.iconColor||n.color},null,8,["name","color"])]),default:t(()=>[l(ee,null,{default:t(()=>[(g(!0),O(N,null,U(n.icon,(d,b)=>(g(),T(F,{key:b},{default:t(()=>[l($,{avatar:""},{default:t(()=>[l(c,{size:"xs",name:d,class:"tabIcon q-mr-xs",color:n.iconColor||n.color},null,8,["name","color"])]),_:2},1024),l($,null,{default:t(()=>[l(j,null,{default:t(()=>[w(r(d),1)]),_:2},1024),l(j,{caption:""},{default:t(()=>[w(r(b),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])):(g(),O("div",lt,[l(c,{size:"xs",name:n.icon,class:"tabIcon q-mr-xs",color:n.iconColor||n.color},null,8,["name","color"])])),n._hasTitleBinding?(g(),O("div",tt,[l(ie,{flat:"",dense:"",label:n.title.default||Object.values(n.title)[0]},{default:t(()=>[l(ee,null,{default:t(()=>[(g(!0),O(N,null,U(n.title,(d,b)=>(g(),T(F,{key:b},{default:t(()=>[l($,null,{default:t(()=>[l(j,null,{default:t(()=>[w(r(d),1)]),_:2},1024),l(j,{caption:""},{default:t(()=>[w(r(b),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["label"])])):(g(),O("div",nt,[S(s("div",{class:"q-tab__label",style:Z({color:n.color})},r(n.title),5),[[W,e.page.hideLabels!==!0]])])),s("div",{class:"row items-center no-wrap",style:Z([{"margin-left":"16px"},{color:n.color}])},[l(M,{vertical:"",class:"q-ma-xs"}),S(l(u,{round:"",type:"button",icon:"mdi-restore",tooltip:e.$t("restore"),color:"positive",onClick:d=>e.restoreTab(n.id)},null,8,["tooltip","onClick"]),[[W,n._deleted===!0]]),S(l(Q,{class:J("tabOptions-"+n.id),dense:"",flat:"",round:"",color:"white",icon:"mdi-dots-vertical"},null,8,["class"]),[[W,n._deleted!==!0]]),l(he,{target:".tabOptions-"+n.id,anchor:"bottom left",self:"top left","auto-close":""},{default:t(()=>[S(l(F,{clickable:"",onClick:d=>e.copyTab(n.id,!0)},{default:t(()=>[l($,{avatar:""},{default:t(()=>[l(c,{size:"xs",name:"mdi-content-copy"})]),_:1}),l($,null,{default:t(()=>[w(r(e.$t("copy")),1)]),_:1})]),_:2},1032,["onClick"]),[[W,n._deleted!==!0]]),S(l(F,{clickable:"",onClick:d=>e.copyTab(n.id)},{default:t(()=>[l($,{avatar:""},{default:t(()=>[l(c,{size:"xs",name:"mdi-content-duplicate"})]),_:1}),l($,null,{default:t(()=>[w(r(e.$t("duplicate")),1)]),_:1})]),_:2},1032,["onClick"]),[[W,n._deleted!==!0]]),S(l(F,{class:J("tabOptions-move-"+n.id),onMouseover:d=>e.tabOptions[".tabOptions-move-"+n.id].show(),clickable:""},{default:t(()=>[l($,{avatar:""},{default:t(()=>[l(c,{size:"xs",name:"mdi-folder-move-outline"})]),_:1}),l($,null,{default:t(()=>[w(r(e.$t("move")),1)]),_:1}),l($,{side:""},{default:t(()=>[l(c,{name:"mdi-chevron-right"})]),_:1}),l(he,{ref:d=>e.setRef(n,d),anchor:"top end",self:"top start","auto-close":""},{default:t(()=>[l(ee,null,{default:t(()=>[(g(!0),O(N,null,U(e.pages,d=>(g(),T(F,{key:d.id,clickable:"",onClick:b=>e.moveTab(n.id,d.id)},{default:t(()=>[l($,{avatar:""},{default:t(()=>[l(c,{size:"xs",name:d.icon},null,8,["name"])]),_:2},1024),l($,null,{default:t(()=>[w(r(d.title),1)]),_:2},1024),l($,{side:""})]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1536)]),_:2},1032,["class","onMouseover"]),[[W,n._deleted!==!0&&e.pages.length>0]]),l(F,{clickable:"",style:{color:"#fff",background:"var(--q-negative)"},onClick:d=>e.deleteTab(n.id)},{default:t(()=>[l($,{avatar:""},{default:t(()=>[l(c,{size:"xs",name:"mdi-delete"})]),_:1}),l($,null,{default:t(()=>[w(r(e.$t("delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["target"])],4)]),_:2},1032,["name","style","class","disable"]))]),_:1},16,["component-data","modelValue"])]),_:1},8,["modelValue"]),l(He,{modelValue:e.selectedTab,"onUpdate:modelValue":o[4]||(o[4]=n=>e.selectedTab=n),animated:"","keep-alive":"",class:"border"},{default:t(()=>[(g(!0),O(N,null,U(e.tabs,n=>(g(),T(Fe,{key:n.id,name:n.id,style:{padding:"16px 0"},class:"body"},{default:t(()=>[l(k,{pageId:e.page.id,tabId:n.id},null,8,["pageId","tabId"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])):H("",!0)])}var at=ne(Bl,[["render",ot]]);const it=le({name:"LayoutsPage",components:{Draggable:be,DrawerSection:at,JsonEditor:Me},setup(){const e=ce(),o=Ve(),i=te(),q=[{id:"copy",icon:"mdi-content-copy",label:e.t("copy")},{id:"duplicate",icon:"mdi-content-duplicate",label:e.t("duplicate")}],D=m=>!m._error&&i.set({[m.id]:JSON.parse(m.value)}),I=m=>i.set({["settings."+m.id]:m.value}),u=L({get(){return(i.getLayout||[]).map(z=>(z._hasIconBinding=typeof z.icon=="object",z._hasTitleBinding=typeof z.title=="object",z))},set(m){i.setLayout(m)}}),c=B(i.selectedPage?i.selectedPage:i.getLayout.find(m=>m.type==="page"&&m._deleted!==!0)),p=m=>{c.value=m},k=()=>i.addDrawerItem({type:"divider"}),n=()=>i.addDrawerItem({type:"header",title:e.t("New Header")}),d=()=>{i.addDrawerItem({type:"page",icon:"mdi-file",title:e.t("New Page"),tabs:[]}),c.value=u.value[u.value.length-1],i.addTab({pageId:c.value.id})},b=m=>{const z=m.id;i.copyDrawerItem({itemId:z,copyWidgets:m.val==="copy"});const V=u.value[u.value.length-1];V.type==="page"&&(c.value=V)},a=m=>{i.deleteDrawerItem({itemId:m}),c.value.id===m&&(c.value=u.value.find(z=>z.type==="page"&&z._deleted!==!0))},_=m=>{i.restoreDrawerItem({itemId:m});const z=u.value.find(V=>V.id===m);z.type==="page"&&(c.value=z)};return oe(X({},Ce()),{copyMenu:q,json:L(()=>i.layout),settings:L(()=>i.settings),proWarning:L(()=>!Be.isPro()&&u.value.filter(m=>m.type==="page").length>1),pageHeight:L(()=>o.pageHeight),pagesWithoutDeletionsCount:L(()=>i.getPagesWithoutDeletions.length),onChangeSettings:I,onJsonEditor:D,onSelectPage:p,selectedPage:c,pages:u,addDivider:k,addHeader:n,addPage:d,copyItem:b,deleteItem:a,restoreItem:_})}}),st={class:"full-height LayoutsPage"},dt={class:"row no-wrap"},rt={class:"row",style:{"margin-bottom":"54px"}},ut={class:"col-3"},ct={class:"text-h6 primary q-ma-sm"},gt={key:0},pt={key:1},mt={key:1},vt={key:2},ft={class:"row items-center"},ht={class:"col-9"};function yt(e,o,i,q,D,I){const u=P("alert"),c=P("icon"),p=P("inputs"),k=P("draggable"),n=P("paper"),d=P("drawer-section"),b=P("json-editor");return g(),O("div",st,[s("div",dt,[l(Te,{class:"paper",style:{"min-height":"56px"}},{default:t(()=>[l(We,{shrink:""},{default:t(()=>[w(r(e.$t("Layout")),1)]),_:1})]),_:1})]),S(s("div",rt,[s("div",ut,[l(n,{class:"q-pa-sm"},{default:t(()=>[s("div",ct,r(e.$t("Drawer")+" / "+e.$t("Pages")),1),l(Re,null,{default:t(()=>[l(Q,{color:"primary",icon:"mdi-plus-circle",label:e.$t("Add Page"),onClick:e.addPage},null,8,["label","onClick"]),l(Q,{color:"secondary",icon:"mdi-plus-circle",label:e.$t("Add Header"),onClick:e.addHeader},null,8,["label","onClick"]),l(Q,{color:"secondary",icon:"mdi-plus-circle",label:e.$t("Add Divider"),onClick:e.addDivider},null,8,["label","onClick"])]),_:1}),S(l(u,{style:{margin:"16px 0 0 0"}},{default:t(()=>[w(r(e.$t("Only a single page is allowed without Pro. A single page may hold infinite tabs though."))+".",1)]),_:1},512),[[W,e.proWarning]]),l(M,{style:{margin:"16px 0"}}),l(ee,null,{default:t(()=>[l(k,ye({class:"list-group",tag:"div","component-data":{tag:"div",type:"transition",name:e.drag?null:"flip-list"},modelValue:e.pages,"onUpdate:modelValue":o[1]||(o[1]=a=>e.pages=a)},e.dragOptions,{onStart:o[2]||(o[2]=a=>e.drag=!0),onEnd:o[3]||(o[3]=a=>e.drag=!1),"item-key":"id",handle:".dragndrop"}),{item:t(({element:a})=>[(g(),T(F,{key:a.id,clickable:!a.type||a.type==="page"||a.type==="header",onClick:_=>e.onSelectPage(a),class:J({rowDeleted:a._deleted===!0,selected:e.selectedPage.id===a.id}),disable:a._deleted===!0},{default:t(()=>[l($,{avatar:"",center:""},{default:t(()=>[l(c,{size:"sm",name:"mdi-drag-horizontal",class:"dragndrop"})]),_:1}),!a.type||a.type==="page"?(g(),T($,{key:0,avatar:"",center:"",style:Z({backgroundColor:a.backgroundColor})},{default:t(()=>[a._hasIconBinding?(g(),O("div",gt,[l(ie,{flat:"",dense:""},{label:t(()=>[l(c,{name:a.icon.default||Object.values(a.icon)[0],color:e.selectedPage.id===a.id?"white":"primary",styles:{color:a.iconColor}},null,8,["name","color","styles"])]),default:t(()=>[l(ee,null,{default:t(()=>[(g(!0),O(N,null,U(a.icon,(_,m)=>(g(),T(F,{key:m},{default:t(()=>[l($,{avatar:""},{default:t(()=>[l(c,{size:"xs",name:_,class:"pageIcon q-mr-xs",color:a.iconColor||a.color},null,8,["name","color"])]),_:2},1024),l($,null,{default:t(()=>[l(j,null,{default:t(()=>[w(r(_),1)]),_:2},1024),l(j,{caption:""},{default:t(()=>[w(r(m),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])):(g(),O("div",pt,[l(c,{name:a.icon,color:e.selectedPage.id===a.id?"white":"primary",styles:{color:a.iconColor}},null,8,["name","color","styles"])]))]),_:2},1032,["style"])):H("",!0),l($,{class:J({itemDeleted:a._deleted===!0}),style:Z({backgroundColor:a.backgroundColor,color:a.color})},{default:t(()=>[a.type==="divider"?(g(),T(M,{key:0})):H("",!0),a._hasTitleBinding?(g(),O("div",mt,[l(ie,{flat:"",dense:"",label:a.title.default||Object.values(a.title)[0]},{default:t(()=>[l(ee,null,{default:t(()=>[(g(!0),O(N,null,U(a.title,(_,m)=>(g(),T(F,{key:m},{default:t(()=>[l($,null,{default:t(()=>[l(j,null,{default:t(()=>[w(r(_),1)]),_:2},1024),l(j,{caption:""},{default:t(()=>[w(r(m),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["label"])])):(g(),O("div",vt,[l(j,{class:J({header:a.type==="header"}),style:Z({color:a.color})},{default:t(()=>[w(r(a.title),1)]),_:2},1032,["class","style"])]))]),_:2},1032,["class","style"]),l($,{side:"",class:J({rowDeleted:a._deleted===!0,selected:e.selectedPage.id===a.id})},{default:t(()=>[s("div",ft,[a.type==="page"?S((g(),T(p,{key:0,type:"button",round:"",icon:"mdi-content-copy",tooltip:e.$t("copy"),onClick:o[0]||(o[0]=K(()=>{},["stop"])),items:e.copyMenu,onOnSelect:e.copyItem,id:a.id,denseMenu:""},null,8,["tooltip","items","onOnSelect","id"])),[[W,a.type!=="divider"&&a._deleted!==!0]]):S((g(),T(p,{key:1,type:"button",round:"",icon:"mdi-content-copy",tooltip:e.$t("copy"),onClick:K(_=>e.copyItem({id:a.id}),["stop"])},null,8,["tooltip","onClick"])),[[W,a.type!=="divider"&&a._deleted!==!0]]),S(l(p,{type:"button",round:"",icon:"mdi-delete",tooltip:e.$t("delete"),color:"negative",onClick:K(_=>e.deleteItem(a.id),["stop"])},null,8,["tooltip","onClick"]),[[W,(a.type&&a.type!=="page"||(!a.type||a.type==="page")&&e.pagesWithoutDeletionsCount>1)&&a._deleted!==!0]]),S(l(p,{type:"button",round:"",icon:"mdi-restore",tooltip:e.$t("restore"),color:"positive",onClick:K(_=>e.restoreItem(a.id),["stop"]),class:"restore"},null,8,["tooltip","onClick"]),[[W,a._deleted===!0]])])]),_:2},1032,["class"])]),_:2},1032,["clickable","onClick","class","disable"]))]),_:1},16,["component-data","modelValue"]),l(M),l(F,null,{default:t(()=>[l($,{avatar:"",center:""}),l($,{avatar:"",center:""},{default:t(()=>[l(c,{name:"mdi-cog",color:"primary"})]),_:1}),l($,null,{default:t(()=>[l(j,null,{default:t(()=>[w(r(e.$t("Configuration"))+" & "+r(e.$t("Help")),1)]),_:1}),l(j,{caption:""},{default:t(()=>[w(r(e.$t("show in sidebar")),1)]),_:1})]),_:1}),l($,{side:""},{default:t(()=>[l(p,{type:"Switch",inline:"",onOnChange:e.onChangeSettings,id:"drawerShowSettings",value:e.settings.drawerShowSettings},null,8,["onOnChange","value"])]),_:1})]),_:1})]),_:1})]),_:1})]),s("div",ht,[l(n,{class:"q-pa-sm"},{default:t(()=>[e.selectedPage&&e.selectedPage.id?(g(),T(d,{key:0,onOnSelectPage:e.onSelectPage,pageId:e.selectedPage.id},null,8,["onOnSelectPage","pageId"])):H("",!0)]),_:1})])],512),[[W,!e.settings.configExpertMode]]),S(l(n,{style:Z({height:e.pageHeight-66-16+"px"})},{default:t(()=>[l(b,{id:"layout",json:e.json,onOnChange:e.onJsonEditor},null,8,["json","onOnChange"])]),_:1},8,["style"]),[[W,e.settings.configExpertMode]])])}var Lt=ne(it,[["render",yt]]);export{Lt as default};
