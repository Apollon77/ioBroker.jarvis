import{bt as L,a4 as T,bM as H,Q as n,da as b,ed as w,k as d,dt as c,ao as C,aG as I,ay as u,W as v,b3 as f,bn as p,a2 as y,d1 as k,b1 as D,a1 as B,D as $,X as z,C as K}from"./index-6f5af1db.js";const N=T({name:"ModuleStateHTML",props:["widget","_containerSize"],setup(e){const m=H(),_=n(()=>e.widget.config);n(()=>({...b.joinConfig(_.value,w)}));const a=d(!1),t=d(null),i=d(),r=(o,E,G,S)=>{if(a.value=!0,o)return t.value=o&&o.message||o,t.value;S.value=S},s=n(()=>i.value&&i.value.val||""),M=n(()=>s.value&&typeof s.value=="string"&&s.value.indexOf("<script")>-1),l=e.widget.items&&e.widget.items[0]||{},g=c.get(l.deviceId);let h=[];return g?h=c.listen(g.id,l.primaryStateKey,r):(t.value=m.t("Device {deviceId} not found").replace("{deviceId}",l.deviceId),console.warn("StateHTML",t.value),a.value=!0),C(()=>c.unlisten(h)),{loaded:a,error:t,html:s,hasScript:M}}}),V={class:"jarvis-StateHTML StateHTML"},j=["innerHTML"],F=["srcdoc"];function Q(e,m,_,a,t,i){const r=I("alert");return u(),v("div",V,[f(y(k,{indeterminate:""},null,512),[[p,!e.loaded&&!e.error]]),f(y(r,null,{default:D(()=>[B($(e.error),1)]),_:1},512),[[p,e.loaded&&e.error]]),f(z("div",null,[e.hasScript?(u(),v("iframe",{key:1,class:"StateHTML-iFrame",style:K({border:0,height:e._containerSize.height+"px"}),srcdoc:e.html},null,12,F)):(u(),v("div",{key:0,innerHTML:e.html},null,8,j))],512),[[p,e.loaded&&!e.error]])])}var P=L(N,[["render",Q],["__scopeId","data-v-47feba1f"]]);export{P as default};
