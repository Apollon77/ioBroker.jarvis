var $=Object.defineProperty,Q=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var C=(e,t,s)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,E=(e,t)=>{for(var s in t||(t={}))b.call(t,s)&&C(e,s,t[s]);if(j)for(var s of j(t))Z.call(t,s)&&C(e,s,t[s]);return e},O=(e,t)=>Q(e,V(t));import{_ as q,x as G,cR as m,dN as W,dO as J,de as K,dP as X,m as x,o as c,f as l,g as o,q as i,N as u,ah as D,cZ as h,t as d,k as f,dn as ee}from"./index-edd2d6c0.js";var M={};Object.defineProperty(M,"__esModule",{value:!0});const N=90.8333,g=360/24,te=60*60*1e3;function se(e){return Math.ceil((e.getTime()-new Date(e.getFullYear(),0,1).getTime())/864e5)}function T(e){return Math.sin(e*2*Math.PI/360)}function P(e){return Math.acos(e)*360/(2*Math.PI)}function ne(e){return Math.asin(e)*360/(2*Math.PI)}function ie(e){return Math.tan(e*2*Math.PI/360)}function I(e){return Math.cos(e*2*Math.PI/360)}function y(e,t){const s=e%t;return s<0?s+t:s}function z(e,t,s,w,r){const v=se(r),a=t/g,k=s?v+(6-a)/24:v+(18-a)/24,p=.9856*k-3.289,_=y(p+1.916*T(p)+.02*T(2*p)+282.634,360),A=.91764*ie(_);let n;n=360/(2*Math.PI)*Math.atan(A),n=y(n,360);const B=Math.floor(_/90)*90,F=Math.floor(n/90)*90;n=n+(B-F),n/=g;const S=.39782*T(_),L=I(ne(S)),H=(I(w)-S*T(e))/(L*I(e)),R=(s?360-P(H):P(H))/g+n-.06571*k-6.622,U=y(R-t/g,24),Y=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate());return new Date(Y+U*te)}function ae(e,t,s=new Date){return z(e,t,!0,N,s)}function oe(e,t,s=new Date){return z(e,t,!1,N,s)}var re=M.getSunrise=ae,ce=M.getSunset=oe;const le=G({name:"DateTime",props:["widget","_containerSize","_widgetSize"],data(){return{DateTime:null,gps:null,sunrise:null,sunset:null,week:null}},methods:{runInterval(){this.config.refresh&&this.config.refresh>0&&(this.setDateTimeInterval=setInterval(()=>{this.setDateTime()},this.config.refresh*1e3))},setDateTime(){try{const e=new Date;this.DateTime=m(e,this.config.format.replace(/(?:\r|\n|\r\n)/g,"'<br />'")),this.week=W(e)+".",this.gps!==null&&(this.sunrise=m(re(...this.gps),"HH:mm"),this.sunset=m(ce(...this.gps),"HH:mm"))}catch(e){console.log(e.message||e),this.DateTime=m(new Date,this.config._defaults.format)}}},computed:O(E({},J(ee)),{config(){const e=K.joinConfig(this.widget.config,X);return e.refresh=e.format.indexOf("s")>-1?1:e.format.indexOf("m")>-1?10:60,e},city(){return this.ioBrokerStore.meta.city}}),watch:{"ioBrokerStore.meta":{deep:!0,immediate:!0,handler(e){const{latitude:t,longitude:s}=e;this.gps=!t||!s?null:[t,s],this.gps&&this.setDateTime()}},widget:{immediate:!0,handler(e){e.revision!==this.revision&&(this.revision=e.revision,clearInterval(this.setDateTimeInterval),this.runInterval(),this.setDateTime())}}},beforeUnmount(){clearInterval(this.setDateTimeInterval)}}),me={class:"jarvis-DateTime-Clock DateTime-Clock"},ue=["innerHTML"],De={class:"row jarvis-DateTime-Details DateTime-Details"},he={key:0},de={class:"jarvis-DateTime-Details-Item DateTime-Details-Item"},fe={key:1},ge={class:"jarvis-DateTime-Details-Item DateTime-Details-Item"},Te={key:2},ve={class:"jarvis-DateTime-Details-Item DateTime-Details-Item"},pe={key:3},_e={class:"jarvis-DateTime-Details-Item DateTime-Details-Item"};function Ie(e,t,s,w,r,v){const a=x("icon");return c(),l("div",{key:e.revision,class:"jarvis-DateTime-Container DateTime-Container"},[o("div",me,[o("span",{innerHTML:e.DateTime},null,8,ue)]),o("div",De,[e.config.city!==!1?(c(),l("div",he,[i(a,{size:"xs",name:"mdi-city-variant-outline",class:"jarvis-DateTime-Details-Icon DateTime-Details-Icon"}),u(i(h,{color:"primary"},null,512),[[D,!e.city]]),o("span",de,d(e.city),1)])):f("",!0),e.config.sun!==!1?(c(),l("div",fe,[i(a,{size:"xs",name:"mdi-weather-sunset-up",class:"jarvis-DateTime-Details-Icon DateTime-Details-Icon"}),u(i(h,{color:"primary"},null,512),[[D,!e.sunrise]]),o("span",ge,d(e.sunrise),1)])):f("",!0),e.config.sun!==!1?(c(),l("div",Te,[i(a,{size:"xs",name:"mdi-weather-sunset-down",class:"jarvis-DateTime-Details-Icon DateTime-Details-Icon"}),u(i(h,{color:"primary"},null,512),[[D,!e.sunset]]),o("span",ve,d(e.sunset),1)])):f("",!0),e.config.calendarweek!==!1?(c(),l("div",pe,[i(a,{size:"xs",name:"mdi-calendar-week",class:"jarvis-DateTime-Details-Icon DateTime-Details-Icon"}),u(i(h,{color:"primary"},null,512),[[D,!e.week]]),o("span",_e,d(e.week),1)])):f("",!0)])])}var Se=q(le,[["render",Ie]]);export{Se as default};
