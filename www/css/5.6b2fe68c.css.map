{"version":3,"sources":["C:/Users/Zefau/Projects/jarvis/src/pages/Configuration/WidgetsPage/WidgetPage/src/pages/Configuration/WidgetsPage/WidgetPage/WidgetPage.vue"],"names":[],"mappings":"AAkNA,2BACA,YAAA,CACA,kBAAA,CACA,UAAA,CACA,iBACA","file":"5.6b2fe68c.css","sourcesContent":["<template>\n\t<q-dialog\n\t\t:value=\"widget !== null\"\n\t\tfull-height\n\t\tpersistent\n\t\t>\n\t\t\n\t\t<q-card class=\"column full-height\" style=\"width: 1400px; max-width: 90vw;\" v-if=\"widget !== null\">\n\t\t\t<q-card-section class=\"row items-center\">\n\t\t\t\t<div class=\"text-h6\">{{ $t('Widget') }} {{ widget.title }}</div>\n\t\t\t\t\n\t\t\t\t<q-space />\n\t\t\t\t<q-btn flat round color=\"grey\" icon=\"close\" @click=\"cancel()\" />\n\t\t\t</q-card-section>\n\t\t\t<q-separator />\n\t\t\t\n\t\t\t<q-card-section class=\"col scroll body\">\n\t\t\t\t\n\t\t\t\t<!-- WIDGET BOX -->\n\t\t\t\t<div class=\"text-h6 primary q-ma-sm\">{{ $t('Widget-Box') }}</div>\n\t\t\t\t<q-separator style=\"margin: 0 -16px\" />\n\t\t\t\t\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t<div class=\"col\">\n\t\t\t\t\t\t<inputs @onChange=\"onChange\" id=\"icon\" :label=\"$t('Widget Icon')\" :value=\"widget.icon || ModuleSettings.icon || ''\" :icon=\"widget.icon\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"col\">\n\t\t\t\t\t\t<inputs @onChange=\"onChange\" id=\"title\" :label=\"$t('Widget Title')\" :value=\"widget.title || ''\" autofocus />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"col\">\n\t\t\t\t\t\t<inputs @onChange=\"onChange\" id=\"link\" :label=\"$t('Widget Link')\" :value=\"widget.link || ''\" info=\"config#HomeKitTile#jumper#info\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"col\">\n\t\t\t\t\t\t<inputs type=\"switch\" @onChange=\"onChange\" id=\"hideTitle\" :label=\"$t('Hide Widget Title and Icon')\" :value=\"widget.hideTitle || false\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<!-- MODULE CONFIGURATION -->\n\t\t\t\t<div class=\"text-h6 primary q-ma-sm\">{{ $t('Module') }}</div>\n\t\t\t\t<q-separator style=\"margin: 0 -16px\" />\n\t\t\t\t\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t<div class=\"col-3\">\n\t\t\t\t\t\t<inputs @onSelect=\"onChange\" id=\"module\" :label=\"$t('Module')\" type=\"select\" :options=\"ModuleList\" :value=\"widget.module\" options-dense use-input required :error=\"errors['module'] !== undefined\" :error-message=\"errors['module']\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"col-9\">\n\t\t\t\t\t\t<div class=\"centered\" v-show=\"widget.module\">{{ $t(widget.module + '#description') }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div v-show=\"widget.module\">\n\t\t\t\t\t\n\t\t\t\t\t<!-- MODULE CONFIGURAGION -->\n\t\t\t\t\t<div class=\"text-h7 primary q-ma-sm\">{{ $t('Module Configuration') }}</div>\n\t\t\t\t\t<q-separator style=\"margin: 0 0 8px 0\" />\n\t\t\t\t\t\n\t\t\t\t\t<div class=\"row\" v-show=\"ModuleConfigurations.length > 0\">\n\t\t\t\t\t\t<template v-for=\"ModuleConfig in ModuleConfigurations\">\n\t\t\t\t\t\t<div :class=\"'col-' + (ModuleConfig.columns || 4)\" :key=\"ModuleConfig.parameter\" v-if=\"ModuleConfig.hide !== true\" v-show=\"dependencies(ModuleConfig.dependencies)\">\n\t\t\t\t\t\t\t<inputs\n\t\t\t\t\t\t\t\t@onChange=\"onChange({ ...arguments[0], 'id': 'config.' + ModuleConfig.parameter })\"\n\t\t\t\t\t\t\t\t@onSelect=\"onChange({ ...arguments[0], 'id': 'config.' + ModuleConfig.parameter })\"\n\t\t\t\t\t\t\t\tv-bind=\"ModuleConfig\"\n\t\t\t\t\t\t\t\t:value=\"getValueForInput(ModuleConfig)\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"row\" v-show=\"ModuleConfigurations.length === 0\">\n\t\t\t\t\t\t<p class=\"q-pa-sm\">\n\t\t\t\t\t\t\t{{ $t('No configuration options for this module') }}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<!-- MODULE CUSTOM COMPONENT -->\n\t\t\t\t\t<div class=\"row\" v-if=\"ModuleSettings && ModuleSettings.customConfiguration\">\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t:is=\"ModuleSettings.customConfiguration\"\n\t\t\t\t\t\t\t:config=\"widget.config\"\n\t\t\t\t\t\t\t@onChange=\"onChange\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<!-- MODULE DEVICES -->\n\t\t\t\t\t<template v-if=\"ModuleSettings.addDevice !== false\">\n\t\t\t\t\t<div class=\"text-h7 primary q-ma-sm\">{{ $t('Module Devices') }}</div>\n\t\t\t\t\t<q-separator style=\"margin: 0 -0 8px 0\" />\n\t\t\t\t\t\n\t\t\t\t\t<div class=\"row\">\n\t\t\t\t\t\t<widget-devices-section\n\t\t\t\t\t\t\t@onChange=\"onChange\"\n\t\t\t\t\t\t\t:itemList=\"widget.items || []\"\n\t\t\t\t\t\t\t:module=\"widget.module\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</q-card-section>\n\t\t\t\n\t\t\t<q-separator />\n\t\t\t<q-card-actions align=\"right\">\n\t\t\t\t<q-btn flat :label=\"$t('Cancel')\" color=\"negative\" @click=\"cancel()\" />\n\t\t\t\t<q-btn flat :label=\"$t('Apply')\" color=\"primary\" @click=\"save\" :disable=\"hasErrors\" />\n\t\t\t</q-card-actions>\n\t\t</q-card>\n\t</q-dialog>\n</template>\n\n<script>\nimport { defineComponent } from '@vue/composition-api';\n\nimport WidgetDevicesSection from './WidgetDevicesSection.vue';\n\nimport Modules from 'src/modules/'\n\nconst _rfdc = require('rfdc')();\nexport default defineComponent({\n\t'name': 'WidgetPage',\n\t'props': [ 'widgetId' ],\n\t\n\t'components': {\n\t\tWidgetDevicesSection\n\t},\n\t\n\tdata() {\n\t\tthis.ModuleList = Modules._ModuleList.map(module => ({ 'label': module, 'value': module }));\n\t\t\n\t\treturn {\n\t\t\t'component': null,\n\t\t\t'errors': {},\n\t\t\t'ModuleConfigurations': [],\n\t\t\t'ModuleSettings': {},\n\t\t\t'widget': null\n\t\t}\n\t},\n\t\n\t'computed': {\n\t\thasErrors() {\n\t\t\treturn Object.keys(this.errors).length > 0;\n\t\t}\n\t},\n\t\n\t'methods': {\n\t\tdependencies(dependencies) {\n\t\t\tif (!dependencies) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t\n\t\t\treturn Object.keys(dependencies).some(dependency => this.widget.config[dependency] === dependencies[dependency]);\n\t\t},\n\t\tgetValueForInput(ModuleConfig) {\n\t\t\treturn this.widget && this.widget.config[ModuleConfig.parameter] !== undefined ? this.widget.config[ModuleConfig.parameter] : (typeof ModuleConfig.value === 'function' ? ModuleConfig.value() : ModuleConfig.value);\n\t\t},\n\t\tonChange(props) {\n\t\t\tconst { _error, id, value } = props;\n\t\t\t\n\t\t\t// error\n\t\t\tif (_error) {\n\t\t\t\tthis.$set(this.errors, id, _error);\n\t\t\t}\n\t\t\t\n\t\t\t// config\n\t\t\telse if (id.indexOf('config.') > -1) {\n\t\t\t\tthis.$delete(this.errors, id);\n\t\t\t\tthis.$set(this.widget.config, id.replace('config.', ''), value);\n\t\t\t}\n\t\t\t\n\t\t\t// no error, thus set data\n\t\t\telse {\n\t\t\t\tthis.$delete(this.errors, id);\n\t\t\t\tthis.$set(this.widget, id, value);\n\t\t\t\t\n\t\t\t\t// module change\n\t\t\t\tif (id === 'module') {\n\t\t\t\t\tthis.ModuleConfigurations = Modules._ModuleConfigurations[value] || [];\n\t\t\t\t\tthis.ModuleSettings = Modules._ModuleSettings[value] || {};\n\t\t\t\t\tthis.$set(this.widget, 'config', {});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcancel(widget = null) {\n\t\t\tthis.$emit('onClose', widget);\n\t\t\tthis.widget = null;\n\t\t\tthis.errors = {};\n\t\t},\n\t\tsave() {\n\t\t\tthis.$store.commit('editor/addWidget', { 'widget': this.widget });\n\t\t\tthis.cancel(this.widget);\n\t\t}\n\t},\n\t\n\t'watch': {\n\t\twidgetId(id) {\n\t\t\tif (id === null) {\n\t\t\t\tthis.widget = null;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.widget = this.$store.state.editor.widgets[id] ? _rfdc(this.$store.state.editor.widgets[id]) : { id, 'config': {} };\n\t\t\t\tthis.ModuleConfigurations = Modules._ModuleConfigurations[this.widget.module] || [];\n\t\t\t\tthis.ModuleSettings = Modules._ModuleSettings[this.widget.module] || {};\n\t\t\t}\n\t\t}\n\t}\n});\n</script>\n\n<style scoped>\n.centered {\n\tdisplay: flex;\n\talign-items: center;\n\theight: 80%;\n\tpadding-left: 16px;\n}\n</style>\n"]}