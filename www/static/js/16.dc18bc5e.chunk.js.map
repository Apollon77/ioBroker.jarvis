{"version":3,"sources":["components/Collapsible.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toArray.js","pages/ConfigurationPage/DevicesPage/ComponentConfigPage.js","pages/ConfigurationPage/DevicesPage/JsonEditor.js","pages/ConfigurationPage/DevicesPage/i18n/de.js","pages/ConfigurationPage/DevicesPage/i18n/en.js","components/EnhancedTableToolbar.js","components/EnhancedTableHead.js","components/EnhancedTableBody.js","components/EnhancedTable.js","pages/ConfigurationPage/DevicesPage/Devices.config.js","pages/ConfigurationPage/DevicesPage/StateExplorer.js","pages/ConfigurationPage/DevicesPage/DevicesPage.js","pages/ConfigurationPage/DevicesPage/ImportDevicesPage.js","pages/ConfigurationPage/DevicesPage/DevicesListPage.js","../node_modules/@material-ui/core/esm/Accordion/AccordionContext.js","../node_modules/@material-ui/icons/Edit.js","../node_modules/@material-ui/icons/KeyboardArrowRight.js","../node_modules/@material-ui/icons/Add.js","pages/ConfigurationPage/DevicesPage/i18n sync /^/.*$","../node_modules/@material-ui/icons/CloudDownload.js","../node_modules/@material-ui/icons/FileCopy.js","../node_modules/@material-ui/core/esm/AccordionSummary/AccordionSummary.js","../node_modules/@material-ui/core/esm/AccordionDetails/AccordionDetails.js","../node_modules/@material-ui/core/esm/Accordion/Accordion.js","../node_modules/@babel/runtime/helpers/esm/toArray.js"],"names":["useStyles","makeStyles","theme","transition","duration","transitions","shortest","expanded","Collapsible","position","create","left","top","right","height","content","opacity","backgroundColor","palette","divider","display","margin","marginTop","marginBottom","CollapsibleSummary","minHeight","padding","spacing","CollapsibleSummaryContent","flexGrow","CollapsibleSummaryExpandIcon","transform","CollapsibleDetails","CollapsibleContext","React","createContext","forwardRef","props","ref","arr","defaultExpanded","childrenProp","children","className","other","classes","useState","undefined","setExpanded","handleChange","useCallback","event","Children","toArray","arrayWithHoles","iterableToArray","unsupportedIterableToArray","nonIterableRest","summary","contextValue","useMemo","toggle","Paper","elevation","root","clsx","Provider","value","Collapse","in","timeout","aria-labelledby","id","role","expandIcon","onClick","onBlur","onFocusVisible","useContext","ButtonBase","focusRipple","disableRipple","component","aria-expanded","stopPropagation","IconButton","size","tabIndex","aria-hidden","ComponentConfig","memo","Log","_","_onClose","_onChange","config","attributes","open","setOpen","useEffect","componentConfiguration","Object","keys","map","configKey","configOption","val","_translate","info","otherConfigOption","label","i18n","t","selection","Tag","Inputs","type","key","disableTypography","container","item","width","inputProps","style","textAlign","onChange","header","actions","Button","variant","color","dense","maxWidth","fullWidth","disablePadding","JsonEditor","mode","allowedModes","htmlElementProps","JsonEditorPopup","useToolbarStyles","paddingLeft","paddingRight","highlight","secondary","main","lighten","light","text","primary","dark","title","flex","EnhancedTableToolbar","rowCount","numSelected","rightActionButton","aria-label","EnhancedTableHead","headCells","onSelectAllClick","selectable","sortable","order","orderBy","onRequestSort","indeterminate","checked","headCell","align","sortDirection","active","direction","property","noWrap","whiteSpace","nestedObjects","seen","indexOf","push","EnhancedTable","columns","sortedRows","emptyRows","rowStyles","selected","row","index","isItemSelected","labelId","styles","columnId","rowStyle","hover","aria-checked","column","scope","toLowerCase","format","Array","isArray","JSON","stringify","toString","showTableContent","colSpan","table","minWidth","descendingComparator","a","b","orderByCase","orderA","orderB","tmpA","tmpB","substr","err","console","error","message","getComparator","stableSort","array","comparator","stabilizedThis","el","sort","CustomTableBody","rows","toolbar","pagination","defaultOrder","defaultOrderBy","defaultSelected","defaultPage","defaultRowsPerPage","toolbarRightActionButton","setOrder","setOrderBy","setSelected","page","setPage","length","rowsPerPage","setRowsPerPage","TableBody","EnhancedTableBody","Fragment","stickyHeader","target","newSelecteds","n","slice","Math","min","selectedIndex","newSelected","concat","rowsPerPageOptions","count","onChangePage","newPage","onChangeRowsPerPage","parseInt","Error","TreeView","TreeItem","action","TreeItemContent","TreeItemError","textDecoration","cursor","fontWeight","TreeItemExpanded","TreeItemSelected","TreeItemGroup","TreeItemLabel","Entry","alignItems","Group","EntryIcon","marginRight","EntryText","indexObjects","list","objectsTree","objectId","lastIndexOf","namespace","StateExplorer","Cache","get","objectList","setObjectList","selectedItem","useRef","searchTimeout","Connection","connection","getObjects","then","res","forEach","promise","i","status","obj","tree","_objectList","Date","now","set","catch","stack","Fieldset","Text","clearTimeout","current","setTimeout","data","filter","prevObjectList","timeConverter","parseDate","updated","startIcon","defaultCollapseIcon","defaultExpandIcon","onNodeSelect","e","renderTree","states","channelKey","stateKey","Item","nodeId","channel","details","group","otherProps","common","name","GroupIcon","StateIcon","caption","arrow","getLanguage","StateExplorerPopup","state","onClose","s","iconContainer","flexDirection","alignRight","justifyContent","marginLeft","ModifyIcon","verticalAlign","heading","ListItem","drag","userSelect","isDragging","_merge","require","_copy","DevicesPage","device","setDevice","errors","setErrors","EDITOR","prevErrors","nextErrors","_addState","newStateKey","replace","prevDevice","_addDefaultStates","func","FUNCTIONS","stateKeys","reverse","substitute","xs","onDelete","savedDevice","options","split","base","characteristic","param","_updated","onSave","_onSave","disabled","FieldsetItem","autoFocus","required","Select","function","funcKey","FUNCTION_ICONS","sortOptionsByKey","icon","Switch","suppressPopup","DeviceStates","_renameState","nextDevice","splice","sKey","_moveState","source","destination","_deleteState","AddDeviceState","StateAddRef","setError","onAddState","_setNewStateKey","shrink","onEnter","renderedStates","DragDeviceState","onDragEnd","droppableId","provided","snapshot","innerRef","droppableProps","placeholder","draggableId","draggableProps","dragHandleProps","DeviceState","fields","DevicesStates","field","DeviceStateField","prompt","fontSize","noPadding","fieldProps","deviceDefaults","json","DeviceStateFieldJsonEditor","DeviceStateFieldAutoComplete","DeviceStateFieldStateExplorer","DeviceStateFieldOther","node","setValue","showJsonEditor","setShowJsonEditor","additionalProps","DeviceStateFieldInput","setVal","showStateExplorer","setShowStateExplorer","components","option","getComponents","componentConfig","setComponentConfig","componentsOptions","userConfig","c","renderOption","Input","ucFirst","transparent","gap","ImportDevicesPage","loading","setLoading","importDevices","setImportDevices","componentWillUnmount","search","adapters","Adapters","foundDevicesByManufacturer","categories","_markDeviceToImport","addOrRemove","moveDeviceToIgnore","devices","findIndex","d","moveDeviceToNew","ignore","hash","uuid","prevImportDevices","deviceIds","_created","nextImportDevices","_setImportDeviceList","foundDevices","_new","_added","_incorrect","_ignored","deviceList","newDevices","reason","categoryKey","manufacturer","note","Devices","importEnums","onImport","values","AdapterList","_setSearch","attribute","adapter","Category","DeviceList","prevProps","nextProps","allSelected","setAllSelected","Device","category","button","prevSelected","Checkbox","deviceChecked","setDeviceChecked","markDeviceToImport","prevChecked","searchResults","adapterKey","AdapterItem","RadioGroup","inputs","adapterName","default","setChecked","deviceObjectType","devicePattern","deleteButton","hr","CustomTextInput","CustomDialogTitle","TableCell","paper","zIndex","newlyCreatedDevice","paddingTop","setTranslations","language","DevicesListPage","_groupDevices","groupBy","g","deviceId","sortObject","selectedDevice","setSelectedDevice","settings","configGroupDevices","lastDeviceAdded","filterBy","filterByTimeout","groups","setGroups","setWidth","_onDevicesChange","document","getElementById","scrollTop","offsetTop","_saveDevices","saveDevices","_filterBy","_copyDevice","_deleteInWidgets","layout","drawerKey","drawer","tabs","tab","columnIndex","_fullscreen","widget","secondaryStatesKeys","secondaryStatesKeyIndex","primaryStateKey","bodyStateKey","_onLayoutsChange","filters","match","RegExp","labels","trim","result","groupedDevices","_selectDevice","paperComponent","boxWidth","parentNode","offsetWidth","p","link","orientation","saveDevice","prevDeviceStates","_renamed","prevStateKey","DeviceTable","CustomTableProps","join","AccordionContext","_interopRequireDefault","_interopRequireWildcard","defineProperty","exports","_default","createElement","webpackContext","req","webpackContextResolve","__webpack_require__","o","code","resolve","module","AccordionSummary","IconButtonProps","_objectWithoutProperties","_React$useState","focusedState","setFocusedState","_React$useContext","_React$useContext$dis","_extends","focused","edge","withStyles","focus","disabledOpacity","AccordionDetails","Accordion","_props$defaultExpande","_props$disabled","expandedProp","_props$square","square","_props$TransitionComp","TransitionComponent","TransitionProps","_useControlled","useControlled","controlled","_useControlled2","_slicedToArray","setExpandedState","_React$Children$toArr","_React$Children$toArr2","rounded","disabledBackground","borderRadius","borderTopLeftRadius","shape","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"],"mappings":"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","file":"static/js/16.dc18bc5e.chunk.js","sourcesContent":["import React, { useState, useCallback, useMemo } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ButtonBase from '@material-ui/core/ButtonBase'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Collapse from '@material-ui/core/Collapse'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport ExpandIcon from '@material-ui/icons/KeyboardArrowRight'\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => {\r\n\tconst transition = {\r\n\t\tduration: theme.transitions.duration.shortest,\r\n\t};\r\n\t\r\n\treturn {\r\n\t\texpanded: {\r\n\t\t},\r\n\t\tCollapsible: {\r\n\t\t\tposition: 'relative',\r\n\t\t\ttransition: theme.transitions.create(['margin'], transition),\r\n\t\t\t'&:before': {\r\n\t\t\t\tposition: 'absolute',\r\n\t\t\t\tleft: 0,\r\n\t\t\t\ttop: -1,\r\n\t\t\t\tright: 0,\r\n\t\t\t\theight: 1,\r\n\t\t\t\tcontent: '\"\"',\r\n\t\t\t\topacity: 1,\r\n\t\t\t\tbackgroundColor: theme.palette.divider,\r\n\t\t\t\ttransition: theme.transitions.create(['opacity', 'background-color'], transition),\r\n\t\t\t},\r\n\t\t\t'&:first-child': {\r\n\t\t\t\t'&:before': {\r\n\t\t\t\t\tdisplay: 'none',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t'&$expanded': {\r\n\t\t\t\tmargin: '16px 0',\r\n\t\t\t\t'&:first-child': {\r\n\t\t\t\t\tmarginTop: 0,\r\n\t\t\t\t},\r\n\t\t\t\t'&:last-child': {\r\n\t\t\t\t\tmarginBottom: 0,\r\n\t\t\t\t},\r\n\t\t\t\t'&:before': {\r\n\t\t\t\t\topacity: 0,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t'&$expanded + &': {\r\n\t\t\t\t'&:before': {\r\n\t\t\t\t\tdisplay: 'none',\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t},\r\n\t\tCollapsibleSummary: {\r\n\t\t\tdisplay: 'flex',\r\n\t\t\tminHeight: 8 * 6,\r\n\t\t\ttransition: theme.transitions.create(['min-height', 'background-color'], transition),\r\n\t\t\tpadding: theme.spacing(0, 2),\r\n\t\t\t'&$expanded': {\r\n\t\t\t\tminHeight: 64,\r\n\t\t\t}\r\n\t\t},\r\n\t\tCollapsibleSummaryContent: {\r\n\t\t\tdisplay: 'flex',\r\n\t\t\tflexGrow: 1,\r\n\t\t\ttransition: theme.transitions.create(['margin'], transition),\r\n\t\t\tmargin: '12px 0',\r\n\t\t\t\r\n\t\t\t'&$expanded': {\r\n\t\t\t\tmargin: '20px 0',\r\n\t\t\t},\r\n\t\t},\r\n\t\tCollapsibleSummaryExpandIcon: {\r\n\t\t\ttransform: 'rotate(0deg)',\r\n\t\t\ttransition: theme.transitions.create('transform', transition),\r\n\t\t\t'&:hover': {\r\n\t\t\t\t// Disable the hover effect for the IconButton,\r\n\t\t\t\t// because a hover effect should apply to the entire Expand button and\r\n\t\t\t\t// not only to the IconButton.\r\n\t\t\t\tbackgroundColor: 'transparent',\r\n\t\t\t},\r\n\t\t\t'&$expanded': {\r\n\t\t\t\ttransform: 'rotate(90deg)',\r\n\t\t\t},\r\n\t\t},\r\n\t\tCollapsibleDetails: {\r\n\t\t\t//display: 'flex',\r\n\t\t\tpadding: theme.spacing(0, 2, 2, 4),\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst CollapsibleContext = React.createContext({});\r\n\r\nexport default React.forwardRef(function Collapsible(props, ref) {\r\n\tconst { expanded: defaultExpanded, children: childrenProp, className, ...other } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [expanded, setExpanded] = useState(defaultExpanded !== undefined ? defaultExpanded : false);\r\n\tconst handleChange = useCallback(\r\n\t\t(event) => {\r\n\t\t\tsetExpanded(!expanded);\r\n\t\t},\r\n\t\t[expanded, setExpanded]\r\n\t);\r\n\t\r\n\tconst [summary, ...children] = React.Children.toArray(childrenProp);\r\n\tconst contextValue = useMemo(() => ({ expanded, toggle: handleChange }), [ expanded, handleChange ]);\r\n\t\r\n\treturn (\r\n\t\t<Paper\r\n\t\t\televation={0} \r\n\t\t\tclasses={{ root: clsx(classes.Collapsible, { [classes.expanded]: expanded }, className) }}\r\n\t\t\tref={ref}\r\n\t\t\t{...other}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<CollapsibleContext.Provider value={contextValue}>{summary}</CollapsibleContext.Provider>\r\n\t\t\t<Collapse in={expanded} timeout=\"auto\">\r\n\t\t\t\t<div aria-labelledby={summary.props.id} id={summary.props['aria-controls']} role=\"region\">\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</div>\r\n\t\t\t</Collapse>\r\n\t\t</Paper>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nexport const CollapsibleSummary = React.forwardRef(function CollapsibleSummary(props, ref) {\r\n\tconst { children, className, expandIcon, onBlur, onClick, onFocusVisible, ...other } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { expanded, toggle } = React.useContext(CollapsibleContext);\r\n\tconst handleChange = (event) => {\r\n\t\tevent.stopPropagation();\r\n\t\t\r\n\t\tif (toggle) {\r\n\t\t\ttoggle(event);\r\n\t\t}\r\n\t\tif (onClick) {\r\n\t\t\tonClick(event);\r\n\t\t}\r\n\t};\r\n\t\r\n\treturn (\r\n\t\t<ButtonBase\r\n\t\t\tfocusRipple={false}\r\n\t\t\tdisableRipple\r\n\t\t\tcomponent=\"div\"\r\n\t\t\taria-expanded={expanded}\r\n\t\t\tclassName={clsx(classes.CollapsibleSummary, { [classes.expanded]: expanded }, className)}\r\n\t\t\tonClick={handleChange}\r\n\t\t\tref={ref}\r\n\t\t\t{...other}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<IconButton\r\n\t\t\t\tclassName={clsx(classes.CollapsibleSummaryExpandIcon, { [classes.expanded]: expanded })}\r\n\t\t\t\tcomponent=\"div\"\r\n\t\t\t\tsize=\"small\"\r\n\t\t\t\ttabIndex={null}\r\n\t\t\t\trole={null}\r\n\t\t\t\taria-hidden\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{expandIcon ? expandIcon : <ExpandIcon />}\r\n\t\t\t</IconButton>\r\n\t\t\t<div className={clsx(classes.CollapsibleSummaryContent, { [classes.expanded]: expanded })}>\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</ButtonBase>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nexport const CollapsibleDetails = React.forwardRef(function CollapsibleDetails(props, ref) {\r\n\tconst { className, ...other } = props;\r\n\tconst classes = useStyles();\r\n\r\n\treturn <div className={clsx(classes.CollapsibleDetails, className)} ref={ref} {...other} />;\r\n});\r\n","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}","import React, { useState, useEffect } from 'react'\r\n//import clsx from 'clsx'\r\n\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Info from '../../../components/Info'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n}));\r\n */\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst ComponentConfig = React.memo(props => {\r\n\tLog._('WidgetPage', 'RENDER ComponentConfig', 'development');\r\n\t//const classes = useStyles();\r\n\tconst { _onClose, _onChange, id, config, attributes } = props;\r\n\t\r\n\tconst [open,setOpen] = useState(false);\r\n\tconst onClose = () => {\r\n\t\tsetOpen(false)\r\n\t\t_onClose();\r\n\t}\r\n\t\r\n\tuseEffect(() => {\r\n\t\tsetOpen(config !== null);\r\n\t}, [config]);\r\n\t\r\n\tif (id === null || config === null || config === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t// component configuration\r\n\tconst componentConfiguration = Object.keys(config).map(configKey => {\r\n\t\tlet configOption = config[configKey];\r\n\t\tconfigOption = typeof configOption === 'object' ? configOption : { 'label': configKey, 'val': configOption.val !== undefined ? configOption.val : configOption }\r\n\t\tlet { _translate, info, ...otherConfigOption } = configOption;\r\n\t\t\r\n\t\totherConfigOption.label = configOption.label || configKey;\r\n\t\totherConfigOption.label = _translate ? i18n.t(configOption.label) : configOption.label;\r\n\t\totherConfigOption.val = _translate ? i18n.t(configOption.val) : configOption.val;\r\n\t\totherConfigOption.selection = typeof otherConfigOption.selection === 'function' ? otherConfigOption.selection(props) : otherConfigOption.selection;\r\n\t\t\r\n\t\tconst Tag = Inputs[configOption.type || 'Text'];\r\n\t\treturn (\r\n\t\t\t<ListItem key={'Config-' + configKey} divider>\r\n\t\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t\t<Grid container spacing={1}>\r\n\t\t\t\t\t\t<Grid item><Info info={info} /></Grid>\r\n\t\t\t\t\t\t<Grid item><Typography>{i18n.t(otherConfigOption.label)}</Typography></Grid>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</ListItemText>\r\n\t\t\t\t\r\n\t\t\t\t<ListItemSecondaryAction>\r\n\t\t\t\t\t<Tag\r\n\t\t\t\t\t\tkey={'componentConfig.' + id + '.' + configKey}\r\n\t\t\t\t\t\tid={'componentConfig.' + id + '.' + configKey}\r\n\t\t\t\t\t\t{...otherConfigOption}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel=''\r\n\t\t\t\t\t\twidth={180}\r\n\t\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\t\tstyle: { textAlign: 'right' }\r\n\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tonChange={(props, val) => _onChange(props, val, attributes)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t</ListItem>\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('Component configuration')}\r\n\t\t\tactions={\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={onClose} color=\"primary\" label=\"Apply\" />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='xs'\r\n\t\t\tfullWidth={true}\r\n\t\t\topen={open}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<List dense disablePadding>\r\n\t\t\t\t{componentConfiguration}\r\n\t\t\t</List>\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default ComponentConfig;\r\n","import React from 'react'\r\n//import clsx from 'clsx'\r\n\r\nimport i18n from '../../../controller/i18n'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\nimport { JsonEditor as Editor } from 'jsoneditor-react'\r\nimport 'jsoneditor-react/es/editor.min.css'\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst JsonEditor = React.forwardRef((props, ref) => {\r\n\tconst { val, height, _onChange } = props;\r\n\t\r\n\treturn (\r\n\t\t<Editor\r\n\t\t\tref={ref}\r\n\t\t\tvalue={val || {}}\r\n\t\t\tmode='text'\r\n\t\t\tallowedModes={['tree', 'view', 'form', 'text']}\r\n\t\t\thtmlElementProps={{ style: { 'height': height || 0, 'display': !height ? 'none' : 'block' } }}\r\n\t\t\tonChange={_onChange}\r\n\t\t\t/>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nexport const JsonEditorPopup = React.memo(props => {\r\n\tconst { open, _onClose } = props;\r\n\t\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('JSON Editor')}\r\n\t\t\tactions={\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={_onClose} color=\"primary\" label=\"Apply\" />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='sm'\r\n\t\t\tfullWidth={true}\r\n\t\t\topen={open}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<JsonEditor {...props} />\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default JsonEditor;\r\n","export default {\r\n\t\r\n\t// Config\r\n\t\"config#Devices#state#label\": \"Datenpunkt (Anzeige)\",\r\n\t\"config#Devices#state#info\": \"Datenpunkt dessen State als Wert angezeigt wird\",\r\n\t\"config#Devices#stateStyle#label\": \"Datenpunkt Stil\",\r\n\t\"config#Devices#stateStyle#info\": \"Stil des angezeigten Wertes (im JSON Format)\",\r\n\t\"config#Devices#properties#label\": \"Datenpunkt Eigenschaften\",\r\n\t\"config#Devices#properties#info\": \"Eigenschaften des Datenpunkts: on, off, min, max sowie level (im JSON Format)\",\r\n\t\"config#Devices#display#label\": \"Anzeigevariante\",\r\n\t\"config#Devices#display#info\": \"Texte die den angezeigten Wert ersetzen (im JSON Format)\",\r\n\t\"config#Devices#label#label\": \"Label\",\r\n\t\"config#Devices#unit#label\": \"Einheit\",\r\n\t\"config#Devices#unit#info\": \"Einheit des Datenpunkts, z. B. % oder °\",\r\n\t\"config#Devices#action#label\": \"Datenpunkt (Trigger)\",\r\n\t\"config#Devices#action#info\": \"Datenpunkt der zum Schalten getriggert wird\",\r\n\t\"config#Devices#icon#label\": \"Icon\",\r\n\t\"config#Devices#icon#info\": \"Material Icon (klick zur Ansicht aller Icons)\",\r\n\t\"config#Devices#iconStyle#label\": \"Icon Stil\",\r\n\t\"config#Devices#iconStyle#info\": \"Stil des Icons (im JSON Format)\",\r\n\t\"config#Devices#hide#label\": \"im Popup verstecken\",\r\n\t\"config#Devices#hide#info\": \"Datenpunkt nicht in den Geräte-Details (Popup) zeigen\",\r\n\t\"config#Devices#bodyElement#label\": \"Body Element\",\r\n\t\"config#Devices#actionElement#label\": \"Action Element\",\r\n\t\r\n\t\"import#warning\": \"Damit ein Gerät vom Importer erkannt wird, müssen die Datenpunkte des Geräts unter einem gemeinsamen Datenpunkt des Typs \\\"{deviceObjectType}\\\" strukturiert sein.\",\r\n\t\r\n\t\r\n\t// Component\r\n\t\"State Explorer\": \"Datenpunkt Explorer\",\r\n\t\"State\": \"Datenpunkt (Anzeige)\",\r\n\t\"Action\": \"Datenpunkt (Trigger)\",\r\n\t\"(Un)Select all adapters\": \"alle Adapter (de)selektieren\",\r\n\t\"(Un)Select all devices\": \"alle Geräte (de)selektieren\",\r\n\t\"Suppress Popup\": \"Popup unterdrücken\",\r\n\t\"Do not open the device details in the popup when the device is clicked\": \"Keine Geräte-Details (Popup) öffnen, wenn das Gerät im Widget angeklickt wird\",\r\n\t\"add default states\": \"Standard Datenpunkte\",\r\n\t\r\n\t\"No whitespaces allowed in the state\": \"Keine Leerzeichen im Datenpunkt erlaubt\",\r\n\t\"JSON format\": \"JSON Format\",\r\n\t\"Devices List\": \"Geräteliste\",\r\n\t\"Group by\": \"Gruppieren nach\",\r\n\t\"Filter\": \"Filtern\",\r\n\t\"add device\": \"Gerät hinzufügen\",\r\n\t\"import devices\": \"Geräte importieren\",\r\n\t\r\n\t\"Device ID\": \"Geräte ID\",\r\n\t\"Name\": \"Name\",\r\n\t\"Function\": \"Gewerk\",\r\n\t\"States\": \"States\",\r\n\t\"Options\": \"Optionen\",\r\n\t\"adapter\": \"Adapter\",\r\n\t\r\n\t\"add state\": \"Datenpunkt hinzufügen\",\r\n\t\"new state key\": \"neuer Datenpunkt Bezeichner\",\r\n\t\"State Key\": \"Datenpunkt Bezeichner\",\r\n\t\r\n\t\"No input given\": \"Bitte etwas eingeben\",\r\n\t\"Wrong JSON format\": \"Falsches JSON Format\",\r\n\t\"Type in a state key / identifier\": \"State Bezeichnung eingeben\",\r\n\t\"State key already used\": \"State bereits in Benutzung\",\r\n\t\r\n\t\"Device Configuration\": \"Gerätekonfiguration\",\r\n\t\"Delete Device\": \"Gerät löschen\",\r\n\t\"General\": \"Allgemein\",\r\n\t\"Device\": \"Gerät\",\r\n\t\"Displayed Name\": \"Anzeigename\",\r\n\t\r\n\t\"New Devices\": \"neue Geräte\",\r\n\t\"Devices that have been added already\": \"bereits hinzugefügte Geräte\",\r\n\t\"Devices with incorrect configuration (states not found)\": \"Geräte mit inkorrekter Konfiguration (Datenpunkte nicht gefunden)\",\r\n\t\"Devices marked as ignored\": \"ignorierte Geräte\",\r\n\t\"Devices Import\": \"Geräte importieren\",\r\n\t\"Read adapters\": \"Adapter lesen\",\r\n\t\"Import selected devices\": \"ausgewählte Geräte importieren\",\r\n\t\"Adapters\": \"Adapter\",\r\n\t\"Search the adapter structure for all devices or only devices added to enums\": \"Adapter-Struktur entweder nach allen oder nur nach in Enums vorhandenen Geräten durchsuchen\",\r\n\t\"Search adapter structure for all devices\": \"nach allen Geräten durchsuchen\",\r\n\t\"Search only for devices added to enums\": \"nur nach in Enums hinzugefügten Geräten durchsuchen\",\r\n\t\"ignore\": \"ignorieren\",\r\n\t\"move to new devices\": \"zu den neuen Geräten verschieben\"\r\n}","export default {\r\n\t\r\n\t// Config\r\n\t\"config#Devices#state#label\": \"State (to display)\",\r\n\t\"config#Devices#state#info\": \"State which value is shown\",\r\n\t\"config#Devices#stateStyle#label\": \"State Style\",\r\n\t\"config#Devices#stateStyle#info\": \"State Style of the displayed values (in JSON Format)\",\r\n\t\"config#Devices#properties#label\": \"State Properties\",\r\n\t\"config#Devices#properties#info\": \"State Properties such as min, max, dimmerOn Werte (in JSON Format)\",\r\n\t\"config#Devices#display#label\": \"Display variant\",\r\n\t\"config#Devices#display#info\": \"Texts replacing the displayed value (in JSON Format)\",\r\n\t\"config#Devices#label#label\": \"Label\",\r\n\t\"config#Devices#unit#label\": \"Unit\",\r\n\t\"config#Devices#action#label\": \"State (to trigger)\",\r\n\t\"config#Devices#action#info\": \"State used to trigger an action\",\r\n\t\"config#Devices#icon#label\": \"Icon\",\r\n\t\"config#Devices#icon#info\": \"Material Icon (click to view icons)\",\r\n\t\"config#Devices#iconStyle#label\": \"Icon Style\",\r\n\t\"config#Devices#iconStyle#info\": \"Icon Style of the icon (in JSON Format)\",\r\n\t\"config#Devices#hide#label\": \"Hide state in popup\",\r\n\t\"config#Devices#hide#info\": \"Don't show state in the device details (popup)\",\r\n\t\"config#Devices#bodyElement#label\": \"Body Element\",\r\n\t\"config#Devices#actionElement#label\": \"Action Element\",\r\n\t\r\n\t\"import#warning\": \"For a device to be detected the states have to be grouped using a state of the type \\\"{deviceObjectType}\\\".\"\r\n}","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport clsx from 'clsx'\r\n\r\nimport { lighten, makeStyles } from '@material-ui/core/styles'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\n\r\nconst useToolbarStyles = makeStyles(theme => ({\r\n  root: {\r\n    paddingLeft: theme.spacing(2),\r\n    paddingRight: theme.spacing(1),\r\n  },\r\n  highlight:\r\n    theme.palette.type === 'light'\r\n      ? {\r\n          color: theme.palette.secondary.main,\r\n          backgroundColor: lighten(theme.palette.secondary.light, 0.85),\r\n        }\r\n      : {\r\n          color: theme.palette.text.primary,\r\n          backgroundColor: theme.palette.secondary.dark,\r\n        },\r\n  title: {\r\n    flex: '1 1 100%',\r\n  },\r\n}));\r\n\r\nexport default function EnhancedTableToolbar(props) {\r\n  const classes = useToolbarStyles();\r\n  const { title, rowCount, numSelected, rightActionButton } = props;\r\n\r\n  return (\r\n    <Toolbar\r\n      className={clsx(classes.root, {\r\n        [classes.highlight]: numSelected > 0,\r\n      })}\r\n    >\r\n      {numSelected > 0 ? (\r\n        <Typography className={classes.title} color=\"inherit\" variant=\"subtitle1\">\r\n          {numSelected} selected\r\n        </Typography>\r\n      ) : (\r\n        <Typography className={classes.title} variant=\"h6\" id=\"tableTitle\">\r\n\t\t\t{title !== undefined && (title + ' (' + rowCount + ')')}\r\n        </Typography>\r\n      )}\r\n\r\n      {numSelected > 0 ? (\r\n        <Tooltip title=\"Delete\">\r\n          <IconButton aria-label=\"delete\">\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        </Tooltip>\r\n      )\r\n\t  : rightActionButton}\r\n    </Toolbar>\r\n  );\r\n};\r\n\r\nEnhancedTableToolbar.propTypes = {\r\n  numSelected: PropTypes.number.isRequired,\r\n};","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport TableHead from '@material-ui/core/TableHead'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableSortLabel from '@material-ui/core/TableSortLabel'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\n\r\n\r\nexport default function EnhancedTableHead(props) {\r\n  const { headCells, onSelectAllClick, selectable, sortable, order, orderBy, numSelected, rowCount, onRequestSort } = props;\r\n  const createSortHandler = property => event => {\r\n    onRequestSort(event, property);\r\n  };\r\n\r\n  return (\r\n    <TableHead>\r\n      <TableRow>\r\n\t\t{selectable !== false &&\r\n\t\t\t<TableCell padding=\"checkbox\">\r\n\t\t\t  <Checkbox\r\n\t\t\t\tindeterminate={numSelected > 0 && numSelected < rowCount}\r\n\t\t\t\tchecked={rowCount > 0 && numSelected === rowCount}\r\n\t\t\t\tonChange={onSelectAllClick}\r\n\t\t\t\tinputProps={{ 'aria-label': 'select all' }}\r\n\t\t\t  />\r\n\t\t\t</TableCell>\r\n\t\t}\r\n\t\t\r\n        {headCells.map(headCell => (\r\n          <TableCell\r\n            key={headCell.id}\r\n            align={headCell.align || 'left'}\r\n            padding={headCell.disablePadding ? 'none' : 'default'}\r\n            sortDirection={sortable && (orderBy === headCell.id ? order : false)}\r\n\t\t\tstyle={{ width: headCell.width || 'auto' }}\r\n          >\r\n\t\t  {sortable ?\r\n            <TableSortLabel\r\n              active={orderBy === headCell.id}\r\n              direction={orderBy === headCell.id ? order : 'asc'}\r\n              onClick={createSortHandler(headCell.orderBy || headCell.id)}\r\n            >\r\n              <strong>{headCell.label}</strong>\r\n            </TableSortLabel>\r\n\t\t\t:\r\n\t\t\t <strong>{headCell.label}</strong>\r\n\t\t\t}\r\n          </TableCell>\r\n        ))}\r\n      </TableRow>\r\n    </TableHead>\r\n  );\r\n}\r\n\r\nEnhancedTableHead.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n  numSelected: PropTypes.number.isRequired,\r\n  onRequestSort: PropTypes.func.isRequired,\r\n  onSelectAllClick: PropTypes.func.isRequired,\r\n  order: PropTypes.oneOf(['asc', 'desc']).isRequired,\r\n  orderBy: PropTypes.string.isRequired,\r\n  rowCount: PropTypes.number.isRequired,\r\n};","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\nimport clsx from 'clsx'\r\nimport { format } from 'date-fns'\r\n\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tnoWrap: {\r\n\t\twhiteSpace: 'nowrap'\r\n\t}\r\n}));\r\n\r\n\r\n// https://stackoverflow.com/questions/9382167/serializing-object-that-contains-cyclic-object-value\r\nfunction nestedObjects(key, val, seen) {\r\n\t\r\n\tif (val !== null && typeof val === 'object') {\r\n\t\tif (seen.indexOf(val) >= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tseen.push(val);\r\n\t}\r\n\t\r\n\treturn val;\r\n}\r\n\r\nfunction showTableContent(content, type = '') {\r\n\t\r\n\tif (content === undefined || content === null) {\r\n\t\treturn '';\r\n\t}\r\n\t\r\n\tlet seen = [];\r\n\tswitch(type.toLowerCase()) {\r\n\t\tcase 'date':\r\n\t\t\tcontent = format(content, 'yyyy-MM-dd HH:mm:ss');\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault:\r\n\t\t\tcontent = Array.isArray(content) || typeof content === 'object' ? JSON.stringify(content, (key, val) => nestedObjects(key, val, seen)) : content;\r\n\t\t\tcontent = typeof content === 'boolean' ? content.toString() : content;\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn content;\r\n}\r\n\r\nexport default function EnhancedTable(props) {\r\n\tconst { columns, sortedRows, emptyRows, rowStyles, selectable, selected, onClick } = props;\r\n\tconst classes = useStyles();\r\n\tconst isSelected = id => selected.indexOf(id) !== -1;\r\n\r\n\treturn (\r\n\r\n<TableBody>\r\n\t{sortedRows.map((row, index) => {\r\n\t\tconst isItemSelected = isSelected(row.id);\r\n\t\tconst labelId = `enhanced-table-checkbox-${index}`;\r\n\t\t\r\n\t\tlet styles = {};\r\n\t\tfor (let columnId in rowStyles) {\r\n\t\t\tlet rowStyle = rowStyles[columnId];\r\n\t\t\t\r\n\t\t\tif (row[columnId] && Object.keys(rowStyle).indexOf(row[columnId]) > -1) {\r\n\t\t\t\tstyles = { ...styles, ...rowStyle[row[columnId]] };\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n\t<TableRow\r\n\t\tkey={'TableRow-' + index}\r\n\t\thover\r\n\t\tonClick={onClick ? (event => onClick(event, row.id)) : undefined}\r\n\t\trole=\"checkbox\"\r\n\t\taria-checked={isItemSelected}\r\n\t\ttabIndex={-1}\r\n\t\tselected={isItemSelected}\r\n\t\t>\r\n\t\t\r\n\t\t{selectable !== false &&\r\n\t\t<TableCell\r\n\t\t\tkey={'TableCell-' + index + '-Checkbox'}\r\n\t\t\tstyle={styles}\r\n\t\t\tpadding=\"checkbox\"\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<Checkbox\r\n\t\t\t\tchecked={isItemSelected}\r\n\t\t\t\tinputProps={{ 'aria-labelledby': labelId }}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</TableCell>\r\n\t\t}\r\n\t\t\r\n\t\t{columns.map(column => (\r\n\t\t<TableCell\r\n\t\t\tkey={'TableCell-' + index + '-' + column.id}\r\n\t\t\tclasses={{ root: clsx(column.noWrap && classes.noWrap) }}\r\n\t\t\tstyle={styles}\r\n\t\t\tscope=\"row\"\r\n\t\t\tpadding={column.disablePadding ? 'none' : 'default'}\r\n\t\t\t>\r\n\r\n\t\t\t{showTableContent(row[column.id], column.type)}\r\n\t\t</TableCell>\r\n\r\n\t\t))}\r\n\r\n\t</TableRow>\r\n\t\t\r\n\t\t);\r\n\t})}\r\n\t\r\n\t{emptyRows > 0 && (\r\n\t<TableRow style={{ height: 53 * emptyRows }}>\r\n\t\t<TableCell colSpan={6} />\r\n\t</TableRow>\r\n\t)}\r\n\t\r\n</TableBody>\r\n\r\n\t);\r\n}","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React, { useEffect } from 'react'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Table from '@material-ui/core/Table'\r\nimport TableContainer from '@material-ui/core/TableContainer'\r\nimport TablePagination from '@material-ui/core/TablePagination'\r\n\r\nimport EnhancedTableToolbar from '../components/EnhancedTableToolbar'\r\nimport EnhancedTableHead from '../components/EnhancedTableHead'\r\nimport EnhancedTableBody from '../components/EnhancedTableBody'\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  table: {\r\n    minWidth: 750,\r\n  }\r\n}));\r\n\r\n\r\nfunction descendingComparator(a, b, orderBy, orderByCase) {\r\n\t\r\n\tlet orderA, orderB;\r\n\tif (orderBy.indexOf('.') === -1) {\r\n\t\torderA = a[orderBy] || '';\r\n\t\torderB = b[orderBy] || '';\r\n\t}\r\n\telse {\r\n\t\tlet tmpA = { ...a };\r\n\t\tlet tmpB = { ...b };\r\n\t\tlet key = orderBy;\r\n\t\tlet index;\r\n\t\t\r\n\t\twhile (key.indexOf('.') > -1) {\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tindex = key.substr(0, key.indexOf('.'));\r\n\t\t\t\tkey = key.substr(key.indexOf('.')+1);\r\n\t\t\t\ttmpA = tmpA[index];\r\n\t\t\t\ttmpB = tmpB[index];\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tconsole.error(err.message);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\torderA = tmpA[key] || '';\r\n\t\torderB = tmpB[key] || '';\r\n\t}\r\n\t\r\n\tif (orderByCase !== true) {\r\n\t\torderA = typeof orderA === 'object' ? JSON.stringify(orderA) : orderA.toLowerCase();\r\n\t\torderB = typeof orderB === 'object' ? JSON.stringify(orderB) : orderB.toLowerCase();\r\n\t}\r\n\t\r\n\t\r\n  if (orderB < orderA) {\r\n    return -1;\r\n  }\r\n  if (orderB > orderA) {\r\n    return 1;\r\n  }\r\n  return 0;\r\n}\r\n\r\nfunction getComparator(order, orderBy, orderByCase) {\r\n  return order === 'desc'\r\n    ? (a, b) => descendingComparator(a, b, orderBy, orderByCase)\r\n    : (a, b) => -descendingComparator(a, b, orderBy, orderByCase);\r\n}\r\n\r\nfunction stableSort(array, comparator) {\r\n  const stabilizedThis = array.map((el, index) => [el, index]);\r\n  stabilizedThis.sort((a, b) => {\r\n    const order = comparator(a[0], b[0]);\r\n    if (order !== 0) return order;\r\n    return a[1] - b[1];\r\n  });\r\n  return stabilizedThis.map(el => el[0]);\r\n}\r\n\r\nexport default function EnhancedTable(props) {\r\n  const classes = useStyles();\r\n  \r\n  const { title, headCells, size, CustomTableBody, rows, toolbar, selectable, pagination, defaultOrder, defaultOrderBy, orderByCase, defaultSelected, defaultPage, defaultRowsPerPage, toolbarRightActionButton } = props;\r\n  \r\n  const [order, setOrder] = React.useState(defaultOrder || 'asc');\r\n  const [orderBy, setOrderBy] = React.useState(defaultOrderBy || headCells[0].orderBy || headCells[0].id);\r\n  const [selected, setSelected] = React.useState(defaultSelected || []);\r\n  const [page, setPage] = React.useState(defaultPage || 0);\r\n  const [rowsPerPage, setRowsPerPage] = React.useState(pagination ? (defaultRowsPerPage || 5) : rows.length);\r\n\r\nuseEffect(() => setRowsPerPage(pagination ? (defaultRowsPerPage || 5) : rows.length), [rows.length, pagination, defaultRowsPerPage]);\r\n\r\n\r\n  const handleRequestSort = (event, property) => {\r\n    const isAsc = orderBy === property && order === 'asc';\r\n    setOrder(isAsc ? 'desc' : 'asc');\r\n    setOrderBy(property);\r\n  };\r\n\r\n  const handleSelectAllClick = event => {\r\n    if (event.target.checked) {\r\n      const newSelecteds = rows.map(n => n.id);\r\n      setSelected(newSelecteds);\r\n      return;\r\n    }\r\n    setSelected([]);\r\n  };\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = event => {\r\n    setRowsPerPage(parseInt(event.target.value, 10));\r\n    setPage(0);\r\n  };\r\n\r\n  const selectRow = (event, id) => {\r\n    const selectedIndex = selected.indexOf(id);\r\n    let newSelected = [];\r\n\r\n    if (selectedIndex === -1) {\r\n      newSelected = newSelected.concat(selected, id);\r\n    } else if (selectedIndex === 0) {\r\n      newSelected = newSelected.concat(selected.slice(1));\r\n    } else if (selectedIndex === selected.length - 1) {\r\n      newSelected = newSelected.concat(selected.slice(0, -1));\r\n    } else if (selectedIndex > 0) {\r\n      newSelected = newSelected.concat(\r\n        selected.slice(0, selectedIndex),\r\n        selected.slice(selectedIndex + 1),\r\n      );\r\n    }\r\n\r\n    setSelected(newSelected);\r\n  };\r\n\r\n  const TableBody = CustomTableBody || EnhancedTableBody;\r\n  return (\r\n\t<React.Fragment>\r\n\t\t{toolbar !== false &&\r\n        <EnhancedTableToolbar\r\n\t\t  title={title}\r\n          rowCount={rows.length}\r\n\t\t  numSelected={selected.length || 0}\r\n\t\t  rightActionButton={toolbarRightActionButton}\r\n\t\t  />}\r\n\t\t\r\n        <TableContainer>\r\n          <Table\r\n            className={classes.table}\r\n            aria-labelledby=\"tableTitle\"\r\n            aria-label=\"enhanced table\"\r\n\t\t\tsize={size}\r\n\t\t\tstickyHeader={true}\r\n          >\r\n            <EnhancedTableHead\r\n              classes={classes}\r\n              numSelected={selected.length}\r\n              order={order}\r\n              orderBy={orderBy}\r\n              onSelectAllClick={handleSelectAllClick}\r\n              onRequestSort={handleRequestSort}\r\n              rowCount={rows.length}\r\n\t\t\t  {...props}\r\n            />\r\n\t\t\t\r\n\t\t\t<TableBody\r\n\t\t\t\tcolumns={headCells}\r\n\t\t\t\tsortedRows={stableSort(rows, getComparator(order, orderBy, orderByCase)).slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)}\r\n\t\t\t\temptyRows={rowsPerPage - Math.min(rowsPerPage, rows.length - page * rowsPerPage)}\r\n\t\t\t\tonClick={selectable !== false && selectRow}\r\n\t\t\t\tselected={selected}\r\n\t\t\t\t{...props}\r\n\t\t\t\t/>\r\n\t\t\t\r\n          </Table>\r\n        </TableContainer>\r\n\t\t{pagination && <TablePagination\r\n          rowsPerPageOptions={[5, 10, 25]}\r\n          component=\"div\"\r\n          count={rows.length}\r\n          rowsPerPage={rowsPerPage}\r\n          page={page}\r\n          onChangePage={handleChangePage}\r\n          onChangeRowsPerPage={handleChangeRowsPerPage}\r\n        />}\r\n\t</React.Fragment>\r\n\t\r\n  );\r\n}","\r\n\r\nexport default {\r\n\t\"state\": {\r\n\t\t\"label\": \"config#Devices#state#label\",\r\n\t\t\"info\": \"config#Devices#state#info\",\r\n\t\t\r\n\t\t//<IGNORE>\r\n\t\t// white space not allowed\r\n\t\t\"onValidate\": val => {\r\n\t\t\tif (val.indexOf(' ') > -1) {\r\n\t\t\t\tthrow new Error('No whitespaces allowed in the state');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn val;\r\n\t\t}//</IGNORE>\r\n\t},\r\n\t\"stateStyle\": {\r\n\t\t\"label\": \"config#Devices#stateStyle#label\",\r\n\t\t\"info\": \"config#Devices#stateStyle#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"properties\": {\r\n\t\t\"label\": \"config#Devices#properties#label\",\r\n\t\t\"info\": \"config#Devices#properties#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"display\": {\r\n\t\t\"label\": \"config#Devices#display#label\",\r\n\t\t\"info\": \"config#Devices#display#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"label\": {\r\n\t\t\"label\": \"config#Devices#label#label\",\r\n\t\t\"info\": \"config#Devices#label#info\"\r\n\t},\r\n\t\"unit\": {\r\n\t\t\"label\": \"config#Devices#unit#label\",\r\n\t\t\"info\": \"config#Devices#unit#info\",\r\n\t\t\"json\": true,\r\n\t\t\r\n\t\t// if only a single string is given for a unit, convert it to a json compatible format to it will pass validation later\r\n\t\t\"onValidate\": val => val.indexOf(\" \") === -1 && val.indexOf('\"') === -1 && val.indexOf(\"}\") === -1 && val.indexOf(\"{\") === -1 ? '\"' + val + '\"' : val\r\n\t},\r\n\t\"icon\": {\r\n\t\t\"label\": \"config#Devices#icon#label\",\r\n\t\t\"info\": \"config#Devices#icon#info\",\r\n\t\t\"link\": \"https://materialdesignicons.com/\",\r\n\t\t\"json\": true,\r\n\t\t\r\n\t\t// if only a single string is given for an icon, convert it to a json compatible format to it will pass validation later\r\n\t\t\"onValidate\": val => val.indexOf(\" \") === -1 && val.indexOf('\"') === -1 && val.indexOf(\"}\") === -1 && val.indexOf(\"{\") === -1 ? '\"' + val + '\"' : val\r\n\t},\r\n\t\"iconStyle\": {\r\n\t\t\"label\": \"config#Devices#iconStyle#label\",\r\n\t\t\"info\": \"config#Devices#iconStyle#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"placeholder_1\": {\r\n\t\t\"type\": \"Placeholder\"\r\n\t},\r\n\t\"action\": {\r\n\t\t\"label\": \"config#Devices#action#label\",\r\n\t\t\"info\": \"config#Devices#action#info\",\r\n\t\t\r\n\t\t//<IGNORE>\r\n\t\t// white space not allowed\r\n\t\t\"onValidate\": val => {\r\n\t\t\tif (val.indexOf(' ') > -1) {\r\n\t\t\t\tthrow new Error('No whitespaces allowed in the state');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn val;\r\n\t\t}//</IGNORE>\r\n\t},\r\n\t\"bodyElement\": {\r\n\t\t\"label\": \"config#Devices#bodyElement#label\",\r\n\t\t\"autoComplete\": true,\r\n\t\t\"autoHighlight\": true,\r\n\t\t\"options\": null,\r\n\t\t\"renderOption\": null\r\n\t},\r\n\t\"actionElement\": {\r\n\t\t\"label\": \"config#Devices#actionElement#label\",\r\n\t\t\"autoComplete\": true,\r\n\t\t\"autoHighlight\": true,\r\n\t\t\"options\": null,\r\n\t\t\"renderOption\": null\r\n\t},\r\n\t\"hide\": {\r\n\t\t\"label\": \"config#Devices#hide#label\",\r\n\t\t\"info\": \"config#Devices#hide#info\",\r\n\t\t\"type\": \"Switch\"\r\n\t}\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Cache from '../../../controller/Cache'\r\nimport Connection from '../../../controller/Connection'\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\nimport timeConverter from '../../../helpers/timeConverter'\r\n\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport TreeItem from '@material-ui/lab/TreeItem'\r\nimport TreeView from '@material-ui/lab/TreeView'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport CollapseIcon from '@material-ui/icons/ArrowDropDown'\r\nimport ExpandIcon from '@material-ui/icons/ArrowRight'\r\nimport GroupIcon from '@material-ui/icons/Folder'\r\nimport RefreshIcon from '@material-ui/icons/Refresh'\r\nimport StateIcon from '@material-ui/icons/BookmarkBorder'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tdivider: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\tTreeView: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t'&:focus > $TreeItemContent $TreeItemLabel, &:hover > $TreeItemContent $TreeItemLabel, &$TreeItemSelected > $TreeItemContent $TreeItemLabel': {\r\n\t\t\tbackgroundColor: 'transparent',\r\n\t\t},\r\n\t},\r\n\tTreeItem: {\r\n\t\tcolor: theme.palette.text.secondary,\r\n\t\t'&:hover > $TreeItemContent': {\r\n\t\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\t},\r\n\t},\r\n\tTreeItemContent: {\r\n\t\tcolor: theme.palette.text.secondary,\r\n\t\tpaddingRight: theme.spacing(1),\r\n\t\t//fontWeight: theme.typography.fontWeightMedium,\r\n\t\t'$TreeItemExpanded > &': {\r\n\t\t\t//fontWeight: theme.typography.fontWeightRegular,\r\n\t\t},\r\n\t},\r\n\tTreeItemError: {\r\n\t\tbackgroundColor: theme.palette.error.light,\r\n\t\ttextDecoration: 'line-through',\r\n\t\tcursor: 'not-allowed !important',\r\n\t\tfontWeight: 'normal',\r\n\t},\r\n\tTreeItemExpanded: {\r\n\t},\r\n\tTreeItemSelected: {\r\n\t\tfontWeight: 'bold !important',\r\n\t},\r\n\tTreeItemGroup: {\r\n\t\tfontWeight: 'initial',\r\n\t\t'& $TreeItemContent': {\r\n\t\t\tpaddingLeft: theme.spacing(2),\r\n\t\t},\r\n\t},\r\n\tTreeItemLabel: {\r\n\t\tfontWeight: 'inherit',\r\n\t\tcolor: 'inherit',\r\n\t},\r\n\tEntry: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tpadding: theme.spacing(0.5, 0),\r\n\t},\r\n\tGroup: {\r\n\t\t//fontWeight: 'bold'\r\n\t},\r\n\tEntryIcon: {\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tEntryText: {\r\n\t\tfontWeight: 'inherit',\r\n\t\tflexGrow: 1,\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst indexObjects = (list, index) => {\r\n\tlet objectsTree = {}\r\n\tlet root = [];\r\n\t\r\n\tfor (let objectId of list) {\r\n\t\t\r\n\t\t// index state\r\n\t\tobjectsTree[objectId.substr(0, objectId.lastIndexOf('.'))] = objectsTree[objectId.substr(0, objectId.lastIndexOf('.'))] || {}\r\n\t\tobjectsTree[objectId.substr(0, objectId.lastIndexOf('.'))][objectId] = index[objectId];\r\n\t\t\r\n\t\t// make sure state is added to all its parents\r\n\t\tlet namespace = objectId;\r\n\t\twhile (namespace.indexOf('.') > -1) {\r\n\t\t\tconst id = namespace;\r\n\t\t\tnamespace = namespace.substr(0, namespace.lastIndexOf('.'));\r\n\t\t\t\r\n\t\t\tif (objectsTree[namespace] === undefined || objectsTree[namespace][id] === undefined) {\r\n\t\t\t\tobjectsTree[namespace] = objectsTree[namespace] || {}\r\n\t\t\t\tobjectsTree[namespace][id] = {}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (namespace && namespace.indexOf('.') === -1 && root.indexOf(namespace) === -1) {\r\n\t\t\t\troot.push(namespace);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn [ root, objectsTree ];\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst StateExplorer = React.memo(props => {\r\n\tconst { val, _onChange } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\tconst [objectList,setObjectList] = useState(Cache.get('objectList') || null);\r\n\tconst selectedItem = useRef(val);\r\n\tconst searchTimeout = useRef();\r\n\t\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (objectList === null || !objectList.root) {\r\n\t\t\tconst socket = Connection.connection;\r\n\t\t\tsocket.getObjects()\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tlet list = [];\r\n\t\t\t\t\tlet index = {}\r\n\t\t\t\t\t\r\n\t\t\t\t\tres.forEach((promise, i) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (promise.status === 'fulfilled' && promise.value && Array.isArray(promise.value.rows)) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// read results and sort\r\n\t\t\t\t\t\t\tfor (let obj of promise.value.rows) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// skip system\r\n\t\t\t\t\t\t\t\tif (obj.id.substr(0,6) === 'system') {\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// index result\r\n\t\t\t\t\t\t\t\tindex[obj.id] = obj.value;\r\n\t\t\t\t\t\t\t\tlist.push(obj.id);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t// index sorted results\r\n\t\t\t\t\tlist.sort();\r\n\t\t\t\t\tconst [ root, tree ] = indexObjects(list, index);\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst _objectList = {\r\n\t\t\t\t\t\t'updated': Date.now(),\r\n\t\t\t\t\t\t'root': root.sort(),\r\n\t\t\t\t\t\t'list': list,\r\n\t\t\t\t\t\t'tree': tree\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tCache.set('objectList', _objectList);\r\n\t\t\t\t\tsetObjectList(_objectList);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tLog._('StateExplorer', error.message, 'error', true, error.stack);\r\n\t\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t}, [objectList]);\r\n\t\r\n\t//\r\n\tconst search = (props, val) => {\r\n\t\tclearTimeout(searchTimeout.current);\r\n\t\tsearchTimeout.current = setTimeout(() => {\r\n\t\t\tconst data = Cache.get('objectList');\r\n\t\t\t\r\n\t\t\tconst [ root, tree ] = indexObjects(data.list.filter(obj => obj.toLowerCase().indexOf(val.toLowerCase()) > -1), data.tree);\r\n\t\t\tsetObjectList(prevObjectList => ({\r\n\t\t\t\t...prevObjectList,\r\n\t\t\t\t'root': root.sort(),\r\n\t\t\t\t'tree': tree\r\n\t\t\t}));\r\n\t\t\t\r\n\t\t}, 750);\r\n\t}\r\n\t\r\n\t//\r\n\tconst selectObject = (e, val) => {\r\n\t\tconst selected = objectList.tree[val] || null; // tree only holds channels, thus null will be a state\r\n\t\t\r\n\t\tif (selected === null) {\r\n\t\t\tval = val.indexOf(' ') === -1 ? val : '';\r\n\t\t\tselectedItem.current = val;\r\n\t\t\t_onChange(val);\r\n\t\t}\r\n\t}\r\n\t\r\n\t//\r\n\tconst renderTree = key => {\r\n\t\tlet states = [];\r\n\t\tlet children = [];\r\n\t\t\r\n\t\t// channels\r\n\t\tif (objectList.tree[key]) {\r\n\t\t\tObject.keys(objectList.tree[key]).forEach(channelKey => {\r\n\t\t\t\tconst child = objectList.tree[key][channelKey];\r\n\t\t\t\t\r\n\t\t\t\tif (child.type === 'state') {\r\n\t\t\t\t\tstates.push(channelKey);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tchildren.push(renderTree(channelKey));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\t\r\n\t\t// states\r\n\t\tif (states.length > 0) {\r\n\t\t\tchildren = children.concat(\r\n\t\t\t\tstates.map(stateKey => <Item key={stateKey} error={(stateKey.indexOf(' ') > -1)} nodeId={stateKey} label={<Entry key={stateKey} error={(stateKey.indexOf(' ') > -1)} id={stateKey.substr(stateKey.lastIndexOf('.')+1)} {...objectList.tree[stateKey.substr(0, stateKey.lastIndexOf('.'))][stateKey]} />} />)\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\tconst channel = key.substr(key.lastIndexOf('.')+1);\r\n\t\tconst details = key.indexOf('.') > -1 ? objectList.tree[key.substr(0, key.lastIndexOf('.'))][key] : {}\r\n\t\treturn (\r\n\t\t\t<Item key={key} nodeId={key} children={children} label={<Entry key={key} group id={channel} {...details} />} />\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<Paper>\r\n\t\t\t<Inputs.Fieldset>\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tid='search'\r\n\t\t\t\t\tlabel='Search'\r\n\t\t\t\t\tonChange={search}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<div className={classes.divider} />\r\n\t\t\t\t<div style={{ margin: 'auto 0' }}>\r\n\t\t\t\t\t{objectList !== null && <span style={{ margin: 'auto 0' }}>{i18n.t('Last refresh') + ': ' + timeConverter.parseDate(objectList.updated, 'dd.MM.yyyy, HH:mm:ss')}</span>}\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\tlabel='refresh'\r\n\t\t\t\t\t\tstartIcon={<RefreshIcon />}\r\n\t\t\t\t\t\tonClick={() => setObjectList(null)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t\t<Divider />\r\n\t\t\t\r\n\t\t\t{(objectList === null || !objectList.root) ?\r\n\t\t\t<LinearProgress />\r\n\t\t\t:\r\n\t\t\t<TreeView\r\n\t\t\t\tclassName={classes.TreeView}\r\n\t\t\t\tdefaultCollapseIcon={<CollapseIcon />}\r\n\t\t\t\tdefaultExpandIcon={<ExpandIcon />}\r\n\t\t\t\tonNodeSelect={selectObject}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{objectList.root.map(key => renderTree(key))}\r\n\t\t\t</TreeView>}\r\n\t\t</Paper>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst Item = props => {\r\n\tconst { children, error, ...otherProps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<TreeItem\r\n\t\t\tclasses={{\r\n\t\t\t\troot: clsx(error && classes.TreeItemError, classes.TreeItem),\r\n\t\t\t\tcontent: classes.TreeItemContent,\r\n\t\t\t\texpanded: classes.TreeItemExpanded,\r\n\t\t\t\tselected: classes.TreeItemSelected,\r\n\t\t\t\tgroup: classes.TreeItemGroup,\r\n\t\t\t\tlabel: classes.TreeItemLabel\r\n\t\t\t}}\r\n\t\t\t\r\n\t\t\t{...otherProps}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{children || null}\r\n\t\t</TreeItem>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst Entry = props => {\r\n\tconst { id, error, type, group, common } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst name = common && common.name ? common.name : '';\t\r\n\tconst EntryIcon = group ? GroupIcon : StateIcon;\r\n\treturn (\r\n\t\t<div className={clsx(error && classes.TreeItemError, classes.Entry, group && classes.Group)}>\r\n\t\t\t<EntryIcon color=\"inherit\" className={classes.EntryIcon} />\r\n\t\t\t<EntryText width=\"40%\" caption label={id} />\r\n\t\t\t{name.length > 60 ? \r\n\t\t\t\t<Tooltip title={name} arrow>\r\n\t\t\t\t\t<div style={{ width: '40%' }}>\r\n\t\t\t\t\t\t<EntryText label={name.substr(0, 60) + '...'} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t:\r\n\t\t\t\t<EntryText width=\"40%\" label={name} />\r\n\t\t\t}\r\n\t\t\t<EntryText width=\"10%\" label={type} />\r\n\t\t\t<EntryText width=\"10%\" label={common && common.role} />\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst EntryText = props => {\r\n\tconst { label, width, caption } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<div style={{ width: width || '100%' }}>\r\n\t\t\t<Typography variant={caption ? 'caption' : 'body2'} className={classes.EntryText}>\r\n\t\t\t\t{(label && label[i18n.getLanguage()]) || label || ''}\r\n\t\t\t</Typography>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport const StateExplorerPopup = React.memo(props => {\r\n\tconst { open, _onClose, _onChange } = props;\r\n\t\r\n\tconst state = useRef(props.val);\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('State Explorer')}\r\n\t\t\tactions={[\r\n\t\t\t\t<Inputs.Button key='action-cancel' variant=\"text\" onClick={_onClose} color=\"secondary\" label=\"Cancel\" />,\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={() => _onChange(state.current)} color=\"primary\" label=\"Apply\" />\r\n\t\t\t]}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='lg'\r\n\t\t\tfullWidth={true}\r\n\t\t\t\r\n\t\t\topen={open}\r\n\t\t\tonClose={_onClose}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<StateExplorer {...props} _onChange={s => state.current = s} />\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default StateExplorer;\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\r\n\r\nimport DevicesStates from './Devices.config'\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\nimport FUNCTIONS, { icons as FUNCTION_ICONS, componentsOptions } from '../../../functions'\r\nimport ucFirst from '../../../helpers/utils'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\n\r\nimport AddIcon from '@material-ui/icons/Add'\r\nimport EditIcon from '@material-ui/icons/Edit'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\nimport ComponentConfig from '../DevicesPage/ComponentConfigPage'\r\nimport { JsonEditorPopup } from '../DevicesPage/JsonEditor'\r\nimport { StateExplorerPopup } from '../DevicesPage/StateExplorer'\r\nimport { Screenshot, getComponents } from '../../../modules/StateList/StateList.settings'\r\n\r\nimport Collapsible, { CollapsibleSummary, CollapsibleDetails } from '../../../components/Collapsible'\r\nimport Dialog from '../../../components/Dialog'\r\nimport Icon from '../../../components/Icon'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n\tfullWidth: {\r\n\t\twidth: '100%',\r\n\t},\r\n\ticonContainer: {\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'center'\r\n\t},\r\n\talignRight: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\t\r\n\t\t'& > :not(:first-child)': {\r\n\t\t\tmarginLeft: 8,\r\n\t\t}\r\n\t},\r\n\tModifyIcon: {\r\n\t\tverticalAlign: 'bottom'\r\n\t},\r\n\theading: {\r\n\t\tmargin: 'auto auto auto 0'\r\n\t},\r\n\tListItem: {\r\n\t\tpadding: 0\r\n\t},\r\n\tdrag: {\r\n\t\tcursor: 'grab !important',\r\n\t\tuserSelect: 'none',\r\n\t\t\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\t}\r\n\t},\r\n\tisDragging: {\r\n\t\tbackgroundColor: theme.palette.action.selected,\r\n\t}\r\n}));\r\n\r\n\r\nconst _merge = require('deepmerge');\r\nconst _copy = require('rfdc')();\r\n\r\nconst DevicesPage = React.memo(props => {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [device,setDevice] = useState(_copy(props.device));\r\n\tconst [errors,setErrors] = useState({});\r\n\tconst EDITOR = useRef({});\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onChange = useCallback((props, val) => {\r\n\t\t\r\n\t\t// error handler\r\n\t\tsetErrors(prevErrors => {\r\n\t\t\tlet nextErrors = { ...prevErrors }\r\n\t\t\t\r\n\t\t\t// error occured\r\n\t\t\tif (props.error && props.error !== prevErrors[props.id]) {\r\n\t\t\t\tnextErrors[props.id] = props.error;\r\n\t\t\t\treturn nextErrors;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// no error -> remove old error\r\n\t\t\telse if (!props.error && prevErrors[props.id]) {\r\n\t\t\t\tdelete nextErrors[props.id];\r\n\t\t\t\treturn nextErrors;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevErrors;\r\n\t\t});\r\n\t\t\r\n\t\t// set value\r\n\t\tEDITOR.current[props.id] = val;\r\n\t\t\r\n\t}, []);\r\n\t\r\n\t/*\r\n\t * trigger initial validation\r\n\t */\r\n\tuseEffect(() => {\r\n\t\tif (!props.device.name) {\r\n\t\t\tsetErrors(prevErrors => ({\r\n\t\t\t\t...prevErrors,\r\n\t\t\t\t'device->name': true\r\n\t\t\t}));\r\n\t\t}\r\n\t\t\r\n\t}, [props.device.name]);\r\n\t\r\n\tif (device === null) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onSave = () => {\r\n\t\tlet savedDevice = { ...device }\r\n\t\tsavedDevice.options = savedDevice.options || {}\r\n\t\tsavedDevice.attributes = savedDevice.attributes || {}\r\n\t\t\r\n\t\tfor (const key in EDITOR.current) {\r\n\t\t\tconst val = EDITOR.current[key];\r\n\t\t\tconst [ type, base, characteristic, param ] = key.split('->');\r\n\t\t\t\r\n\t\t\t// states\r\n\t\t\tif (type === 'states') {\r\n\t\t\t\tif (typeof savedDevice[type][base] === 'object' && characteristic.toLowerCase().indexOf('config') > -1) {\r\n\t\t\t\t\tsavedDevice[type][base][characteristic] = savedDevice[type][base][characteristic] || {}\r\n\t\t\t\t\tsavedDevice[type][base][characteristic][param] = val;\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof savedDevice[type][base] === 'object') {\r\n\t\t\t\t\tsavedDevice[type][base][characteristic] = val;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tsavedDevice[type][base] = {\r\n\t\t\t\t\t\t'state': savedDevice[type][base],\r\n\t\t\t\t\t\t[characteristic]: val\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// options or attributes\r\n\t\t\telse if (type === 'options' || type === 'attributes') {\r\n\t\t\t\tsavedDevice[type][base] = val;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// device\r\n\t\t\telse {\r\n\t\t\t\tsavedDevice[base] = val;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// save\r\n\t\tsavedDevice.attributes._updated = Date.now();\r\n\t\tprops.onSave(savedDevice);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _deleteDevice = () => props.onDelete && props.onDelete(device.id);\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _addState = newStateKey => {\r\n\t\t\r\n\t\tconst stateKey = newStateKey.replace(/ /g, '');\r\n\t\tsetDevice(prevDevice => ({\r\n\t\t\t...prevDevice,\r\n\t\t\tstates: {\r\n\t\t\t\t[stateKey]: {},\r\n\t\t\t\t...prevDevice.states || {}\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _renameState = (stateKey, newStateKey) => {\r\n\t\tnewStateKey = newStateKey.replace(/ /g, '');\r\n\t\t\r\n\t\t// verify state key does not exist\r\n\t\tif (device.states[newStateKey] !== undefined) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// replace state key in layout\r\n\t\t//props.onReplaceStateKey(device.id, stateKey, newStateKey); // this is wrong here because Device has to be saved first\r\n\t\tEDITOR.current['states->' + newStateKey + '->_renamed'] = stateKey;\r\n\t\t\r\n\t\t// change state key in EDITOR\r\n\t\tlet state = {}\r\n\t\tfor (let key in EDITOR.current) {\r\n\t\t\tconst [ type, base, characteristic ] = key.split('->');\r\n\t\t\t\r\n\t\t\tif (type === 'states' && base === stateKey) {\r\n\t\t\t\tstate[characteristic] = EDITOR.current[key];\r\n\t\t\t\tEDITOR.current[type + '->' + newStateKey + '->' + characteristic] = EDITOR.current[key];\r\n\t\t\t\tdelete EDITOR.current[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// change state key in device\r\n\t\tsetDevice(prevDevice => {\r\n\t\t\tconst nextDevice = { ...prevDevice, 'states': {} }\r\n\t\t\t\r\n\t\t\tconst states = Object.keys(prevDevice.states);\r\n\t\t\tconst position = states.indexOf(stateKey);\r\n\t\t\tstates.splice(position, 1, newStateKey);\r\n\t\t\t\r\n\t\t\tfor (let sKey of states) {\r\n\t\t\t\tnextDevice.states[sKey] = {\r\n\t\t\t\t\t...prevDevice.states[sKey === newStateKey ? stateKey : sKey],\r\n\t\t\t\t\t...state\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn nextDevice;\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _addDefaultStates = func => {\r\n\t\t\r\n\t\tif (FUNCTIONS[func] !== undefined) {\r\n\t\t\tconst stateKeys = Object.keys(device.states || {});\r\n\t\t\tObject.keys(FUNCTIONS[func]).reverse().forEach(stateKey => {\r\n\t\t\t\tconst state = FUNCTIONS[func][stateKey];\r\n\t\t\t\t\r\n\t\t\t\tif (state.substitute !== true && stateKeys.indexOf(stateKey) === -1 && stateKey.substr(0,1) !== '_') {\r\n\t\t\t\t\t_addState(stateKey);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _moveState = res => {\r\n\t\t\r\n\t\tif (res.source && res.destination && res.source.index !== res.destination.index) {\r\n\t\t\t\r\n\t\t\tsetDevice(prevDevice => {\r\n\t\t\t\tlet nextDevice = { ...prevDevice, 'states': {} }\r\n\t\t\t\t\r\n\t\t\t\tlet states = Object.keys(prevDevice.states);\r\n\t\t\t\tstates.splice(res.destination.index, 0, states.splice(res.source.index, 1)[0]);\r\n\t\t\t\tstates.forEach(stateKey => {\r\n\t\t\t\t\tnextDevice.states[stateKey] = prevDevice.states[stateKey];\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\treturn nextDevice;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _deleteState = stateKey => {\r\n\t\t\r\n\t\t//props.onStateDelete(device.id, stateKey); // this is wrong here because Device has to be saved first\r\n\t\tsetDevice(prevDevice => {\r\n\t\t\tlet nextDevice = { ...prevDevice }\r\n\t\t\tdelete nextDevice.states[stateKey];\r\n\t\t\treturn nextDevice;\r\n\t\t});\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\tLog._('DevicesPages', 'RENDER DevicesPage', 'development');\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\tid='DeviceConfiguration'\r\n\t\t\theader={i18n.t('Device Configuration') + ' (' + i18n.t('Device ID') + ': ' + device.id + ')'}\r\n\t\t\tactions={[\r\n\t\t\t\t<Grid key='actions' container>\r\n\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t\t{device.name && <Inputs.Button key='action->delete' variant=\"text\" onClick={() => _deleteDevice()} color=\"secondary\" startIcon={<DeleteIcon />} label=\"Delete Device\" />}\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t<Grid item xs={6} className={classes.alignRight}>\r\n\t\t\t\t\t\t<Inputs.Button key='action->cancel' className=\"cancel\" variant=\"text\" onClick={() => props.onClose()} color=\"secondary\" label=\"Cancel\" />\r\n\t\t\t\t\t\t<Inputs.Button key='action->save' className=\"apply\" variant=\"text\" onClick={() => _onSave()} color=\"primary\" disabled={Object.keys(errors).length > 0} label=\"Apply\" />\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</Grid>\r\n\t\t\t]}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='lg'\r\n\t\t\tfullWidth={true}\r\n\t\t\t\r\n\t\t\topen={true}\r\n\t\t\tonClose={() => props.onClose()}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<Inputs.Fieldset label='General'>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tkey=\"device->name\"\r\n\t\t\t\t\t\tid=\"device->name\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\tautoFocus\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Device'\r\n\t\t\t\t\t\tval={device.name}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tkey=\"device->label\"\r\n\t\t\t\t\t\tid=\"device->label\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Label'\r\n\t\t\t\t\t\tval={device.label || ''}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Select\r\n\t\t\t\t\t\tkey=\"device->function\"\r\n\t\t\t\t\t\tid=\"device->function\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Function'\r\n\t\t\t\t\t\tval={device.function || 'other'}\r\n\t\t\t\t\t\tselection={\r\n\t\t\t\t\t\t\tObject.keys(FUNCTIONS).map(funcKey => {\r\n\t\t\t\t\t\t\t\tconst func = funcKey !== '_defaults' ? funcKey : 'other';\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t[func]: i18n.t(func),\r\n\t\t\t\t\t\t\t\t\t'icon': FUNCTION_ICONS[funcKey] || null,\r\n\t\t\t\t\t\t\t\t\t'_key': func,\r\n\t\t\t\t\t\t\t\t\t'_translated': true,\r\n\t\t\t\t\t\t\t\t\t'_sort': i18n.t(func)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsortOptionsByKey\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// add default state keys of function (if not added already)\r\n\t\t\t\t\t\t\tif (Object.keys(device.states).length === 0) {\r\n\t\t\t\t\t\t\t\t_addDefaultStates(val);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t_onChange(props, val);\r\n\t\t\t\t\t\t\tsetDevice(prevDevice => ({\r\n\t\t\t\t\t\t\t\t...prevDevice,\r\n\t\t\t\t\t\t\t\t'function': val\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tkey=\"device->icon\"\r\n\t\t\t\t\t\tid=\"device->icon\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Icon'\r\n\t\t\t\t\t\tval={device.icon || ''}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Switch\r\n\t\t\t\t\t\tkey=\"device->suppressPopup\"\r\n\t\t\t\t\t\tid=\"device->suppressPopup\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Suppress Popup'\r\n\t\t\t\t\t\tinfo='Do not open the device details in the popup when the device is clicked'\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tval={device.suppressPopup !== undefined ? device.suppressPopup : false}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t\t\r\n\t\t\t<Inputs.Fieldset label='States'>\r\n\t\t\t\t<DeviceStates\r\n\t\t\t\t\t_onChange={_onChange}\r\n\t\t\t\t\t_addState={_addState}\r\n\t\t\t\t\t_addDefaultStates={_addDefaultStates}\r\n\t\t\t\t\t_renameState={_renameState}\r\n\t\t\t\t\t_moveState={_moveState}\r\n\t\t\t\t\t_deleteState={_deleteState}\r\n\t\t\t\t\terrors={errors}\r\n\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t</Dialog>\r\n\t)\r\n});\r\n\r\nexport default DevicesPage;\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst AddDeviceState = React.memo(props => {\r\n\tLog._('DevicesPages', 'RENDER AddDeviceState', 'development');\r\n\tconst { device } = props;\r\n\t\r\n\tconst StateAddRef = useRef();\r\n\tconst [error,setError] = useState('');\r\n\t\r\n\tconst onAddState = () => {\r\n\t\tconst newStateKey = StateAddRef.current.value || '';\r\n\t\t\r\n\t\t// empty state key\r\n\t\tif (!newStateKey) {\r\n\t\t\tsetError(i18n.t('Type in a state key / identifier'));\r\n\t\t}\r\n\r\n\t\t// state key exists already\r\n\t\telse if (Object.keys(device.states || {}).indexOf(newStateKey) > -1) {\r\n\t\t\tsetError(i18n.t('State key already used'));\r\n\t\t}\r\n\t\t\r\n\t\t// add state\r\n\t\telse {\r\n\t\t\tsetError('');\r\n\t\t\tprops._setNewStateKey(newStateKey)\r\n\t\t\tprops._addState(newStateKey);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<ListItem key='StatesListItemLabel->add' dense divider className=\"DeviceStateAdd\">\r\n\t\t\t<ListItemIcon>\r\n\t\t\t\t<IconButton size=\"small\" disabled>\r\n\t\t\t\t\t<AddIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</ListItemIcon>\r\n\t\t\t\r\n\t\t\t<ListItemText disableTypography style={{ display: 'flex' }}>\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tid='states->add'\r\n\t\t\t\t\tref={StateAddRef}\r\n\t\t\t\t\tshrink={true}\r\n\t\t\t\t\tlabel='new state key'\r\n\t\t\t\t\tval={props.newStateKey}\r\n\t\t\t\t\tonEnter={onAddState}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<div style={{ display: 'flex', margin: 'auto 0' }}>\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\tclassName=\"DeviceStateAddButton\"\r\n\t\t\t\t\t\tlabel='add state'\r\n\t\t\t\t\t\tonClick={onAddState}\r\n\t\t\t\t\t\twidth={275}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\tlabel='add default states'\r\n\t\t\t\t\t\tonClick={() => props._addDefaultStates(device.function)}\r\n\t\t\t\t\t\twidth={275}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t\t<span style={{ color: '#900' }}>{error}</span>\r\n\t\t\t</ListItemText>\r\n\t\t</ListItem>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceStates = React.memo(props => {\r\n\tLog._('DevicesPages', 'RENDER DeviceStates', 'development');\r\n\tconst { device, _moveState } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst newStateKey = useRef('');\r\n\tconst setNewStateKey = val => newStateKey.current = val;\r\n\t\r\n\tconst renderedStates = Object.keys(device.states || {}).map((stateKey, i) => {\r\n\t\tlet state = device.states[stateKey];\r\n\t\tstate = typeof state === 'string' ? { 'state': state } : state;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<DragDeviceState\r\n\t\t\t\t{...props}\r\n\t\t\t\tkey={'DeviceState->' + stateKey}\r\n\t\t\t\tindex={i}\r\n\t\t\t\tstate={{ ...state, 'key': stateKey }}\r\n\t\t\t\texpanded={stateKey === newStateKey.current}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<List classes={{ root: classes.fullWidth }} dense>\r\n\t\t\t<AddDeviceState newStateKey={newStateKey.current} _setNewStateKey={setNewStateKey} {...props} />\r\n\t\t\t<DragDropContext onDragEnd={_moveState}>\r\n\t\t\t\t<Droppable\r\n\t\t\t\t\tkey='DeviceStates'\r\n\t\t\t\t\tdroppableId='states'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{(provided, snapshot) => (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t{...provided.droppableProps}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{renderedStates}\r\n\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Droppable>\r\n\t\t\t</DragDropContext>\r\n\t\t</List>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DragDeviceState = props => {\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<Draggable\r\n\t\t\tkey={props.state.key}\r\n\t\t\tdraggableId={'state->' + props.state.key}\r\n\t\t\tindex={props.index}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{(provided, snapshot) => (\r\n\t\t\t<div\r\n\t\t\t\tclassName={clsx(classes.drag, snapshot.isDragging && classes.isDragging)}\r\n\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<DeviceState {...props} />\r\n\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</Draggable>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceState = React.memo(props => {\r\n\tLog._('DevicesPages', 'RENDER DeviceState', 'development');\r\n\tconst { state, expanded, _renameState, _deleteState } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst fields = Object.keys(DevicesStates).map(field => <DeviceStateField key={'DeviceStateField->' + state.key + '->' + field} {...props} field={field} />);\r\n\tconst renameState = () => {\r\n\t\tconst stateKey = prompt(i18n.t('Rename State Key'), state.key);\r\n\t\t\r\n\t\tif (stateKey && stateKey !== state.key) {\r\n\t\t\t_renameState(state.key, stateKey);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<ListItem\r\n\t\t\tkey={'StatesListItem->' + state.key}\r\n\t\t\tclasses={{ root: clsx(classes.ListItem, 'DeviceState') }}\r\n\t\t\tdense\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t<Collapsible key={'DeviceState->' + state.key} expanded={expanded} className={'DeviceState DeviceState->' + state.key}>\r\n\t\t\t\t\t<CollapsibleSummary>\r\n\t\t\t\t\t\t<Typography classes={{ root: classes.heading }} display=\"inline\">{state.key}</Typography>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<IconButton size=\"small\" onClick={renameState}>\r\n\t\t\t\t\t\t\t<EditIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t<IconButton size=\"small\" onClick={e => {e.stopPropagation();_deleteState(state.key)}}>\r\n\t\t\t\t\t\t\t<DeleteIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t<Icon style={{ fontSize: '1.5em', margin: 'auto 8px' }} icon=\"mdi:drag\" />\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</CollapsibleSummary>\r\n\t\t\t\t\t<CollapsibleDetails>\r\n\t\t\t\t\t\t<Inputs.Fieldset noPadding>\r\n\t\t\t\t\t\t\t{fields}\r\n\t\t\t\t\t\t</Inputs.Fieldset>\r\n\t\t\t\t\t</CollapsibleDetails>\r\n\t\t\t\t</Collapsible>\r\n\t\t\t</ListItemText>\r\n\t\t</ListItem>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceStateField = React.memo(props => {\r\n\tconst { device, field } = props;\r\n\tconst fieldProps = DevicesStates[field];\r\n\tconst deviceDefaults = _merge(FUNCTIONS['_defaults'], FUNCTIONS[device.function] || {});\r\n\t\r\n\t// JSON\r\n\tif (fieldProps.json === true) {\r\n\t\treturn <DeviceStateFieldJsonEditor {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n\t\r\n\t// AutoComplete\r\n\telse if (fieldProps.options !== undefined) {\r\n\t\treturn <DeviceStateFieldAutoComplete {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n\t\r\n\t// State Explorer\r\n\telse if (field === 'state' || field === 'action') {\r\n\t\treturn <DeviceStateFieldStateExplorer {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n\t\r\n\t// Other\r\n\telse {\r\n\t\treturn <DeviceStateFieldOther {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n});\r\n\r\nconst DeviceStateFieldJsonEditor = React.memo(props => {\r\n\tconst { state, field, _onChange } = props;\r\n\t\r\n\t\r\n\tconst value = useRef(state[field] && state[field].node ? state[field].node : (state[field] || ''));\r\n\tconst setValue = val => value.current = val;\r\n\tconst [showJsonEditor,setShowJsonEditor] = useState(false);\r\n\tconst onChange = (props, val) => !props.error && _onChange(props, val);\r\n\t\r\n\t// additional props\r\n\tlet additionalProps = {}\r\n\tadditionalProps.action = () => setShowJsonEditor(true);\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t<JsonEditorPopup\r\n\t\t\t\topen={showJsonEditor}\r\n\t\t\t\t_onClose={() => setShowJsonEditor(false)}\r\n\t\t\t\tval={value.current}\r\n\t\t\t\theight={500}\r\n\t\t\t\t_onChange={val => {\r\n\t\t\t\t\tonChange({ 'id': 'states->' + state.key + '->' + field }, val);\r\n\t\t\t\t\tsetValue(val);\r\n\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<DeviceStateFieldInput {...props} additionalProps={additionalProps} val={value.current} setVal={setValue} _onChange={onChange} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldStateExplorer = React.memo(props => {\r\n\tconst { state, field, _onChange } = props;\r\n\t\r\n\t\r\n\tconst [value,setValue] = useState(state[field] && state[field].node ? state[field].node : (state[field] || ''));\r\n\tconst setVal = val => setValue(val);\r\n\tconst [showStateExplorer,setShowStateExplorer] = useState(false);\r\n\t\r\n\t// additional props\r\n\tlet additionalProps = {}\r\n\tadditionalProps.action = () => setShowStateExplorer(true);\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t\r\n\t\t\t<StateExplorerPopup\r\n\t\t\t\topen={showStateExplorer}\r\n\t\t\t\t_onClose={() => setShowStateExplorer(false)}\r\n\t\t\t\tval={value}\r\n\t\t\t\t_onChange={val => {\r\n\t\t\t\t\t_onChange({ 'id': 'states->' + state.key + '->' + field }, val);\r\n\t\t\t\t\tsetValue(val);\r\n\t\t\t\t\tsetShowStateExplorer(false);\r\n\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<DeviceStateFieldInput {...props} additionalProps={additionalProps} val={value} setVal={setVal} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldAutoComplete = React.memo(props => {\r\n\tconst { device, deviceDefaults, state, field, fieldProps, _onChange } = props;\r\n\t\r\n\t\r\n\t// components\r\n\tconst components = {\r\n\t\t'screenshot': (option, state) => <Screenshot func={device.function} option={option} selected={state.selected} />,\r\n\t\t'bodyElement': getComponents(device.function, 'body'),\r\n\t\t'actionElement': getComponents(device.function, 'action')\r\n\t}\r\n\t\r\n\tconst [value,setValue] = useState(\r\n\t\t(state[field] && state[field].node !== undefined) || state[field] !== undefined ? // prefer if given but empty (which means user has unselected it)\r\n\t\t\t((state[field] && state[field].node) || state[field] || '') : (\r\n\t\t\t\t(field.indexOf('Element') > -1 && deviceDefaults[state.key.toLowerCase()] && deviceDefaults[state.key.toLowerCase()][field]) ||\r\n\t\t\t\t(field.indexOf('Element') > -1 && deviceDefaults['_any'] && deviceDefaults['_any'][field]) ||\r\n\t\t\t\t''\r\n\t\t\t)\r\n\t);\r\n\t\r\n\tconst setVal = val => setValue(val);\r\n\tconst [componentConfig,setComponentConfig] = useState(null);\r\n\t\r\n\t//\r\n\tconst property = useRef({});\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (value && property.current[value] === undefined) {\r\n\t\t\tlet config = _merge(\r\n\t\t\t\tcomponentsOptions['_defaults'][value] || {},\r\n\t\t\t\t(componentsOptions[props.device.function] && componentsOptions[props.device.function][value]) || {}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\t// apply user specific values\r\n\t\t\tconst userConfig = props.state[value + 'Config'] || {}\r\n\t\t\tObject.keys(userConfig).forEach(c => {\r\n\t\t\t\tconfig[c] = typeof config[c] !== 'object' ? { 'val': config[c] } : config[c];\r\n\t\t\t\tconfig[c].val = userConfig[c];\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tproperty.current[value] = config;\r\n\t\t}\r\n\t\t\r\n\t}, [value, props.device, props.state]);\r\n\t\r\n\t// additional props\r\n\tlet additionalProps = {}\r\n\tif (fieldProps.options !== undefined) {\r\n\t\tadditionalProps.options = typeof fieldProps.options === 'function' ? fieldProps.options(props.device) : components[field];\r\n\t}\r\n\t\r\n\tif (fieldProps.renderOption !== undefined) {\r\n\t\tadditionalProps.renderOption = typeof fieldProps.renderOption === 'function' ? ((option, state) => fieldProps.renderOption(option, state, props.device)) : components['screenshot'];\r\n\t}\r\n\t\r\n\tadditionalProps.action = ((componentsOptions['_defaults'] && componentsOptions['_defaults'][value]) || (componentsOptions[device.function] && componentsOptions[device.function][value])) && (() => setComponentConfig({ 'id': field + 'Config', 'config': property.current[value] }));\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t\r\n\t\t\t<ComponentConfig\r\n\t\t\t\t_onClose={() => setComponentConfig(null)}\r\n\t\t\t\t_onChange={(props, val) => {\r\n\t\t\t\t\tconst key = props.id.substr(props.id.lastIndexOf('.')+1);\r\n\t\t\t\t\tproperty.current[value][key].val = val;\r\n\t\t\t\t\t_onChange({ ...props, 'id': 'states->' + state.key + '->' + value + 'Config->' + key }, val);\r\n\t\t\t\t}}\r\n\t\t\t\tid={(componentConfig && componentConfig.id) || null}\r\n\t\t\t\tconfig={(componentConfig && componentConfig.config) || {}}\r\n\t\t\t\tdevice={device}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<DeviceStateFieldInput {...props} additionalProps={additionalProps} val={value} setVal={setVal} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldOther = React.memo(props => {\r\n\tconst { state, field } = props;\r\n\t\r\n\t\r\n\tconst [value,setValue] = useState(state[field] && state[field].node ? state[field].node : (state[field] || ''));\r\n\tconst setVal = val => setValue(val);\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t<DeviceStateFieldInput {...props} val={value} setVal={setVal} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldInput = React.memo(props => {\r\n\tconst { deviceDefaults, state, field, fieldProps, additionalProps, setVal, _onChange } = props;\r\n\t\r\n\t\r\n\tconst Input = Inputs[fieldProps.type || 'Text'];\r\n\t\r\n\treturn (\r\n\t\t<Inputs.FieldsetItem className={'field->' + field} columns={4}>\r\n\t\t\t<Input\r\n\t\t\t\t{...fieldProps}\r\n\t\t\t\t{...additionalProps}\r\n\t\t\t\t\r\n\t\t\t\tid={'states->' + state.key + '->' + field}\r\n\t\t\t\tshrink={true}\r\n\t\t\t\tlabel={fieldProps.label || ucFirst(field)}\r\n\t\t\t\tplaceholder={(deviceDefaults[state.key.toLowerCase()] && deviceDefaults[state.key.toLowerCase()][field.replace('Element', '')]) || fieldProps.val || ''}\r\n\t\t\t\twidth={370}\r\n\t\t\t\tval={props.val}\r\n\t\t\t\t\r\n\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\tsetVal(val);\r\n\t\t\t\t\ttypeof fieldProps.onChange === 'function' ? fieldProps.onChange(props, val, _onChange) : _onChange(props, val);\r\n\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t</Inputs.FieldsetItem>\r\n\t);\r\n});\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n//import clsx from 'clsx'\r\nimport { v1 as uuid } from 'uuid'\r\n\r\nimport Log from '../../../controller/Log'\r\nimport i18n from '../../../controller/i18n'\r\nimport Devices from '../../../controller/Devices'\r\nimport Adapters from '../../../config/adapters'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Accordion from '@material-ui/core/Accordion'\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary'\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails'\r\nimport Chip from '@material-ui/core/Chip'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport InfoIcon from '@material-ui/icons/Info'\r\n\r\nimport Collapsible, { CollapsibleSummary, CollapsibleDetails } from '../../../components/Collapsible'\r\nimport Dialog from '../../../components/Dialog'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tfullWidth: {\r\n\t\twidth: '100%',\r\n\t},\r\n\theading: {\r\n\t\tpaddingRight: theme.spacing()\r\n\t},\r\n\ttransparent: {\r\n\t\tbackgroundColor: 'transparent',\r\n\t},\r\n\tListItem: {\r\n\t\tdisplay: 'flex',\r\n\t},\r\n\tgap: {\r\n\t\tmargin: '0 auto'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function ImportDevicesPage(props) {\r\n\tconst [loading,setLoading] = useState(null);\r\n\tconst [importDevices,setImportDevices] = useState({});\r\n\tconst componentWillUnmount = useRef(false);\r\n\t\r\n\tlet search = useRef({\r\n\t\tfilter: 'all',\r\n\t\tadapters: Object.keys(Adapters) || [],\r\n\t});\r\n\t\r\n\tlet foundDevicesByManufacturer = useRef({});\r\n\tlet categories = useRef({\r\n\t\t'_new': {\r\n\t\t\t'hash': '',\r\n\t\t\t'name': i18n.t('New Devices'),\r\n\t\t\t'expanded': true,\r\n\t\t\t'devices': []\r\n\t\t},\r\n\t\t'_added': {\r\n\t\t\t'hash': '',\r\n\t\t\t'name': i18n.t('Devices that have been added already'),\r\n\t\t\t'devices': []\r\n\t\t},\r\n\t\t'_incorrect': {\r\n\t\t\t'hash': '',\r\n\t\t\t'name': i18n.t('Devices with incorrect configuration (states not found)'),\r\n\t\t\t'devices': []\r\n\t\t},\r\n\t\t'_ignored': {\r\n\t\t\t'hash': '',\r\n\t\t\t'name': i18n.t('Devices marked as ignored'),\r\n\t\t\t'devices': []\r\n\t\t},\r\n\t});\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onClose = () => {\r\n\t\tcomponentWillUnmount.current = true;\r\n\t\tprops.onClose && props.onClose();\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _importDevices = () => props.onImport && props.onImport(importDevices);\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _markDeviceToImport = (device, addOrRemove = null) => {\r\n\t\t\r\n\t\t// mark device as ignored\r\n\t\tlet moveDeviceToIgnore = categories.current['_new'].devices.findIndex(d => d.id === device.id);\r\n\t\tlet moveDeviceToNew = categories.current['_ignored'].devices.findIndex(d => d.id === device.id);\r\n\t\t\r\n\t\tif (device.attributes && device.attributes.ignore === true && moveDeviceToIgnore > -1) {\r\n\t\t\tcategories.current['_new'].devices.splice(moveDeviceToIgnore, 1);\r\n\t\t\tcategories.current['_ignored'].devices.push(device);\r\n\t\t\tcategories.current['_ignored'].hash = uuid();\r\n\t\t\tcategories.current['_new'].hash = uuid();\r\n\t\t}\r\n\t\telse if (device.attributes && device.attributes.ignore === false && moveDeviceToNew > -1) {\r\n\t\t\tcategories.current['_ignored'].devices.splice(moveDeviceToNew, 1);\r\n\t\t\tcategories.current['_new'].devices.push(device);\r\n\t\t\tcategories.current['_ignored'].hash = uuid();\r\n\t\t\tcategories.current['_new'].hash = uuid();\r\n\t\t}\r\n\t\t\r\n\t\t// mark device to import\r\n\t\tsetImportDevices(prevImportDevices => {\r\n\t\t\tdevice.attributes = device.attributes || {}\r\n\t\t\t\r\n\t\t\tlet deviceIds = Object.keys(prevImportDevices);\r\n\t\t\tif (addOrRemove === true || (addOrRemove === null && (deviceIds.indexOf(device.id) === -1 || device.attributes.ignore === true || device.attributes.ignore === false))) {\r\n\t\t\t\tdevice.attributes.ignore = device.attributes.ignore === false ? null : device.attributes.ignore;\r\n\t\t\t\tdevice.attributes._created = Date.now();\r\n\t\t\t\t\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...prevImportDevices,\r\n\t\t\t\t\t[device.id]: device\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// unmark device from import\r\n\t\t\telse {\r\n\t\t\t\tlet nextImportDevices = { ...prevImportDevices }\r\n\t\t\t\tdelete nextImportDevices[device.id];\r\n\t\t\t\treturn nextImportDevices;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _setSearch = (attribute, value, action = null) => {\r\n\t\t\r\n\t\tif (Array.isArray(search.current[attribute])) {\r\n\t\t\t\r\n\t\t\t// remove from array\r\n\t\t\tif (action === 'remove' || (action === null && search.current[attribute].indexOf(value) > -1)) {\r\n\t\t\t\tsearch.current[attribute] = search.current[attribute].filter(adapter => adapter !== value);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// add to array\r\n\t\t\telse {\r\n\t\t\t\tsearch.current[attribute].push(value);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsearch.current[attribute] = value;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _setImportDeviceList = foundDevices => {\r\n\t\t\r\n\t\t// only show result list if dialogue has not been closed\r\n\t\tif (componentWillUnmount.current !== false) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// reset last search\r\n\t\tfoundDevicesByManufacturer.current = {}\r\n\t\tcategories.current._new.devices = [];\r\n\t\tcategories.current._added.devices = [];\r\n\t\tcategories.current._incorrect.devices = [];\r\n\t\tcategories.current._ignored.devices = [];\r\n\t\t\r\n\t\t// add devices\r\n\t\tlet deviceList = props.devices;\r\n\t\tlet newDevices = {}\r\n\t\t\r\n\t\tfoundDevices.forEach((res, index) => {\r\n\t\t\tlet device = res.value || res.reason.device;\r\n\t\t\tdevice.attributes = device.attributes || {}\r\n\t\t\t\r\n\t\t\t// get category\r\n\t\t\tlet categoryKey = '_new';\r\n\t\t\tif (res.status === 'fulfilled' && res.value && res.value.states && Object.keys(res.value.states).length > 0) {\r\n\t\t\t\t\r\n\t\t\t\t// device added already\r\n\t\t\t\tif (deviceList[device.id] !== undefined) {\r\n\t\t\t\t\tcategoryKey = '_added';\r\n\t\t\t\t\t\r\n\t\t\t\t\t// device has been ignored\r\n\t\t\t\t\tif (deviceList[device.id].attributes && deviceList[device.id].attributes.ignore === true) {\r\n\t\t\t\t\t\tcategoryKey = '_ignored';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tnewDevices[device.id] = device;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// by manufacturer\r\n\t\t\t\tif (device.attributes.manufacturer && device.attributes.manufacturer.namespace) {\r\n\t\t\t\t\tfoundDevicesByManufacturer.current[device.attributes.manufacturer.namespace] = foundDevicesByManufacturer.current[device.attributes.manufacturer.namespace] || [];\r\n\t\t\t\t\tfoundDevicesByManufacturer.current[device.attributes.manufacturer.namespace].push(device.id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tcategoryKey = '_incorrect';\r\n\t\t\t\tdevice.states = null;\r\n\t\t\t\tdevice.attributes.note = device.attributes.note || (res.reason && res.reason.error && res.reason.error.message) || i18n.t('No correct defined states found. The device may be unknown. Please help the developer to add support for this device and report to Github.');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tcategories.current[categoryKey].devices.push(device);\r\n\t\t});\r\n\t\t\r\n\t\tsetImportDevices(newDevices);\r\n\t\tsetLoading('done');\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _getDevices = () => {\r\n\t\tsetLoading('loading');\r\n\t\t\r\n\t\t/*\r\n\t\t * retrieve devices\r\n\t\t */\r\n\t\tif (search.current.filter === 'all') {\r\n\t\t\tDevices.importDevices(search.current.adapters)\r\n\t\t\t\t.then(_setImportDeviceList)\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tLog._('ImportDevicesPage', 'IMPORT_DEVICES: ' + err.message, 'error');\r\n\t\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t/*\r\n\t\t * retrieve enums\r\n\t\t */\r\n\t\telse {\r\n\t\t\tDevices.importEnums('functions', search.current.adapters)\r\n\t\t\t\t.then(_setImportDeviceList)\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tLog._('ImportDevicesPage', 'IMPORT_ENUMS: ' + err.message, 'error');\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('Devices Import')}\r\n\t\t\tactions={<>\r\n\t\t\t\t<Inputs.Button width=\"auto\" id='action-cancel' onClick={_onClose} label='Cancel' variant=\"text\" color=\"secondary\" />\r\n\t\t\t\t<Inputs.Button width=\"auto\" id='action-read' onClick={_getDevices} label='Read adapters' variant=\"text\" disabled={loading === 'loading'} loading={loading === 'loading'} />\r\n\t\t\t\t{loading === 'done' && (\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\twidth=\"auto\"\r\n\t\t\t\t\t\tid='action-import'\r\n\t\t\t\t\t\tonClick={_importDevices}\r\n\t\t\t\t\t\tlabel={i18n.t('Import selected devices') + ' (' + Object.values(importDevices).filter(device => !device.attributes || device.attributes.ignore !== true).length + ')'}\r\n\t\t\t\t\t\tdisabled={Object.keys(importDevices).length === 0}\r\n\t\t\t\t\t\tvariant=\"text\"\r\n\t\t\t\t\t\t/>)}\r\n\t\t\t</>}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='md'\r\n\t\t\tfullWidth={true}\r\n\t\t\t\r\n\t\t\topen={true}\r\n\t\t\tonClose={props.onClose}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<Inputs.Fieldset label='Adapters'>\r\n\t\t\t\t<Inputs.FieldsetItem>\r\n\t\t\t\t\t<AdapterList\r\n\t\t\t\t\t\tloading={loading}\r\n\t\t\t\t\t\tfoundDevicesByManufacturer={foundDevicesByManufacturer}\r\n\t\t\t\t\t\tsearch={search}\r\n\t\t\t\t\t\t_setSearch={_setSearch}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t\t{loading !== null && <Inputs.Fieldset label='Devices'>\r\n\t\t\t\t<Inputs.FieldsetItem>\r\n\t\t\t\t\t{loading === 'loading' && <CircularProgress />}\r\n\t\t\t\t\t{loading === 'done' && Object.keys(categories.current).map(key => <Category key={'Category-' + key} {...{ id: key, ...categories.current[key] }} _markDeviceToImport={_markDeviceToImport} />)}\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t</Inputs.Fieldset>}\r\n\t\t</Dialog>\r\n\t)\r\n}\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst Category = React.memo(props => {\r\n\tconst classes = useStyles();\r\n\tconst { id, name, expanded, devices } = props;\r\n\t\r\n\treturn (\r\n\t\t<Accordion classes={{ root: classes.fullWidth }} key={id} defaultExpanded={expanded === true}>\r\n\t\t\t<AccordionSummary expandIcon={<ExpandMoreIcon />}>\r\n\t\t\t\t<Typography className={classes.heading}>{name}</Typography>\r\n\t\t\t\t<Chip color=\"primary\" size=\"small\" label={devices.length} />\r\n\t\t\t</AccordionSummary>\r\n\t\t\t<AccordionDetails>\r\n\t\t\t\t<DeviceList {...props} />\r\n\t\t\t</AccordionDetails>\r\n\t\t</Accordion>\r\n\t)\r\n\t\r\n}, (prevProps, nextProps) => prevProps.hash === nextProps.hash);\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceList = props => {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [allSelected,setAllSelected] = useState(props.id === '_new' ? true : false);\r\n\tconst deviceList = props.devices.map(device => {\r\n\t\treturn (\r\n\t\t\t<Device\r\n\t\t\t\tkey={'Category-' + props.id + '-Device-' + device.id}\r\n\t\t\t\tallSelected={allSelected}\r\n\t\t\t\tcategory={props}\r\n\t\t\t\tdevice={device}\r\n\t\t\t\t_markDeviceToImport={props._markDeviceToImport}\r\n\t\t\t\t/>\r\n\t\t);\r\n\t});\r\n\t\r\n\tconst _onSelected = () => {\r\n\t\tsetAllSelected(prevSelected => prevSelected === false);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<List classes={{ root: classes.fullWidth }} dense>\r\n\t\t\t{props.id !== '_incorrect' && props.id !== '_ignored' && <ListItem dense button divider onClick={_onSelected}>\r\n\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t<Inputs.Checkbox\r\n\t\t\t\t\t\tchecked={allSelected}\r\n\t\t\t\t\t\ttabIndex={-1}\r\n\t\t\t\t\t\tdisableRipple\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t</ListItemIcon>\r\n\t\t\t\t<ListItemText primary={<strong>{i18n.t('(Un)Select all devices')}</strong>} />\r\n\t\t\t</ListItem>}\r\n\t\t\t{deviceList}\r\n\t\t</List>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst Device = React.memo(props => {\r\n\tconst classes = useStyles();\r\n\tconst { category, device, _markDeviceToImport } = props;\r\n\t\r\n\tconst [deviceChecked,setDeviceChecked] = useState(category.id === '_new' || (device.attributes && device.attributes.ignore !== undefined) ? true : false);\r\n\tuseEffect(() => {\r\n\t\tsetDeviceChecked(props.allSelected);\r\n\t\tprops._markDeviceToImport(props.device, props.allSelected);\r\n\t\t\r\n\t}, [props]);\r\n\t\r\n\tconst markDeviceToImport = () => {\r\n\t\tsetDeviceChecked(prevChecked => prevChecked !== true);\r\n\t\t_markDeviceToImport && _markDeviceToImport(device);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<ListItem\r\n\t\t\tkey={device.id}\r\n\t\t\tbutton={category.id !== '_incorrect' && category.id !== '_ignored'}\r\n\t\t\tdense\r\n\t\t\tdivider\r\n\t\t\tonClick={() => category.id !== '_incorrect' && category.id !== '_ignored' && markDeviceToImport(device)}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<ListItemIcon>\r\n\t\t\t\t<Inputs.Checkbox\r\n\t\t\t\t\tid={device.id}\r\n\t\t\t\t\tchecked={deviceChecked}\r\n\t\t\t\t\tdisabled={category.id === '_incorrect' || category.id === '_ignored'}\r\n\t\t\t\t\ttabIndex={-1}\r\n\t\t\t\t\tdisableRipple\r\n\t\t\t\t\tinputProps={{ 'aria-labelledby': device.id }}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</ListItemIcon>\r\n\t\t\t<ListItemText classes={{ root: classes.ListItem }} disableTypography>\r\n\t\t\t\t<DeviceStates device={device} />\r\n\t\t\t\t\r\n\t\t\t</ListItemText>\r\n\t\t\t<ListItemSecondaryAction>\r\n\t\t\t\t{category.id === '_new' && <Inputs.Button\r\n\t\t\t\t\twidth=\"auto\"\r\n\t\t\t\t\tvariant=\"text\"\r\n\t\t\t\t\tlabel='ignore'\r\n\t\t\t\t\tonClick={event => {\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tdevice.attributes = {\r\n\t\t\t\t\t\t\t...device.attributes,\r\n\t\t\t\t\t\t\t'ignore': true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tmarkDeviceToImport(device);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t/>}\r\n\t\t\t\t\t\r\n\t\t\t\t{category.id === '_ignored' && <Inputs.Button\r\n\t\t\t\t\twidth=\"auto\"\r\n\t\t\t\t\tvariant=\"text\"\r\n\t\t\t\t\tlabel='move to new devices'\r\n\t\t\t\t\tonClick={event => {\r\n\t\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tdevice.attributes = {\r\n\t\t\t\t\t\t\t...device.attributes,\r\n\t\t\t\t\t\t\t'ignore': false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tmarkDeviceToImport(device);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t/>}\r\n\t\t\t\t\t\r\n\t\t\t</ListItemSecondaryAction>\r\n\t\t</ListItem>\r\n\t)\r\n\t\r\n}, (prevProps, nextProps) => prevProps.device.attributes.ignore === nextProps.device.attributes.ignore && prevProps.allSelected === nextProps.allSelected);\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceStates = React.memo(props => {\r\n\tconst { device } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst states = !device.states ? <Typography display=\"block\">{device.attributes.note}</Typography> : Object.keys(device.states).map(stateKey => <DeviceState key={'DeviceState-' + device.id + '-' + stateKey} state={{ ...device.states[stateKey], 'key': stateKey }} />);\r\n\t\r\n\treturn (\r\n\t\t<Collapsible classes={{ root: classes.transparent }} key={'DeviceStates-' + device.id}>\r\n\t\t\t<CollapsibleSummary>\r\n\t\t\t\t<Typography className={classes.heading}>{device.name}</Typography>\r\n\t\t\t\t{device.attributes && device.attributes.manufacturer && <Chip color=\"secondary\" size=\"small\" label={device.attributes.manufacturer.name} />}\r\n\t\t\t</CollapsibleSummary>\r\n\t\t\t<CollapsibleDetails>\r\n\t\t\t\t<Typography style={{ margin: '0 0 8px 0' }}>{i18n.t('Function')}: {i18n.t(device.function)} <code>{device.function}</code></Typography>\r\n\t\t\t\t{states}\r\n\t\t\t</CollapsibleDetails>\r\n\t\t</Collapsible>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceState = React.memo(props => {\r\n\tconst { state } = props;\r\n\t\r\n\treturn (\r\n\t\t<Grid container spacing={2}>\r\n\t\t\t<Grid item xs={12}>\r\n\t\t\t\t<Typography display=\"block\"><strong>{state.key}</strong></Typography>\r\n\t\t\t\t\r\n\t\t\t\t<Typography component=\"span\" variant=\"subtitle1\">{i18n.t('State')}: </Typography>\r\n\t\t\t\t<code>{state.state || '-'}</code>\r\n\t\t\t\t<br />\r\n\t\t\t\t\r\n\t\t\t\t<Typography component=\"span\" variant=\"subtitle1\">{i18n.t('Action')}: </Typography>\r\n\t\t\t\t<code>{state.action || '-'}</code>\r\n\t\t\t</Grid>\r\n\t\t</Grid>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst AdapterList = React.memo(props => {\r\n\tconst { loading, foundDevicesByManufacturer, search, _setSearch } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [allSelected,setAllSelected] = useState(true);\r\n\tconst _onSelected = e => {\r\n\t\tsearch.current.adapters = allSelected ? [] : (Object.keys(Adapters) || []);\r\n\t\tsetAllSelected(prevSelected => prevSelected === false);\r\n\t}\r\n\t\r\n\tlet searchResults = 0;\r\n\tconst adapters = Object.keys(Adapters).map(adapterKey => {\r\n\t\tconst adapter = { ...Adapters[adapterKey], 'namespace': adapterKey, 'devices': foundDevicesByManufacturer.current[adapterKey] || [] }\r\n\t\tsearchResults = searchResults + (adapter.devices && Array.isArray(adapter.devices) ? adapter.devices.length : 0);\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<AdapterItem\r\n\t\t\t\t{...props}\r\n\t\t\t\tkey={'AdapterItem-' + adapterKey}\r\n\t\t\t\tadapter={adapter}\r\n\t\t\t\tselected={search.current.adapters.indexOf(adapter.namespace) > -1}\r\n\t\t\t\t/>\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Inputs.RadioGroup\r\n\t\t\t\tonChange={(props, val) => _setSearch('filter', val)}\r\n\t\t\t\tlabel='Search the adapter structure for all devices or only devices added to enums'\r\n\t\t\t\tinputs={[\r\n\t\t\t\t\t{ label: 'Search adapter structure for all devices', value: 'all' },\r\n\t\t\t\t\t{ label: 'Search only for devices added to enums', value: 'enums' }\r\n\t\t\t\t]}\r\n\t\t\t\trequired\r\n\t\t\t\tval={search.current.filter}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<Collapsible key={'AdapterList-' + loading} expanded={loading !== 'done'}>\r\n\t\t\t\t<CollapsibleSummary>\r\n\t\t\t\t\t<Typography style={{ margin: 'auto 0' }}>{i18n.t('Adapter List')}</Typography>\r\n\t\t\t\t\t<div className={classes.gap}></div>\r\n\t\t\t\t\t{searchResults > 0 && <Chip color=\"secondary\" label={i18n.t('Devices') + ': ' + searchResults} />}\r\n\t\t\t\t</CollapsibleSummary>\r\n\t\t\t\t<CollapsibleDetails>\r\n\t\t\t\t\t<List classes={{ root: classes.fullWidth }} dense>\r\n\t\t\t\t\t\t<ListItem dense button divider onClick={_onSelected}>\r\n\t\t\t\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t\t\t\t<Inputs.Checkbox\r\n\t\t\t\t\t\t\t\t\tchecked={allSelected}\r\n\t\t\t\t\t\t\t\t\ttabIndex={-1}\r\n\t\t\t\t\t\t\t\t\tdisableRipple\r\n\t\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t</ListItemIcon>\r\n\t\t\t\t\t\t\t<ListItemText primary={<strong>{i18n.t('(Un)Select all adapters')}</strong>} />\r\n\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t{adapters}\r\n\t\t\t\t\t</List>\r\n\t\t\t\t</CollapsibleDetails>\r\n\t\t\t</Collapsible>\r\n\t\t</>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst AdapterItem = props => {\r\n\tconst { adapter, selected, _setSearch } = props;\r\n\tconst adapterName = adapter.default;\r\n\t\r\n\tconst [checked,setChecked] = useState(selected);\r\n\tuseEffect(() => {setChecked(selected)}, [selected]);\r\n\t\r\n\tconst setAdapter = () => {\r\n\t\tsetChecked(prevChecked => prevChecked !== true);\r\n\t\t_setSearch('adapters', adapter.namespace);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<ListItem key={adapter.namespace} dense button divider onClick={setAdapter}>\r\n\t\t\t<ListItemIcon>\r\n\t\t\t\t<Inputs.Checkbox\r\n\t\t\t\t\tid={adapter.namespace}\r\n\t\t\t\t\tchecked={checked}\r\n\t\t\t\t\ttabIndex={-1}\r\n\t\t\t\t\tdisableRipple\r\n\t\t\t\t\tinputProps={{ 'aria-labelledby': adapterName }}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</ListItemIcon>\r\n\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t<Typography display=\"inline\">{adapterName + ' ' + i18n.t('adapter')}</Typography>\r\n\t\t\t\t<span style={{ 'marginLeft': 2, 'verticalAlign': 'bottom' }}>\r\n\t\t\t\t\t<Tooltip title={i18n.t('import#warning').replace('{deviceObjectType}', adapter.deviceObjectType || 'device').replace('{devicePattern}', adapter.devicePattern)}>\r\n\t\t\t\t\t\t<InfoIcon color=\"primary\" />\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</span>\r\n\t\t\t</ListItemText>\r\n\t\t\t\r\n\t\t\t<ListItemSecondaryAction>\r\n\t\t\t\t{adapter.devices && Array.isArray(adapter.devices) && adapter.devices.length > 0 && <Chip color=\"primary\" size=\"small\" label={i18n.t('Devices') + ': ' + adapter.devices.length} />}\r\n\t\t\t</ListItemSecondaryAction>\r\n\t\t</ListItem>\r\n\t)\r\n}","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\nimport { v4 as uuid } from 'uuid'\r\n\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport AddIcon from '@material-ui/icons/AddCircle'\r\nimport EditIcon from '@material-ui/icons/Edit'\r\nimport ImportIcon from '@material-ui/icons/CloudDownload'\r\nimport CopyIcon from '@material-ui/icons/FileCopy'\r\n\r\nimport Collapsible, { CollapsibleSummary, CollapsibleDetails } from '../../../components/Collapsible'\r\nimport EnhancedTable from '../../../components/EnhancedTable'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\nimport { sortObject } from '../../../helpers/utils'\r\nimport DevicesPage from './DevicesPage'\r\nimport ImportDevicesPage from './ImportDevicesPage'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tdeleteButton: {\r\n\t\tmarginTop: '25px'\r\n\t},\r\n\thr: {\r\n\t\tmargin: '10px 2px'\r\n\t},\r\n\theading: {\r\n\t\tmarginRight: theme.spacing()\r\n\t},\r\n\tCustomTextInput: {\r\n\t\twidth: 150\r\n\t},\r\n\tCustomDialogTitle: {\r\n\t\tpadding: 0,\r\n\t\tmarginRight: '50px'\r\n\t},\r\n\tTableCell: {\r\n\t\tverticalAlign: 'top',\r\n\t\tpadding: '5px 0'\r\n\t},\r\n\tdivider: {\r\n\t\tmargin: 'auto',\r\n\t},\r\n\tpaper: {\r\n\t\tpaddingLeft: theme.spacing(2),\r\n\t\tpaddingRight: theme.spacing(1),\r\n\t\tmarginBottom: theme.spacing(1),\r\n\t\tminHeight: '64px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\t\r\n\t\tmargin: '0 auto',\r\n\t\tposition: 'fixed',\r\n\t\tzIndex: 999,\r\n\t\tright: 0,\r\n\t\tleft: 0,\r\n\t},\r\n\tnewlyCreatedDevice: {\r\n\t\tbackgroundColor: 'rgba(99, 233, 30, 0.08) !important'\r\n\t},\r\n\tListItem: {\r\n\t\tpadding: 0\r\n\t},\r\n\tDeviceList: {\r\n\t\tpaddingTop: '72px'\r\n\t}\r\n}));\r\n\r\n\r\ni18n.setTranslations(language => require('./i18n/' + language));\r\n\r\nconst DevicesListPage = React.memo(props => {\r\n\tLog._('DevicesListPage', 'RENDER DevicesListPage', 'development');\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _groupDevices = (groupBy, d) => {\r\n\t\t\r\n\t\tlet g = {}\r\n\t\tfor (let deviceId in d) {\r\n\t\t\tlet device = d[deviceId];\r\n\t\t\t\r\n\t\t\t// by manufacturer\r\n\t\t\tif (groupBy === 'manufacturer') {\r\n\t\t\t\tconst manufacturer = device.attributes && device.attributes.manufacturer ? device.attributes.manufacturer.name : ('(' + i18n.t('no manufacturer') + ')');\r\n\t\t\t\tg[manufacturer] = g[manufacturer] || [];\r\n\t\t\t\tg[manufacturer].push(device);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// by function\r\n\t\t\telse {\r\n\t\t\t\tconst func = i18n.t(device.function);\r\n\t\t\t\tg[func] = g[func] || [];\r\n\t\t\t\tg[func].push(device);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn sortObject(g, false);\r\n\t}\r\n\t\r\n\t\r\n\tconst [selectedDevice,setSelectedDevice] = useState(null);\r\n\tconst [importDevices,setImportDevices] = useState(null);\r\n\t\r\n\tconst devices = useRef(props.devices);\r\n\tconst groupBy = useRef(props.settings.configGroupDevices || 'function');\r\n\tconst lastDeviceAdded = useRef();\r\n\tconst filterBy = useRef();\r\n\tconst filterByTimeout = useRef();\r\n\t\r\n\tconst [groups,setGroups] = useState(_groupDevices(groupBy.current, props.devices));\r\n\tconst [width,setWidth] = useState('100%');\r\n\t\r\n\t\r\n\t// \r\n\tuseEffect(() => {\r\n\t\tdevices.current = props.devices;\r\n\t\tsetGroups(_groupDevices(props.settings.configGroupDevices || 'function', props.devices));\r\n\t\t\r\n\t}, [props.devices, props.settings]);\r\n\t\r\n\t// \r\n\tuseEffect(() => {\r\n\t\tprops._onDevicesChange && props._onDevicesChange(devices.current);\r\n\t\t\r\n\t}, [groups, props]);\r\n\t\r\n\t// \r\n\tuseEffect(() => {\r\n\t\tif (lastDeviceAdded.current) {\r\n\t\t\tdocument.getElementById('DialogContent').scrollTop = (document.getElementById('device-' + lastDeviceAdded.current) && document.getElementById('device-' + lastDeviceAdded.current).offsetTop) || 0;\r\n\t\t}\r\n\t\t\r\n\t}, [groups]);\r\n\t\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _importDevices = importDevices => _saveDevices({ ...devices.current, ...importDevices });\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _saveDevice = saveDevice => {\r\n\t\tlastDeviceAdded.current = saveDevice.id;\r\n\t\t\r\n\t\t// detect state key changes (only for modified devices)\r\n\t\tif (devices.current[saveDevice.id]) {\r\n\t\t\t\r\n\t\t\t// detect state key changes (replacements)\r\n\t\t\tlet prevDeviceStates = Object.keys(devices.current[saveDevice.id].states || {});\r\n\t\t\t\r\n\t\t\tfor (let stateKey in saveDevice.states) {\r\n\t\t\t\tconst state = saveDevice.states[stateKey];\r\n\t\t\t\t\r\n\t\t\t\tif (state._renamed) {\r\n\t\t\t\t\t_deleteInWidgets(saveDevice.id, state._renamed, stateKey);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// detect state key changes (deletions)\r\n\t\t\tprevDeviceStates.forEach(prevStateKey => {\r\n\t\t\t\t\r\n\t\t\t\tif (saveDevice.states[prevStateKey] === undefined) {\r\n\t\t\t\t\t_deleteInWidgets(saveDevice.id, prevStateKey);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t_saveDevices({ ...devices.current, [saveDevice.id]: { ...saveDevice, 'hash': Date.now() } });\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _saveDevices = saveDevices => {\r\n\t\tdevices.current = saveDevices;\r\n\t\t_filterBy(filterBy.current, saveDevices);\r\n\t\t\r\n\t\tsetSelectedDevice(null);\r\n\t\tsetImportDevices(null);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _copyDevice = device => {\r\n\t\tconst id = device.id.substr(-6).substr(0,1) === '_' ? device.id.substr(0, device.id.lastIndexOf('_')) + '_' + uuid().substr(0,5) : device.id + '_' + uuid().substr(0,5);\r\n\t\tdevices.current[id] = { ...device, 'name': device.name + ' (' + i18n.t('duplicate') + ')', 'id': id, 'hash': Date.now() }\r\n\t\t\r\n\t\t_saveDevices(devices.current);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _deleteDevice = deviceId => {\r\n\t\t_deleteInWidgets(deviceId);\r\n\t\tdelete devices.current[deviceId];\r\n\t\t\r\n\t\t_saveDevices(devices.current);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _deleteInWidgets = (deviceId, stateKey = null, newStateKey = '') => {\r\n\t\tlet layout = [ ...props.layout ];\r\n\t\t\r\n\t\t// drawer\r\n\t\tfor (let drawerKey of Object.keys(layout)) {\r\n\t\t\tlet drawer = layout[drawerKey];\r\n\t\t\t\r\n\t\t\t// tabs\r\n\t\t\tfor (let tab of drawer.tabs) {\r\n\t\t\t\ttab.columns = tab._fullscreen !== undefined ? [[tab._fullscreen]] : tab.columns;\r\n\t\t\t\t\r\n\t\t\t\t// columns\r\n\t\t\t\tfor (let columnIndex in tab.columns) {\r\n\t\t\t\t\tlet column = tab.columns[columnIndex];\r\n\t\t\t\t\t\r\n\t\t\t\t\t// widgets\r\n\t\t\t\t\tfor (let widget of column) {\r\n\t\t\t\t\t\twidget = widget || { devices: [] }\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// device deletion\r\n\t\t\t\t\t\tif (stateKey === null) {\r\n\t\t\t\t\t\t\twidget.devices = widget.devices.filter(d => d.deviceId !== deviceId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state deletion or replacement\r\n\t\t\t\t\t\telse if (stateKey !== null) {\r\n\t\t\t\t\t\t\twidget.devices = widget.devices.map(d => {\r\n\t\t\t\t\t\t\t\tif (d.deviceId === deviceId) {\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// remove from secondary state keys\r\n\t\t\t\t\t\t\t\t\tif (Array.isArray(d.secondaryStatesKeys) && d.secondaryStatesKeys.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\tconst secondaryStatesKeyIndex = d.secondaryStatesKeys.indexOf(stateKey);\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tif (secondaryStatesKeyIndex > -1) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (newStateKey !== '') {\r\n\t\t\t\t\t\t\t\t\t\t\t\td.secondaryStatesKeys.splice(secondaryStatesKeyIndex, 1, newStateKey);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\t\td.secondaryStatesKeys.splice(secondaryStatesKeyIndex, 1);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// remove from primary and body state key\r\n\t\t\t\t\t\t\t\t\td.primaryStateKey = d.primaryStateKey !== stateKey ? d.primaryStateKey : newStateKey;\r\n\t\t\t\t\t\t\t\t\td.bodyStateKey = d.bodyStateKey !== stateKey ? d.bodyStateKey : newStateKey;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\treturn d;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tprops._onLayoutsChange(layout);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _groupBy = (p, val) => {\r\n\t\tgroupBy.current = val;\r\n\t\tsetGroups(_groupDevices(val, devices.current));\r\n\t\tprops._onLayoutsChange(null, { 'configGroupDevices': val });\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _filterBy = (val = '', d) => {\r\n\t\tfilterBy.current = val;\r\n\t\tval = val.toLowerCase();\r\n\t\t\r\n\t\tclearTimeout(filterByTimeout.current);\r\n\t\tfilterByTimeout.current = setTimeout(() => {\r\n\t\t\t\r\n\t\t\t// get filter params\r\n\t\t\tconst filters = val.match(RegExp(/-(id|name|function|stateId|stateLabel|state|action|manufacturer):[^\\\\-]*/g));\r\n\t\t\tlet labels = []\r\n\t\t\tlet values = {}\r\n\t\t\t\r\n\t\t\tfilters && filters.forEach(filter => {\r\n\t\t\t\tlet [ label, value ] = filter.substr(1).split(':');\r\n\t\t\t\tlabels.push(label.trim());\r\n\t\t\t\tvalues[label.trim()] = value.trim().toLowerCase();\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// filter devices\r\n\t\t\tlet result = {}\r\n\t\t\tObject.values(d).forEach(device => {\r\n\t\t\t\t\r\n\t\t\t\t// filter by device\r\n\t\t\t\tif (\r\n\t\t\t\t\t\t((!filters || labels.indexOf('id') > -1) && device.id.toLowerCase().indexOf(values['id'] || val) > -1) ||\r\n\t\t\t\t\t\t((!filters || labels.indexOf('name') > -1) && device.name.toLowerCase().indexOf(values['name'] || val) > -1) ||\r\n\t\t\t\t\t\t((!filters || labels.indexOf('function') > -1) && device.function.toLowerCase().indexOf(values['function'] || val) > -1) ||\r\n\t\t\t\t\t\t((!filters || labels.indexOf('function') > -1) && i18n.t(device.function).toLowerCase().indexOf(values['function'] || val) > -1) ||\r\n\t\t\t\t\t\t((!filters || labels.indexOf('manufacturer') > -1) && device.attributes && device.attributes.manufacturer && device.attributes.manufacturer.name.toLowerCase().indexOf(values['manufacturer'] || val) > -1)\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tresult[device.id] = device;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// filter by device states\r\n\t\t\t\tif (result[device.id] === undefined) {\r\n\t\t\t\t\tdevice.states = device.states || {}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let stateKey in device.states) {\r\n\t\t\t\t\t\tlet state = device.states[stateKey]\r\n\t\t\t\t\t\tstate.label = state.label || '';\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t((!filters || labels.indexOf('stateId') > -1) && stateKey.toLowerCase().indexOf(values['stateId'] || val) > -1) ||\r\n\t\t\t\t\t\t\t\t((!filters || labels.indexOf('stateLabel') > -1) && state.label.toLowerCase().indexOf(values['stateLabel'] || val) > -1) ||\r\n\t\t\t\t\t\t\t\t((!filters || labels.indexOf('state') > -1) && state.state && typeof state.state !== 'object' && state.state.toLowerCase().indexOf(values['state'] || val) > -1) ||\r\n\t\t\t\t\t\t\t\t((!filters || labels.indexOf('action') > -1) && state.action && typeof state.action !== 'object' && state.action.toLowerCase().indexOf(values['action'] || val) > -1) ||\r\n\t\t\t\t\t\t\t\t((!filters || labels.indexOf('state') > -1) && state.state && typeof state.state === 'object' && state.state.node.toLowerCase().indexOf(values['state'] || val) > -1) ||\r\n\t\t\t\t\t\t\t\t((!filters || labels.indexOf('action') > -1) && state.action && typeof state.action === 'object' && state.action.node.toLowerCase().indexOf(values['action'] || val) > -1)\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tresult[device.id] = device;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tsetGroups(_groupDevices(groupBy.current, result));\r\n\t\t\t\r\n\t\t}, 750);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\tlet groupedDevices = [];\r\n\tfor (let key in groups) {\r\n\t\tconst labelId = key.toLowerCase().replace(/ /g, '');\r\n\t\t\r\n\t\tgroupedDevices.push(\r\n\t\t\t<ListItem dense classes={{ root: classes.ListItem }} key={'group-' + labelId}>\r\n\t\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t\t<Group\r\n\t\t\t\t\t\tid={labelId}\r\n\t\t\t\t\t\tlabel={key}\r\n\t\t\t\t\t\tdevices={groups[key]}\r\n\t\t\t\t\t\t_selectDevice={device => setSelectedDevice(device.id)}\r\n\t\t\t\t\t\t_copyDevice={_copyDevice}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</ListItemText>\r\n\t\t\t</ListItem>\r\n\t\t);\r\n\t}\r\n\t\r\n\t// adjust width\r\n\tconst paperComponent = useCallback(el => {\r\n\t\tif (el !== null) {\r\n\t\t\tconst boxWidth = el.parentNode.offsetWidth-20;\r\n\t\t\tsetWidth(boxWidth);\r\n\t\t}\r\n\t}, []);\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Paper ref={paperComponent} className={clsx(classes.paper, 'DeviceListFilter')} style={{ width: width }}>\r\n\t\t\t\t<Typography classes={{ root: classes.heading }} display=\"inline\" variant=\"h6\">\r\n\t\t\t\t\t{i18n.t('Devices List') + ' (' + Object.keys(devices.current).length + ')'}\r\n\t\t\t\t</Typography>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.Select\r\n\t\t\t\t\tkey=\"groupBy\"\r\n\t\t\t\t\tlabel=\"Group by\"\r\n\t\t\t\t\twidth={150}\r\n\t\t\t\t\t\r\n\t\t\t\t\tonChange={_groupBy}\r\n\t\t\t\t\tval={groupBy.current}\r\n\t\t\t\t\tselection={[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t'function': 'Function'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t'manufacturer': 'Manufacturer'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tkey=\"filterBy\"\r\n\t\t\t\t\tid=\"filterBy\"\r\n\t\t\t\t\twidth={400}\r\n\t\t\t\t\t\r\n\t\t\t\t\tlabel=\"Filter\"\r\n\t\t\t\t\tinfo=\"DevicesListPage#filterBy#info\"\r\n\t\t\t\t\tlink=\"https://forum.iobroker.net/post/542452\"\r\n\t\t\t\t\t\r\n\t\t\t\t\tonChange={(props, val) => _filterBy(val, devices.current)}\r\n\t\t\t\t\tval={filterBy.current}\r\n\t\t\t\t\t//placeholder={i18n.t('Filter') + '..'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<Divider\r\n\t\t\t\t\tclasses={{ root: classes.divider }}\r\n\t\t\t\t\torientation=\"vertical\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.Button\r\n\t\t\t\t\tkey=\"device-add\"\r\n\t\t\t\t\tclassName=\"deviceAdd\"\r\n\t\t\t\t\tonClick={() => setSelectedDevice('#new')}\r\n\t\t\t\t\tstartIcon={<AddIcon />}\r\n\t\t\t\t\tdisabled={selectedDevice !== null || importDevices !== null}\r\n\t\t\t\t\tlabel='add device'\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.Button\r\n\t\t\t\t\tkey=\"devices-import\"\r\n\t\t\t\t\tclassName=\"deviceImport\"\r\n\t\t\t\t\tonClick={() => setImportDevices(true)}\r\n\t\t\t\t\tstartIcon={<ImportIcon />}\r\n\t\t\t\t\tdisabled={selectedDevice !== null || importDevices !== null}\r\n\t\t\t\t\tlabel='import devices'\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t</Paper>\r\n\t\t\t\r\n\t\t\t{selectedDevice != null && (\r\n\t\t\t\t<DevicesPage\r\n\t\t\t\t\tdevice={selectedDevice === '#new' ? { 'id': uuid(), 'function': 'other', 'states': {}, 'options': {}, 'attributes': { '_created': Date.now() }} : devices.current[selectedDevice]}\r\n\t\t\t\t\tonSave={_saveDevice}\r\n\t\t\t\t\tonDelete={_deleteDevice}\r\n\t\t\t\t\tonClose={() => setSelectedDevice(null)}\r\n\t\t\t\t\t/>)}\r\n\t\t\t\r\n\t\t\t{importDevices !== null && (\r\n\t\t\t\t<ImportDevicesPage\r\n\t\t\t\t\tdevices={devices.current}\r\n\t\t\t\t\tonImport={_importDevices}\r\n\t\t\t\t\tonClose={() => setImportDevices(null)}\r\n\t\t\t\t\t/>)}\r\n\t\t\t\r\n\t\t\t<List className=\"DeviceList\" classes={{ root: classes.DeviceList }} dense>\r\n\t\t\t\t{groupedDevices}\r\n\t\t\t</List>\r\n\t\t</>\r\n\t)\r\n\r\n}, (prevProps, nextProps) => nextProps.selected !== true); // re-render on false (not equal), only render when selected\r\n\r\nexport default DevicesListPage;\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst Group = props => {\r\n\tconst { id, label, devices } = props;\r\n\t\r\n\treturn (\r\n\t\t<Collapsible key={'DeviceStates-' + id + '-' + devices.length} className=\"Group\">\r\n\t\t\t<CollapsibleSummary>{label + ' (' + devices.length + ')'}</CollapsibleSummary>\r\n\t\t\t<CollapsibleDetails>\r\n\t\t\t\t<DeviceTable {...props} />\r\n\t\t\t</CollapsibleDetails>\r\n\t\t</Collapsible>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceTable = props => {\r\n\tLog._('DevicesListPage', 'RENDER DeviceTable', 'development');\r\n\tconst { devices } = props;\r\n\t\r\n\treturn (\r\n\t\t<EnhancedTable\r\n\t\t\ttoolbar={false}\r\n\t\t\theadCells={[\r\n\t\t\t\t{ id: 'edit', width: '3%', disablePadding: true, label: '' },\r\n\t\t\t\t{ id: 'copy', width: '2%', disablePadding: true, label: '' },\r\n\t\t\t\t{ id: 'name', width: '15%', label: i18n.t('Name') },\r\n\t\t\t\t{ id: 'manufacturer', width: '15%', label: i18n.t('Manufacturer') },\r\n\t\t\t\t{ id: 'function', width: '10%', label: i18n.t('Function') },\r\n\t\t\t\t{ id: 'states', width: '55%', disablePadding: false, label: i18n.t('States') },\r\n\t\t\t\t//{ id: 'options', width: '20%', disablePadding: false, label: i18n.t('Options') },\r\n\t\t\t\t//{ id: 'attributes', width: '15%', disablePadding: false, label: i18n.t('Attributes') }\r\n\t\t\t]}\r\n\t\t\trows={Object.values(devices)}\r\n\t\t\t\r\n\t\t\tdefaultOrderBy=\"name\"\r\n\t\t\tselectable={false}\r\n\t\t\tsortable={true}\r\n\t\t\tstickyHeader\r\n\t\t\t\r\n\t\t\tCustomTableBody={CustomTableProps => <DeviceList {...props} {...CustomTableProps} />}\r\n\t\t\t/>\r\n\t);\r\n\t\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceList = props => {\r\n\tLog._('DevicesListPage', 'RENDER DeviceList', 'development');\r\n\tconst classes = useStyles();\r\n\tconst { sortedRows, _selectDevice, _copyDevice } = props;\r\n\t\r\n\treturn (\r\n\t\t<TableBody>\r\n\t\t\r\n\t\t{sortedRows.map((device, index) => {\r\n\t\t\t//let options = Object.keys(device.options || {}).filter(optionKey => (device.options[optionKey] === '' || (Array.isArray(device.options[optionKey]) && device.options[optionKey].length === 0) || (typeof device.options[optionKey] === 'object' && Object.keys(device.options[optionKey]).length === 0)) === false).sort().join(', '); \r\n\t\t\t//let attributes = Object.keys(device.attributes || {}).sort().join(', ');\r\n\t\t\t\r\n\t\t\t// skip\r\n\t\t\tif (device.attributes && device.attributes.ignore === true) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn (\r\n\t\t\t\t<TableRow\r\n\t\t\t\t\tkey={'TableRow-' + index}\r\n\t\t\t\t\tid={'device-' + device.id}\r\n\t\t\t\t\thover\r\n\t\t\t\t\ttabIndex={-1}\r\n\t\t\t\t\tselected={device.attributes && device.attributes._created > Date.now()-24*60*60*1000}\r\n\t\t\t\t\tclasses={{ selected: classes.newlyCreatedDevice, root: \"Device\" }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<TableCell padding=\"checkbox\" scope=\"row\" align=\"center\">\r\n\t\t\t\t\t\t<IconButton onClick={() => _selectDevice(device)}>\r\n\t\t\t\t\t\t\t<EditIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t<TableCell padding=\"checkbox\" align=\"center\">\r\n\t\t\t\t\t\t<IconButton onClick={() => _copyDevice(device)}>\r\n\t\t\t\t\t\t\t<CopyIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t<TableCell>{device.name + (device.label ? ' (' + device.label + ')' : '')}</TableCell>\r\n\t\t\t\t\t<TableCell>{(device.attributes && device.attributes.manufacturer && device.attributes.manufacturer.name) || ''}</TableCell>\r\n\t\t\t\t\t<TableCell>{i18n.t(device.function)} (<code>{device.function}</code>)</TableCell>\r\n\t\t\t\t\t<TableCell>{Object.keys(device.states || {}).join(', ')}</TableCell>\r\n\t\t\t\t\t{/*<TableCell>{options.length > 35 ? <Tooltip title={options}><span>{options.substr(0,32) + '...'}</span></Tooltip> : options}</TableCell>*/}\r\n\t\t\t\t\t{/*<TableCell>{attributes.length > 35 ? <Tooltip title={attributes}><span>{attributes.substr(0,32) + '...'}</span></Tooltip> : attributes}</TableCell>*/}\r\n\t\t\t\t</TableRow>\r\n\t\t\t\r\n\t\t\t);\r\n\t\t})}\r\n\t\t\r\n\t\t</TableBody>\r\n\t);\r\n\t\r\n}","import * as React from 'react';\n/**\n * @ignore - internal component.\n * @type {React.Context<{} | {expanded: boolean, disabled: boolean, toggle: () => void}>}\n */\n\nvar AccordionContext = React.createContext({});\n\nif (process.env.NODE_ENV !== 'production') {\n  AccordionContext.displayName = 'AccordionContext';\n}\n\nexport default AccordionContext;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"\n}), 'Edit');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z\"\n}), 'KeyboardArrowRight');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\"\n}), 'Add');\n\nexports.default = _default;","var map = {\n\t\"./de\": 2045,\n\t\"./de.js\": 2045,\n\t\"./en\": 2046,\n\t\"./en.js\": 2046\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 2163;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z\"\n}), 'CloudDownload');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z\"\n}), 'FileCopy');\n\nexports.default = _default;","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\n\n/* eslint-disable jsx-a11y/aria-role */\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport ButtonBase from '../ButtonBase';\nimport IconButton from '../IconButton';\nimport withStyles from '../styles/withStyles';\nimport AccordionContext from '../Accordion/AccordionContext';\nexport var styles = function styles(theme) {\n  var transition = {\n    duration: theme.transitions.duration.shortest\n  };\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      display: 'flex',\n      minHeight: 8 * 6,\n      transition: theme.transitions.create(['min-height', 'background-color'], transition),\n      padding: theme.spacing(0, 2),\n      '&:hover:not($disabled)': {\n        cursor: 'pointer'\n      },\n      '&$expanded': {\n        minHeight: 64\n      },\n      '&$focused': {\n        backgroundColor: theme.palette.action.focus\n      },\n      '&$disabled': {\n        opacity: theme.palette.action.disabledOpacity\n      }\n    },\n\n    /* Pseudo-class applied to the root element, children wrapper element and `IconButton` component if `expanded={true}`. */\n    expanded: {},\n\n    /* Pseudo-class applied to the root element if `focused={true}`. */\n    focused: {},\n\n    /* Pseudo-class applied to the root element if `disabled={true}`. */\n    disabled: {},\n\n    /* Styles applied to the children wrapper element. */\n    content: {\n      display: 'flex',\n      flexGrow: 1,\n      transition: theme.transitions.create(['margin'], transition),\n      margin: '12px 0',\n      '&$expanded': {\n        margin: '20px 0'\n      }\n    },\n\n    /* Styles applied to the `IconButton` component when `expandIcon` is supplied. */\n    expandIcon: {\n      transform: 'rotate(0deg)',\n      transition: theme.transitions.create('transform', transition),\n      '&:hover': {\n        // Disable the hover effect for the IconButton,\n        // because a hover effect should apply to the entire Expand button and\n        // not only to the IconButton.\n        backgroundColor: 'transparent'\n      },\n      '&$expanded': {\n        transform: 'rotate(180deg)'\n      }\n    }\n  };\n};\nvar AccordionSummary = /*#__PURE__*/React.forwardRef(function AccordionSummary(props, ref) {\n  var children = props.children,\n      classes = props.classes,\n      className = props.className,\n      expandIcon = props.expandIcon,\n      IconButtonProps = props.IconButtonProps,\n      onBlur = props.onBlur,\n      onClick = props.onClick,\n      onFocusVisible = props.onFocusVisible,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"expandIcon\", \"IconButtonProps\", \"onBlur\", \"onClick\", \"onFocusVisible\"]);\n\n  var _React$useState = React.useState(false),\n      focusedState = _React$useState[0],\n      setFocusedState = _React$useState[1];\n\n  var handleFocusVisible = function handleFocusVisible(event) {\n    setFocusedState(true);\n\n    if (onFocusVisible) {\n      onFocusVisible(event);\n    }\n  };\n\n  var handleBlur = function handleBlur(event) {\n    setFocusedState(false);\n\n    if (onBlur) {\n      onBlur(event);\n    }\n  };\n\n  var _React$useContext = React.useContext(AccordionContext),\n      _React$useContext$dis = _React$useContext.disabled,\n      disabled = _React$useContext$dis === void 0 ? false : _React$useContext$dis,\n      expanded = _React$useContext.expanded,\n      toggle = _React$useContext.toggle;\n\n  var handleChange = function handleChange(event) {\n    if (toggle) {\n      toggle(event);\n    }\n\n    if (onClick) {\n      onClick(event);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(ButtonBase, _extends({\n    focusRipple: false,\n    disableRipple: true,\n    disabled: disabled,\n    component: \"div\",\n    \"aria-expanded\": expanded,\n    className: clsx(classes.root, className, disabled && classes.disabled, expanded && classes.expanded, focusedState && classes.focused),\n    onFocusVisible: handleFocusVisible,\n    onBlur: handleBlur,\n    onClick: handleChange,\n    ref: ref\n  }, other), /*#__PURE__*/React.createElement(\"div\", {\n    className: clsx(classes.content, expanded && classes.expanded)\n  }, children), expandIcon && /*#__PURE__*/React.createElement(IconButton, _extends({\n    className: clsx(classes.expandIcon, expanded && classes.expanded),\n    edge: \"end\",\n    component: \"div\",\n    tabIndex: null,\n    role: null,\n    \"aria-hidden\": true\n  }, IconButtonProps), expandIcon));\n});\nprocess.env.NODE_ENV !== \"production\" ? AccordionSummary.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * The content of the accordion summary.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * The icon to display as the expand indicator.\n   */\n  expandIcon: PropTypes.node,\n\n  /**\n   * Props applied to the `IconButton` element wrapping the expand icon.\n   */\n  IconButtonProps: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  onBlur: PropTypes.func,\n\n  /**\n   * @ignore\n   */\n  onClick: PropTypes.func,\n\n  /**\n   * @ignore\n   */\n  onFocusVisible: PropTypes.func\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiAccordionSummary'\n})(AccordionSummary);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport withStyles from '../styles/withStyles';\nexport var styles = function styles(theme) {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      display: 'flex',\n      padding: theme.spacing(1, 2, 2)\n    }\n  };\n};\nvar AccordionDetails = /*#__PURE__*/React.forwardRef(function AccordionDetails(props, ref) {\n  var classes = props.classes,\n      className = props.className,\n      other = _objectWithoutProperties(props, [\"classes\", \"className\"]);\n\n  return /*#__PURE__*/React.createElement(\"div\", _extends({\n    className: clsx(classes.root, className),\n    ref: ref\n  }, other));\n});\nprocess.env.NODE_ENV !== \"production\" ? AccordionDetails.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * The content of the accordion details.\n   */\n  children: PropTypes.node,\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiAccordionDetails'\n})(AccordionDetails);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _toArray from \"@babel/runtime/helpers/esm/toArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport { isFragment } from 'react-is';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { chainPropTypes } from '@material-ui/utils';\nimport Collapse from '../Collapse';\nimport Paper from '../Paper';\nimport withStyles from '../styles/withStyles';\nimport AccordionContext from './AccordionContext';\nimport useControlled from '../utils/useControlled';\nexport var styles = function styles(theme) {\n  var transition = {\n    duration: theme.transitions.duration.shortest\n  };\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      position: 'relative',\n      transition: theme.transitions.create(['margin'], transition),\n      '&:before': {\n        position: 'absolute',\n        left: 0,\n        top: -1,\n        right: 0,\n        height: 1,\n        content: '\"\"',\n        opacity: 1,\n        backgroundColor: theme.palette.divider,\n        transition: theme.transitions.create(['opacity', 'background-color'], transition)\n      },\n      '&:first-child': {\n        '&:before': {\n          display: 'none'\n        }\n      },\n      '&$expanded': {\n        margin: '16px 0',\n        '&:first-child': {\n          marginTop: 0\n        },\n        '&:last-child': {\n          marginBottom: 0\n        },\n        '&:before': {\n          opacity: 0\n        }\n      },\n      '&$expanded + &': {\n        '&:before': {\n          display: 'none'\n        }\n      },\n      '&$disabled': {\n        backgroundColor: theme.palette.action.disabledBackground\n      }\n    },\n\n    /* Styles applied to the root element if `square={false}`. */\n    rounded: {\n      borderRadius: 0,\n      '&:first-child': {\n        borderTopLeftRadius: theme.shape.borderRadius,\n        borderTopRightRadius: theme.shape.borderRadius\n      },\n      '&:last-child': {\n        borderBottomLeftRadius: theme.shape.borderRadius,\n        borderBottomRightRadius: theme.shape.borderRadius,\n        // Fix a rendering issue on Edge\n        '@supports (-ms-ime-align: auto)': {\n          borderBottomLeftRadius: 0,\n          borderBottomRightRadius: 0\n        }\n      }\n    },\n\n    /* Styles applied to the root element if `expanded={true}`. */\n    expanded: {},\n\n    /* Styles applied to the root element if `disabled={true}`. */\n    disabled: {}\n  };\n};\nvar Accordion = /*#__PURE__*/React.forwardRef(function Accordion(props, ref) {\n  var childrenProp = props.children,\n      classes = props.classes,\n      className = props.className,\n      _props$defaultExpande = props.defaultExpanded,\n      defaultExpanded = _props$defaultExpande === void 0 ? false : _props$defaultExpande,\n      _props$disabled = props.disabled,\n      disabled = _props$disabled === void 0 ? false : _props$disabled,\n      expandedProp = props.expanded,\n      onChange = props.onChange,\n      _props$square = props.square,\n      square = _props$square === void 0 ? false : _props$square,\n      _props$TransitionComp = props.TransitionComponent,\n      TransitionComponent = _props$TransitionComp === void 0 ? Collapse : _props$TransitionComp,\n      TransitionProps = props.TransitionProps,\n      other = _objectWithoutProperties(props, [\"children\", \"classes\", \"className\", \"defaultExpanded\", \"disabled\", \"expanded\", \"onChange\", \"square\", \"TransitionComponent\", \"TransitionProps\"]);\n\n  var _useControlled = useControlled({\n    controlled: expandedProp,\n    default: defaultExpanded,\n    name: 'Accordion',\n    state: 'expanded'\n  }),\n      _useControlled2 = _slicedToArray(_useControlled, 2),\n      expanded = _useControlled2[0],\n      setExpandedState = _useControlled2[1];\n\n  var handleChange = React.useCallback(function (event) {\n    setExpandedState(!expanded);\n\n    if (onChange) {\n      onChange(event, !expanded);\n    }\n  }, [expanded, onChange, setExpandedState]);\n\n  var _React$Children$toArr = React.Children.toArray(childrenProp),\n      _React$Children$toArr2 = _toArray(_React$Children$toArr),\n      summary = _React$Children$toArr2[0],\n      children = _React$Children$toArr2.slice(1);\n\n  var contextValue = React.useMemo(function () {\n    return {\n      expanded: expanded,\n      disabled: disabled,\n      toggle: handleChange\n    };\n  }, [expanded, disabled, handleChange]);\n  return /*#__PURE__*/React.createElement(Paper, _extends({\n    className: clsx(classes.root, className, expanded && classes.expanded, disabled && classes.disabled, !square && classes.rounded),\n    ref: ref,\n    square: square\n  }, other), /*#__PURE__*/React.createElement(AccordionContext.Provider, {\n    value: contextValue\n  }, summary), /*#__PURE__*/React.createElement(TransitionComponent, _extends({\n    in: expanded,\n    timeout: \"auto\"\n  }, TransitionProps), /*#__PURE__*/React.createElement(\"div\", {\n    \"aria-labelledby\": summary.props.id,\n    id: summary.props['aria-controls'],\n    role: \"region\"\n  }, children)));\n});\nprocess.env.NODE_ENV !== \"production\" ? Accordion.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n\n  /**\n   * The content of the accordion.\n   */\n  children: chainPropTypes(PropTypes.node.isRequired, function (props) {\n    var summary = React.Children.toArray(props.children)[0];\n\n    if (isFragment(summary)) {\n      return new Error(\"Material-UI: The Accordion doesn't accept a Fragment as a child. \" + 'Consider providing an array instead.');\n    }\n\n    if (! /*#__PURE__*/React.isValidElement(summary)) {\n      return new Error('Material-UI: Expected the first child of Accordion to be a valid element.');\n    }\n\n    return null;\n  }),\n\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n\n  /**\n   * If `true`, expands the accordion by default.\n   */\n  defaultExpanded: PropTypes.bool,\n\n  /**\n   * If `true`, the accordion will be displayed in a disabled state.\n   */\n  disabled: PropTypes.bool,\n\n  /**\n   * If `true`, expands the accordion, otherwise collapse it.\n   * Setting this prop enables control over the accordion.\n   */\n  expanded: PropTypes.bool,\n\n  /**\n   * Callback fired when the expand/collapse state is changed.\n   *\n   * @param {object} event The event source of the callback.\n   * @param {boolean} expanded The `expanded` state of the accordion.\n   */\n  onChange: PropTypes.func,\n\n  /**\n   * If `true`, rounded corners are disabled.\n   */\n  square: PropTypes.bool,\n\n  /**\n   * The component used for the collapse effect.\n   * [Follow this guide](/components/transitions/#transitioncomponent-prop) to learn more about the requirements for this component.\n   */\n  TransitionComponent: PropTypes.elementType,\n\n  /**\n   * Props applied to the [`Transition`](http://reactcommunity.org/react-transition-group/transition#Transition-props) element.\n   */\n  TransitionProps: PropTypes.object\n} : void 0;\nexport default withStyles(styles, {\n  name: 'MuiAccordion'\n})(Accordion);","import arrayWithHoles from \"@babel/runtime/helpers/esm/arrayWithHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableRest from \"@babel/runtime/helpers/esm/nonIterableRest\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}"],"sourceRoot":""}