{"version":3,"sources":["helpers/timeConverter.js","modules/StateListItem.js","modules/StateList.js","Settings.js","functions/blind.js","modules/AdapterStatus.js","modules/Chart.js","modules/DateTime.js","modules/Map.js","modules/StateListHorizontal.js","modules/Weather.js","modules/MultimediaItem.js","modules/Multimedia.js","i18n sync /^/.*/.js$","i18n/de.js","i18n/en.js","functions/door.js","functions/heating.js","functions/defaults.js","functions/location.js","functions/user.js","functions/window.js","components/GridContainer.js","components/StatusSnackbar.js","config/config.dev.js","functions/index.js","Function.js","Adapters.js","Device.js","components/TopBar.js","helpers/useWindowDimensions.js","components/TabBar.js","components/Notifications.js","modules/index.js","components/Popup.js","components/Widget.js","Jarvis.js","App.js","serviceWorker.js","index.js","helpers/colorConverter.js","functions/light.js","Socket.js","Connection.js","i18n.js"],"names":["timeToSeconds","time","toString","indexOf","split","length","hours","minutes","seconds","parseInt","timeToHoursMinutesSeconds","withHours","Number","isNaN","Math","floor","substr","join","secondsToDateTime","dateTimeFormat","format","Date","locale","de","styles","theme","defaultListDivider","margin","defaultListIcon","props","components","icon","horizontalListItem","display","textAlign","paddingRight","width","marginTop","horizontalListItemIcon","minWidth","horizontalListItemAction","top","right","position","transform","verticalListItemAction","ListItemIconElement","withStyles","customClassNames","children","classes","classNames","Array","isArray","map","className","clsx","StateListItem","state","device","primaryStateKey","getDeviceState","secondaryStateKey","this","on","stateKey","setState","openDialog","horizontal","component","action","options","get","getIcon","val","primary","getAction","primaryAction","secondary","Fragment","divider","ListItem","finger","button","onClick","bind","ListItemIcon","getStyle","ListItemText","getComponent","getOption","subtitle","timeChanged","ListItemSecondaryAction","key","id","style","React","Component","defaultListSectionDivider","defaultListSectionDividerItem","padding","defaultListSectionText","breakpoints","down","horizontalList","flexDirection","flexWrap","ListDivider","getDevicesBySubgroup","subgroup","title","subgroupActions","handleChange","targetStatus","forEach","status","setDeviceState","ButtonGroup","color","size","Button","i18n","t","StateList","devices","push","settings","List","dense","i","listSection","listItem","Settings","console","log","setting","window","language","navigator","userLanguage","setLanguage","loadTranslations","pageTitle","document","pageFavicon","getElementById","href","translations","setTranslation","useStyles","makeStyles","value","float","lineHeight","marginRight","noBorder","borderLeftColor","configurations","level","round","level2","unit","defaults","LevelComponent","actions","useState","setLevel","useEffect","activity","setActivity","states","requestDeviceState","catch","err","error","sKey","s","manufacturer","borderRightColor","disabled","AdapterStatus","adapterInformation","adapterAliveStatus","newUpdates","updatesJson","lastUpdateCheck","socket","Connection","getConnection","list","blacklist","updates","updateStates","getStates","subscribeStates","update","lastIndexOf","getAdapterInstances","instances","rows","adapters","instance","common","name","concat","replace","sort","item1","item2","aliveStatus","prevState","updateList","JSON","parse","Object","keys","adapterList","loading","adapter","enabled","alive","connected","connection","tooltip","alt","src","extIcon","small","version","UpdateAvailable","availableVersion","runAsCompactMode","compactGroup","StatusIndicator","notAlive","root","noUpdates","container","UpdatesListItem","UpdatesIndicator","noDevicesAllowed","fontStyle","backgroundColor","spacing","paddingLeft","borderRadius","height","fontSize","Chart","chartFilter","chartConfig","yAxes","unshift","type","ticks","callback","yLeftAxisUnitBefore","parseFloat","toFixed","yLeftAxisUnitAfter","errors","datePicker","selectedTimeRangeValue","selectedTimeRangeUnit","selectedDateTime","dateNow","chartLabels","chartData","labels","datasets","chartPan","chartZoom","timer","timeRangeRef","createRef","chartRef","chartUpdates","chartOptions","maintainAspectRatio","spanGaps","legend","legendClickHandler","tooltips","callbacks","label","item","data","datasetIndex","scales","plugins","colorschemes","scheme","zoom","pan","mode","getTimeRange","axis","getAxis","requestDeviceStateHistory","history","start","end","step","addChartGraph","liveUpdates","updateChartGraph","prevProps","clearTimeout","setTimeout","getTime","timeRange","axisTimeFormat","helpers","prevMarker","markers","marker","index","entry","ts","reduce","a","b","chartIndex","findIndex","groupChartData","current","chartInstance","values","prevStates","dataSet","fill","graphConfig","e","legendItem","ci","meta","getDatasetMeta","hidden","resetZoom","inputRef","input","onChange","event","target","displayEmpty","disableUnderline","select","deLocale","utils","DateFnsUtils","open","onOpen","onClose","variant","ampm","InputProps","iconButton","dividerVertical","orientation","placement","buttonDisabled","toolbar","errorMessage","severity","createElement","toolbarButtons","disableElevation","chartHeight","ref","alignItems","justifyContent","marginBottom","whiteSpace","marginLeft","flex","palette","main","DateTime","refTimer","useRef","setDateTime","city","setCity","sunrise","setSunrise","sunset","setSunset","refresh","_global","iobroker","latitude","longitude","getSunrise","getSunset","sun","mapOverview","left","bottom","zIndex","cursor","mapIconContainer","mapIconParent","boxShadow","mapIcon","content","mapTooltip","Map","defaultZoom","defaultPosition","setMarkers","memoizedMapInitialised","useCallback","memoizedHandleClick","flyTo","prevMarkers","mapMarkers","Marker","attributes","avatar","undefined","aria-label","arrow","useFlyTo","center","whenReady","attribution","url","markerIcon","offset","info","function","L","divIcon","html","iconSize","memoizedHandleMouseEvent","closeTooltip","openTooltip","riseOnHover","onMouseOver","direction","tooltipDirection","permanent","tooltipPermanent","StateListHorizontal","paper","Weather","setData","getRemoteResource","then","response","statusCode","body","weatherForecast","day","forecast","dailyForecast","date","justify","Multimedia","progress","progressTimeout","isRunning","duration","noHeader","styleImage","styleLengthBar","background","backgroundImage","backgroundUrlPrepend","playIconElements","Divider","image","noImage","information","informationLeft","grandParent","parent","informationRight","lengthBar","controls","controlsBox","controlsBoxLeft","controlsBoxCenter","Fab","controlButton","controlsBoxRight","backgroundPosition","minHeight","paddingTop","controlButtonSmall","MultimediaItem","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","resolve","module","exports","temperature","setTemperature","humidity","boost","Level","min","max","PowerAction","sliderMarkLabel","Action","secondaryAction","stateVal","parentOnChange","checked","setChecked","TriggerAction","startIcon","Label","linebreak","br","markSteps","markStep","markLabel","onChangeCommitted","defaultValue","valueLabelDisplay","marks","number","_any","battery","door","power","trigger","wind","true","false","gridContainer","GridContainer","contents","columns","grid","column","Grid","xs","sm","md","lg","xl","warn","success","green","dark","warning","amber","iconVariant","opacity","message","variantIcon","CheckCircleIcon","WarningIcon","ErrorIcon","InfoIcon","StatusSnackbar","autoHideDuration","closeButton","other","Icon","Snackbar","anchorOrigin","vertical","SnackbarContent","IconButton","require","default","blind","heating","jalousie","light","location","user","Function","functionType","functionId","toLowerCase","functions","defaultStyles","_isFunction","obj","EventEmitter","Device","deviceProperties","sysLang","room","_setProperties","stateSubscriptions","stateType","node","config","attribute","stateValKeys","stateValKey","stateValValue","tmp","ignoredStates","ignoredState","hiddenStates","hideStates","hideState","stateOrAttribute","_getStateFromKey","Adapters","groups","group","formatDistanceToNow","lc","includeSeconds","addSuffix","pair","option","_getUserSetting","_getConfigurationSetting","property","forceDefault","stateProperty","deviceState","defaultIcon","subscribe","responses","Promise","reject","emit","getState","_updateDeviceState","subscribeDeviceState","historyCache","getStateHistory","res","subscribeState","params","child","appBar","flexGrow","menuButton","transition","flexShrink","userSelect","TopBar","connectionStatus","toggleDrawer","navigate","notifications","connectionStatusIcon","connectionStatusTooltip","AppBar","Toolbar","Typography","Tooltip","getWindowDimensions","innerWidth","innerHeight","paddingBottom","tabs","borderBottom","fixed","indicator","fullscreen","TabBar","_settings","selectTab","tabBarProps","tab","setTab","setFixed","handleScroll","threshold","scrollY","prevFixed","offsetTop","offsetHeight","addEventListener","removeEventListener","renderedTabs","Tab","tabsHideLabels","Tabs","selectedTab","TabPanel","renderedTab","windowDimensions","setWindowDimensions","handleResize","useWindowDimensions","mapHeight","setMapHeight","topBarHeight","setHidden","Box","role","Notifications","Drawer","anchor","drawer","ModuleSettings","DialogTitle","grey","disableTypography","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Popup","forceUpdate","allSettled","nextProps","nextState","closeDialog","Dialog","maxWidth","fullWidth","dividers","autoFocus","card","cardHeaderNoContents","cardAvatar","cardContent","Widget","iconStyle","Card","CardHeader","Avatar","CardContent","getGroup","groupId","Tag","Modules","getGridContents","gridContents","columnContents","Jarvis","tabTitle","page","notificationDrawer","notificationsUnread","dialog","dialogContents","layout","tabsEnabled","widgetProps","filter","notification","unread","tabPanels","tabLabel","tabPanel","now","topBarTitle","getTabPanels","App","loaded","errorHandler","reconnect","port","protocol","hostname","listeners","connect","setSettings","applySettings","getObject","processDevices","promises","results","result","deviceList","groupedDevices","deviceId","jarvis","processDevice","groupDevice","stringify","CircularProgress","topBar","tabBar","gridColumns","SkeletonLoader","Skeleton","animation","gridItem","loaders","random","loader","renderError","renderLoadingProgress","renderLoadingSkeleton","ThemeProvider","Boolean","match","ReactDOM","render","serviceWorker","ready","registration","unregister","HsvToRgb","h","r","g","f","p","q","v","RgbToHex","LightColorAction","colorSpace","setColorSpace","colors","Red","Green","Blue","Hue","Saturation","Brightness","LightColorComponent","initialColor","onChangeComplete","colorTemperature","hue","rgb","hsv","hex","setHue","hsl","Socket","io","timeout","query","statesSubscribes","attempts","reason","stateChange","ids","cb","cbs","reg","RegExp","task","hasOwnProperty","test","getObjectView","design","search","pattern","setUrl","setListeners","listener","setListener","languages","loadTranslation","translation","lang","word","placeholders","parts","shift","ucFirst","charAt","toUpperCase","slice"],"mappings":"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","file":"static/js/main.cf9fa383.chunk.js","sourcesContent":["import { format } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToSeconds(time) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\ttime = time.toString();\r\n\t\tlet format = time.split(':').length-1;\r\n\t\tlet [ hours, minutes, seconds ] = format > 1 ? time.split(':') : ('0:' + time).split(':');\r\n\t\ttime = parseInt(hours) * 3600 + parseInt(minutes) * 60 + parseInt(seconds);\r\n\t}\r\n\t\r\n\treturn parseInt(time);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToHoursMinutesSeconds(time, withHours = false) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\treturn time;\r\n\t}\r\n\t\r\n\ttime = parseInt(time);\r\n\twithHours = withHours || (time > 3600);\r\n\t\r\n\tif (Number.isNaN(time)) {\r\n\t\treturn withHours ? '00:00:00' : '00:00';\r\n\t}\r\n\t\r\n\tlet hours = '0' + Math.floor(time/3600);\r\n\tlet minutes = '0' + Math.floor(time/60);\r\n\tlet seconds = '0' + (time % 60);\r\n\t\r\n\treturn withHours ? [ hours.substr(-2), minutes.substr(-2), seconds.substr(-2) ].join(':') : [ minutes.substr(-2), seconds.substr(-2) ].join(':');\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction secondsToDateTime(seconds, dateTimeFormat = 'dd. MMM yyyy, HH:mm') {\r\n\treturn format(new Date(seconds*1000), dateTimeFormat, { locale: de });\r\n}\r\n\r\n\r\nexport default {\r\n\ttimeToSeconds,\r\n\ttimeToHoursMinutesSeconds,\r\n\tsecondsToDateTime\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListDivider: {\r\n\t\tmargin: '0 0 5px 0'\r\n\t},\r\n\tdefaultListIcon: props => ({\r\n\t\t...theme.components.icon,\r\n\t\t...props.styles\r\n\t}),\r\n\thorizontalListItem: {\r\n\t\tdisplay: 'inline-block',\r\n\t\ttextAlign: 'center',\r\n\t\tpaddingRight: '16px',\r\n\t\twidth: '140px',\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\thorizontalListItemIcon: {\r\n\t\tminWidth: 'auto'\r\n\t},\r\n\thorizontalListItemAction: {\r\n\t\ttextAlign: 'center',\r\n\t\ttop: 0,\r\n\t\tright: 0,\r\n\t\tposition: 'static',\r\n\t\ttransform: 'none',\r\n\t},\r\n\tverticalListItemAction: {\r\n\t\ttextAlign: 'right'\r\n\t},\r\n});\r\n\r\n\r\nconst ListItemIconElement = withStyles(styles)(props => {\r\n\tconst { customClassNames, children, classes } = props;\r\n\t\r\n\tlet classNames = Array.isArray(customClassNames) ? customClassNames : [customClassNames];\r\n\tclassNames = classNames.map(className => (classes[className] ? classes[className] : className));\r\n\t\r\n\treturn <span className={clsx(classNames)}>{children}</span>\r\n});\r\n\r\n\r\nclass StateListItem extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t\tthis.state[this.props.device.primaryStateKey] = this.props.device.getDeviceState() || {}\r\n\t\t\r\n\t\tif (this.props.device.secondaryStateKey) {\r\n\t\t\tthis.state[this.props.device.secondaryStateKey] = this.props.device.getDeviceState(this.props.device.secondaryStateKey) || {}\r\n\t\t}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\tthis.props.device.on('stateChange', (stateKey, state) => {\r\n\t\t\tif (stateKey === this.props.device.primaryStateKey || stateKey === this.props.device.secondaryStateKey) {\r\n\t\t\t\tthis.setState({ [stateKey]: state });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, device, component, action } = this.props;\r\n\t\t\r\n\t\tconst state = this.state[device.primaryStateKey];\r\n\t\tconst options = device.get('options');\r\n\t\t\r\n\t\tlet icon = device.getIcon(device.primaryStateKey, state.val);\r\n\t\tlet primary = device.getAction(device.primaryStateKey, device.options.primaryAction === false);\r\n\t\tlet secondary = action && this.state[device.secondaryStateKey] ? device.getAction(device.secondaryStateKey) : null;\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{options.divider && options.divider !== 'after' && <ListItem divider className={classes.defaultListDivider} />}\r\n\t\r\n\t<ListItem\r\n\t\tclassName={clsx(this.props.openDialog && classes.finger, horizontal && classes.horizontalListItem)}\r\n\t\tbutton={this.props.openDialog !== null}\r\n\t\tonClick={this.props.openDialog && this.openDialog.bind(this)}\r\n\t\t>\r\n\t\t\r\n\t\t<ListItemIcon className={clsx(horizontal && classes.horizontalListItemIcon)}>\r\n\t\t{icon === null ? <React.Fragment /> :\r\n\t\t\t<ListItemIconElement customClassNames={['defaultListIcon','mdi mdi-' + icon]} styles={device.getStyle('icon', device.primaryStateKey, state.val)} />\r\n\t\t}\r\n\t\t</ListItemIcon>\r\n\t\t\r\n\t\t<ListItemText\r\n\t\t\tprimary={(component && device.getComponent()) || device.getOption('label')}\r\n\t\t\tsecondary={(options.subtitle !== null ? (options.subtitle || (state && state.timeChanged) || null) : null)}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={ horizontal ? classes.horizontalListItemAction : classes.verticalListItemAction }>\r\n\t\t\t{!secondary ? primary : [ primary, <br key={'br_' + device.id} />, secondary ]}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t\r\n\t{options.divider && options.divider === 'after' && <ListItem divider style={{margin: '5px 0'}} />}\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateListItem);\r\n","import React from 'react'\r\nimport i18n from '../i18n'\r\n\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport StateListItem from './StateListItem'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListSectionDivider: {\r\n\t\tmargin: '5px 0 0 0'\r\n\t},\r\n\tdefaultListSectionDividerItem: {\r\n\t\tmargin: '6px 0 7px 0',\r\n\t\tpadding: '0 16px !important'\r\n\t},\r\n\tdefaultListSectionText: {\r\n\t\tmargin: 0,\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: '0 0 0 10px',\r\n\t\t}\r\n\t},\r\n\thorizontalList: {\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'row',\r\n\t\tflexWrap: 'wrap'\r\n\t}\r\n});\r\n\r\n\r\nconst ListDivider = withStyles(styles)(props => {\r\n\tconst { classes, getDevicesBySubgroup, subgroup, title, subgroupActions } = props;\r\n\t\r\n\tconst handleChangeOn = () => handleChange(true);\r\n\tconst handleChangeOff = () => handleChange(false);\r\n\tconst handleChange = targetStatus => {\r\n\t\t\r\n\t\tconst devices = getDevicesBySubgroup(subgroup);\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\tlet status = targetStatus;\r\n\t\t\tif (device.primaryStateKey === 'level') {\r\n\t\t\t\tstatus = status ? 100 : 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdevice.setDeviceState(null, status);\r\n\t\t});\r\n\t}\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t<ListItem divider className={classes.defaultListSectionDivider} />\r\n\t<ListItem className={classes.defaultListSectionDividerItem}>\r\n\t\t<ListItemText\r\n\t\t\tclassName={classes.defaultListSectionText}\r\n\t\t\tprimary={title}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction>\r\n\t\t{subgroupActions === null || subgroupActions === false ? null :\r\n\t\t\t<ButtonGroup color=\"primary\" size=\"small\">\r\n\t\t\t\t<Button onClick={handleChangeOn}>{i18n.t('on')}</Button>\r\n\t\t\t\t<Button onClick={handleChangeOff}>{i18n.t('off')}</Button>\r\n\t\t\t</ButtonGroup>\r\n\t\t}\r\n\t\t\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n</React.Fragment>\r\n\t\r\n\t);\r\n});\r\n\r\nclass StateList extends React.Component {\r\n\t\r\n\tgetDevicesBySubgroup(subgroup) {\r\n\t\t\r\n\t\tlet devices = [];\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\r\n\t\t\tif (subgroup === device.getOption('subgroup')) {\r\n\t\t\t\tdevices.push(device);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn devices;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, devices, settings, component, action, ...props } = this.props;\r\n\t\tlet subgroup;\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense={true} className={horizontal && classes.horizontalList}>\r\n\t{devices.map((device, i) => {\r\n\t\t\r\n\t\tconst listSection = subgroup !== null && device.options.subgroup !== null && device.options.subgroup !== subgroup && <ListDivider\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={'ListDivider-' + device.get('id')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetDevicesBySubgroup={this.getDevicesBySubgroup.bind(this)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroup={device.getOption('subgroup')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={device.options.subgroup}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroupActions={settings.subgroupActions || device.options.subgroupActions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tconst listItem = <StateListItem\r\n\t\t\t\t\t\t\t{...props}\r\n\t\t\t\t\t\t\tkey={'StateListItem-' + device.get('id')}\r\n\t\t\t\t\t\t\thorizontal={horizontal}\r\n\t\t\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t\t\tcomponent={component || false}\r\n\t\t\t\t\t\t\taction={action || true}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tsubgroup = device.getOption('subgroup');\r\n\t\treturn [ listSection, listItem ];\r\n\t})}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateList);\r\n","import i18n from './i18n'\r\n\r\n/**\r\n * Settings\r\n *\r\n *\r\n */\r\nexport default class Settings {\r\n\r\n\t/*\r\n\t * holds the settings\r\n\t */\r\n\tstatic settings = {};\r\n\r\n\t/**\r\n\t * Set settings.\r\n\t *\r\n\t * @param\t{Object}\tsettings\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setSettings(settings) {\r\n\t\tif (settings) {\r\n\t\t\tSettings.settings = { ...Settings.settings, ...settings || {} };\r\n\t\t\tconsole.log('Settings', Settings.settings);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a setting.\r\n\t *\r\n\t * @param\t{String}\tsettings\r\n\t * @return\t{Mixed|null}\r\n\t */\r\n\tstatic getSetting(setting) {\r\n\t\treturn Settings.settings[setting] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Apply settings.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic applySettings() {\r\n\t\t\r\n\t\t// language\r\n\t\twindow.language = (Settings.settings.language || navigator.language || navigator.userLanguage || 'en').substr(0, 2);\r\n\t\ti18n.setLanguage(window.language);\r\n\t\ti18n.loadTranslations(['en', 'de']);\r\n\t\t\r\n\t\t// page title\r\n\t\tif (Settings.settings.pageTitle) {\r\n\t\t\tdocument.title = Settings.settings.pageTitle;\r\n\t\t}\r\n\t\t\r\n\t\t// favicon\r\n\t\tif (Settings.settings.pageFavicon && Settings.settings.pageFavicon.substr(0, 5) === 'data:') {\r\n\t\t\tdocument.getElementById('favicon').href = Settings.settings.pageFavicon;\r\n\t\t}\r\n\t\t\r\n\t\t// translations\r\n\t\tif (Settings.settings.translations) {\r\n\t\t\t\r\n\t\t\tlet translations = Settings.settings.translations;\r\n\t\t\tfor (let language in translations) {\r\n\t\t\t\ti18n.setTranslation(language, translations[language]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport StopIcon from '@material-ui/icons/Stop';\r\n\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tvalue: props => ({\r\n\t\tfloat: 'left',\r\n\t\tlineHeight: '32px',\r\n\t\tmarginRight: '10px'\r\n\t}),\r\n\tnoBorder: {\r\n\t\tborderLeftColor: 'transparent'\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction BlindLevelAction(props) {\r\n\tconst { device, state, stateKey } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onGoUp = () => {\r\n\t\tsetLevel(100);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 100).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst onGoDown = () => {\r\n\t\tsetLevel(0);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 0).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst onStop = () => {\r\n\t\tsetActivity(false);\r\n\t\tdevice.setDeviceState('activity', true).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\t// level\r\n\tconst [level, setLevel] = useState(state.value);\r\n\tuseEffect(() => setLevel(state.value), [state.value]);\r\n\t\r\n\t// activity\r\n\tconst [activity, setActivity] = useState(null);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (device.states.activity && device.states.activity.state) {\r\n\t\t\tdevice.states.activity.state = typeof device.states.activity.state === 'string' ? { 'node': device.states.activity.state } : device.states.activity.state;\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('activity', true).catch(err => console.error(err));\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('stateChange', (sKey, s) => {\r\n\t\t\t\tif (sKey === 'activity') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet val = s.val;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// HomeMatic\r\n\t\t\t\t\tif (device.options.manufacturer === 'HomeMatic') {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tswitch(val) {\r\n\t\t\t\t\t\t\tcase 1: // UP\r\n\t\t\t\t\t\t\tcase 2: // DOWN\r\n\t\t\t\t\t\t\t\tval = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tcase 3: // STABLE\r\n\t\t\t\t\t\t\tdefault: // UNKNOWN\r\n\t\t\t\t\t\t\t\tval = false;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//\r\n\t\t\t\t\tsetActivity(val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t}, [device]);\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t<div className={classes.value}>\r\n\t\t{level + state.unit}\r\n\t</div>\r\n\t\r\n\t<ButtonGroup size=\"small\">\r\n\t\t<Button color=\"primary\" onClick={onGoUp}><ExpandLessIcon /></Button>\r\n\t\t\t{activity !== null && <Button color=\"secondary\" style={{ borderRightColor: !activity ? 'transparent' : 'rgba(245, 0, 87, 0.5)' }} onClick={onStop} disabled={!activity}><StopIcon /></Button>}\r\n\t\t<Button color=\"primary\" style={activity !== null ? { borderLeftColor: !activity ? 'rgba(0, 0, 0, 0.26)' : 'transparent' } : {}} onClick={onGoDown}><ExpandMoreIcon /></Button>\r\n\t</ButtonGroup>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tlevel: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t},\r\n\t\tlevel2: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel2: defaults.components.LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tlevel: BlindLevelAction\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { format } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\n\r\nimport Connection from '../Connection'\r\nimport i18n from '../i18n'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport List from '@material-ui/core/List'\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport StarIcon from '@material-ui/icons/Star';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tnoUpdates: {\r\n\t\tfontStyle: 'italic',\r\n\t\ttextAlign: 'right',\r\n\t\tcolor: 'rgba(0, 0, 0, 0.54)'\r\n\t},\r\n\tUpdateAvailable: {\r\n\t\tcolor: '#CCAA00',\r\n\t},\r\n\tUpdatesListItem: {\r\n\t\tbackgroundColor: '#ffd700',\r\n\t\tcolor: '#fff',\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t\tpaddingLeft: theme.spacing(2)\r\n\t},\r\n\tUpdatesIndicator: {\r\n\t\tright: theme.spacing(3.75),\r\n\t\tbackgroundColor: '#CCAA00',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t\tcolor: '#fff',\r\n\t\ttextAlign: 'center',\r\n\t\tfontSize: '1rem !important'\r\n\t},\r\n\tStatusIndicator: {\r\n\t\tfontSize: '1.4rem'\r\n\t},\r\n\tloading: {\r\n\t\ttextAlign: 'center',\r\n\t\tmarginTop: '5px'\r\n\t},\r\n\tsmall: {\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t},\r\n\talive: {\r\n\t\tcolor: '#86d686'\r\n\t},\r\n\tnotAlive: {\r\n\t\tcolor: '#f7e43b'\r\n\t},\r\n\tdisabled: {\r\n\t\tcolor: '#bababa'\r\n\t}\r\n});\r\n\r\n\r\nclass AdapterStatus extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tadapterInformation: [],\r\n\t\t\tadapterAliveStatus: {},\r\n\t\t\tnewUpdates: false,\r\n\t\t\tupdatesJson: '',\r\n\t\t\tlastUpdateCheck: ''\r\n\t\t}\r\n\t\t\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\tthis.list = this.props.settings.list ? (Array.isArray(this.props.settings.list) ? this.props.settings.list : this.props.settings.list.split(',')) : null;\r\n\t\tthis.blacklist = this.props.settings.blacklist ? (Array.isArray(this.props.settings.blacklist) ? this.props.settings.blacklist : this.props.settings.blacklist.split(',')) : null;\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// retrieve updates\r\n\t\tif (this.props.settings.updates !== false) {\r\n\t\t\t\r\n\t\t\tlet updateStates = ['admin.0.info.newUpdates', 'admin.0.info.lastUpdateCheck', 'admin.0.info.updatesJson'];\r\n\t\t\tthis.socket.getStates(updateStates, (err, states) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tnewUpdates: states['admin.0.info.newUpdates'].val,\r\n\t\t\t\t\tlastUpdateCheck: states['admin.0.info.lastUpdateCheck'].val,\r\n\t\t\t\t\tupdatesJson: states['admin.0.info.updatesJson'].val\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// get state updates\r\n\t\t\t\tthis.socket.subscribeStates(updateStates, (id, update) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tid = id.substr(id.lastIndexOf('.')+1);\r\n\t\t\t\t\tif (this.state[id] !== update.val) {\r\n\t\t\t\t\t\tthis.setState({ [id]: update.val });\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get adapter instances\r\n\t\tthis.socket.getAdapterInstances((err, instances) => {\r\n\t\t\t\r\n\t\t\tlet states = [];\r\n\t\t\tif (instances && instances.rows) {\r\n\t\t\t\tlet adapters = [];\r\n\t\t\t\t\r\n\t\t\t\t// states per instance to retrieve\r\n\t\t\t\tinstances.rows.forEach((instance, i) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get alive / connected states\r\n\t\t\t\t\tif ((!this.list || (this.list && this.list.indexOf(instance.value.common.name) > -1)) && (!this.blacklist || (this.blacklist && this.blacklist.indexOf(instance.value.common.name) === -1))) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tadapters.push(instance);\r\n\t\t\t\t\t\tstates = states.concat([\r\n\t\t\t\t\t\t\tinstance.id + '.alive',\r\n\t\t\t\t\t\t\tinstance.id + '.connected',\r\n\t\t\t\t\t\t\tinstance.id.replace('system.adapter.', '') + '.info.connection'\r\n\t\t\t\t\t\t]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// sort instances\r\n\t\t\t\tthis.setState({ adapterInformation: adapters.sort((item1, item2) => {\r\n\t\t\t\t\t\tif (item1.id > item2.id) return 1;\r\n\t\t\t\t\t\telse if (item2.id > item1.id) return -1;\r\n\t\t\t\t\t\telse return 0;\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// retrieve intial states\r\n\t\t\t\tthis.socket.getStates(states, (err, adapterAliveStatus) => {\r\n\t\t\t\t\tthis.setState({ adapterAliveStatus });\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get state updates\r\n\t\t\t\t\tthis.socket.subscribeStates(states, (id, aliveStatus) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (aliveStatus && (!this.state.adapterAliveStatus[id] || (aliveStatus.val !== this.state.adapterAliveStatus[id].val))) {\r\n\t\t\t\t\t\t\tthis.setState(prevState => ({ adapterAliveStatus: { ...prevState.adapterAliveStatus, [id]: aliveStatus } }));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\t// adapter updates\r\n\t\tconst updateList = (this.state.updatesJson && JSON.parse(this.state.updatesJson)) || {};\r\n\t\tconst updates = Object.keys(updateList).length\r\n\t\t\r\n\t\t// adapter instances\r\n\t\tlet adapterList = <ListItem key='loading' className={classes.loading}><CircularProgress size={20} /></ListItem>\r\n\t\t\r\n\t\tif (this.state.adapterInformation.length > 0) {\r\n\t\t\t\r\n\t\t\tadapterList = this.state.adapterInformation.map(adapter => {\r\n\t\t\t\tadapter.update = updateList[adapter.value.common.name] || false;\r\n\t\t\t\t\r\n\t\t\t\tconst enabled = adapter.value.common.enabled;\r\n\t\t\t\tconst alive = (this.state.adapterAliveStatus[adapter.id + '.alive'] && this.state.adapterAliveStatus[adapter.id + '.alive'].val) || false;\r\n\t\t\t\tconst connected = (this.state.adapterAliveStatus[adapter.id + '.connected'] && this.state.adapterAliveStatus[adapter.id + '.connected'].val) || false;\r\n\t\t\t\tconst connection = this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'] ? this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'].val : true;\r\n\t\t\t\t\r\n\t\t\t\tconst tooltip = i18n.t('Adapter') + ' ' + (enabled ? (alive && connected && connection ? i18n.t('alive') : i18n.t('not alive')) : i18n.t('disabled'));\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t\r\n\t\t\t\t\t<ListItem key={'adapter-' + adapter.id}>\r\n\t\t\t\t\t\t<ListItemAvatar>\r\n\t\t\t\t\t\t\t<Avatar alt={adapter.value.common.name} src={adapter.value.common.extIcon} className={classes.small} />\r\n\t\t\t\t\t\t</ListItemAvatar>\r\n\t\t\t\t\t\t<ListItemText\r\n\t\t\t\t\t\t\tprimary={adapter.value.common.title}\r\n\t\t\t\t\t\t\tsecondary={[\r\n\t\t\t\t\t\t\t\t'v' + adapter.value.common.version,\r\n\t\t\t\t\t\t\t\t(adapter.update && (<span key={'updates-' + adapter.id}>, <span className={classes.UpdateAvailable}>{i18n.t('Update available') + ' v' + adapter.update.availableVersion}</span></span>)),\r\n\t\t\t\t\t\t\t\t(adapter.value.common.runAsCompactMode && ', ' + i18n.t('Compact Mode') + ' ' + i18n.t('on') + ' (' + i18n.t('Group') + ' ' + adapter.value.common.compactGroup + ')')\r\n\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, enabled ? (alive && connected && connection ? classes.alive : classes.notAlive) : classes.disabled)}>\r\n\t\t\t\t\t\t\t<Tooltip title={tooltip}>\r\n\t\t\t\t\t\t\t\t<span className={enabled ? (alive && connected && connection ? 'mdi mdi-check-circle' : 'mdi mdi-alert') : 'mdi mdi-close'}></span>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t\t\t</ListItem>\r\n\t\t\t\t\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense>\r\n\t{this.state.newUpdates === false ? (this.state.lastUpdateCheck && \r\n\t<ListItem key=\"updates\" classes={{ root: classes.noUpdates }}>\r\n\t\t<ListItemText\r\n\t\t\tprimary={i18n.t('last update') + ': ' + format(new Date(this.state.lastUpdateCheck), 'dd.MM.yyyy HH:mm:ss', { locale: de })}\r\n\t\t\t/>\r\n\t\t\r\n\t</ListItem>)\r\n\t:\r\n\t<ListItem key=\"updates\" classes={{ container: classes.UpdatesListItem }}>\r\n\t\t<ListItemAvatar>\r\n\t\t\t<StarIcon />\r\n\t\t</ListItemAvatar>\r\n\t\t<ListItemText\r\n\t\t\tprimary={i18n.t('Updates available') + '!'}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, classes.UpdatesIndicator)}>\r\n\t\t\t{updates}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t}\r\n\t\r\n\t{adapterList}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport const Settings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Adapter Status'),\r\n\ticon: 'traffic-light'\r\n}\r\n\r\nexport default withStyles(styles)(AdapterStatus);\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { Line } from 'react-chartjs-2'\r\n// eslint-disable-next-line\r\nimport chartjs_colorschemes from 'chartjs-plugin-colorschemes'\r\n// eslint-disable-next-line\r\nimport chartjs_zoom from 'chartjs-plugin-zoom'\r\n\r\nimport deLocale from 'date-fns/locale/de'\r\nimport DateFnsUtils from '@date-io/date-fns'\r\n\r\nimport i18n from '../i18n'\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport Alert from '@material-ui/lab/Alert'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport { MuiPickersUtilsProvider, DateTimePicker } from '@material-ui/pickers'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport Select from '@material-ui/core/Select'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CalendarIcon from '@material-ui/icons/Event'\r\nimport CalendarTodayIcon from '@material-ui/icons/EventAvailable'\r\nimport HistoryIcon from '@material-ui/icons/History'\r\nimport FastRewindIcon from '@material-ui/icons/FastRewind'\r\n//import DisablePan from '@material-ui/icons/SelectAll'\r\n//import DisableZoom from '@material-ui/icons/LocationDisabled'\r\nimport ResetZoom from '@material-ui/icons/ZoomOutMap'\r\nimport LiveUpdates from '@material-ui/icons/Update'\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tloading: {\r\n\t\tposition: 'absolute',\r\n\t\tbackgroundColor: 'rgba(0, 0, 0, 0.3)',\r\n\t\twidth: '100%',\r\n\t\theight: '100%',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'center',\r\n\t},\r\n\terrorMessage: {\r\n\t\tmarginBottom: 5,\r\n\t\tmarginRight: 15,\r\n\t\twidth: '100%'\r\n\t},\r\n\ttoolbar: {\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\ttoolbarButtons: {\r\n\t\tdisplay: 'initial',\r\n\t\twhiteSpace: 'nowrap'\r\n\t},\r\n\toptions: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t},\r\n\tdatePicker: {\r\n\t\tpadding: '2px 4px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tmargin: 2\r\n\t},\r\n\tinput: {\r\n\t\tmarginLeft: theme.spacing(1),\r\n\t\tflex: 1,\r\n\t},\r\n\tselect: {\r\n\t\twidth: 100\r\n\t},\r\n\ticon: {\r\n\t\tmargin: 10,\r\n\t},\r\n\ticonButton: {\r\n\t\tpadding: 10,\r\n\t},\r\n\tdivider: {\r\n\t\tmargin: '15px 0',\r\n\t},\r\n\tdividerVertical: {\r\n\t\theight: 28,\r\n\t\tmargin: 4,\r\n\t},\r\n\tbutton: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff !important',\r\n\t\tmargin: '4px'\r\n\t},\r\n\tbuttonDisabled: {\r\n\t\tbackgroundColor: '#eee',\r\n\t\tmargin: '4px'\r\n\t}\r\n});\r\n\r\n\r\nclass Chart extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\t// chart settings\r\n\t\tthis.chartFilter = this.props.settings.chartFilter || {};\r\n\t\tthis.chartConfig = this.props.settings.chartConfig || {};\r\n\t\t\r\n\t\tthis.chartConfig.yAxes = this.chartConfig.yAxes || [];\r\n\t\tthis.chartConfig.yAxes.unshift({\r\n\t\t\tid: 'left',\r\n\t\t\ttype: 'linear',\r\n\t\t\tposition: 'left',\r\n\t\t\tticks: {\r\n\t\t\t\tcallback: value => (this.chartConfig.yLeftAxisUnitBefore || '') + Number.parseFloat(value).toFixed(1) + (this.chartConfig.yLeftAxisUnitAfter || '')\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// states\r\n\t\tthis.state = {\r\n\t\t\tloading: true,\r\n\t\t\terrors: [],\r\n\t\t\t\r\n\t\t\tdatePicker: false,\r\n\t\t\tselectedTimeRangeValue: (this.chartFilter && this.chartFilter.selectedTimeRangeValue) || 1,\r\n\t\t\tselectedTimeRangeUnit: (this.chartFilter && this.chartFilter.selectedTimeRangeUnit) || 'days',\r\n\t\t\tselectedDateTime: (this.chartFilter && this.chartFilter.selectedDateTime && new Date(this.chartFilter.selectedDateTime)) || new Date(),\r\n\t\t\tdateNow: this.chartFilter && this.chartFilter.selectedDateTime ? false : true,\r\n\t\t\t\r\n\t\t\tchartLabels: [],\r\n\t\t\tchartData: {\r\n\t\t\t\tlabels: [],\r\n\t\t\t\tdatasets: []\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tchartPan: true,\r\n\t\t\tchartZoom: true\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tthis.timer = null;\r\n\t\tthis.timeRangeRef = React.createRef();\r\n\t\t\r\n\t\t// chart instance options\r\n\t\tthis.chartRef = React.createRef();\r\n\t\tthis.chartUpdates = {};\r\n\t\tthis.chartOptions = {\r\n\t\t\tmaintainAspectRatio: false,\r\n\t\t\tspanGaps: true,\r\n\t\t\tlegend: {\r\n\t\t\t\tonClick: this.legendClickHandler.bind(this)\r\n\t\t\t},\r\n\t\t\ttooltips: {\r\n\t\t\t\tcallbacks: {\r\n\t\t\t\t\tlabel: (item, data) => data.datasets[item.datasetIndex].label + ': ' + item.value + data.datasets[item.datasetIndex].unit\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tscales: {\r\n\t\t\t\tyAxes: this.chartConfig.yAxes\r\n\t\t\t},\r\n\r\n\t\t\tplugins: {\r\n\t\t\t\tcolorschemes: {\r\n\t\t\t\t\tscheme: 'brewer.SetOne9'\r\n\t\t\t\t},\r\n\t\t\t\tzoom: {\r\n\t\t\t\t\t// Container for pan options\r\n\t\t\t\t\tpan: {\r\n\t\t\t\t\t\t// Boolean to enable panning\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Panning directions\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Container for zoom options\r\n\t\t\t\t\tzoom: {\r\n\t\t\t\t\t\t// Boolean to enable zooming\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Zooming directions.\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// request initial history data\r\n\t\tlet options = { ...this.getTimeRange(), axis: this.getAxis() };\r\n\t\t\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\tdevice.label = device.name + ' (' + i18n.t(device.primaryStateKey) + ')';\r\n\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// add listeners for newly requested data\r\n\t\t\tdevice.on('historyChange', (stateKey, history, state) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.addChartGraph(device, history, { ...options, axis: this.getAxis(options.start, options.end) } );\r\n\t\t\t\tthis.setState({ loading: false });\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// add listeners for data updates\r\n\t\t\tif (this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow) {\r\n\t\t\t\t\r\n\t\t\t\tdevice.on('stateChange', (stateKey, val, state) => this.updateChartGraph(device, val, { ...options, axis: this.getAxis(options.end, new Date()) } ));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tif (this.state.selectedTimeRangeValue &&\r\n\t\t\t\t(prevState.selectedDateTime !== this.state.selectedDateTime || prevState.selectedTimeRangeValue !== this.state.selectedTimeRangeValue || prevState.selectedTimeRangeUnit !== this.state.selectedTimeRangeUnit)\r\n\t\t\t) {\r\n\t\t\t\r\n\t\t\t// request updated history data\r\n\t\t\tthis.setState({ loading: true, errors: [] });\r\n\t\t\t\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\r\n\t\t\t\tconst options = this.getTimeRange();\r\n\t\t\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => {\r\n\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t}\r\n\t\r\n\tgetTimeRange() {\r\n\t\t\r\n\t\tconst end = this.state.selectedDateTime.getTime();\r\n\t\tlet timeRange = this.state.selectedTimeRangeValue;\r\n\t\tlet step = 1;\r\n\t\tlet axisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\r\n\t\tswitch(this.state.selectedTimeRangeUnit) {\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'seconds':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'minutes':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\ttimeRange = timeRange*60;\r\n\t\t\t\t//step = step;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'hours':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60;\r\n\t\t\t\tstep = step*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'days':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60*24;\r\n\t\t\t\tstep = step*60*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'months':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*31;\r\n\t\t\t\tstep = step*60*60*24;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'years':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*365;\r\n\t\t\t\tstep = step*60*60*24*31;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\t'axisTimeFormat': axisTimeFormat,\r\n\t\t\t'start': end-timeRange*1000,\r\n\t\t\t'end': end,\r\n\t\t\t'timeRange': timeRange*1000,\r\n\t\t\t'step': step*1000\r\n\t\t};\r\n\t}\r\n\t\r\n\tgetAxis(start, end) {\r\n\t\t\r\n\t\tconst { step, axisTimeFormat } = this.getTimeRange();\r\n\t\tlet axis = {};\r\n\t\t\r\n\t\tfor (let time = start; time <= end; time += step) {\r\n\t\t\taxis[time] = helpers.secondsToDateTime(time/1000, axisTimeFormat);\r\n\t\t}\r\n\t\t\r\n\t\treturn axis;\r\n\t}\r\n\t\r\n\tgroupChartData(chartData, axis) {\r\n\t\t\r\n\t\tlet prevMarker;\r\n\t\tlet data = [];\r\n\t\t\r\n\t\tlet markers = Object.keys(axis);\r\n\t\tmarkers.forEach((marker, i) => {\r\n\t\t\tprevMarker = markers[(i-1 > 0 ? i-1 : 0)];\r\n\t\t\t\r\n\t\t\tfor (let index in chartData) {\r\n\t\t\t\tlet entry = chartData[index];\r\n\t\t\t\tentry.val = parseFloat(entry.val);\r\n\t\t\t\t\r\n\t\t\t\t// \r\n\t\t\t\tif (!entry.ts || entry.val === null) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// before range, continue\r\n\t\t\t\tif (prevMarker > entry.ts) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// in range\r\n\t\t\t\telse if (prevMarker < entry.ts && entry.ts <= marker) {\r\n\t\t\t\t\tdata[i] = !data[i] ? [ entry.val ] : [ ...data[i], entry.val ]; // parseFloat((data[i] ? ((data[i]+entry.val)/2) : entry.val).toFixed(2));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// beyond range, so next marker\r\n\t\t\t\telse if (entry.ts > marker) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif (!data[i]) {\r\n\t\t\t\t// \r\n\t\t\t}\r\n\t\t\telse if (data[i].length === 1) {\r\n\t\t\t\tdata[i] = data[i][0];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdata[i] = data[i].reduce((a,b) => a + b, 0) / data[i].length;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn data;\r\n\t}\r\n\t\r\n\tupdateChartGraph(device, value, options) {\r\n\t\t\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex === -1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tthis.chartUpdates[chartIndex] = this.chartUpdates[chartIndex] || [];\r\n\t\tthis.chartUpdates[chartIndex].push({\r\n\t\t\t'ts': value.ts,\r\n\t\t\t'val': value.val\r\n\t\t});\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(this.chartUpdates[chartIndex], options.axis);\r\n\t\t\r\n\t\t//console.log(value);\r\n\t\t//console.log(options, options.axis, data);\r\n\t\t\r\n\t\t// update chart\r\n\t\tthis.chartRef.current.chartInstance.data.labels = [ ...this.state.chartData.labels, ...Object.values(options.axis) ];\r\n\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = [ ...this.state.chartData.datasets[chartIndex].data, ...data ];\r\n\t\tthis.chartRef.current.chartInstance.update();\r\n\t}\r\n\t\r\n\taddChartGraph(device, history, options) {\r\n\t\t\r\n\t\t// only add chart if data is given\r\n\t\tif (!history || !history.length) {\r\n\t\t\tlet error = i18n.t('No history data given for %s').replace('%s', device.label) + '!';\r\n\t\t\tthis.setState(prevStates => ({ errors: [ ...prevStates.errors, error ] }));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(history, options.axis);\r\n\t\t\r\n\t\t// update chart\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex > -1) {\r\n\t\t\tthis.chartRef.current.chartInstance.data.labels = Object.values(options.axis);\r\n\t\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = data;\r\n\t\t\tthis.chartRef.current.chartInstance.update();\r\n\t\t}\r\n\t\t\r\n\t\t// index chart\r\n\t\telse {\r\n\t\t\tthis.setState(prevStates => ({ chartLabels: [ ...prevStates.chartLabels, device.label ] }));\r\n\t\t\t\r\n\t\t\t// chart dataset\r\n\t\t\tlet dataSet = {\r\n\t\t\t\tlabel: device.label,\r\n\t\t\t\tunit: device.states[device.primaryStateKey].state.value.unit || '',\r\n\t\t\t\tfill: false,\r\n\t\t\t\t...device.options.graphConfig || {},\r\n\t\t\t\tdata: data\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t// add data to chart\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\taxisTimeFormat: options.axisTimeFormat,\r\n\t\t\t\tchartData: {\r\n\t\t\t\t\tlabels: Object.values(options.axis),\r\n\t\t\t\t\tdatasets: [ ...prevStates.chartData.datasets, dataSet ],\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\t\r\n\tlegendClickHandler(e, legendItem) {\r\n\t\t\r\n\t\tlet index = legendItem.datasetIndex;\r\n\t\tlet ci = this.chartRef.current.chartInstance;\r\n\t\tlet meta = ci.getDatasetMeta(index);\r\n\r\n\t\tmeta.hidden = meta.hidden === null ? !ci.data.datasets[index].hidden : null;\r\n\t\tci.update();\r\n\t\tci.resetZoom();\r\n\t}\r\n\t\r\n\tdisablePan() {\r\n\t\tlet pan = this.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled = (pan === false);\r\n\t\tthis.setState({ chartPan: (pan === false) });\r\n\t}\r\n\t\r\n\tdisableZoom() {\r\n\t\tlet zoom = this.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled = (zoom === false);\r\n\t\tthis.setState({ chartZoom: (zoom === false) });\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, settings } = this.props;\r\n\t\treturn (\r\n\r\n<div>\r\n\t<div className={classes.options}>\r\n\t\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('Period shown in Chart')}>\r\n\t\t\t\t<HistoryIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<InputBase\r\n\t\t\t\tinputRef={this.timeRangeRef}\r\n\t\t\t\tclassName={classes.input}\r\n\t\t\t\tvalue={this.state.selectedTimeRangeValue}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeValue: event.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<Select\r\n\t\t\t\tvalue={this.state.selectedTimeRangeUnit}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeUnit: event.target.value })}\r\n\t\t\t\tdisplayEmpty\r\n\t\t\t\tdisableUnderline\r\n\t\t\t\tclassName={classes.select}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<MenuItem value=\"seconds\">{i18n.t('Seconds')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"minutes\">{i18n.t('Minutes')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"hours\">{i18n.t('Hours')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"days\">{i18n.t('Days')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"months\">{i18n.t('Months')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"years\">{i18n.t('Years')}</MenuItem>\r\n\t\t\t</Select>\r\n\t\t\t\r\n\t\t\t{/*\r\n\t\t\t<IconButton className={classes.iconButton} onClick={() => this.timeRangeRef.current.focus()}>\r\n\t\t\t\t<CalendarIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t*/}\r\n\t\t</Paper>\r\n\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('End date')}>\r\n\t\t\t\t<FastRewindIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<MuiPickersUtilsProvider locale={deLocale} utils={DateFnsUtils}>\r\n\t\t\t\t<DateTimePicker\r\n\t\t\t\t\tclassName={classes.input}\r\n\t\t\t\t\tvalue={this.state.selectedDateTime}\r\n\t\t\t\t\tonChange={selectedDateTime => this.setState({ selectedDateTime: selectedDateTime, dateNow: false })}\r\n\t\t\t\t\t\r\n\t\t\t\t\topen={this.state.datePicker}\r\n\t\t\t\t\tonOpen={() => this.setState({ datePicker: true })}\r\n\t\t\t\t\tonClose={() => this.setState({ datePicker: false })}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvariant=\"inline\"\r\n\t\t\t\t\tampm={false}\r\n\t\t\t\t\tformat='dd.MM.yyyy HH:mm'\r\n\t\t\t\t\tInputProps={{\r\n\t\t\t\t\t\tdisableUnderline: true,\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</MuiPickersUtilsProvider>\r\n\t\t\t\r\n\t\t\t<Tooltip title={i18n.t('Select end date')}>\r\n\t\t\t\t<IconButton color=\"primary\" className={classes.iconButton} onClick={() => this.setState({ datePicker: true })}>\r\n\t\t\t\t\t<CalendarIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t\t<Divider className={classes.dividerVertical} orientation=\"vertical\" />\r\n\t\t\t<Tooltip title={i18n.t('Select today as end date')}>\r\n\t\t\t\t<IconButton className={classes.iconButton} onClick={() => this.setState({ selectedDateTime: new Date(), dateNow: true })}>\r\n\t\t\t\t\t<CalendarTodayIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t</Paper>\r\n\t\t\r\n\t\t<Tooltip title={i18n.t('Live updates are ' + (this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow ? 'on' : 'off'))} placement=\"top\" style={{ display: 'flex' }}>\r\n\t\t\t<span>\r\n\t\t\t\t<Button disabled={true} className={clsx(classes.datePicker, this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow ? classes.button : classes.buttonDisabled)}>\r\n\t\t\t\t\t<LiveUpdates />\r\n\t\t\t\t</Button>\r\n\t\t\t</span>\r\n\t\t</Tooltip>\r\n\t\t\r\n\t</div>\r\n\t<Divider className={classes.divider} />\r\n\t\r\n\t<div className={classes.toolbar}>\r\n\t\t<div className={classes.errorMessage}>\r\n\t\t\t{this.state.errors.length > 0 && <Alert severity=\"error\">{this.state.errors.map((error, i) => [ error, React.createElement('br', { key: 'br-error-' + i }) ])}</Alert>}\r\n\t\t</div>\r\n\t\t\r\n\t\t<ButtonGroup className={classes.toolbarButtons} color=\"primary\">\r\n\t\t{/*\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartPan ? 'contained' : 'outlined'} onClick={this.disablePan.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartPan ? 'Disable panning' : 'Enable panning')}>\r\n\t\t\t\t\t<DisablePan />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartZoom ? 'contained' : 'outlined'} onClick={this.disableZoom.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartZoom ? 'Disable Zoom' : 'Enable Zoom')}>\r\n\t\t\t\t\t<DisableZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t*/}\r\n\t\t\t<Button disableElevation={true} variant=\"contained\" onClick={() => this.chartRef.current.chartInstance.resetZoom()}>\r\n\t\t\t\t<Tooltip title={i18n.t('Reset Zoom')}>\r\n\t\t\t\t\t<ResetZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t</ButtonGroup>\r\n\t</div>\r\n\t\r\n\t<div className={'chart-container'} style={{ position: 'relative', height: settings.chartHeight || '500px' }}>\r\n\t\t{this.state.loading && <div className={classes.loading}>\r\n\t\t\t<CircularProgress />\r\n\t\t</div>}\r\n\t\t\r\n\t\t<Line\r\n\t\t\tref={this.chartRef}\r\n\t\t\tdata={this.state.chartData}\r\n\t\t\toptions={this.chartOptions}\r\n\t\t\t/>\r\n\t\t\t\r\n\t</div>\r\n</div>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Chart);\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport { format } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\nimport { getSunrise, getSunset } from 'sunrise-sunset-js'\r\n\r\nimport i18n from '../i18n'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\n\r\n\r\nexport default function DateTime(props) {\r\n\tconst { settings } = props;\r\n\t\r\n\tconst refTimer = useRef();\r\n\tconst [DateTime, setDateTime] = useState(format(new Date(), settings.format, { locale: de }));\r\n\tconst [city, setCity] = useState('');\r\n\tconst [sunrise, setSunrise] = useState('');\r\n\tconst [sunset, setSunset] = useState('');\r\n\t\r\n\t// https://date-fns.org/v2.9.0/docs/format\r\n\tsettings.style = { fontSize: '1.5rem', textAlign: 'center', ...settings.style };\r\n\tsettings.format = settings.format || 'dd.MM.yyyy HH:mm:ss';\r\n\tsettings.refresh = settings.format.indexOf('s') > -1 ? 1000 : (settings.format.indexOf('i') > -1 ? 60*1000 : 60*60*1000);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tclearTimeout(refTimer.current);\r\n\t\trefTimer.current = setTimeout(() => setDateTime(format(new Date(), settings.format, { locale: de })), settings.refresh);\r\n\t\t\r\n\t\t//\r\n\t\tif (settings._global.iobroker.latitude && settings._global.iobroker.longitude) {\r\n\t\t\tsetSunrise(getSunrise(settings._global.iobroker.latitude, settings._global.iobroker.longitude));\r\n\t\t\tsetSunset(getSunset(settings._global.iobroker.latitude, settings._global.iobroker.longitude));\r\n\t\t}\r\n\t\t\r\n\t\tif (settings._global.iobroker.city) {\r\n\t\t\tsetCity(settings._global.iobroker.city);\r\n\t\t}\r\n\t\t\r\n\t}, [settings]);\r\n\t\r\n\treturn (\r\n\r\n<div style={settings.style}>\r\n\t{i18n.t('%DateTime').replace(/%DateTime/, DateTime)}\r\n\t\r\n\t{settings.sun !== false && <div style={{ margin: '5px 0', fontSize: '1.2rem' }}>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-city-variant-outline\"></span> {city ? city : <CircularProgress size=\"1.2rem\" />}\r\n\t\t<span style={{ margin: '0 10px' }}></span>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-weather-sunset-up\"></span> {sunrise ? format(sunrise, 'HH:mm') : <CircularProgress size=\"1.2rem\" />}\r\n\t\t<span style={{ margin: '0 10px' }}></span>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-weather-sunset-down\"></span> {sunset ? format(sunset, 'HH:mm') : <CircularProgress size=\"1.2rem\" />}\r\n\t</div>\r\n\t}\r\n\t\r\n</div>\r\n\r\n\t);\r\n}\r\n\r\nexport const Settings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Time'),\r\n\ticon: 'clock-outline'\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport L from 'leaflet'\r\nimport { Map as LeafletMap, TileLayer, Marker as LeafletMarker, Tooltip as LeafletTooltip } from 'react-leaflet'\r\n\r\nimport i18n from '../i18n'\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tmap: {\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapOverview: {\r\n\t\tcolor: '#666',\r\n\t\tposition: 'absolute',\r\n\t\tleft: 0,\r\n\t\tbottom: 0,\r\n\t\twidth: '100%',\r\n\t\theight: '60px',\r\n\t\tzIndex: 999,\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\t\r\n\t\t'& > *': {\r\n\t\t\tmargin: theme.spacing(1),\r\n\t\t\tcursor: 'pointer',\r\n\t\t},\r\n\t},\r\n\tmapIconContainer: {\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tboxShadow: '0 0 0 8px rgba(255, 255, 255, 0.3)',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '2rem',\r\n\t\tcolor: theme.palette.primary.main,\r\n\t\ttransform: 'translate3d(4px, -4px,0)', /* for fontSize: '2.3rem' -> 'translate3d(2px, -8px,0)', */\r\n\t\tdisplay: 'block',\r\n\t\t\r\n\t\t'&:after': {\r\n\t\t\tcontent: '\"\"',\r\n\t\t\tdisplay: 'block',\r\n\t\t\tpadding: '50% 0%'\r\n\t\t}\r\n\t},\r\n\tmapTooltip: {\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Map(props) {\r\n\tconst { settings, devices } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [zoom,] = useState(settings.component.defaultZoom);\r\n\tconst [position,] = useState(settings.component.defaultPosition ? (Array.isArray(settings.component.defaultPosition) ? settings.component.defaultPosition : settings.component.defaultPosition.split(',')) : [ settings._global.iobroker.latitude, settings._global.iobroker.longitude ]);\r\n\tconst [markers, setMarkers] = useState({});\r\n\t\r\n\t// map instance\r\n\tconst map = useRef();\r\n\tconst memoizedMapInitialised = useCallback(function() {map.current = this}, [],);\r\n\t\r\n\t// Marker click in overview\r\n\tconst memoizedHandleClick = useCallback(flyTo => map.current.flyTo(flyTo.split(',')), [],);\r\n\t\r\n\t// get gps position coordinates\r\n\tuseEffect(() => {\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('position').catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\t\r\n\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\tif (!prevMarkers[device.id]) {\r\n\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: null };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('stateChange', (stateKey, state) => {\r\n\t\t\t\t\r\n\t\t\t\tif (stateKey === 'position') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\t\tif (!prevMarkers[device.id] || prevMarkers[device.id].position !== state.val) {\r\n\t\t\t\t\t\t\tdevice.options.position = state.val;\r\n\t\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: device };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\r\n\t}, [devices]);\r\n\t\r\n\t// add markers\r\n\tlet mapMarkers = [], mapOverview = [];\r\n\tif (devices.length > 0 && devices.length === Object.keys(markers).length) {\r\n\t\t\r\n\t\tfor (let key in markers) {\r\n\t\t\tlet device = markers[key];\r\n\t\t\tif (device !== null) {\r\n\t\t\t\tlet marker = <Marker key={'marker-' + device.id} position={device.options.position} device={device} settings={settings.component} />\r\n\t\t\t\tmapMarkers.push(marker);\r\n\t\t\t\t\r\n\t\t\t\tlet item = null;\r\n\t\t\t\tif (device.attributes.avatar) {\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} src={device.attributes.avatar} onClick={() => memoizedHandleClick(device.options.position)} />\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlet state = device.getDeviceState();\r\n\t\t\t\t\tconst icon = device.getIcon(null, state && state.val !== undefined ? state.val : null);\r\n\t\t\t\t\tconst styles = device.getStyle('icon', null, state && state.val !== undefined ? state.val : null);\r\n\t\t\t\t\tconsole.log(state && state.val !== undefined ? state.val : null);\r\n\t\t\t\t\tconsole.log(styles);\r\n\t\t\t\t\t\r\n\t\t\t\t\titem = <Avatar style={styles} key={'overview-' + device.id} alt={device.name} onClick={() => memoizedHandleClick(device.options.position)}><span className={clsx('mdi mdi-' + icon)}></span></Avatar>\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tmapOverview.push(<Tooltip key={'tooltip-' + device.id} title={device.name} aria-label={device.name} arrow>{item}</Tooltip>);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Box className={classes.mapOverview}>\r\n\t\t<Typography>{i18n.t('Jump to')}:</Typography>\r\n\t\t{mapOverview}\r\n\t</Box>\r\n\t<LeafletMap useFlyTo={true} center={position} zoom={zoom} className={classes.map} whenReady={memoizedMapInitialised}>\r\n\t\t<TileLayer\r\n\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n\t\t\turl='https://{s}.tile.osm.org/{z}/{x}/{y}.png'\r\n\t\t\t/>\r\n\t\t\r\n\t\t{mapMarkers}\r\n\t</LeafletMap>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nfunction Marker(props) {\r\n\tconst { position, device, settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tlet markerIcon = null, offset = 40;\r\n\tconsole.info('Marker for ' + device.function + ' ' + device.name + ' added to map.');\r\n\t\r\n\t// Marker with avatar / picture\r\n\tif (device.attributes && device.attributes.avatar && device.attributes.avatar.substr(0, 11) === 'data:image/') {\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<img src=\"' + device.attributes.avatar + '\" class=\"' + classes.mapIconParent + '\" />',\r\n\t\t\ticonSize: [ 64, 64 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker with Icon\r\n\telse {\r\n\t\toffset = 30;\r\n\t\tlet state = device.getDeviceState();\r\n\t\tconst icon = device.getIcon(null, state && state.val !== undefined ? state.val : null);\r\n\t\tconst styles = device.getStyle('icon', null, state && state.val !== undefined ? state.val : null);\r\n\t\t\r\n\t\tconsole.log(styles); \r\n\t\tconst useStyles = makeStyles({root: styles}, {name:'testi'});\r\n\t\tconsole.log(useStyles.root); \r\n\t\t\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<div class=\"' + clsx(classes.mapIconParent) + '\"><span class=\"' + clsx(classes.mapIcon, 'mdi mdi-' + icon) + '\"></span></div>',\r\n\t\t\ticonSize: [ 40, 40 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker MouseOver / MouseOut (bring tooltip to front if markers overlay)\r\n\tconst memoizedHandleMouseEvent = useCallback(function() {this.closeTooltip().openTooltip()}, [],);\r\n\r\n\treturn (\r\n\r\n<LeafletMarker riseOnHover={true} position={Array.isArray(position) ? position : position.split(',')} icon={markerIcon} onMouseOver={memoizedHandleMouseEvent}>\r\n\t<LeafletTooltip className={classes.mapTooltip} direction={settings.tooltipDirection || 'bottom'} permanent={settings.tooltipPermanent || true} offset={[0,offset]}>\r\n\t\t{device.name}\r\n\t</LeafletTooltip>\r\n</LeafletMarker>\r\n\r\n\t);\r\n}","import React from 'react'\r\n\r\nimport StateList from './StateList'\r\n\r\n\r\nexport default function StateListHorizontal(props) {\r\n\treturn (<StateList horizontal={true} {...props} />);\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport Connection from '../Connection'\r\nimport i18n from '../i18n'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tpaper: {\r\n\t\twidth: 100,\r\n\t\theight: 160,\r\n\t\tpadding: 5,\r\n\t\ttextAlign: 'center',\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Weather(props) {\r\n\tconst { settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [data,setData] = useState(null);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tConnection.getConnection.getRemoteResource(settings.url).then(\r\n\t\t\tresponse => {\r\n\t\t\t\t\r\n\t\t\t\tif (response.statusCode === 200) {\r\n\t\t\t\t\tsetData(JSON.parse(response.body));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror => console.error(error)\r\n\t\t);\r\n\t\t\r\n\t}, [settings.url]);\r\n\t\r\n\tlet weatherForecast = [];\r\n\t//console.log(data);\r\n\t\r\n\tif (!data) {\r\n\t\treturn null;\r\n\t}\r\n\telse {\r\n\t\tfor (let day in data.day) {\r\n\t\t\tlet forecast = data.day[day];\r\n\t\t\tforecast.title = day === 1 ? i18n.t('today') : (day === 2 ? i18n.t('tomorrow') : forecast.name);\r\n\t\t\t\r\n\t\t\tconst dailyForecast = (\r\n\r\n<Grid key={'day-' + day} item>\r\n\t<Paper className={classes.paper}>\r\n\t\t<Typography variant=\"body1\">\r\n\t\t\t{forecast.title}\r\n\t\t</Typography>\r\n\t\t<Typography variant=\"caption\">\r\n\t\t\t{forecast.date}\r\n\t\t</Typography>\r\n\r\n\r\n\t</Paper>\r\n</Grid>\r\n\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tweatherForecast.push(dailyForecast);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container justify=\"space-between\" spacing={1}>\r\n\t{weatherForecast}\r\n\t\r\n</Grid>\r\n\r\n\t);\r\n}\r\n\r\nexport const Settings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Weather'),\r\n\ticon: 'weather-partly-cloudy'\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\n//import IconButton from '@material-ui/core/IconButton'\r\nimport Fab from '@material-ui/core/Fab'\r\nimport PlayIcon from '@material-ui/icons/PlayArrow'\r\nimport PauseIcon from '@material-ui/icons/Pause'\r\nimport StopIcon from '@material-ui/icons/Stop'\r\nimport SkipPreviousIcon from '@material-ui/icons/SkipPrevious'\r\nimport SkipNextIcon from '@material-ui/icons/SkipNext'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdivider: {\r\n\t\tmargin: '15px -16px'\r\n\t},\r\n\tcontainer: {\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t},\r\n\tnoHeader: {\r\n\t\tmarginTop: theme.spacing(-4),\r\n\t},\r\n\timage: {\r\n\t\theight: '200px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'flex-end',\r\n\t\tbackgroundPosition: 'center',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tnoImage: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tdisplay: 'flex',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tinformation: {\r\n\t\tbackgroundColor: theme.palette.primary.main + '66',\r\n\t\tcolor: '#fff',\r\n\t\tpadding: '10px',\r\n\t\tmargin: 0,\r\n\t\twidth: '100%',\r\n\t\tminHeight: '45px'\r\n\t},\r\n\tinformationLeft: {\r\n\t\twidth: '80%',\r\n\t\tfloat: 'left',\r\n\t\tmargin: 0\r\n\t},\r\n\tinformationRight: {\r\n\t\twidth: '19%',\r\n\t\tfloat: 'right',\r\n\t\tmargin: 0,\r\n\t\ttextAlign: 'right'\r\n\t},\r\n\tlength: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\twidth: '100%',\r\n\t\theight: '7px',\r\n\t},\r\n\tlengthBar: {\r\n\t\tbackgroundColor: theme.palette.secondary.main,\r\n\t\theight: '100%',\r\n\t},\r\n\tcontrols: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'stretch'\r\n\t},\r\n\tcontrolsBox: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t\talignItems: 'center',\r\n\t\tpaddingTop: '30px'\r\n\t},\r\n\tcontrolsBoxLeft: {\r\n\t\tflex: 1,\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'baseline'\r\n\t},\r\n\tcontrolsBoxCenter: {\r\n\t\tflex: 3\r\n\t},\r\n\tcontrolsBoxRight: {\r\n\t\tflex: 1,\r\n\t\tjustifyContent: 'end'\r\n\t},\r\n\tcontrolButton: {\r\n\t\tmargin: '0 5px'\r\n\t},\r\n\tcontrolButtonSmall: {\r\n\t\tmargin: '0 10px',\r\n\t\tfontSize: '1.2rem',\r\n\t\theight: '32px',\r\n\t\twidth: '32px'\r\n\t}\r\n});\r\n\r\n\r\nclass Multimedia extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// get initial states\r\n\t\tfor (let stateKey in this.props.device.states) {\r\n\t\t\tthis.props.device.requestDeviceState(stateKey, true).catch(err => console.error(err));\r\n\t\t}\r\n\t\t\r\n\t\t// receive updates\r\n\t\tthis.props.device.on('stateChange', (stateKey, state) => {\r\n\t\t\t\r\n\t\t\t// duration\r\n\t\t\tif (stateKey === 'duration' && state && state.val.indexOf(':') === -1) {\r\n\t\t\t\tstate.val = helpers.timeToHoursMinutesSeconds(state.val);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// isRunning\r\n\t\t\tif (stateKey === 'isRunning' && state && typeof state.val === 'string') {\r\n\t\t\t\tstate.val = state.val.indexOf('play') > -1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.setState({ [stateKey]: state }, () => {\r\n\t\t\t\tthis.progress();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\tprogress() {\r\n\t\tclearTimeout(this.progressTimeout);\r\n\t\t\r\n\t\tif (this.state.isRunning && this.state.isRunning.val === true && this.state.progress && this.state.progress.val && this.state.duration && this.state.duration.val) {\r\n\t\t\tthis.progressTimeout = setTimeout(() => {\r\n\t\t\t\tthis.setState(prevState => ({ progress: { ...prevState.progress, val: helpers.timeToSeconds(prevState.progress.val) + 1 }}), () => this.progress());\r\n\t\t\t}, 1000);\r\n\t\t}\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\tsetDeviceState(stateKey, value) {\r\n\t\tthis.props.device.setDeviceState(stateKey, value).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, noHeader, index, device } = this.props;\r\n\t\tlet styleImage = {}, styleLength = {}, styleLengthBar = {};\r\n\t\t\r\n\t\t// background\r\n\t\tif (this.state.background && this.state.background.val !== '') {\r\n\t\t\tstyleImage.backgroundImage = 'url(' + ((device.options.backgroundUrlPrepend || '') + this.state.background.val) + ')';\r\n\t\t}\r\n\t\t\r\n\t\t// duration\r\n\t\tif (this.state.duration && this.state.duration.val) {\r\n\t\t\tstyleLengthBar.width = ((this.state.progress && this.state.progress.val) || 0) + 'px';\r\n\t\t}\r\n\t\t\r\n\t\tconst playIconElements = this.state.isRunning && this.state.isRunning.val ? [<PauseIcon onClick={this.setDeviceState.bind(this, 'pause', true)} />, <StopIcon />] : [<PlayIcon onClick={this.setDeviceState.bind(this, 'play', true)} />];\r\n\t\t//const repeatIcon = 'repeat'; // repeat, repeat-off, repeat-once\r\n\t\t//const shuffleIcon = 'shuffle-variant'; // shuffle-variant, shuffle-disabled\r\n\t\t//const volumeIcon = 'volume-high'; // volume-variant-off\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{index > 0 && <Divider className={classes.divider} />}\r\n\t<div className={clsx(classes.container, noHeader && classes.noHeader)}>\r\n\t\t\r\n\t\t<div className={clsx(this.state.background && this.state.background.val !== '' ? classes.image : classes.noImage)} style={ styleImage } onClick={this.openDialog.bind(this)}>\r\n\t\t\t\r\n\t\t\t<div className={classes.information}>\r\n\t\t\t\t<p className={classes.informationLeft}>\r\n\t\t\t\t\t{this.state.grandParent && this.state.grandParent.val && [this.state.grandParent.val, <br key={'br-' + device.id} />]}\r\n\t\t\t\t\t{this.state.parent && this.state.parent.val && this.state.parent.val + ' - '}{this.state.title && this.state.title.val}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p className={classes.informationRight}>\r\n\t\t\t\t\t{this.state.progress && helpers.timeToHoursMinutesSeconds(this.state.progress.val)} / {this.state.duration && this.state.duration.val}\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div className={classes.length} style={ styleLength }>\r\n\t\t\t<div className={classes.lengthBar} style={ styleLengthBar }></div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div className={classes.controls}>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxLeft)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + repeatIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + shuffleIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxCenter)}>\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipPreviousIcon onClick={this.setDeviceState.bind(this, 'previous', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t\t{playIconElements.map((icon, i) => \r\n\t\t\t\t<Fab key={'icon-' + i} className={classes.controlButton} size=\"large\" color=\"primary\">\r\n\t\t\t\t\t{icon}\r\n\t\t\t\t</Fab>\r\n\t\t\t\t)}\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipNextIcon onClick={this.setDeviceState.bind(this, 'next', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxRight)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + volumeIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t</div>\r\n\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Multimedia);\r\n","import React from 'react'\r\n\r\nimport MultimediaItem from './MultimediaItem'\r\n\r\n\r\nexport default function StateList(props) {\r\n\tconst { devices, settings } = props;\r\n\treturn devices.map((device, i) => <MultimediaItem key={'MultimediaItem-' + device.id} {...props} index={i} noHeader={i === 0 && settings.icon === null && settings.title === null} device={device} />)\r\n}\r\n","var map = {\n\t\"./de.js\": 328,\n\t\"./en.js\": 329\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 327;","export default {\r\n\t/*\r\n\t * LOADING SCREEN\r\n\t */\r\n\t\"Retrieving settings\": \"Einstellungen werden geladen\",\r\n\t\r\n\t/*\r\n\t * GENERAL\r\n\t */\r\n\t\"last update\": \"letzte Aktualisierung\",\r\n\t\"Updates available\": \"Aktualisierung verfügbar\",\r\n\t\r\n\t/*\r\n\t * STATES\r\n\t */\r\n\t\"on\": \"an\",\r\n\t\"off\": \"aus\",\r\n\t\r\n\t\"user\": \"User\",\r\n\t\"users\": \"Users\",\r\n\t\r\n\t\"door\": \"Tür\",\r\n\t\"window\": \"Fenster\",\r\n\t\r\n\t\"open\": \"offen\",\r\n\t\"closed\": \"geschlossen\",\r\n\t\r\n\t\"turn on\": \"anschalten\",\r\n\t\"power\": \"Geräte Status\",\r\n\t\"trigger\": \"Geräte Status\",\r\n\t\r\n\t\"brightness\": \"Helligkeit\",\r\n\t\"wind\": \"Wind\",\r\n\t\"battery\": \"Batterie\",\r\n\t\r\n\t\"%DateTime\": \"%DateTime Uhr\",\r\n\t\"boost\": \"Boost\",\r\n\t\r\n\t/*\r\n\t * BLINDS\r\n\t */\r\n\t\"blind#level\": \"Behanghöhe\",\r\n\t\"blind#level2\": \"Lamellenposition\",\r\n\t\r\n\t\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"light#power\": \"Licht\",\r\n\t\"light#level\": \"Helligkeit\",\r\n\t\"colorTemperature\": \"Farbtemperatur\",\r\n\t\"hue\": \"Farbe\",\r\n\t\"light#rgb\": \"Farbraum Rot-Grün-Blau (RGB)\",\r\n\t\"hex\": \"Farbe\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HEATING\r\n\t */\r\n\t\"temperature\": \"Temperatur\",\r\n\t\"humidity\": \"Luftfeuchtigkeit\",\r\n\t\"setTemperature\": \"eingestellte Temperatur\",\r\n\t\r\n\t\r\n\t/*\r\n\t * DOOR\r\n\t */\r\n\t\"bell\": \"Klingel\",\r\n\t\"lock\": \"Schloß\",\r\n\t\"presence\": \"Präsenz\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HOUSEHOLD\r\n\t */\r\n\t\"running\": \"Gerät läuft\",\r\n\t\"consumption\": \"Verbrauch\"\r\n}","export default {\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"level\": \"Brightness\",\r\n\t\"colorTemperature\": \"Color Temperature\",\r\n\t\"hue\": \"Color\",\r\n\t\"color\": \"Color\",\r\n\t\"hex\": \"Color\",\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction HeatingSetTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={0} max={35} {...props} />\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\ttemperature: {\r\n\t\t\tvalue: (val) => val.toFixed(1),\r\n\t\t\tunit: ' °C'\r\n\t\t},\r\n\t\tsetTemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer-chevron-up'\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tboost: {\r\n\t\t\ticon: 'radiator'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tsetTemperature: HeatingSetTemperatureComponent\r\n\t},\r\n\tactions: {\r\n\t\tboost: defaults.actions.PowerAction\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport Slider from '@material-ui/core/Slider'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport Button from '@material-ui/core/Button'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tprimaryAction: props => ({\r\n\t\t...props.styles\r\n\t}),\r\n\tsecondaryAction: props => ({\r\n\t\tcolor: '#999',\r\n\t\tfontSize: '14px',\r\n\t\t...props.styles\r\n\t}),\r\n});\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\tcomponent: {\r\n\t\tpadding: theme.spacing(2, 8, 2, 2)\r\n\t},\r\n\tsliderMarkLabel: {\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tdisplay: 'none',\r\n\t\t\t'&:nth-child(5)': { display: 'block' },\r\n\t\t\t'&:nth-child(15)': { display: 'block' },\r\n\t\t\t'&:nth-child(25)': { display: 'block' }\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nconst Action = withStyles(styles)(props => {\r\n\tconst { classes, device, state, stateKey } = props;\r\n\treturn (\r\n\r\n<span className={clsx((stateKey === device.primaryStateKey && classes.primaryAction) || (stateKey === device.secondaryStateKey && classes.secondaryAction))}>\r\n\t{state && state.value} {state && state.unit}\r\n</span>\r\n\r\n\t);\r\n});\r\n\r\nfunction PowerAction(props) {\r\n\tconst { device, stateKey, stateVal, onChange: parentOnChange } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal);\r\n\tuseEffect(() => setChecked(stateVal), [stateVal]);\r\n\t\r\n\treturn (\r\n\r\n<Switch\r\n\tchecked={checked}\r\n\tonChange={parentOnChange || onChange}\r\n\tvalue={checked !== true}\r\n\tcolor=\"primary\"\r\n\t/>\r\n\r\n\t);\r\n}\r\n\r\nfunction TriggerAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onClick = () => {\r\n\t\tdevice.setDeviceState(stateKey, true).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\t//\r\n\tif (stateVal === true || stateVal > 0) {\r\n\t\treturn <Action {...props} onChange={null} />;\r\n\t}\r\n\t\r\n\tconst icon = 'power';\r\n\treturn (\r\n\r\n<Button\r\n\tvariant=\"outlined\"\r\n\tcolor=\"primary\"\r\n\tsize=\"small\"\r\n\tstartIcon={<span className={'mdi mdi-' + icon}></span>}\r\n\tonClick={onClick}\r\n\t>\r\n\t\r\n\t{i18n.t('turn on')}\r\n</Button>\r\n\r\n\t);\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction Label(props) {\r\n\tconst { label, br } = props;\r\n\tconst linebreak = br || false;\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t{label}\r\n\t{linebreak && <br />}\r\n</React.Fragment>\r\n\t\r\n\t);\r\n}\r\n\r\nfunction Component(props) {\r\n\tconst { title, children } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Label label={title} />\r\n\t<div className={classes.component}>\r\n\t\t{children}\r\n\t\r\n\t</div>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\nfunction LevelComponent(props) {\r\n\tlet { device, stateKey, stateVal, title, min, max, step, markSteps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onChange = (e, val) => {\r\n\t\tsetLevel(val);\r\n\t\tdevice.setDeviceState(stateKey, val).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [level, setLevel] = useState(stateVal);\r\n\tuseEffect(() => setLevel(stateVal), [stateVal]);\r\n\t\r\n\t// default settings\r\n\tmin = min || 0;\r\n\tmax = max || 100;\r\n\tstep = step || 1;\r\n\tmarkSteps = markSteps || 11; // 0 to 10\r\n\tlet markStep = ((max-min)/(markSteps-1)) || 10;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<Slider\r\n\t\tclasses={{ markLabel: classes.sliderMarkLabel }}\r\n\t\t//onChange\r\n\t\tonChangeCommitted={onChange}\r\n\t\tdefaultValue={level}\r\n\t\tvalueLabelDisplay=\"auto\"\r\n\t\tmarks={[...Array(markSteps).keys()].map(number => ({ 'value': min+number*markStep, 'label': min+number*markStep }))}\r\n\t\tmin={min}\r\n\t\tmax={max}\r\n\t\tstep={step}\r\n\t/>\r\n\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\t_any: {\r\n\t\t\tvalue: (val) => val.toString(),\r\n\t\t\t//unit\r\n\t\t\t//icon\r\n\t\t\t//state\r\n\t\t},\r\n\t\tbattery: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'battery-medium'\r\n\t\t},\r\n\t\tdoor: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'water-percent'\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tpower: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\ttemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer'\r\n\t\t},\r\n\t\ttrigger: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\twind: {\r\n\t\t\tunit: ' km/h',\r\n\t\t\ticon: 'weather-windy'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tLabel,\r\n\t\tComponent,\r\n\t\tLevelComponent,\r\n\t\t\r\n\t\tlevel: LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tAction,\r\n\t\tPowerAction,\r\n\t\tTriggerAction,\r\n\t\t\r\n\t\tpower: PowerAction,\r\n\t\ttrigger: TriggerAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\ttrue: {\r\n\t\t\t\t\t'color': '#090',\r\n\t\t\t\t\t'fontWeight': 'bold'\r\n\t\t\t\t},\r\n\t\t\t\tfalse: {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'home'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'account'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'window-open-variant',\r\n\t\t\t\t'false': 'window-closed-variant'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tgridContainer: {\r\n\t\tpaddingLeft: theme.spacing(1),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(0.4)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function GridContainer(props) {\r\n\tconst { contents = {} } = props;\r\n\t\r\n\tconst classes = useStyles();\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tlet grid = [];\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\t\r\n\t\tif (!contents[column]) {\r\n\t\t\tconsole.warn('No content for column #' + column + '!');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t\r\n\t\tgrid.push(\r\n\t\t\t<Grid key={column} item\t\t\t\t// @see https://material-ui.com/customization/breakpoints/\r\n\t\t\t\txs={12}\t\t\t\t\t\t\t//    0 -  600px\r\n\t\t\t\tsm={6}\t\t\t\t\t\t\t//  600 -  960px\r\n\t\t\t\tmd={6}\t\t\t\t\t\t\t//  960 - 1280px\r\n\t\t\t\tlg={Math.round(12/columns)}\t\t// 1280 - 1920px\r\n\t\t\t\txl={Math.round(12/columns)}\t\t// \t\t> 1920px\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{contents[column]}\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container spacing={0} className={classes.gridContainer}>\r\n\t{grid}\r\n</Grid>\r\n\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport WarningIcon from '@material-ui/icons/Warning';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { amber, green } from '@material-ui/core/colors';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tsuccess: {\r\n\t\tbackgroundColor: green[600],\r\n\t},\r\n\terror: {\r\n\t\tbackgroundColor: theme.palette.error.dark,\r\n\t},\r\n\tinfo: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t},\r\n\twarning: {\r\n\t\tbackgroundColor: amber[700],\r\n\t},\r\n\ticon: {\r\n\t\tfontSize: 20,\r\n\t},\r\n\ticonVariant: {\r\n\t\topacity: 0.9,\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tmessage: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t},\r\n}));\r\n\r\n\r\nconst variantIcon = {\r\n\tsuccess: CheckCircleIcon,\r\n\twarning: WarningIcon,\r\n\terror: ErrorIcon,\r\n\tinfo: InfoIcon,\r\n};\r\n\r\n\r\nexport default function StatusSnackbar(props) {\r\n\tconst classes = useStyles();\r\n\tlet { className, open, autoHideDuration, message, closeButton, onClose, variant, ...other } = props;\r\n\tconst Icon = variantIcon[variant];\r\n\t\r\n\topen = open || true;\r\n\tautoHideDuration = autoHideDuration || null;\r\n\treturn (\r\n\r\n<Snackbar\r\n\tanchorOrigin={{\r\n\t\tvertical: 'bottom',\r\n\t\thorizontal: 'center',\r\n\t}}\r\n\topen={open}\r\n\tautoHideDuration={autoHideDuration}\r\n\tonClose={onClose}\r\n\t>\r\n\t<SnackbarContent\r\n\t\tclassName={clsx(classes[variant], className)}\r\n\t\tmessage={\r\n\t\t\t<span id=\"client-snackbar\" className={classes.message}>\r\n\t\t\t\t<Icon className={clsx(classes.icon, classes.iconVariant)} />\r\n\t\t\t\t{message}\r\n\t\t\t</span>\r\n\t\t}\r\n\t\taction={closeButton && [\r\n\t\t\t<IconButton key=\"close\" aria-label=\"close\" color=\"inherit\" onClick={onClose}>\r\n\t\t\t\t<CloseIcon className={classes.icon} />\r\n\t\t\t</IconButton>,\r\n\t\t]}\r\n\t\t{...other}\r\n\t\t/>\r\n\t\t\r\n</Snackbar>\r\n\r\n\t);\r\n}","export default {\r\n\t\"iobrokerWebAdapterUrl\": \"https://192.168.178.29:8082\"\r\n}","\r\nexport default {\r\n\tdefaults: require('./defaults').default,\r\n\t\r\n\tblind: require('./blind').default,\r\n\tdoor: require('./door').default,\r\n\theating: require('./heating').default,\r\n\tjalousie: require('./blind').default,\r\n\tlight: require('./light').default,\r\n\tlocation: require('./location').default,\r\n\tuser: require('./user').default,\r\n\twindow: require('./window').default\r\n}","import EventEmitter from 'events'\r\nimport functions from './functions'\r\n\r\n\r\n/**\r\n * Function\r\n *\r\n * @param\t{String}\t\tfunctionType\r\n * @return\t{Function}\r\n *\r\n */\r\nexport default class Function extends EventEmitter {\r\n\t\r\n\tconstructor(functionType) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.function = functionType;\r\n\t\t\r\n\t\tif (!this.function) {\t\r\n\t\t\tthrow new Error('No function given!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.functionId = this.function.toLowerCase();\r\n\t\t\r\n\t\t// configuration\r\n\t\tthis.defaults = functions['defaults'].configurations;\r\n\t\tthis.configurations = (functions[this.functionId] && functions[this.functionId].configurations) || {};\r\n\t\t\r\n\t\t// styles\r\n\t\tthis.defaultStyles = functions['defaults'].styles;\r\n\t\tthis.styles = (functions[this.functionId] && functions[this.functionId].styles) || {};\r\n\t\t\r\n\t\t// components and actions\r\n\t\tthis.components = { ...functions['defaults'].components, ...(functions[this.functionId] && functions[this.functionId].components) || {} };\r\n\t\tthis.actions = { ...functions['defaults'].actions, ...(functions[this.functionId] && functions[this.functionId].actions) || {} };\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Mixed}\r\n\t * @private\r\n\t */\r\n\t_applyFunction(key, val) {\r\n\t\treturn this._isFunction(key) ? key(val) : val;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{String}\r\n\t * @private\r\n\t */\r\n\t_getValueFromSettings(settings, defaults = '') {\r\n\t\t\r\n\t\tfor (let key in settings) {\r\n\t\t\tif (settings[key] !== undefined) {\r\n\t\t\t\treturn settings[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn defaults;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isFunction(key) {\r\n\t\treturn key && typeof key === 'function';\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isValue(val) {\r\n\t\treturn val !== undefined; // || val === null || val === false; // null is considered a value, so it can be used to actually null the output\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_setObjectStructure(obj, defaultValue = undefined) {\r\n\t\t\r\n\t\tif (!obj || typeof obj != 'object') {\r\n\t\t\tobj = { 'default': obj || defaultValue };\r\n\t\t}\r\n\t\telse if (typeof obj == 'object' && !obj.default) {\r\n\t\t\tobj.default = defaultValue;\r\n\t\t}\r\n\t\t\r\n\t\treturn obj;\r\n\t}\r\n}\r\n","export default {\r\n\t\"hm-rpc\": \"HomeMatic\",\r\n}","import React from 'react'\r\nimport i18n from './i18n'\r\nimport Function from './Function'\r\nimport Adapters from './Adapters'\r\n\r\nimport { formatDistanceToNow } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\n\r\n\r\n/**\r\n * Device\r\n *\r\n * @param\t{Object}\tdeviceProperties\r\n * @param\t{String}\tdeviceProperties.id\r\n * @param\t{String}\tdeviceProperties.name\r\n * @param\t{String}\t[deviceProperties.room=null]\r\n * @param\t{String}\tdeviceProperties.function\r\n * @param\t{Object}\tdeviceProperties.states\r\n * @param\t{Object}\t[deviceProperties.attributes={}]\r\n * @param\t{Object}\tdeviceProperties.options\r\n * @param\t{Object}\tsocket\r\n * @return\t{Device}\r\n *\r\n */\r\nexport default class Device extends Function {\r\n\t\r\n\tconstructor(deviceProperties, socket, language = window.sysLang || 'en') {\r\n\t\ttry {\r\n\t\t\tsuper(deviceProperties.function);\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthrow new Error('No function given for device ' + deviceProperties.name + '!');\r\n\t\t}\r\n\t\t\r\n\t\t// initialise class data\r\n\t\tthis.id = deviceProperties.id;\r\n\t\tthis.name = deviceProperties.name;\r\n\t\t\r\n\t\tthis.room = deviceProperties.room || null;\r\n\t\t\r\n\t\tthis.states = deviceProperties.states;\r\n\t\tthis.options = deviceProperties.options;\r\n\t\tthis.attributes = deviceProperties.attributes || {};\r\n\t\t\r\n\t\tthis.socket = socket;\r\n\t\t\r\n\t\t// verify data\r\n\t\tif (!this.options || typeof this.options !== 'object' || Object.keys(this.options).length === 0) {\r\n\t\t\tthrow new Error('Device' + (deviceProperties.id || deviceProperties.name ? ' ' + (deviceProperties.name || deviceProperties.id) : '') + ' not defined for jarvis!');\r\n\t\t}\r\n\t\telse if (!this.states || typeof this.states !== 'object' || Object.keys(this.states).length === 0) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no states defined)!');\r\n\t\t}\r\n\t\telse if (!this.id || !this.name || !this.function) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no id, name or function defined)!');\r\n\t\t}\r\n\t\telse if (!this.socket) {\t\r\n\t\t\tthrow new Error('No socket given!');\r\n\t\t}\r\n\t\t\r\n\t\t// hierarchy\r\n\t\tthis.children = deviceProperties.children || [];\r\n\t\tthis.parent = deviceProperties.parent || null;\r\n\t\t\r\n\t\t// do some stuff\r\n\t\tthis._setProperties();\r\n\t\tthis.stateSubscriptions = [];\r\n\t\t\r\n\t\t// listen for errors of the device\r\n\t\tthis.on('error', err => console.error('Device error occured!', err));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object|String}\r\n\t * @private\r\n\t */\r\n\t_getStateFromKey(stateKey = null, stateType = 'state') {\r\n\t\t\r\n\t\t// already a state object\r\n\t\tif (stateKey && typeof stateKey === 'object') {\r\n\t\t\treturn stateKey;\r\n\t\t}\r\n\t\t\r\n\t\t// get state object\r\n\t\tlet s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\t// state not an object so far\r\n\t\tif (typeof s === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey] = { [stateType]: { 'node': s }};\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\telse if (typeof s[stateType] === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey][stateType] = { 'node': s[stateType] };\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\t\r\n\t\t// state not valid\r\n\t\tif (!s || !s[stateType]) {\r\n\t\t\treturn 'Incorrect or non-defined state key for device ' + this.name + '!';\r\n\t\t}\r\n\t\telse if (typeof s[stateType] == 'object' && !s[stateType].node) {\r\n\t\t\treturn 'No ' + stateType + ' specified for device ' + this.name + '!';\r\n\t\t}\r\n\t\t\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getConfigurationSetting(config, stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this[config][stateKey]) {\r\n\t\t\t\r\n\t\t\t// 1. if stateKey (e.g. level, power) is available, try to replace an attribute (e.g. icon, unit or for styles state, icon) based on current state (e.g. true, false)\r\n\t\t\tif (typeof this[config][stateKey][attribute] === 'object') {\r\n\t\t\t\t\r\n\t\t\t\tconst stateValKeys = Object.keys(this[config][stateKey][attribute]);\r\n\t\t\t\tif (stateValKeys.toString().indexOf('<') > -1 || stateValKeys.toString().indexOf('>') > -1 || stateValKeys.toString().indexOf('!=') > -1) { // !=, >, >=, <, <=\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet val = this[config][stateKey][attribute]['default'];\r\n\t\t\t\t\tstateValKeys.forEach(stateValKey => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet stateValValue = stateValKey.replace('<=', '').replace('<', '').replace('>=', '').replace('>', '').replace('!=', '');\r\n\t\t\t\t\t\tif (stateValKey.indexOf('<=') > -1 && stateVal <= stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKey.indexOf('<') > -1 && stateVal < stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKey.indexOf('>=') > -1 && stateVal >= stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKey.indexOf('>') > -1 && stateVal > stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKeys.toString().indexOf('!=') > -1 && stateVal != stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn val;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn super._isValue(this[config][stateKey][attribute][stateVal]) ? this[config][stateKey][attribute][stateVal] : this[config][stateKey][attribute]['default'];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 2. if #1 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config][stateKey][attribute])) {\r\n\t\t\t\treturn this[config][stateKey][attribute](stateVal);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 3. fallback to stateKey with attribute, if defined but neither an object (thus stateless) nor a function\r\n\t\t\telse if (typeof this[config][stateKey][attribute] === 'string') {\r\n\t\t\t\treturn this[config][stateKey][attribute];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (this[config]['_any']) {\r\n\t\t\t\r\n\t\t\t// 4. fallback to _any if no stateKey (e.g. level, power) is given, but consider attribute to be stateful (e.g. true, false)\r\n\t\t\tif (typeof this[config]['_any'][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config]['_any'][attribute][stateVal]) ? this[config]['_any'][attribute][stateVal] : this[config]['_any'][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 5. if #4 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config]['_any'][attribute])) {\r\n\t\t\t\treturn this[config]['_any'][attribute](stateVal);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// nothing, return undefined (not null, because this would mean take an empty value)\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getUserSetting(stateKey, attribute, stateVal, styles = false) {\r\n\t\t\r\n\t\tlet options = this.options;\r\n\t\t\r\n\t\tif (styles) {\r\n\t\t\toptions = this.options['styles'];\r\n\t\t\tlet tmp = attribute;\r\n\t\t\tattribute = stateKey;\r\n\t\t\tstateKey = tmp;\r\n\t\t}\r\n\t\t\r\n\t\tif (options[attribute] && options[attribute][stateKey]) {\r\n\t\t\tif (typeof options[attribute][stateKey] === 'object') {\r\n\t\t\t\treturn super._isValue(options[attribute][stateKey][stateVal]) ? options[attribute][stateKey][stateVal] : options[attribute][stateKey]['default'];\r\n\t\t\t}\r\n\t\t\telse if (super._isFunction(options[attribute][stateKey])) {\r\n\t\t\t\treturn options[attribute][stateKey](stateVal);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn options[attribute][stateKey];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return void\r\n\t * @private\r\n\t *\r\n\t */\r\n\t_setProperties() {\r\n\t\t\r\n\t\tlet states = Object.keys(this.states);\r\n\t\t\r\n\t\t// delete ignored states\r\n\t\tif (this.options.ignoredStates) {\r\n\t\t\tthis.options.ignoredStates = Array.isArray(this.options.ignoredStates) ? this.options.ignoredStates : [this.options.ignoredStates];\r\n\t\t\t\r\n\t\t\tthis.options.ignoredStates.forEach(ignoredState => {\r\n\t\t\t\tif (this.states[ignoredState]) {\r\n\t\t\t\t\tdelete this.states[ignoredState];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get hidden states\r\n\t\tthis.options.hiddenStates = [];\r\n\t\tif (this.options.hideStates) {\r\n\t\t\tthis.options.hideStates = Array.isArray(this.options.hideStates) ? this.options.hideStates : [this.options.hideStates];\r\n\t\t\t\r\n\t\t\tthis.options.hideStates.forEach(hideState => {\r\n\t\t\t\tif (this.states[hideState]) {\r\n\t\t\t\t\tthis.options.hiddenStates.push(hideState);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// properties\r\n\t\tthis.primaryStateKey = this.options.primary || states[0];\r\n\t\tthis.secondaryStateKey = this.options.secondary || null;\r\n\t\t\r\n\t\t// bring user settings for value, state, unit, icon and styles in structure\r\n\t\t['value', 'state', 'unit', 'icon', 'styles'].forEach(key => {\r\n\t\t\t\r\n\t\t\tlet stateOrAttribute = this.options[key] && Object.keys(this.options[key])[0];\r\n\t\t\tthis.options[key] = !this.options[key] ? {} : super._setObjectStructure(stateOrAttribute && states.indexOf(stateOrAttribute) > -1 ? this.options[key] : { [this.primaryStateKey]: this.options[key] });\r\n\t\t});\r\n\t\t\r\n\t\t// manufacturer\r\n\t\tthis.states[this.primaryStateKey] = this._getStateFromKey(this.primaryStateKey);\r\n\t\tthis.options.manufacturer = (this.primaryStateKey && Adapters[this.states[this.primaryStateKey].state.node.substr(0, this.states[this.primaryStateKey].state.node.indexOf('.'))]) || 'unknown';\r\n\t\t\r\n\t\t// all options\r\n\t\tthis.options.groups = Array.isArray(this.options.group) ? this.options.group : [this.options.group];\r\n\t\tthis.options.sort = this.options.sort || 999;\r\n\t\t\r\n\t\tthis.options.label = (this.options.label && (typeof this.options.label === 'string' && this.options.label.replace(/%name%/g, this.name))) || this.options.label || this.name;\r\n\t\t//this.options.subtitle = this.options.subtitle;\r\n\t\tthis.options.divider = this.options.divider || false;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_updateDeviceState(stateKey, state) {\r\n\t\t\r\n\t\t// add time changed\r\n\t\tstate.timeChanged = formatDistanceToNow(new Date(state.lc-5*1000), { locale: de, includeSeconds: true, addSuffix: true })\r\n\t\t\r\n\t\t// add unit\r\n\t\tstate.unit = '';\r\n\t\t\r\n\t\t// assign value\r\n\t\tstate.value = state.val;\r\n\t\t\r\n\t\t// mapping of value to state values\r\n\t\t[{ 'value': 'value' }, { 'state': 'value' }, { 'unit': 'unit' }].forEach(pair => {\r\n\t\t\tlet attribute = Object.keys(pair).toString();\r\n\t\t\tlet option = Object.values(pair).toString();\r\n\t\t\tlet settings = {};\r\n\t\t\t\r\n\t\t\t// get user setting\r\n\t\t\tsettings['options'] = this._getUserSetting(stateKey, attribute, state.value);\r\n\t\t\t\r\n\t\t\t// get function setting or fallback to defaults\r\n\t\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, state.value);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tstate[option] = super._getValueFromSettings(settings, state[option]);\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\tstate.value = i18n.t(state.value);\r\n\t\treturn state;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tget(property) {\r\n\t\treturn this[property] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetAction(stateKey = null, forceDefault = false) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state ? state.val : null;\r\n\t\t\r\n\t\tconst Action = (!forceDefault && this.actions[stateKey]) || this.actions.Action;\r\n\t\treturn <Action key={'action-' + this.id + '-' + stateKey} device={this} state={state} stateKey={stateKey} stateVal={stateVal} styles={this.getStyle('state', stateKey, stateVal)} />\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetComponent(stateKey) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state ? state.val : null;\r\n\t\t\r\n\t\tconst Component = this.components[stateKey];\r\n\t\treturn (Component && <Component title={this.states[stateKey].label || i18n.t(this.function + '#' + stateKey)} device={this} stateKey={stateKey} stateVal={stateVal} />) || this.states[stateKey].label || i18n.t(this.function + '#' + stateKey);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateProperty=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetDeviceState(stateKey = null, stateProperty = null) {\r\n\t\tconst s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tlet deviceState = null;\r\n\t\t\r\n\t\tif (s && s.state && stateProperty !== null && s.state.value !== undefined && s.state.value[stateProperty] !== undefined) {\r\n\t\t\tdeviceState = s.state.value[stateProperty];\r\n\t\t}\r\n\t\telse if (s && s.state && stateProperty === null && s.state.value !== undefined) {\r\n\t\t\tdeviceState = s.state.value;\r\n\t\t}\r\n\t\t\r\n\t\treturn deviceState;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get an icon based on the current device state (or falls back to a default).\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateVal=default]\r\n\t * @param\t{String}\t[defaultIcon=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetIcon(stateKey, stateVal = '', defaultIcon = '?') {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'icon', stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, 'icon', stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, defaultIcon);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetOption(option, stateVal = 'default') {\r\n\t\treturn (this.options[option] && (this.options[option][stateVal] || this.options[option]['default'])) || this.options[option] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetStyle(attribute, stateKey = null, stateVal = 'default') {\r\n\t\tlet settings = {};\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, attribute, stateVal, true);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['styles', 'defaultStyles'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, {});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests all state values from the backend.\r\n\t *\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Array<Promises>}\r\n\t *\r\n\t */\r\n\trequestDeviceStates(subscribe = false) {\r\n\t\t\r\n\t\tlet responses = [];\r\n\t\tfor (let stateKey in this.states) {\r\n\t\t\tresponses.push(this.requestDeviceState(stateKey, subscribe));\r\n\t\t}\r\n\t\t\r\n\t\treturn responses;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceState(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.value !== undefined && this.stateSubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getState(s.state.node)\r\n\t\t\t\t\t.then(state => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (state === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @return\t{Promise}\r\n\t * @see https://github.com/ioBroker/ioBroker.history#access-values-from-javascript-adapter\r\n\t *\r\n\t */\r\n\trequestDeviceStateHistory(stateKey = null, subscribe = false, options = {}) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\ts.state.historyCache = s.state.historyCache || {};\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (options.start && options.end && options.step && s.state.historyCache[options.start + '#' + options.end + '#' + options.step] !== undefined) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('historyChange', stateKey, s.state.historyCache[options.start + '#' + options.end + '#' + options.step], s.state);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getStateHistory(s.state.node, options)\r\n\t\t\t\t\t.then(history => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (history === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// cache result\r\n\t\t\t\t\t\tif (options.start && options.end && options.step) {\r\n\t\t\t\t\t\t\ts.state.historyCache[options.start + '#' + options.end + '#' + options.step] = history;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.history = history;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('historyChange', stateKey, s.state.history, s.state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetAction(action) {\r\n\t\tthis.options.action = action;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetComponent(component) {\r\n\t\tthis.options.label = component;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\tvalue\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsetDeviceState(stateKey = null, value) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey, 'action');\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.socket.setState(s.action.node, value)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\r\n\t\t\t\t\t// get state value if not subscribed\r\n\t\t\t\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\t\t\t\tthis.requestDeviceState(stateKey);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// resolve\r\n\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsubscribeDeviceState(stateKey = null) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\t// add subscription\t\r\n\t\tthis.stateSubscriptions.push(stateKey);\r\n\t\t\r\n\t\t// subscribe\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tthis.socket.subscribeState(s.state.node, (id, state, params) => {\r\n\t\t\t\t\r\n\t\t\t\tif (state && state.val !== this.getDeviceState(stateKey, 'val')) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// format value\r\n\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish state change\r\n\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish to children as well\r\n\t\t\t\t\tthis.children.forEach(child => child.emit('stateChange', stateKey, s.state.value));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t});\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/tooltip'\r\nimport Badge from '@material-ui/core/Badge'\r\nimport NotificationsIcon from '@material-ui/icons/Notifications'\r\nimport MenuIcon from '@material-ui/icons/Menu'\r\nimport SettingsIcon from '@material-ui/icons/Settings'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tappBar: {\r\n\t\tflexGrow: 1,\r\n\t\tboxShadow: 'none',\r\n\t\ttransform: 'none',\r\n\t},\r\n\ttoolbar: {\r\n\t\tbackgroundColor: theme.palette.primary.main\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2)\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingRight: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TopBar(props) {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { children, title, connectionStatus, toggleDrawer, navigate, notifications } = props;\r\n\tconst [ icon, label ] = title.indexOf('|') > -1 ? title.split('|') : [ null, title ];\r\n\t\r\n\tconst connectionStatusIcon = connectionStatus ? 'lan-connect' : (connectionStatus === 'pending' ? 'lan-pending' : 'lan-disconnect');\r\n\tconst connectionStatusTooltip = connectionStatus ? i18n.t('Connected to ioBroker') : (connectionStatus === 'pending' ? i18n.t('Not connected to ioBroker! Reconnecting..') : i18n.t('Not connected to ioBroker! Connection failed!'));\r\n\t\r\n\treturn (\r\n\r\n<AppBar id=\"appBar\" position=\"static\" className={classes.appBar}>\r\n\r\n\t<Toolbar className={classes.toolbar}>\r\n\t\t\r\n\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t{icon && <span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>}\r\n\t\t\t{label !== 'null' && label}\r\n\t\t</Typography>\r\n\t\t<IconButton color=\"inherit\">\r\n\t\t\t<Tooltip title={i18n.t(connectionStatusTooltip)}>\r\n\t\t\t\t<span className={\"mdi mdi-\" + connectionStatusIcon}></span>\r\n\t\t\t</Tooltip>\r\n\t\t</IconButton>\r\n\t\t\r\n\t\t{/*\r\n\t\t<IconButton color=\"inherit\" onClick={() => navigate('settings')}>\r\n\t\t\t<SettingsIcon />\r\n\t\t</IconButton>\r\n\t\t<IconButton color=\"inherit\" onClick={() => toggleDrawer('notificationDrawer', true)}>\r\n\t\t\t<Badge badgeContent={notifications} color=\"secondary\">\r\n\t\t\t\t<NotificationsIcon />\r\n\t\t\t</Badge>\r\n\t\t</IconButton>\r\n\t\t*/}\r\n\t\t\r\n\t</Toolbar>\r\n\t\r\n\t{children}\r\n</AppBar>\r\n\r\n\t);\r\n}\r\n","/*\r\n * by QoP <https://stackoverflow.com/users/4484822/qop>\r\n * @see https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\r\n */\r\nimport { useState, useEffect } from 'react';\r\n\r\nfunction getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\nexport default function useWindowDimensions() {\r\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      setWindowDimensions(getWindowDimensions());\r\n    }\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return windowDimensions;\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport useWindowDimensions from '../helpers/useWindowDimensions'\r\n\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Box from '@material-ui/core/Box'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingBottom: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t},\r\n\ttabs: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tpaddingLeft: theme.spacing(),\r\n\t\tcolor: '#fff',\r\n\t\twidth: 'calc(100% - ' + theme.spacing() + 'px)',\r\n\t\tzIndex: 101,\r\n\t\tborderBottom: '5px solid #eee'\r\n\t},\r\n\tfixed: {\r\n\t\tposition: 'fixed',\r\n\t\ttop: 0\r\n\t},\r\n\tindicator: {\r\n\t\tbackgroundColor: '#fff',\r\n\t},\r\n\tfullscreen: {\r\n\t\tmarginLeft: -theme.spacing(),\r\n\t\tmarginTop: '-5px',\r\n\t},\r\n\tgrid: {\r\n\t\tpaddingBottom: '30px'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TabBar(props) {\r\n\tlet { _settings, tabs, selectTab } = props;\r\n\tconst classes = useStyles();\r\n\tlet tabBarProps = useRef({});\r\n\t\r\n\t// tab\r\n\tconst [tab, setTab] = useState(0);\r\n\tconst handleChange = (event, selectedTab) => {\r\n\t\tselectTab(selectedTab, tabs[selectedTab]);\r\n\t\tsetTab(selectedTab);\r\n\t}\r\n\t\r\n\t// scroll\r\n\tconst [fixed, setFixed] = useState(false);\r\n\tconst handleScroll = useCallback(() => {\r\n\t\tconst threshold = (tabBarProps.current.top + tabBarProps.current.height - 53);\r\n\t\tconst fixed = window.scrollY >= threshold;\r\n\t\t\r\n\t\tsetFixed(prevFixed => {\r\n\t\t\tif (prevFixed !== fixed) {\r\n\t\t\t\tdocument.getElementById('root').style.paddingTop = fixed ? (threshold-5-8) + 'px' : 0;\r\n\t\t\t\treturn fixed;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevFixed;\r\n\t\t});\r\n\t\t\r\n\t}, [tabBarProps]);\r\n\r\n\tuseEffect(() => {\r\n\t\ttabBarProps.current = {\r\n\t\t\ttop: document.getElementById('tabBar').offsetTop,\r\n\t\t\theight: document.getElementById('tabBar').offsetHeight\r\n\t\t}\r\n\t\t\r\n\t\twindow.addEventListener('scroll', handleScroll);\r\n\t\treturn () => window.removeEventListener('keydown', handleScroll, 0);\r\n\t\t\r\n\t}, [handleScroll]);\r\n\t\r\n\t// render tabs\r\n\tconst renderedTabs = tabs.map((tab, i) => {\r\n\t\tconst [ icon, label ] = tab.indexOf('|') > -1 ? tab.split('|') : [ null, tab ];\r\n\t\treturn <Tab key={'tab' + i} icon={<span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>} label={!fixed && _settings.tabsHideLabels !== true && label !== 'null' ? label : null} />\r\n\t});\r\n\t\r\n\treturn (\r\n\r\n<Tabs\r\n\tid=\"tabBar\"\r\n\tvalue={tab}\r\n\tonChange={handleChange}\r\n\tvariant=\"scrollable\"\r\n\tclasses={{\r\n\t\troot: clsx(classes.tabs, fixed && classes.fixed),\r\n\t\tindicator: classes.indicator\r\n\t}}>\r\n\t\r\n\t{renderedTabs}\r\n</Tabs>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport function TabPanel(props) {\r\n\tconst { children, selectedTab, renderedTab, fullscreen } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\t// get map height based on viewport\r\n\tconst { height } = useWindowDimensions();\r\n\tconst [mapHeight, setMapHeight] = useState(height);\r\n\tlet topBarHeight = useRef({});\r\n\t\r\n\tuseEffect(() => {\r\n\t\ttopBarHeight.current = document.getElementById('appBar').offsetHeight;\r\n\t\tsetMapHeight(height-topBarHeight.current+5);\r\n\t\t\r\n\t}, [height]);\r\n\t\r\n\t/*\r\n\t * Some components need to be visible upon loading, so proper initialise.\r\n\t * Due to the 'hidden' attribute though, they might be hidden.\r\n\t * This is a workaround to initially show everything for a short period of time and then hide according to tab settings.\r\n\t *\r\n\t */\r\n\tconst [hidden, setHidden] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tsetTimeout(() => setHidden(selectedTab !== renderedTab), 10);\r\n\t\t\r\n\t}, [selectedTab, renderedTab]);\r\n\t\r\n\treturn (\r\n\r\n<Box\r\n\trole=\"tabpanel\"\r\n\thidden={hidden}\r\n\tid={'tabpanel-' + renderedTab}\r\n\tclassName={clsx(fullscreen ? classes.fullscreen : classes.grid)}\r\n\tstyle={{ height: mapHeight + 'px' }}\r\n\t>\r\n\t\r\n\t{children}\r\n</Box>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport Drawer from '@material-ui/core/Drawer'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdrawer: {\r\n\t\twidth: 400\r\n\t}\r\n});\r\n\r\n\r\nclass Notifications extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t}\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, notifications } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Drawer\r\n\tanchor=\"right\"\r\n\topen={this.props.open}\r\n\tonClose={() => this.props.toggleDrawer('notificationDrawer', false)}\r\n\tclasses={{\r\n\t\tpaper: classes.drawer\r\n\t}}\r\n\t>\r\n\t\r\n</Drawer>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Notifications);\r\n","\r\nexport const ModuleSettings = {\r\n\tAdapterStatus: require('./AdapterStatus').Settings || {},\r\n\tChart: require('./Chart').Settings || {},\r\n\tDateTime: require('./DateTime').Settings || {},\r\n\tMap: require('./Map').Settings || {},\r\n\tMultimedia: require('./Multimedia').Settings || {},\r\n\tStateList: require('./StateList').Settings || {},\r\n\tStateListHorizontal: require('./StateListHorizontal').Settings || {},\r\n\tWeather: require('./Weather').Settings || {}\r\n}\r\n\r\nexport default {\r\n\tAdapterStatus: require('./AdapterStatus').default,\r\n\tChart: require('./Chart').default,\r\n\tDateTime: require('./DateTime').default,\r\n\tMap: require('./Map').default,\r\n\tMultimedia: require('./Multimedia').default,\r\n\tStateList: require('./StateList').default,\r\n\tStateListHorizontal: require('./StateListHorizontal').default,\r\n\tWeather: require('./Weather').default\r\n}","import React from 'react'\r\nimport Connection from '../Connection'\r\nimport Device from '../Device'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle'\r\nimport MuiDialogContent from '@material-ui/core/DialogContent'\r\nimport MuiDialogActions from '@material-ui/core/DialogActions'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Modules from '../modules'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n});\r\n\r\n\r\nconst DialogTitle = withStyles(styles)(props => {\r\n\tconst { children, classes, onClose, ...other } = props;\r\n\treturn (\r\n\r\n<MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n\t<Typography variant=\"h6\">{children}</Typography>\r\n\t{onClose ? (\r\n\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t<CloseIcon />\r\n\t</IconButton>\r\n\t) : null}\r\n</MuiDialogTitle>\r\n\r\n\t);\r\n});\r\n\r\nconst DialogContent = withStyles(theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(1)\r\n\t\t}\r\n\t},\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles(theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n}))(MuiDialogActions);\r\n\r\n\r\nexport default class Popup extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tchildren: []\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tlet device = this.props.contents && this.props.contents.device;\r\n\t\tif (device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\t\r\n\t\t\t// get from cache\r\n\t\t\tif (device.children.length) {\r\n\t\t\t\tconsole.info('Got ' + Object.keys(device.children).length + ' states for device ' + device.name + ' from cache.');\r\n\t\t\t\tthis.setState({ 'children': device.children }, () => this.forceUpdate());\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// retrieve new\r\n\t\t\telse {\r\n\t\t\t\t// loop through states and request status\r\n\t\t\t\tlet responses = [];\r\n\t\t\t\tlet children = [];\r\n\t\t\t\t\r\n\t\t\t\tfor (let stateKey in device.states) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (device.states[stateKey].state === undefined || device.options.hiddenStates.indexOf(stateKey) > -1) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet child = new Device({\r\n\t\t\t\t\t\t\t'parent': device,\r\n\t\t\t\t\t\t\t'id': device.id + '#' + stateKey,\r\n\t\t\t\t\t\t\t'name': device.name,\r\n\t\t\t\t\t\t\t'function': device.function,\r\n\t\t\t\t\t\t\t'states': { [stateKey]: device.states[stateKey] },\r\n\t\t\t\t\t\t\t'options': {\r\n\t\t\t\t\t\t\t\t...device.options,\r\n\t\t\t\t\t\t\t\t'primary': stateKey,\r\n\t\t\t\t\t\t\t\t'secondary': null,\r\n\t\t\t\t\t\t\t\t'divider': children.length !== 0,\r\n\t\t\t\t\t\t\t\t'subgroup': null,\r\n\t\t\t\t\t\t\t\t'subtitle': null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tConnection.getConnection,\r\n\t\t\t\t\t\twindow.language\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// add child to parent\r\n\t\t\t\t\tdevice.children.push(child);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// retrieve state\r\n\t\t\t\t\tresponses.push(child.requestDeviceState(null, true));\r\n\t\t\t\t\tchildren.push(child);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tPromise.allSettled(responses).then(() => {\r\n\t\t\t\t\tconsole.info('Retrieved ' + Object.keys(children).length + ' states for device ' + device.name + '.', responses);\r\n\t\t\t\t\tthis.setState({ 'children': children }, () => this.forceUpdate());\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\tthis.setState({ 'children': [] }, () => this.forceUpdate());\r\n\t\t}\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(nextProps, nextState) {\r\n\t\treturn !this.props.contents || this.props.contents.ts !== nextProps.contents.ts;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { open, closeDialog, contents } = this.props;\r\n\t\tconst { device } = contents;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog onClose={closeDialog} open={open || false} maxWidth={'md'} fullWidth={true}>\r\n\t<DialogTitle onClose={closeDialog}>\r\n\t\t{device.name}\r\n\t</DialogTitle>\r\n\t<DialogContent dividers style={{ padding: 0 }}>\r\n\t\t\r\n\t\t<Modules.StateList openDialog={null} devices={this.state.children} component={true} action={true} />\t\r\n\t\t\r\n\t</DialogContent>\r\n\t<DialogActions>\r\n\t\t<Button autoFocus onClick={closeDialog} color=\"primary\">\r\n\t\t\tClose\r\n\t\t</Button>\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t\t);\r\n\t};\r\n}\r\n","import React from 'react'\r\n\r\nimport Card from '@material-ui/core/Card'\r\nimport CardHeader from '@material-ui/core/CardHeader'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tcard: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t},\r\n\tcardHeaderNoContents: {\r\n\t\tpadding: theme.spacing(),\r\n\t},\r\n\tcardAvatar: props => ({\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff',\r\n\t\tfontSize: '24px',\r\n\t\t...props\r\n\t}),\r\n\tcardContent: {\r\n\t\tpadding: theme.spacing(0, 2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpadding: theme.spacing(0)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Widget(props) {\r\n\tconst { title, icon, iconStyle } = props;\r\n\tconst classes = useStyles(iconStyle);\r\n\t\r\n\treturn (\r\n\r\n<Card className={classes.card}>\r\n\t<CardHeader\r\n\t\tavatar={icon !== null &&\r\n\t\t\t<Avatar variant=\"rounded\" classes={{ root: classes.cardAvatar }}>\r\n\t\t\t\t{React.createElement('span', { 'className': 'mdi mdi-' + (icon || 'home') })}\r\n\t\t\t</Avatar>\r\n\t\t}\r\n\t\ttitle={title &&\r\n\t\t\t<Typography variant=\"h5\" component=\"h2\">\r\n\t\t\t\t{title}\r\n\t\t\t</Typography>\r\n\t\t}\r\n\t/>\r\n\t<CardContent className={classes.cardContent}>\r\n\t\t{props.children}\r\n\t</CardContent>\r\n</Card>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\n\r\nimport Connection from './Connection'\r\n\r\nimport TopBar from './components/TopBar'\r\nimport TabBar, { TabPanel } from './components/TabBar'\r\nimport Notifications from './components/Notifications'\r\nimport GridContainer from './components/GridContainer'\r\nimport Popup from './components/Popup'\r\nimport Widget from './components/Widget'\r\nimport Modules, { ModuleSettings } from './modules'\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst getGroup = (groupId, group, props = {}) => {\r\n\t\r\n\t// group empty\r\n\tif (!group && ModuleSettings[group.settings.component.module].noDevicesAllowed !== true) {\r\n\t\tconsole.error('Group ' + groupId + ' defined in columns but not assigned to any devices!');\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t// get module for component\r\n\tgroup.settings._global = props.settings;\r\n\tgroup.settings.component = typeof group.settings.component === 'string' ? { 'module': group.settings.component } : (group.settings.component || {});\r\n\tconst Tag = Modules[group.settings.component.module || 'StateList'];\r\n\t\r\n\t// get tag\r\n\tif (Tag === undefined) {\r\n\t\tconsole.error('Undefined component \"' + group.settings.component.module + '\" used!');\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\treturn <Tag key={'Tag' + groupId} devices={group.devices} openDialog={props.action ? props.action : null} settings={{ ...group.settings, ...props }} />\r\n}\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst getGridContents = (contents, groups, props = {}) => {\r\n\t\r\n\tlet gridContents = {};\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\t\r\n\t\tlet columnContents = contents[column];\r\n\t\tgridContents[column] = gridContents[column] || [];\r\n\t\t\r\n\t\t// no contents, thus add placeholder\r\n\t\tif (!columnContents || !Object.keys(columnContents).length) {\r\n\t\t\tgridContents[column].push(null);\r\n\t\t}\r\n\t\t\r\n\t\t// add contents\r\n\t\telse {\r\n\t\t\tfor (let groupId in columnContents) {\r\n\t\t\t\t\r\n\t\t\t\tlet group = groups[groupId] || {};\r\n\t\t\t\tgroup.devices = group.devices || [];\r\n\t\t\t\tgroup.settings = columnContents[groupId] || {};\r\n\t\t\t\tgroup.settings._global = props.settings;\r\n\t\t\t\tgroup.settings.component = typeof group.settings.component === 'string' ? { 'module': group.settings.component } : (group.settings.component || {});\r\n\t\t\t\tgroup.settings.module = ModuleSettings[group.settings.component.module] || {};\r\n\t\t\t\t\r\n\t\t\t\tlet content = getGroup(groupId, group, props);\r\n\t\t\t\tif ((group.devices.length > 0 || group.settings.module.noDevicesAllowed) && content) {\r\n\t\t\t\t\tgridContents[column].push(\r\n\t\t\t\t\t\t<Widget key={'Box-' + groupId}\r\n\t\t\t\t\t\t\ttitle={group.settings.title === null ? null : (group.settings.title || group.name || group.settings.module.title)}\r\n\t\t\t\t\t\t\ticon={group.settings.icon === null ? null : (group.settings.icon || group.settings.module.icon)}\r\n\t\t\t\t\t\t\ticonStyle={group.settings.iconStyle}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{content}\r\n\t\t\t\t\t\t</Widget>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn gridContents;\r\n}\r\n\r\n\r\nexport default class Jarvis extends React.Component {\r\n\t\r\n    constructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tconnectionStatus: this.props.connectionStatus || false,\r\n\t\t\t\r\n\t\t\tselectedTab: 0,\r\n\t\t\ttabTitle: '',\r\n\t\t\t\r\n\t\t\tpage: null,\r\n\t\t\t\r\n\t\t\tnotificationDrawer: false,\r\n\t\t\tnotifications: [],\r\n\t\t\tnotificationsUnread: 0,\r\n\t\t\t\r\n\t\t\tdialog: false,\r\n\t\t\tdialogContents: {\r\n\t\t\t\t'ts': 0,\r\n\t\t\t\t'device': {}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// bind methods\r\n\t\tthis.closeDialog = this.closeDialog.bind(this);\r\n\t\tthis.openDialog = this.openDialog.bind(this);\r\n\t\tthis.selectTab = this.selectTab.bind(this);\r\n\t\tthis.toggleDrawer = this.toggleDrawer.bind(this);\r\n\t\tthis.navigate = this.navigate.bind(this);\r\n\t\t\r\n\t\t// get connection\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\t\r\n\t\t// initialise\r\n\t\tthis.gridContents = {};\r\n\t\tthis.layout = this.props.settings.layout;\r\n\t\tthis.tabs = Object.keys(this.layout);\r\n\t\tthis.tabsEnabled = this.tabs[0] !== 1;\r\n\t\tthis.state.tabTitle = this.tabs[this.state.selectedTab];\r\n\t\t\r\n\t\t// no tabs defined, so layout wrap into default tab\r\n\t\tif (!this.tabsEnabled) {\r\n\t\t\tthis.layout = { 'Home': this.layout };\r\n\t\t\tthis.tabs.push('1');\r\n\t\t}\r\n\t\t\r\n\t\t// widget props\r\n\t\tthis.widgetProps = {}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// get notifications\r\n\t\tthis.socket.getState('jarvis.0.notifications').then(notifications => {\r\n\t\t\tnotifications = (notifications && notifications.val && JSON.parse(notifications.val)) || [];\r\n\t\t\t\r\n\t\t\tthis.setState({\r\n\t\t\t\tnotificationsUnread: notifications.filter(notification => !notification.unread || notification.unread !== false).length,\r\n\t\t\t\tnotifications: notifications\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\tthis.socket.subscribeState('jarvis.0.notifications', notifications => console.log(notifications));\r\n\t}\r\n\t\r\n\tgetTabPanels() {\r\n\t\t\r\n\t\tlet tab = 0;\r\n\t\tlet tabPanels = [];\r\n\t\tfor (let tabLabel in this.layout) {\r\n\t\t\tconst contents = this.layout[tabLabel];\r\n\t\t\t\r\n\t\t\t// fullscreen in component\r\n\t\t\tlet groupId = Object.keys(contents)[0];\r\n\t\t\tlet fullscreen = Number.isNaN(parseInt(groupId));\r\n\t\t\t\r\n\t\t\tif (!this.gridContents[tabLabel] && fullscreen) {\r\n\t\t\t\tthis.gridContents[tabLabel] = getGroup(contents, { ...this.props.groups[groupId], settings: contents[groupId] }, { settings: this.props.settings, action: this.openDialog, ...this.widgetProps });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// grid layout\r\n\t\t\telse if (!this.gridContents[tabLabel]) {\r\n\t\t\t\tthis.gridContents[tabLabel] = <GridContainer contents={getGridContents(contents, this.props.groups, { settings: this.props.settings, action: this.openDialog, ...this.widgetProps })} />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet tabPanel = (\r\n\t\t\t\t<TabPanel key={'tabPanel-' + tab} renderedTab={tab} selectedTab={this.state.selectedTab} fullscreen={fullscreen}>\r\n\t\t\t\t\t{this.gridContents[tabLabel]}\r\n\t\t\t\t</TabPanel>\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\ttabPanels.push(tabPanel);\r\n\t\t\ttab++;\r\n\t\t}\r\n\t\t\r\n\t\treturn tabPanels;\r\n\t}\r\n\t\r\n\tcloseDialog() {\r\n\t\tthis.setState({ 'dialog': false, 'dialogContents': { 'ts': Date.now(), 'device': {} } });\r\n\t}\r\n\t\r\n\topenDialog(device) {\r\n\t\tthis.setState({ 'dialog': true, 'dialogContents': { 'ts': Date.now(), 'device': device } });\r\n\t}\r\n\t\r\n\tselectTab(tab, title) {\r\n\t\tthis.setState({ selectedTab: tab, tabTitle: title });\r\n\t}\r\n\t\r\n\ttoggleDrawer(drawer, open) {\r\n\t\tthis.setState({ [drawer]: open });\r\n\t}\r\n\t\r\n\tnavigate(page) {\r\n\t\tthis.setState({ page });\r\n\t}\r\n\t\r\n    render() {\r\n\t\t\r\n        return (\r\n\r\n<React.Fragment>\r\n\t<TopBar\r\n\t\ttitle={this.props.settings.topBarTitle || (this.tabsEnabled && this.state.tabTitle) || 'jarvis'}\r\n\t\tconnectionStatus={this.state.connectionStatus}\r\n\t\ttoggleDrawer={this.toggleDrawer}\r\n\t\tnavigate={this.navigate}\r\n\t\tnotifications={this.state.notificationsUnread}\r\n\t\t>\r\n\t\t\r\n\t\t{this.tabsEnabled && <TabBar _settings={this.props.settings} tabs={this.tabs} selectTab={this.selectTab} />}\r\n\t</TopBar>\r\n\t\r\n\t\r\n\t{/* DRAWER: NOTIFICATIONS */}\r\n\t<Notifications\r\n\t\topen={this.state.notificationDrawer}\r\n\t\ttoggleDrawer={this.toggleDrawer}\r\n\t\tnotifications={this.state.notifications}\r\n\t\t/>\r\n\t\r\n\t\r\n\t{/* PAGE */}\r\n\t\r\n\t\r\n\t{/* POPUP */}\r\n\t<Popup open={this.state.dialog} contents={this.state.dialogContents} closeDialog={this.closeDialog} />\r\n\t{this.getTabPanels()}\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n","import React from 'react'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Skeleton from '@material-ui/lab/Skeleton'\r\n\r\nimport GridContainer from './components/GridContainer'\r\nimport StatusSnackbar from './components/StatusSnackbar'\r\n\r\nimport config from './config/config.dev.js'\r\nimport i18n from './i18n'\r\nimport Connection from './Connection'\r\nimport Settings from './Settings'\r\nimport Device from './Device'\r\nimport Jarvis from './Jarvis'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { ThemeProvider, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tloading: {\r\n\t\tmargin: '10px 0 0 0',\r\n\t\tcolor: '#999'\r\n\t},\r\n\tgridItem: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmarginRight: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n/*\r\n * CONSTANTS\r\n *\r\n */\r\nconst NODE_SETTINGS = 'jarvis.0.settings';\r\nconst NODE_DEVICES = 'jarvis.0.devices';\r\n\r\n\r\nclass App extends React.Component {\r\n\t\r\n    constructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tloaded: [],\r\n\t\t\tconnected: false,\r\n\t\t\terror: false,\r\n\t\t\terrorMessage: '',\r\n\t\t\t\r\n\t\t\ttheme: null\r\n\t\t}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// connect and get connection\r\n\t\tconst errorHandler = err => {\r\n\t\t\tthis.setState({ connected: false, error: true, errorMessage: (typeof err === 'string' ? err : err.message) + '..' });\r\n\t\t\tsetTimeout(() => Connection.reconnect, 10*1000);\r\n\t\t};\r\n\t\t\r\n\t\tconst url = window.location.port === '3000' ? config.iobrokerWebAdapterUrl :\r\n\t\t\twindow.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\r\n\t\t\r\n\t\tconst listeners = [\r\n\t\t\t{ 'event': 'connect', 'callback': () => this.setState({ connected: true, error: false, errorMessage: '' }) },\r\n\t\t\t{ 'event': 'reconnect', 'callback': () => this.setState({ connected: 'pending', error: false, errorMessage: '' }) },\r\n\t\t\t{ 'event': 'disconnect', 'callback': errorHandler },\r\n\t\t\t{ 'event': 'error', 'callback': errorHandler }\r\n\t\t];\r\n\t\t\r\n\t\tconsole.log('Connect to ' + url + '...');\r\n\t\tthis.socket = Connection.connect(url, listeners);\r\n\t\t\r\n\t\t// retrieve settings\r\n\t\tthis.settings = {};\r\n\t\tthis.socket.getState(NODE_SETTINGS)\r\n\t\t\t.then(state => {\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (state) {\r\n\t\t\t\t\t\tthis.settings = { ...this.settings, ...JSON.parse(state.val) || {} };\r\n\t\t\t\t\t\tSettings.setSettings(this.settings);\r\n\t\t\t\t\t\tSettings.applySettings();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// get theme\r\n\t\t\t\t\t\timport('./theme').then(theme => this.setState({ theme: theme.default }));\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst tab = Object.keys(this.settings.layout)[0];\r\n\t\t\t\t\tif (tab === undefined) {\r\n\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\t\terrorMessage: i18n.t('Please create the configuration. See documentation.')\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.setState({ loaded: [ ...this.state.loaded, 'settings' ] });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err) {\r\n\t\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\terrorMessage: i18n.t('Error parsing settings') + '!'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\terror: true,\r\n\t\t\t\t\terrorMessage: typeof err === 'string' ? i18n.t(err) : i18n.t(err.message)\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\r\n\t\t// retrieve ioBroker config\r\n\t\tthis.settings.iobroker = {};\r\n\t\tthis.socket.getObject('system.config', (err, data) => {\r\n\t\t\tif (data && data.common) {\r\n\t\t\t\tthis.settings.iobroker = data.common;\r\n\t\t\t\tSettings.setSettings({ iobroker: this.settings.iobroker });\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// retrieve devices\r\n\t\tthis.devices = {};\r\n\t\tthis.groups = {};\r\n\t\t\r\n\t\tthis.socket.getState(NODE_DEVICES)\r\n\t\t\t.then(state => {\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis.devices = JSON.parse(state.val);\r\n\t\t\t\t\tthis.processDevices(this.devices).then(groups => {\r\n\t\t\t\t\t\tthis.groups = groups;\r\n\t\t\t\t\t\tthis.setState({ loaded: [ ...this.state.loaded, 'groups' ] });\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err) {\r\n\t\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\r\n\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\terrorMessage: i18n.t('Error parsing devices') + '!'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\terror: true,\r\n\t\t\t\t\terrorMessage: i18n.t('Socket failed while getting devices') + '!'\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\r\n    }\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgroupDevice(groups, device) {\r\n\t\t\r\n\t\t// add device to group(s)\r\n\t\tlet options = device.get('options');\r\n\t\toptions.groups.forEach(group => {\r\n\t\t\t\r\n\t\t\tlet groupId = group.toLowerCase().replace(/ /g, '');\r\n\t\t\tif (!groups[groupId]) {\r\n\t\t\t\tgroups[groupId] = { 'id': groupId, 'name': group, 'devices': [device] };\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tgroups[groupId].devices.push(device);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn groups;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tprocessDevice(deviceProperties) {\r\n\t\t\r\n\t\tlet promises = [];\r\n\t\tlet device = null;\r\n\t\ttry {\r\n\t\t\tdevice = new Device(deviceProperties, this.socket, window.language);\r\n\t\t\t\r\n\t\t\t// request primary state value\r\n\t\t\tpromises.push(device.requestDeviceState(null, true));\r\n\t\t\t\r\n\t\t\t// request secondary state value\r\n\t\t\tif (device.secondaryStateKey) {\r\n\t\t\t\tpromises.push(device.requestDeviceState(device.secondaryStateKey, true));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tconsole.warn(err.message);\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tPromise.allSettled(promises).then(results => {\r\n\t\t\t\t\r\n\t\t\t\tresults.forEach(result => {\r\n\t\t\t\t\tif (result.status === 'rejected') {\r\n\t\t\t\t\t\tconsole.error(result);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tresolve(device);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tprocessDevices(deviceList) {\r\n\t\t\r\n\t\t// loop through all devices of in the device list\r\n\t\tlet promises = [];\r\n\t\tlet groups = {};\r\n\t\t\r\n\t\tlet devices = 0, groupedDevices = 0;\r\n\t\tfor (let deviceId in deviceList) {\r\n\t\t\tdevices++;\r\n\t\t\t\r\n\t\t\tdeviceList[deviceId].options = deviceList[deviceId].jarvis;\r\n\t\t\tdelete deviceList[deviceId].jarvis;\r\n\t\t\t\r\n\t\t\tlet deviceProperties = { ...deviceList[deviceId], 'id': deviceId };\r\n\t\t\tpromises.push(new Promise((resolve, reject) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.processDevice(deviceProperties).then(device => {\r\n\t\t\t\r\n\t\t\t\t\tif (device !== null) {\r\n\t\t\t\t\t\tgroupedDevices++;\r\n\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\r\n\t\t\t\t\t\tresolve(deviceId);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treject(deviceId);\r\n\t\t\t\t});\r\n\t\t\t}));\r\n\t\t\t\r\n\t\t\t// check states for own device settings\r\n\t\t\tfor (let stateKey in deviceProperties.states) {\r\n\t\t\t\t\r\n\t\t\t\tlet state = deviceProperties.states[stateKey];\r\n\t\t\t\tif (state && state.jarvis !== undefined) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tpromises.push(new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.processDevice({ ...deviceProperties, 'id': deviceId + '#' + stateKey, 'states': { [stateKey]: state }, 'options': state.jarvis }).then(device => {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (device !== null) {\r\n\t\t\t\t\t\t\t\tgroupedDevices++;\r\n\t\t\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\r\n\t\t\t\t\t\t\t\tresolve(deviceId);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treject(deviceId);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}));\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise(resolve => Promise.allSettled(promises).then(res => {\r\n\t\t\t\r\n\t\t\t// sort groups\r\n\t\t\tfor (let groupId in groups) {\r\n\t\t\t\tgroups[groupId].devices.sort((item1, item2) => {\r\n\t\t\t\t\tif (item1.options.sort > item2.options.sort) return 1;\r\n\t\t\t\t\telse if (item2.options.sort > item1.options.sort) return -1;\r\n\t\t\t\t\telse return 0;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\r\n\t\t\t// return\r\n\t\t\tconsole.info('Processed ' + devices + ' devices. Added ' + groupedDevices + ' devices in ' + Object.keys(groups).length + ' groups.', res, groups);\r\n\t\t\tresolve(groups);\r\n\t\t}));\r\n\t}\r\n\t\r\n\trenderError(error) {\r\n\t\terror = error || this.state.errorMessage;\r\n\t\tconsole.error(JSON.stringify(error));\r\n\t\treturn (\r\n\r\n<StatusSnackbar\r\n\tkey={'StatusSnackbar'}\r\n\tvariant=\"error\"\r\n\tcloseButton={false}\r\n\tmessage={error.toString()}\r\n\t/>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\trenderLoadingProgress() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\r\n<Grid\r\n\tkey=\"loadingProcess\"\r\n\tcontainer\r\n\tspacing={0}\r\n\tdirection=\"column\"\r\n\tjustify=\"center\"\r\n\talignItems=\"center\"\r\n\tstyle={{ minHeight: \"100vh\" }}\r\n\t>\r\n\r\n\t<CircularProgress />\r\n\t<Typography className={classes.loading}>{i18n.t('Retrieving settings')}...</Typography>\r\n\r\n</Grid>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\trenderLoadingSkeleton(props) {\r\n\t\tconst { classes } = this.props;\r\n\t\tconst { topBar, tabBar, gridColumns } = props;\r\n\t\t\r\n\t\tconst SkeletonLoader = (props) => <Skeleton animation=\"wave\" variant=\"rect\" className={classes.gridItem} height={props.height} />;\r\n\t\t\r\n\t\tlet gridContents = {}\r\n\t\tfor (let column = 1; column <= gridColumns; column++) {\r\n\t\t\tgridContents[column] = gridContents[column] || [];\r\n\t\t\t\r\n\t\t\tlet loaders = Math.random() * (5 - 2) + 2;\r\n\t\t\tfor (let loader = 1; loader <= loaders; loader++) {\r\n\t\t\t\tgridContents[column].push(<SkeletonLoader key={column + '#' + loader} height={(Math.random() * (400 - 100) + 100)} />);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t{topBar && <Skeleton animation=\"wave\" variant=\"rect\" height={64} />}\r\n\t{tabBar && <Skeleton animation=\"wave\" variant=\"rect\" height={48} />}\r\n\t<GridContainer key=\"loadingSkeleton\" contents={gridContents} />\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n    render() {\r\n\t\t\r\n\t\t// error message\r\n\t\tconst error = this.state.error ? this.renderError() : null;\r\n\t\t\r\n\t\t// loading screens\r\n\t\tif (this.state.error && this.state.loaded.length < 2) {\r\n\t\t\treturn error;\r\n\t\t}\r\n\t\telse if (this.state.loaded.indexOf('settings') === -1) {\r\n\t\t\treturn this.renderLoadingProgress();\r\n\t\t}\r\n\t\telse if (this.state.loaded.indexOf('groups') === -1) {\r\n\t\t\tconst tab = Object.keys(this.settings.layout)[0];\r\n\t\t\treturn tab === undefined ? null : this.renderLoadingSkeleton({ topBar: true, tabBar: tab !== 1, gridColumns: (tab !== 1 ? Object.keys(this.settings.layout[tab]).length : tab.length) });\r\n\t\t}\r\n\t\t\r\n\t\t// App\r\n\t\treturn (\r\n\r\n<ThemeProvider theme={this.state.theme}>\r\n\t{error}\r\n\t<Jarvis key=\"jarvis\" connectionStatus={this.state.connected} settings={this.settings} groups={this.groups} />\r\n</ThemeProvider>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(App);\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport './index.css'\r\nimport App from './App'\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","/**\r\n *\r\n *\r\n */\r\nfunction HsvToRgb(h, s = 1, v = 1) {\r\n\tif (Array.isArray(h)) {\r\n\t\tv = h[2];\r\n\t\ts = h[1];\r\n\t\th = h[0];\r\n\t}\r\n\telse if (typeof h === 'string' && h.indexOf(',')) {\r\n\t\t[h, s, v] = h.split(',');\r\n\t}\r\n\t\r\n\tif (h > 1) {\r\n\t\th = h/360;\r\n\t}\r\n\t\r\n\tlet r, g, b, i, f, p, q, t;\r\n\t\r\n\ti = Math.floor(h * 6);\r\n\tf = h * 6 - i;\r\n\tp = v * (1 - s);\r\n\tq = v * (1 - f * s);\r\n\tt = v * (1 - (1 - f) * s);\r\n\t\r\n\tswitch (i % 6) {\r\n\t\tcase 0:\r\n\t\t\tr = v;\r\n\t\t\tg = t;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\t\r\n\t\tcase 1:\r\n\t\t\tr = q;\r\n\t\t\tg = v;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 2:\r\n\t\t\tr = p;\r\n\t\t\tg = v;\r\n\t\t\tb = t;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 3:\r\n\t\t\tr = p;\r\n\t\t\tg = q;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 4:\r\n\t\t\tr = t;\r\n\t\t\tg = p;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 5:\r\n\t\t\tr = v;\r\n\t\t\tg = p;\r\n\t\t\tb = q;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault: // for webpack\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn [\r\n\t\tMath.round(r * 255),\r\n\t\tMath.round(g * 255),\r\n\t\tMath.round(b * 255)\r\n\t];\r\n}\r\n\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction RgbToHex(r, g, b) {\r\n\tif (Array.isArray(r)) {\r\n\t\tb = r[2];\r\n\t\tg = r[1];\r\n\t\tr = r[0];\r\n\t}\r\n\telse if (typeof r === 'string' && r.indexOf(',')) {\r\n\t\t[r, g, b] = r.split(',');\r\n\t}\r\n\t\r\n\tr = parseInt(r).toString(16);\r\n\tg = parseInt(g).toString(16);\r\n\tb = parseInt(b).toString(16);\r\n\t\r\n\tif (r.length === 1) r = '0' + r;\r\n\tif (g.length === 1) g = '0' + g;\r\n\tif (b.length === 1) b = '0' + b;\r\n\t\r\n\treturn \"#\" + r + g + b;\r\n}\r\n\r\n\r\nexport default {\r\n\tHsvToRgb,\r\n\tRgbToHex\r\n}","import React, { useState, useEffect } from 'react'\r\nimport { HuePicker, SketchPicker as ColorPicker } from 'react-color'\r\n\r\nimport helpers from '../helpers/colorConverter'\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction LightLevelAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked ? 100 : 0).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal > 0);\r\n\tuseEffect(() => setChecked(stateVal > 0), [stateVal]);\r\n\t\r\n\t// only show percentage if device has a switch itself\r\n\tif (device.parent && device.parent.states.power) {\r\n\t\treturn <defaults.actions.Action {...props} stateVal={checked} onChange={onChange} />;\r\n\t}\r\n\t\r\n\treturn <defaults.actions.PowerAction {...props} stateVal={checked} onChange={onChange} />\r\n}\r\n\r\nfunction LightColorAction(props) {\r\n\tconst { stateKey, stateVal } = props;\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(stateVal);\r\n\tuseEffect(() => setColorSpace(stateVal), [stateVal]);\r\n\t\r\n\tlet colors, labels = {};\r\n\tif (stateKey === 'rgb' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Red: colors[0], Green: colors[1], Blue: colors[2] };\r\n\t\t\r\n\t}\r\n\telse if (stateKey === 'hsv' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Hue: colors[0], Saturation: colors[1], Brightness: colors[2] };\r\n\t}\r\n\t\r\n\tconst Label = defaults.components.Label;\r\n\tlet label = [];\r\n\tfor (let key in labels) {\r\n\t\tlabel.push(<Label key={key} label={key + ' ' + labels[key]} br={true} />);\r\n\t}\r\n\t\r\n\treturn label;\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction LightColorTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={2000} max={6500} step={10} {...props} />\r\n\t);\r\n}\r\n\r\nfunction LightHueComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tsetHue(Math.round(color.hsl.h));\r\n\t\tdevice.setDeviceState(stateKey, Math.round(color.hsl.h)).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [hue, setHue] = useState(stateVal);\r\n\tuseEffect(() => setHue(stateVal), [stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\tconst color = helpers.RgbToHex(helpers.HsvToRgb(hue));\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<HuePicker\r\n\t\tcolor={color}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\nfunction LightColorComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tcolor = color[stateKey];\r\n\t\t\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tcolor = [color.r, color.g, color.b].join(',');\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tcolor = [color.h, color.s, color.v].join(',');\r\n\t\t}\r\n\t\t\r\n\t\tdevice.setDeviceState(stateKey, color).catch(err => console.error(err));\r\n\t};\r\n\t\r\n\tlet initialColor = stateVal || '#ffffff';\r\n\t\r\n\t// RGB\r\n\tif (stateKey === 'rgb') {\r\n\t\tinitialColor = helpers.RgbToHex(initialColor);\r\n\t}\r\n\t// HSV\r\n\telse if (stateKey === 'hsv') {\r\n\t\tinitialColor = helpers.RgbToHex(helpers.HsvToRgb(initialColor));\r\n\t}\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(initialColor);\r\n\tuseEffect(() => {\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(stateVal));\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(helpers.HsvToRgb(stateVal)));\r\n\t\t}\r\n\t\t// HEX\r\n\t\telse if (stateKey === 'hex') {\r\n\t\t\tsetColorSpace(stateVal);\r\n\t\t}\r\n\t}, [stateKey, stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<ColorPicker\r\n\t\tcolor={colorSpace}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\nconst color = {\r\n\ticon: {\r\n\t\t'default': 'palette',\r\n\t},\r\n\tunit: ' °'\r\n}\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tpower: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'lightbulb-on',\r\n\t\t\t\t'false': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tvalue: (val) => val > 0 && val <= 1 ? val * 100 : val,\r\n\t\t\tunit: (value) => value !== 'off' ? ' %' : null,\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'lightbulb-on',\r\n\t\t\t\t'0': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': 'off'\r\n\t\t\t},\r\n\t\t},\r\n\t\tcolorTemperature: {\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'thermometer',\r\n\t\t\t},\r\n\t\t\tunit: ' °K'\r\n\t\t},\r\n\t\thue: color,\r\n\t\trgb: color,\r\n\t\thsv: color,\r\n\t\thex: color\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel: defaults.components.LevelComponent,\r\n\t\tcolorTemperature: LightColorTemperatureComponent,\r\n\t\trgb: LightColorComponent,\r\n\t\thsv: LightColorComponent,\r\n\t\thex: LightColorComponent,\r\n\t\thue: LightHueComponent\r\n\t},\r\n\tactions: {\r\n\t\tpower: defaults.actions.PowerAction,\r\n\t\tlevel: LightLevelAction,\r\n\t\trgb: LightColorAction,\r\n\t\thsv: LightColorAction,\r\n\t\thex: LightColorAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import EventEmitter from 'events'\r\nimport io from 'socket.io-client'\r\n\r\n\r\n/**\r\n * Class for Socket.io conncetion handling.\r\n *\r\n * @description This is based on an implementation @GermanBluefox (https://github.com/GermanBluefox), see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\t\t\t\tOnly required functions are taken from source class. Major change is that all events are emitted, so proper error handling is possible in the App.\r\n *\r\n *\r\n * @param\t{String}\t\turl\r\n * @param\t{Object}\t\toptions\r\n * @return\t{Socket}\r\n * @see https://github.com/ioBroker/ioBroker.socketio/blob/master/lib/socket.js https://github.com/ioBroker/ioBroker.js-controller/blob/master/lib/adapter.js#L635\r\n *\r\n */\r\nexport default class Socket extends EventEmitter {\r\n\t\r\n\tconstructor(url = null, options = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\t// socket connection\r\n\t\tthis.socket = io(url, { timeout: 10000, ...options, query: 'ws=true' });\r\n\t\tthis.statesSubscribes = {}; // subscribed states\r\n\t\t\r\n\t\t/*\r\n\t\t * API events\r\n\t\t * @see https://github.com/socketio/socket.io-client/blob/HEAD/docs/API.md#socket\r\n\t\t *\r\n\t\t */\r\n\t\t// connect\r\n\t\tthis.socket.on('connect', () => this.emit('connect'));\r\n\t\t\r\n\t\t// reconnect: Fired upon a successful reconnection.\r\n\t\tthis.socket.on('reconnect', attempts => this.emit('reconnect', attempts));\r\n\t\t\r\n\t\t// reconnect_error: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_error', error => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// reconnect_failed: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_failed', () => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_failed', 'message': 'Reconnection failed!' }));\r\n\t\t\r\n\t\t// discconect\r\n\t\tthis.socket.on('disconnect', reason => this.emit('disconnect', reason));\r\n\t\t\r\n\t\t// connect_error\r\n\t\tthis.socket.on('connect_error', error => this.emit('error', { 'type': 'connect', 'event': 'connect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// connect_timeout\r\n\t\tthis.socket.on('connect_timeout', () => this.emit('error', { 'type': 'connect', 'event': 'connect_timeout', 'message': 'Connect ran into timeout!' }));\r\n\t\t\r\n\t\t// error\r\n\t\tthis.socket.on('error', error => this.emit('error', { 'type': 'error', 'event': 'error', 'message': error.message }));\r\n\t\t\r\n\t\t/*\r\n\t\t * ioBroker events\r\n\t\t *\r\n\t\t */\r\n\t\tthis.socket.on('stateChange', (id, state) => setTimeout(() => this.stateChange(id, state), 0));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to multiple states by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeStates(ids, cb) {\r\n\t\tids = Array.isArray(ids) ? ids : [ids];\r\n\t\tids.forEach(id => this.subscribeState(id, cb));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to a state by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeState(id, cb) {\r\n\t\t\r\n\t\tif (!this.statesSubscribes[id]) {\r\n\t\t\tlet reg = id\r\n\t\t\t\t.replace(/\\./g, '\\\\.')\r\n\t\t\t\t.replace(/\\*/g, '.*')\r\n\t\t\t\t.replace(/\\(/g, '\\\\(')\r\n\t\t\t\t.replace(/\\)/g, '\\\\)')\r\n\t\t\t\t.replace(/\\+/g, '\\\\+')\r\n\t\t\t\t.replace(/\\[/g, '\\\\[');\r\n\r\n\t\t\tif (reg.indexOf('*') === -1) {\r\n\t\t\t\treg += '$';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.statesSubscribes[id] = { reg: new RegExp(reg), cbs: [cb] };\r\n\t\t\t\r\n\t\t\tif (this.socket.connected) {\r\n\t\t\t\tthis.socket.emit('subscribe', id);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.statesSubscribes[id].cbs.indexOf(cb) === -1 && this.statesSubscribes[id].cbs.push(cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Fires pre-registered callbacks (via subscribeState) upon state change.\r\n\t *\r\n\t */\r\n\tstateChange(id, state) {\r\n\t\t\r\n\t\tid = id ? id.replace(/[\\s'\"]/g, '_') : '';\r\n\t\tfor (const task in this.statesSubscribes) {\r\n\t\t\tif (this.statesSubscribes.hasOwnProperty(task) && this.statesSubscribes[task].reg.test(id)) {\r\n\t\t\t\tthis.statesSubscribes[task].cbs.forEach(cb => cb(id, state));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetAdapterInstances(adapter, cb) {\r\n\t\t\r\n\t\tif (typeof adapter === 'function') {\r\n\t\t\tcb = adapter;\r\n\t\t\tadapter = null;\r\n\t\t}\r\n\t\t\r\n\t\treturn this.getObjectView('system', 'instance', { 'startkey': 'system.adapter.' + (adapter ? adapter + '.' : ''), 'endkey': 'system.adapter.' + (adapter ? adapter + '.999' : 'zzz') }, cb);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object.\r\n\t *\r\n\t */\r\n\tgetObject(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getObject(id, (err, obj) => err ? reject(err) : resolve(obj)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getObject', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetObjectView(design, search, params, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getObjectView(design, search, params, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getObjectView', design, search, params, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a remote ressource.\r\n\t *\r\n\t */\r\n\tgetRemoteResource(url, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getRemoteResource(url, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('httpGet', url, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a state.\r\n\t *\r\n\t */\r\n\tgetState(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getState(id, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getState', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets multiple states at once.\r\n\t *\r\n\t */\r\n\tgetStates(pattern, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStates(pattern, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getStates', pattern, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the state history.\r\n\t *\r\n\t */\r\n\tgetStateHistory(id, options, cb) {\r\n\t\t\r\n\t\tif (typeof options === 'function') {\r\n\t\t\tcb = options;\r\n\t\t\toptions = {};\r\n\t\t}\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStateHistory(id, options, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getHistory', id, options, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a state.\r\n\t *\r\n\t */\r\n\tsetState(id, val, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.setState(id, val, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('setState', id, val, cb);\r\n\t\t}\r\n\t}\r\n}\r\n","import Socket from './Socket'\r\n\r\n/**\r\n * Connection\r\n +\r\n *\r\n */\r\nexport default class Connection {\r\n\r\n\t/*\r\n\t * URL\r\n\t */\r\n\tstatic url = window.location.hostname;\r\n\t\r\n\t/*\r\n\t * Connection\r\n\t */\r\n\tstatic connection = null;\r\n\t\r\n\t/**\r\n\t * Connects to the Socket.\r\n\t *\r\n\t * @param\t{String}\turl\r\n\t * @param\t{Array}\t\tlisteners\r\n\t * @return\t{Connection}\r\n\t */\r\n\tstatic connect(url = null, listeners = null) {\r\n\t\t\r\n\t\t// set URL\r\n\t\tif (url) {\r\n\t\t\tConnection.setUrl = url;\r\n\t\t}\r\n\t\t\r\n\t\t// connect\r\n\t\tConnection.connection = new Socket(Connection.url);\r\n\t\t\r\n\t\t// set listeners\r\n\t\tif (listeners) {\r\n\t\t\tConnection.setListeners = listeners;\r\n\t\t}\r\n\t\t\r\n\t\t// return connection\r\n\t\treturn Connection.connection;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the current Connection.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Connection}\tCurrent Connection\r\n\t */\r\n\tstatic get getConnection() {\r\n\t\treturn Connection.connection || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get the current URL.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get getUrl() {\r\n\t\treturn Connection.url;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Reconnect to the Socket.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get reconnect() {\r\n\t\treturn Connection.connect;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets an event listener.\r\n\t *\r\n\t * @param\t{Object}\t\t\tlistener\r\n\t * @param\t{String}\t\t\tlistener.event\r\n\t * @param\t{Function}\t\t\tlistener.callback\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setListener(listener) {\r\n\t\tConnection.connection.on(listener.event, listener.callback);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set event listeners.\r\n\t *\r\n\t * @param\t{Array<Object>}\t\tlisteners\r\n\t * @return \t{Boolean}\r\n\t */\r\n\tstatic set setListeners(listeners = []) {\r\n\t\t\r\n\t\tif (!listeners || !Array.isArray(listeners)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tlisteners.forEach(listener => Connection.setListener = listener);\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a new URL (has to be set before calling connect()).\r\n\t *\r\n\t * @param\t{String}\tURL\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setUrl(url) {\r\n\t\tConnection.url = url;\r\n\t}\r\n}\r\n","/**\r\n * Internationalization\r\n * Based on https://raw.githubusercontent.com/ioBroker/adapter-react/master/src/i18n.js.\r\n * Copyright 2018-2019 bluefox <dogafox@gmail.com>\r\n *\r\n * MIT License\r\n *\r\n *\r\n */\r\nexport default class i18n {\r\n\r\n\t/*\r\n\t * holds the translations\r\n\t */\r\n\tstatic translations = {};\r\n\r\n\t/*\r\n\t * default language\r\n\t */\r\n\tstatic language = navigator.language || navigator.userLanguage || 'en';\r\n\r\n\t/**\r\n\t * Override default language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setLanguage(language) {\r\n\t\tif (language) {\r\n\t\t\ti18n.language = language;\r\n\t\t\tconsole.log('i18n: Set language to ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads multiple translations.\r\n\t *\r\n\t * @param\t{String|Array}\tlanguages\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslations(languages) {\r\n\t\t\r\n\t\tif (languages) {\r\n\t\t\tlanguages = Array.isArray(languages) ? languages : [languages];\r\n\t\t\tlanguages.forEach(language => i18n.loadTranslation(language));\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads a translation.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslation(language) {\r\n\t\t\r\n\t\tif (language) {\r\n\t\t\tlet translation;\r\n\t\t\ttry {\r\n\t\t\t\ttranslation = require('./i18n/' + language + '.js').default;\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tconsole.error(err.message);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\ti18n.setTranslation(language, translation);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a translation for language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @param\t{Object}\ttranslation\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setTranslation(language, translation) {\r\n\t\tif (language && translation) {\r\n\t\t\ti18n.translations[language] = { ...i18n.translations[language] || {}, ...translation };\r\n\t\t\tconsole.log('i18n: Set translations for language ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic getLanguage() {\r\n\t\treturn i18n.lang;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\t{String}\tword\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @param\t{Boolean}\t[options.ucFirst=false]\r\n\t * @param\t{Object}\t[placeholders={}]\r\n\t * @param\t{String}\t[language=i18n.language]\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic t(word, options = {}, placeholders = {}, language = i18n.language) {\r\n\t\t\r\n\t\tword = word.toString();\r\n\t\tif (i18n.translations[language]) {\r\n\t\t\t\r\n\t\t\t// check if word is concatenated\r\n\t\t\tif (word.indexOf('#') > -1) {\r\n\t\t\t\t\r\n\t\t\t\tlet parts = word.split('#');\r\n\t\t\t\twhile (parts.length > 0 && !i18n.translations[language][parts.join('#')]) {\r\n\t\t\t\t\tparts.shift();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tword = i18n.translations[language][parts.join('#')] || word;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tword = i18n.translations[language][word] || word;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// replace placeholders\r\n\t\tfor (let key in placeholders) {\r\n\t\t\tword = word.replace(RegExp('%' + key + '%', 'g'), placeholders[key]);\r\n\t\t}\r\n\t\t\r\n\t\t// options\r\n\t\tif (options.ucFirst) {\r\n\t\t\tword = word.charAt(0).toUpperCase() + word.slice(1);\r\n\t\t}\r\n\t\t\r\n\t\treturn word;\r\n\t}\r\n}\r\n"],"sourceRoot":""}