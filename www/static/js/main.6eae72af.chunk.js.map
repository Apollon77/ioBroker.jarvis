{"version":3,"sources":["helpers/timeConverter.js","i18n.js","modules/StateListItem.js","modules/StateList.js","functions/blind.js","modules/AdapterStatus.js","modules/Chart.js","modules/DateTime.js","modules/Map.js","modules/StateListHorizontal.js","modules/Weather.js","modules/MultimediaItem.js","modules/Multimedia.js","i18n sync /^/.*/.js$","i18n/de.js","i18n/en.js","functions/door.js","functions/heating.js","functions/defaults.js","functions/location.js","functions/user.js","functions/window.js","components/GridContainer.js","components/StatusSnackbar.js","functions/index.js","Function.js","Adapters.js","Device.js","components/TopBar.js","helpers/useWindowDimensions.js","components/TabBar.js","modules/index.js","components/Popup.js","components/Widget.js","theme.js","Jarvis.js","App.js","serviceWorker.js","index.js","helpers/colorConverter.js","functions/light.js","Socket.js","Connection.js"],"names":["timeToSeconds","time","toString","indexOf","split","length","hours","minutes","seconds","parseInt","timeToHoursMinutesSeconds","withHours","Number","isNaN","Math","floor","substr","join","secondsToDateTime","dateTimeFormat","format","Date","locale","de","i18n","language","console","log","languages","Array","isArray","forEach","loadTranslation","translation","require","default","err","error","message","setTranslation","translations","lang","word","options","placeholders","parts","shift","key","replace","RegExp","ucFirst","charAt","toUpperCase","slice","navigator","userLanguage","styles","theme","defaultListDivider","margin","defaultListIcon","props","components","icon","horizontalListItem","display","textAlign","paddingRight","width","marginTop","horizontalListItemIcon","minWidth","horizontalListItemAction","top","right","position","transform","verticalListItemAction","ListItemIconElement","withStyles","customClassNames","children","classes","classNames","map","className","clsx","StateListItem","state","device","primaryStateKey","getDeviceState","secondaryStateKey","this","on","stateKey","setState","openDialog","horizontal","component","action","get","getIcon","val","primary","getAction","primaryAction","secondary","Fragment","divider","ListItem","finger","button","onClick","bind","ListItemIcon","getStyle","ListItemText","getComponent","getOption","subtitle","timeChanged","ListItemSecondaryAction","id","style","React","Component","defaultListSectionDivider","defaultListSectionDividerItem","padding","defaultListSectionText","breakpoints","down","horizontalList","flexDirection","flexWrap","ListDivider","getDevicesBySubgroup","subgroup","title","subgroupActions","handleChange","targetStatus","status","setDeviceState","ButtonGroup","color","size","Button","t","StateList","devices","push","settings","List","dense","i","listSection","listItem","useStyles","makeStyles","value","float","lineHeight","marginRight","noBorder","borderLeftColor","configurations","level","round","level2","unit","defaults","LevelComponent","actions","useState","setLevel","useEffect","activity","setActivity","states","requestDeviceState","catch","sKey","s","manufacturer","borderRightColor","disabled","AdapterStatus","adapterInformation","adapterAliveStatus","newUpdates","updatesJson","lastUpdateCheck","socket","Connection","getConnection","list","blacklist","updates","updateStates","getStates","subscribeStates","update","lastIndexOf","getAdapterInstances","instances","rows","adapters","instance","common","name","concat","sort","item1","item2","aliveStatus","prevState","updateList","JSON","parse","Object","keys","adapterList","loading","adapter","enabled","alive","connected","connection","tooltip","alt","src","extIcon","small","version","UpdateAvailable","availableVersion","runAsCompactMode","compactGroup","StatusIndicator","notAlive","root","noUpdates","container","UpdatesListItem","UpdatesIndicator","Settings","noDevicesAllowed","fontStyle","backgroundColor","spacing","paddingLeft","borderRadius","height","fontSize","Chart","chartFilter","chartConfig","yAxes","unshift","type","ticks","callback","yLeftAxisUnitBefore","parseFloat","toFixed","yLeftAxisUnitAfter","errors","datePicker","selectedTimeRangeValue","selectedTimeRangeUnit","selectedDateTime","dateNow","chartLabels","chartData","labels","datasets","chartPan","chartZoom","timer","timeRangeRef","createRef","chartRef","chartUpdates","chartOptions","maintainAspectRatio","spanGaps","legend","legendClickHandler","tooltips","callbacks","label","item","data","datasetIndex","scales","plugins","colorschemes","scheme","zoom","pan","mode","getTimeRange","axis","getAxis","requestDeviceStateHistory","history","start","end","step","addChartGraph","liveUpdates","updateChartGraph","prevProps","clearTimeout","setTimeout","getTime","timeRange","axisTimeFormat","helpers","prevMarker","markers","marker","index","entry","ts","reduce","a","b","chartIndex","findIndex","groupChartData","current","chartInstance","values","prevStates","dataSet","fill","graphConfig","e","legendItem","ci","meta","getDatasetMeta","hidden","resetZoom","inputRef","input","onChange","event","target","displayEmpty","disableUnderline","select","deLocale","utils","DateFnsUtils","open","onOpen","onClose","variant","ampm","InputProps","iconButton","dividerVertical","orientation","placement","buttonDisabled","toolbar","errorMessage","severity","createElement","toolbarButtons","disableElevation","chartHeight","ref","alignItems","justifyContent","marginBottom","whiteSpace","marginLeft","flex","palette","main","DateTime","refTimer","useRef","setDateTime","city","setCity","sunrise","setSunrise","sunset","setSunset","refresh","_global","iobroker","latitude","longitude","getSunrise","getSunset","sun","mapOverview","left","bottom","zIndex","cursor","mapIconContainer","mapIconParent","boxShadow","mapIcon","content","mapTooltip","Map","defaultZoom","defaultPosition","setMarkers","memoizedMapInitialised","useCallback","memoizedHandleClick","flyTo","prevMarkers","mapMarkers","Marker","attributes","avatar","aria-label","arrow","useFlyTo","center","whenReady","attribution","url","markerIcon","offset","info","function","L","divIcon","html","iconSize","memoizedHandleMouseEvent","closeTooltip","openTooltip","riseOnHover","onMouseOver","direction","tooltipDirection","permanent","tooltipPermanent","StateListHorizontal","paper","Weather","setData","getRemoteResource","then","response","statusCode","body","weatherForecast","day","forecast","dailyForecast","date","justify","Multimedia","progress","progressTimeout","isRunning","duration","noHeader","styleImage","styleLengthBar","background","backgroundImage","backgroundUrlPrepend","playIconElements","Divider","image","noImage","information","informationLeft","grandParent","parent","informationRight","lengthBar","controls","controlsBox","controlsBoxLeft","controlsBoxCenter","Fab","controlButton","controlsBoxRight","backgroundPosition","minHeight","paddingTop","controlButtonSmall","MultimediaItem","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","resolve","module","exports","temperature","setTemperature","humidity","boost","Level","min","max","PowerAction","sliderMarkLabel","Action","secondaryAction","stateVal","parentOnChange","checked","setChecked","TriggerAction","startIcon","Label","linebreak","br","markSteps","markStep","markLabel","onChangeCommitted","defaultValue","valueLabelDisplay","marks","number","_any","battery","door","power","trigger","wind","gridContainer","GridContainer","contents","columns","grid","column","Grid","xs","sm","md","lg","xl","warn","success","green","dark","warning","amber","iconVariant","opacity","variantIcon","CheckCircleIcon","WarningIcon","ErrorIcon","InfoIcon","StatusSnackbar","autoHideDuration","closeButton","other","Icon","Snackbar","anchorOrigin","vertical","SnackbarContent","IconButton","blind","heating","jalousie","light","location","user","window","Function","functionType","functionId","toLowerCase","functions","defaultStyles","_isFunction","undefined","obj","EventEmitter","Device","deviceProperties","sysLang","room","_setProperties","stateSubscriptions","stateType","node","config","attribute","ignoredStates","ignoredState","hiddenStates","hideStates","hideState","stateOrAttribute","_getStateFromKey","Adapters","groups","group","formatDistanceToNow","lc","includeSeconds","addSuffix","pair","option","_getUserSetting","_getConfigurationSetting","property","forceDefault","stateProperty","deviceState","defaultIcon","subscribe","responses","Promise","reject","emit","getState","_updateDeviceState","subscribeDeviceState","historyCache","getStateHistory","res","subscribeState","params","child","appBar","flexGrow","menuButton","transition","flexShrink","userSelect","TopBar","connectionStatus","connectionStatusIcon","connectionStatusTooltip","AppBar","Toolbar","Typography","Tooltip","getWindowDimensions","innerWidth","innerHeight","paddingBottom","tabs","borderBottom","fixed","indicator","fullscreen","TabBar","selectTab","tabBarProps","tab","setTab","setFixed","handleScroll","threshold","scrollY","prevFixed","document","getElementById","offsetTop","offsetHeight","addEventListener","removeEventListener","renderedTabs","Tab","Tabs","selectedTab","TabPanel","renderedTab","windowDimensions","setWindowDimensions","handleResize","useWindowDimensions","mapHeight","setMapHeight","topBarHeight","setHidden","Box","role","ModuleSettings","DialogTitle","grey","disableTypography","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Popup","forceUpdate","allSettled","nextProps","nextState","closeDialog","Dialog","maxWidth","fullWidth","dividers","autoFocus","card","cardHeaderNoContents","cardAvatar","cardContent","Widget","iconStyle","Card","CardHeader","Avatar","CardContent","blue","pink","createMuiTheme","getGroup","groupId","Tag","Modules","getGridContents","gridContents","columnContents","Jarvis","tabTitle","notificationDrawer","dialog","dialogContents","layout","tabsEnabled","widgetProps","tabPanels","tabLabel","tabPanel","now","ThemeProvider","topBarTitle","getTabPanels","App","loaded","hostname","protocol","port","listeners","reason","connect","useSettings","getObject","processDevices","debug","email","LogRocket","init","uuid","identify","setLanguage","loadTranslations","pageTitle","pageFavicon","href","promises","results","result","deviceList","groupedDevices","deviceId","jarvis","processDevice","groupDevice","stringify","CircularProgress","topBar","tabBar","gridColumns","SkeletonLoader","Skeleton","animation","gridItem","loaders","random","loader","renderError","renderLoadingProgress","renderLoadingSkeleton","Boolean","match","ReactDOM","render","serviceWorker","ready","registration","unregister","HsvToRgb","h","r","g","f","p","q","v","RgbToHex","LightColorAction","colorSpace","setColorSpace","colors","Red","Green","Blue","Hue","Saturation","Brightness","LightColorComponent","initialColor","onChangeComplete","colorTemperature","hue","rgb","hsv","hex","setHue","hsl","Socket","io","timeout","query","statesSubscribes","attempts","stateChange","ids","cb","cbs","reg","task","hasOwnProperty","test","getObjectView","design","search","pattern","setUrl","setListeners","listener","setListener"],"mappings":"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","file":"static/js/main.6eae72af.chunk.js","sourcesContent":["import { format } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToSeconds(time) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\ttime = time.toString();\r\n\t\tlet format = time.split(':').length-1;\r\n\t\tlet [ hours, minutes, seconds ] = format > 1 ? time.split(':') : ('0:' + time).split(':');\r\n\t\ttime = parseInt(hours) * 3600 + parseInt(minutes) * 60 + parseInt(seconds);\r\n\t}\r\n\t\r\n\treturn parseInt(time);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToHoursMinutesSeconds(time, withHours = false) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\treturn time;\r\n\t}\r\n\t\r\n\ttime = parseInt(time);\r\n\twithHours = withHours || (time > 3600);\r\n\t\r\n\tif (Number.isNaN(time)) {\r\n\t\treturn withHours ? '00:00:00' : '00:00';\r\n\t}\r\n\t\r\n\tlet hours = '0' + Math.floor(time/3600);\r\n\tlet minutes = '0' + Math.floor(time/60);\r\n\tlet seconds = '0' + (time % 60);\r\n\t\r\n\treturn withHours ? [ hours.substr(-2), minutes.substr(-2), seconds.substr(-2) ].join(':') : [ minutes.substr(-2), seconds.substr(-2) ].join(':');\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction secondsToDateTime(seconds, dateTimeFormat = 'dd. MMM yyyy, HH:mm') {\r\n\treturn format(new Date(seconds*1000), dateTimeFormat, { locale: de });\r\n}\r\n\r\n\r\nexport default {\r\n\ttimeToSeconds,\r\n\ttimeToHoursMinutesSeconds,\r\n\tsecondsToDateTime\r\n}","/**\r\n * Internationalization\r\n * Based on https://raw.githubusercontent.com/ioBroker/adapter-react/master/src/i18n.js.\r\n * Copyright 2018-2019 bluefox <dogafox@gmail.com>\r\n *\r\n * MIT License\r\n *\r\n *\r\n */\r\nexport default class i18n {\r\n\r\n\t/*\r\n\t * holds the translations\r\n\t */\r\n\tstatic translations = {};\r\n\r\n\t/*\r\n\t * default language\r\n\t */\r\n\tstatic language = navigator.language || navigator.userLanguage || 'en';\r\n\r\n\t/**\r\n\t * Override default language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setLanguage(language) {\r\n\t\tif (language) {\r\n\t\t\ti18n.language = language;\r\n\t\t\tconsole.log('i18n: Set language to ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads multiple translations.\r\n\t *\r\n\t * @param\t{String|Array}\tlanguages\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslations(languages) {\r\n\t\t\r\n\t\tif (languages) {\r\n\t\t\tlanguages = Array.isArray(languages) ? languages : [languages];\r\n\t\t\tlanguages.forEach(language => i18n.loadTranslation(language));\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads a translation.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslation(language) {\r\n\t\t\r\n\t\tif (language) {\r\n\t\t\tlet translation;\r\n\t\t\ttry {\r\n\t\t\t\ttranslation = require('./i18n/' + language + '.js').default;\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tconsole.error(err.message);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\ti18n.setTranslation(language, translation);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a translation for language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @param\t{Object}\ttranslation\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setTranslation(language, translation) {\r\n\t\tif (language && translation) {\r\n\t\t\ti18n.translations[language] = { ...i18n.translations[language] || {}, ...translation };\r\n\t\t\tconsole.log('i18n: Set translations for language ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic getLanguage() {\r\n\t\treturn i18n.lang;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\t{String}\tword\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @param\t{Boolean}\t[options.ucFirst=false]\r\n\t * @param\t{Object}\t[placeholders={}]\r\n\t * @param\t{String}\t[language=i18n.language]\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic t(word, options = {}, placeholders = {}, language = i18n.language) {\r\n\t\t\r\n\t\tword = word.toString();\r\n\t\tif (i18n.translations[language]) {\r\n\t\t\t\r\n\t\t\t// check if word is concatenated\r\n\t\t\tif (word.indexOf('#') > -1) {\r\n\t\t\t\t\r\n\t\t\t\tlet parts = word.split('#');\r\n\t\t\t\twhile (parts.length > 0 && !i18n.translations[language][parts.join('#')]) {\r\n\t\t\t\t\tparts.shift();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tword = i18n.translations[language][parts.join('#')] || word;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tword = i18n.translations[language][word] || word;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// replace placeholders\r\n\t\tfor (let key in placeholders) {\r\n\t\t\tword = word.replace(RegExp('%' + key + '%', 'g'), placeholders[key]);\r\n\t\t}\r\n\t\t\r\n\t\t// options\r\n\t\tif (options.ucFirst) {\r\n\t\t\tword = word.charAt(0).toUpperCase() + word.slice(1);\r\n\t\t}\r\n\t\t\r\n\t\treturn word;\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListDivider: {\r\n\t\tmargin: '0 0 5px 0'\r\n\t},\r\n\tdefaultListIcon: props => ({\r\n\t\t...theme.components.icon,\r\n\t\t...props.styles\r\n\t}),\r\n\thorizontalListItem: {\r\n\t\tdisplay: 'inline-block',\r\n\t\ttextAlign: 'center',\r\n\t\tpaddingRight: '16px',\r\n\t\twidth: '140px',\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\thorizontalListItemIcon: {\r\n\t\tminWidth: 'auto'\r\n\t},\r\n\thorizontalListItemAction: {\r\n\t\ttextAlign: 'center',\r\n\t\ttop: 0,\r\n\t\tright: 0,\r\n\t\tposition: 'static',\r\n\t\ttransform: 'none',\r\n\t},\r\n\tverticalListItemAction: {\r\n\t\ttextAlign: 'right'\r\n\t},\r\n});\r\n\r\n\r\nconst ListItemIconElement = withStyles(styles)(props => {\r\n\tconst { customClassNames, children, classes } = props;\r\n\t\r\n\tlet classNames = Array.isArray(customClassNames) ? customClassNames : [customClassNames];\r\n\tclassNames = classNames.map(className => (classes[className] ? classes[className] : className));\r\n\t\r\n\treturn <span className={clsx(classNames)}>{children}</span>\r\n});\r\n\r\n\r\nclass StateListItem extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t\tthis.state[this.props.device.primaryStateKey] = this.props.device.getDeviceState() || {}\r\n\t\t\r\n\t\tif (this.props.device.secondaryStateKey) {\r\n\t\t\tthis.state[this.props.device.secondaryStateKey] = this.props.device.getDeviceState(this.props.device.secondaryStateKey) || {}\r\n\t\t}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\tthis.props.device.on('stateChange', (stateKey, state) => {\r\n\t\t\tif (stateKey === this.props.device.primaryStateKey || stateKey === this.props.device.secondaryStateKey) {\r\n\t\t\t\tthis.setState({ [stateKey]: state });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, device, component, action } = this.props;\r\n\t\t\r\n\t\tconst state = this.state[device.primaryStateKey];\r\n\t\tconst options = device.get('options');\r\n\t\t\r\n\t\tlet icon = device.getIcon(device.primaryStateKey, state.val);\r\n\t\tlet primary = device.getAction(device.primaryStateKey, device.options.primaryAction === false);\r\n\t\tlet secondary = action && this.state[device.secondaryStateKey] ? device.getAction(device.secondaryStateKey) : null;\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{options.divider && options.divider !== 'after' && <ListItem divider className={classes.defaultListDivider} />}\r\n\t\r\n\t<ListItem\r\n\t\tclassName={clsx(this.props.openDialog && classes.finger, horizontal && classes.horizontalListItem)}\r\n\t\tbutton={this.props.openDialog !== null}\r\n\t\tonClick={this.props.openDialog && this.openDialog.bind(this)}\r\n\t\t>\r\n\t\t\r\n\t\t<ListItemIcon className={clsx(horizontal && classes.horizontalListItemIcon)}>\r\n\t\t{icon === null ? <React.Fragment /> :\r\n\t\t\t<ListItemIconElement customClassNames={['defaultListIcon','mdi mdi-' + icon]} styles={device.getStyle('icon', device.primaryStateKey, state.val)} />\r\n\t\t}\r\n\t\t</ListItemIcon>\r\n\t\t\r\n\t\t<ListItemText\r\n\t\t\tprimary={(component && device.getComponent()) || device.getOption('label')}\r\n\t\t\tsecondary={(options.subtitle !== null ? (options.subtitle || (state && state.timeChanged) || null) : null)}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={ horizontal ? classes.horizontalListItemAction : classes.verticalListItemAction }>\r\n\t\t\t{!secondary ? primary : [ primary, <br key={'br_' + device.id} />, secondary ]}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t\r\n\t{options.divider && options.divider === 'after' && <ListItem divider style={{margin: '5px 0'}} />}\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateListItem);\r\n","import React from 'react'\r\nimport i18n from '../i18n'\r\n\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport StateListItem from './StateListItem'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListSectionDivider: {\r\n\t\tmargin: '5px 0 0 0'\r\n\t},\r\n\tdefaultListSectionDividerItem: {\r\n\t\tmargin: '6px 0 7px 0',\r\n\t\tpadding: '0 16px !important'\r\n\t},\r\n\tdefaultListSectionText: {\r\n\t\tmargin: 0,\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: '0 0 0 10px',\r\n\t\t}\r\n\t},\r\n\thorizontalList: {\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'row',\r\n\t\tflexWrap: 'wrap'\r\n\t}\r\n});\r\n\r\n\r\nconst ListDivider = withStyles(styles)(props => {\r\n\tconst { classes, getDevicesBySubgroup, subgroup, title, subgroupActions } = props;\r\n\t\r\n\tconst handleChangeOn = () => handleChange(true);\r\n\tconst handleChangeOff = () => handleChange(false);\r\n\tconst handleChange = targetStatus => {\r\n\t\t\r\n\t\tconst devices = getDevicesBySubgroup(subgroup);\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\tlet status = targetStatus;\r\n\t\t\tif (device.primaryStateKey === 'level') {\r\n\t\t\t\tstatus = status ? 100 : 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdevice.setDeviceState(null, status);\r\n\t\t});\r\n\t}\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t<ListItem divider className={classes.defaultListSectionDivider} />\r\n\t<ListItem className={classes.defaultListSectionDividerItem}>\r\n\t\t<ListItemText\r\n\t\t\tclassName={classes.defaultListSectionText}\r\n\t\t\tprimary={title}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction>\r\n\t\t{subgroupActions === null || subgroupActions === false ? null :\r\n\t\t\t<ButtonGroup color=\"primary\" size=\"small\">\r\n\t\t\t\t<Button onClick={handleChangeOn}>{i18n.t('on')}</Button>\r\n\t\t\t\t<Button onClick={handleChangeOff}>{i18n.t('off')}</Button>\r\n\t\t\t</ButtonGroup>\r\n\t\t}\r\n\t\t\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n</React.Fragment>\r\n\t\r\n\t);\r\n});\r\n\r\nclass StateList extends React.Component {\r\n\t\r\n\tgetDevicesBySubgroup(subgroup) {\r\n\t\t\r\n\t\tlet devices = [];\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\r\n\t\t\tif (subgroup === device.getOption('subgroup')) {\r\n\t\t\t\tdevices.push(device);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn devices;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, devices, settings, component, action, ...props } = this.props;\r\n\t\tlet subgroup;\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense={true} className={horizontal && classes.horizontalList}>\r\n\t{devices.map((device, i) => {\r\n\t\t\r\n\t\tconst listSection = subgroup !== null && device.options.subgroup !== null && device.options.subgroup !== subgroup && <ListDivider\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={'ListDivider-' + device.get('id')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetDevicesBySubgroup={this.getDevicesBySubgroup.bind(this)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroup={device.getOption('subgroup')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={device.options.subgroup}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroupActions={settings.subgroupActions || device.options.subgroupActions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tconst listItem = <StateListItem\r\n\t\t\t\t\t\t\t{...props}\r\n\t\t\t\t\t\t\tkey={'StateListItem-' + device.get('id')}\r\n\t\t\t\t\t\t\thorizontal={horizontal}\r\n\t\t\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t\t\tcomponent={component || false}\r\n\t\t\t\t\t\t\taction={action || true}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tsubgroup = device.getOption('subgroup');\r\n\t\treturn [ listSection, listItem ];\r\n\t})}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateList);\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport StopIcon from '@material-ui/icons/Stop';\r\n\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tvalue: props => ({\r\n\t\tfloat: 'left',\r\n\t\tlineHeight: '32px',\r\n\t\tmarginRight: '10px'\r\n\t}),\r\n\tnoBorder: {\r\n\t\tborderLeftColor: 'transparent'\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction BlindLevelAction(props) {\r\n\tconst { device, state, stateKey } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onGoUp = () => {\r\n\t\tsetLevel(100);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 100).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst onGoDown = () => {\r\n\t\tsetLevel(0);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 0).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst onStop = () => {\r\n\t\tsetActivity(false);\r\n\t\tdevice.setDeviceState('activity', true).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\t// level\r\n\tconst [level, setLevel] = useState(state.value);\r\n\tuseEffect(() => setLevel(state.value), [state.value]);\r\n\t\r\n\t// activity\r\n\tconst [activity, setActivity] = useState(null);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (device.states.activity && device.states.activity.state) {\r\n\t\t\tdevice.states.activity.state = typeof device.states.activity.state === 'string' ? { 'node': device.states.activity.state } : device.states.activity.state;\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('activity', true).catch(err => console.error(err));\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('stateChange', (sKey, s) => {\r\n\t\t\t\tif (sKey === 'activity') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet val = s.val;\r\n\t\t\t\t\t\r\n\t\t\t\t\t// HomeMatic\r\n\t\t\t\t\tif (device.options.manufacturer === 'HomeMatic') {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tswitch(val) {\r\n\t\t\t\t\t\t\tcase 1: // UP\r\n\t\t\t\t\t\t\tcase 2: // DOWN\r\n\t\t\t\t\t\t\t\tval = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tcase 3: // STABLE\r\n\t\t\t\t\t\t\tdefault: // UNKNOWN\r\n\t\t\t\t\t\t\t\tval = false;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t//\r\n\t\t\t\t\tsetActivity(val);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t}, [device]);\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t<div className={classes.value}>\r\n\t\t{level + state.unit}\r\n\t</div>\r\n\t\r\n\t<ButtonGroup size=\"small\">\r\n\t\t<Button color=\"primary\" onClick={onGoUp}><ExpandLessIcon /></Button>\r\n\t\t\t{activity !== null && <Button color=\"secondary\" style={{ borderRightColor: !activity ? 'transparent' : 'rgba(245, 0, 87, 0.5)' }} onClick={onStop} disabled={!activity}><StopIcon /></Button>}\r\n\t\t<Button color=\"primary\" style={activity !== null ? { borderLeftColor: !activity ? 'rgba(0, 0, 0, 0.26)' : 'transparent' } : {}} onClick={onGoDown}><ExpandMoreIcon /></Button>\r\n\t</ButtonGroup>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tlevel: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t},\r\n\t\tlevel2: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel2: defaults.components.LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tlevel: BlindLevelAction\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { format } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\n\r\nimport Connection from '../Connection'\r\nimport i18n from '../i18n'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport List from '@material-ui/core/List'\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport StarIcon from '@material-ui/icons/Star';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tnoUpdates: {\r\n\t\tfontStyle: 'italic',\r\n\t\ttextAlign: 'right',\r\n\t\tcolor: 'rgba(0, 0, 0, 0.54)'\r\n\t},\r\n\tUpdateAvailable: {\r\n\t\tcolor: '#CCAA00',\r\n\t},\r\n\tUpdatesListItem: {\r\n\t\tbackgroundColor: '#ffd700',\r\n\t\tcolor: '#fff',\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t\tpaddingLeft: theme.spacing(2)\r\n\t},\r\n\tUpdatesIndicator: {\r\n\t\tright: theme.spacing(3.75),\r\n\t\tbackgroundColor: '#CCAA00',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t\tcolor: '#fff',\r\n\t\ttextAlign: 'center',\r\n\t\tfontSize: '1rem !important'\r\n\t},\r\n\tStatusIndicator: {\r\n\t\tfontSize: '1.4rem'\r\n\t},\r\n\tloading: {\r\n\t\ttextAlign: 'center',\r\n\t\tmarginTop: '5px'\r\n\t},\r\n\tsmall: {\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t},\r\n\talive: {\r\n\t\tcolor: '#86d686'\r\n\t},\r\n\tnotAlive: {\r\n\t\tcolor: '#f7e43b'\r\n\t},\r\n\tdisabled: {\r\n\t\tcolor: '#bababa'\r\n\t}\r\n});\r\n\r\n\r\nclass AdapterStatus extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tadapterInformation: [],\r\n\t\t\tadapterAliveStatus: {},\r\n\t\t\tnewUpdates: false,\r\n\t\t\tupdatesJson: {},\r\n\t\t\tlastUpdateCheck: ''\r\n\t\t}\r\n\t\t\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\tthis.list = this.props.settings.list ? (Array.isArray(this.props.settings.list) ? this.props.settings.list : this.props.settings.list.split(',')) : null;\r\n\t\tthis.blacklist = this.props.settings.blacklist ? (Array.isArray(this.props.settings.blacklist) ? this.props.settings.blacklist : this.props.settings.blacklist.split(',')) : null;\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// retrieve updates\r\n\t\tif (this.props.settings.updates !== false) {\r\n\t\t\t\r\n\t\t\tlet updateStates = ['admin.0.info.newUpdates', 'admin.0.info.lastUpdateCheck', 'admin.0.info.updatesJson'];\r\n\t\t\tthis.socket.getStates(updateStates, (err, states) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tnewUpdates: states['admin.0.info.newUpdates'].val,\r\n\t\t\t\t\tlastUpdateCheck: states['admin.0.info.lastUpdateCheck'].val,\r\n\t\t\t\t\tupdatesJson: states['admin.0.info.updatesJson'].val\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// get state updates\r\n\t\t\t\tthis.socket.subscribeStates(updateStates, (id, update) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tid = id.substr(id.lastIndexOf('.')+1);\r\n\t\t\t\t\tconsole.log(id);\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (this.state[id] !== update.val) {\r\n\t\t\t\t\t\tthis.setState({ [id]: update.val }, () => console.log(this.state));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get adapter instances\r\n\t\tthis.socket.getAdapterInstances((err, instances) => {\r\n\t\t\t\r\n\t\t\tlet states = [];\r\n\t\t\tif (instances && instances.rows) {\r\n\t\t\t\tlet adapters = [];\r\n\t\t\t\t\r\n\t\t\t\t// states per instance to retrieve\r\n\t\t\t\tinstances.rows.forEach((instance, i) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get alive / connected states\r\n\t\t\t\t\tif ((!this.list || (this.list && this.list.indexOf(instance.value.common.name) > -1)) && (!this.blacklist || (this.blacklist && this.blacklist.indexOf(instance.value.common.name) === -1))) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tadapters.push(instance);\r\n\t\t\t\t\t\tstates = states.concat([\r\n\t\t\t\t\t\t\tinstance.id + '.alive',\r\n\t\t\t\t\t\t\tinstance.id + '.connected',\r\n\t\t\t\t\t\t\tinstance.id.replace('system.adapter.', '') + '.info.connection'\r\n\t\t\t\t\t\t]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// sort instances\r\n\t\t\t\tthis.setState({ adapterInformation: adapters.sort((item1, item2) => {\r\n\t\t\t\t\t\tif (item1.id > item2.id) return 1;\r\n\t\t\t\t\t\telse if (item2.id > item1.id) return -1;\r\n\t\t\t\t\t\telse return 0;\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// retrieve intial states\r\n\t\t\t\tthis.socket.getStates(states, (err, adapterAliveStatus) => {\r\n\t\t\t\t\tthis.setState({ adapterAliveStatus });\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get state updates\r\n\t\t\t\t\tthis.socket.subscribeStates(states, (id, aliveStatus) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (aliveStatus && (!this.state.adapterAliveStatus[id] || (aliveStatus.val !== this.state.adapterAliveStatus[id].val))) {\r\n\t\t\t\t\t\t\tthis.setState(prevState => ({ adapterAliveStatus: { ...prevState.adapterAliveStatus, [id]: aliveStatus } }));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\t// adapter updates\r\n\t\tconst updateList = (this.state.updatesJson && this.state.updatesJson.val && JSON.parse(this.state.updatesJson.val)) || {};\r\n\t\tconst updates = Object.keys(updateList).length\r\n\t\t\r\n\t\t// adapter instances\r\n\t\tlet adapterList = <ListItem key='loading' className={classes.loading}><CircularProgress size={20} /></ListItem>\r\n\t\t\r\n\t\tif (this.state.adapterInformation.length > 0) {\r\n\t\t\t\r\n\t\t\tadapterList = this.state.adapterInformation.map(adapter => {\r\n\t\t\t\tadapter.update = updateList[adapter.value.common.name] || false;\r\n\t\t\t\t\r\n\t\t\t\tconst enabled = adapter.value.common.enabled;\r\n\t\t\t\tconst alive = (this.state.adapterAliveStatus[adapter.id + '.alive'] && this.state.adapterAliveStatus[adapter.id + '.alive'].val) || false;\r\n\t\t\t\tconst connected = (this.state.adapterAliveStatus[adapter.id + '.connected'] && this.state.adapterAliveStatus[adapter.id + '.connected'].val) || false;\r\n\t\t\t\tconst connection = this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'] ? this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'].val : true;\r\n\t\t\t\t\r\n\t\t\t\tconst tooltip = i18n.t('Adapter') + ' ' + (enabled ? (alive && connected && connection ? i18n.t('alive') : i18n.t('not alive')) : i18n.t('disabled'));\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t\r\n\t\t\t\t\t<ListItem key={'adapter-' + adapter.id}>\r\n\t\t\t\t\t\t<ListItemAvatar>\r\n\t\t\t\t\t\t\t<Avatar alt={adapter.value.common.name} src={adapter.value.common.extIcon} className={classes.small} />\r\n\t\t\t\t\t\t</ListItemAvatar>\r\n\t\t\t\t\t\t<ListItemText\r\n\t\t\t\t\t\t\tprimary={adapter.value.common.title}\r\n\t\t\t\t\t\t\tsecondary={[\r\n\t\t\t\t\t\t\t\t'v' + adapter.value.common.version,\r\n\t\t\t\t\t\t\t\t(adapter.update && (<span key={'updates-' + adapter.id}>, <span className={classes.UpdateAvailable}>{i18n.t('Update available') + ' v' + adapter.update.availableVersion}</span></span>)),\r\n\t\t\t\t\t\t\t\t(adapter.value.common.runAsCompactMode && ', ' + i18n.t('Compact Mode') + ' ' + i18n.t('on') + ' (' + i18n.t('Group') + ' ' + adapter.value.common.compactGroup + ')')\r\n\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, enabled ? (alive && connected && connection ? classes.alive : classes.notAlive) : classes.disabled)}>\r\n\t\t\t\t\t\t\t<Tooltip title={tooltip}>\r\n\t\t\t\t\t\t\t\t<span className={enabled ? (alive && connected && connection ? 'mdi mdi-check-circle' : 'mdi mdi-alert') : 'mdi mdi-close'}></span>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t\t\t</ListItem>\r\n\t\t\t\t\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense>\r\n\t{this.state.newUpdates === false ? (this.state.lastUpdateCheck && \r\n\t<ListItem key=\"updates\" classes={{ root: classes.noUpdates }}>\r\n\t\t<ListItemText\r\n\t\t\tprimary={i18n.t('last update') + ': ' + format(new Date(this.state.lastUpdateCheck), 'dd.MM.yyyy HH:mm:ss', { locale: de })}\r\n\t\t\t/>\r\n\t\t\r\n\t</ListItem>)\r\n\t:\r\n\t<ListItem key=\"updates\" classes={{ container: classes.UpdatesListItem }}>\r\n\t\t<ListItemAvatar>\r\n\t\t\t<StarIcon />\r\n\t\t</ListItemAvatar>\r\n\t\t<ListItemText\r\n\t\t\tprimary={i18n.t('Updates available') + '!'}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, classes.UpdatesIndicator)}>\r\n\t\t\t{updates}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t}\r\n\t\r\n\t{adapterList}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport const Settings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Adapter Status'),\r\n\ticon: 'traffic-light'\r\n}\r\n\r\nexport default withStyles(styles)(AdapterStatus);\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { Line } from 'react-chartjs-2'\r\n// eslint-disable-next-line\r\nimport chartjs_colorschemes from 'chartjs-plugin-colorschemes'\r\n// eslint-disable-next-line\r\nimport chartjs_zoom from 'chartjs-plugin-zoom'\r\n\r\nimport deLocale from 'date-fns/locale/de'\r\nimport DateFnsUtils from '@date-io/date-fns'\r\n\r\nimport i18n from '../i18n'\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport Alert from '@material-ui/lab/Alert'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport { MuiPickersUtilsProvider, DateTimePicker } from '@material-ui/pickers'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport Select from '@material-ui/core/Select'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CalendarIcon from '@material-ui/icons/Event'\r\nimport CalendarTodayIcon from '@material-ui/icons/EventAvailable'\r\nimport HistoryIcon from '@material-ui/icons/History'\r\nimport FastRewindIcon from '@material-ui/icons/FastRewind'\r\n//import DisablePan from '@material-ui/icons/SelectAll'\r\n//import DisableZoom from '@material-ui/icons/LocationDisabled'\r\nimport ResetZoom from '@material-ui/icons/ZoomOutMap'\r\nimport LiveUpdates from '@material-ui/icons/Update'\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tloading: {\r\n\t\tposition: 'absolute',\r\n\t\tbackgroundColor: 'rgba(0, 0, 0, 0.3)',\r\n\t\twidth: '100%',\r\n\t\theight: '100%',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'center',\r\n\t},\r\n\terrorMessage: {\r\n\t\tmarginBottom: 5,\r\n\t\tmarginRight: 15,\r\n\t\twidth: '100%'\r\n\t},\r\n\ttoolbar: {\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\ttoolbarButtons: {\r\n\t\tdisplay: 'initial',\r\n\t\twhiteSpace: 'nowrap'\r\n\t},\r\n\toptions: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t},\r\n\tdatePicker: {\r\n\t\tpadding: '2px 4px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tmargin: 2\r\n\t},\r\n\tinput: {\r\n\t\tmarginLeft: theme.spacing(1),\r\n\t\tflex: 1,\r\n\t},\r\n\tselect: {\r\n\t\twidth: 100\r\n\t},\r\n\ticon: {\r\n\t\tmargin: 10,\r\n\t},\r\n\ticonButton: {\r\n\t\tpadding: 10,\r\n\t},\r\n\tdivider: {\r\n\t\tmargin: '15px 0',\r\n\t},\r\n\tdividerVertical: {\r\n\t\theight: 28,\r\n\t\tmargin: 4,\r\n\t},\r\n\tbutton: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff !important',\r\n\t\tmargin: '4px'\r\n\t},\r\n\tbuttonDisabled: {\r\n\t\tbackgroundColor: '#eee',\r\n\t\tmargin: '4px'\r\n\t}\r\n});\r\n\r\n\r\nclass Chart extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\t// chart settings\r\n\t\tthis.chartFilter = this.props.settings.chartFilter || {};\r\n\t\tthis.chartConfig = this.props.settings.chartConfig || {};\r\n\t\t\r\n\t\tthis.chartConfig.yAxes = this.chartConfig.yAxes || [];\r\n\t\tthis.chartConfig.yAxes.unshift({\r\n\t\t\tid: 'left',\r\n\t\t\ttype: 'linear',\r\n\t\t\tposition: 'left',\r\n\t\t\tticks: {\r\n\t\t\t\tcallback: value => (this.chartConfig.yLeftAxisUnitBefore || '') + Number.parseFloat(value).toFixed(1) + (this.chartConfig.yLeftAxisUnitAfter || '')\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// states\r\n\t\tthis.state = {\r\n\t\t\tloading: true,\r\n\t\t\terrors: [],\r\n\t\t\t\r\n\t\t\tdatePicker: false,\r\n\t\t\tselectedTimeRangeValue: (this.chartFilter && this.chartFilter.selectedTimeRangeValue) || 1,\r\n\t\t\tselectedTimeRangeUnit: (this.chartFilter && this.chartFilter.selectedTimeRangeUnit) || 'days',\r\n\t\t\tselectedDateTime: (this.chartFilter && this.chartFilter.selectedDateTime && new Date(this.chartFilter.selectedDateTime)) || new Date(),\r\n\t\t\tdateNow: this.chartFilter && this.chartFilter.selectedDateTime ? false : true,\r\n\t\t\t\r\n\t\t\tchartLabels: [],\r\n\t\t\tchartData: {\r\n\t\t\t\tlabels: [],\r\n\t\t\t\tdatasets: []\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tchartPan: true,\r\n\t\t\tchartZoom: true\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tthis.timer = null;\r\n\t\tthis.timeRangeRef = React.createRef();\r\n\t\t\r\n\t\t// chart instance options\r\n\t\tthis.chartRef = React.createRef();\r\n\t\tthis.chartUpdates = {};\r\n\t\tthis.chartOptions = {\r\n\t\t\tmaintainAspectRatio: false,\r\n\t\t\tspanGaps: true,\r\n\t\t\tlegend: {\r\n\t\t\t\tonClick: this.legendClickHandler.bind(this)\r\n\t\t\t},\r\n\t\t\ttooltips: {\r\n\t\t\t\tcallbacks: {\r\n\t\t\t\t\tlabel: (item, data) => data.datasets[item.datasetIndex].label + ': ' + item.value + data.datasets[item.datasetIndex].unit\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tscales: {\r\n\t\t\t\tyAxes: this.chartConfig.yAxes\r\n\t\t\t},\r\n\r\n\t\t\tplugins: {\r\n\t\t\t\tcolorschemes: {\r\n\t\t\t\t\tscheme: 'brewer.SetOne9'\r\n\t\t\t\t},\r\n\t\t\t\tzoom: {\r\n\t\t\t\t\t// Container for pan options\r\n\t\t\t\t\tpan: {\r\n\t\t\t\t\t\t// Boolean to enable panning\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Panning directions\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Container for zoom options\r\n\t\t\t\t\tzoom: {\r\n\t\t\t\t\t\t// Boolean to enable zooming\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Zooming directions.\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// request initial history data\r\n\t\tlet options = { ...this.getTimeRange(), axis: this.getAxis() };\r\n\t\t\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\tdevice.label = device.name + ' (' + i18n.t(device.primaryStateKey) + ')';\r\n\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// add listeners for newly requested data\r\n\t\t\tdevice.on('historyChange', (stateKey, history, state) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.addChartGraph(device, history, { ...options, axis: this.getAxis(options.start, options.end) } );\r\n\t\t\t\tthis.setState({ loading: false });\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// add listeners for data updates\r\n\t\t\tif (this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow) {\r\n\t\t\t\t\r\n\t\t\t\tdevice.on('stateChange', (stateKey, val, state) => this.updateChartGraph(device, val, { ...options, axis: this.getAxis(options.end, new Date()) } ));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tif (this.state.selectedTimeRangeValue &&\r\n\t\t\t\t(prevState.selectedDateTime !== this.state.selectedDateTime || prevState.selectedTimeRangeValue !== this.state.selectedTimeRangeValue || prevState.selectedTimeRangeUnit !== this.state.selectedTimeRangeUnit)\r\n\t\t\t) {\r\n\t\t\t\r\n\t\t\t// request updated history data\r\n\t\t\tthis.setState({ loading: true, errors: [] });\r\n\t\t\t\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\r\n\t\t\t\tconst options = this.getTimeRange();\r\n\t\t\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => {\r\n\t\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t}\r\n\t\r\n\tgetTimeRange() {\r\n\t\t\r\n\t\tconst end = this.state.selectedDateTime.getTime();\r\n\t\tlet timeRange = this.state.selectedTimeRangeValue;\r\n\t\tlet step = 1;\r\n\t\tlet axisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\r\n\t\tswitch(this.state.selectedTimeRangeUnit) {\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'seconds':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'minutes':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\ttimeRange = timeRange*60;\r\n\t\t\t\t//step = step;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'hours':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60;\r\n\t\t\t\tstep = step*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'days':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60*24;\r\n\t\t\t\tstep = step*60*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'months':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*31;\r\n\t\t\t\tstep = step*60*60*24;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'years':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*365;\r\n\t\t\t\tstep = step*60*60*24*31;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\t'axisTimeFormat': axisTimeFormat,\r\n\t\t\t'start': end-timeRange*1000,\r\n\t\t\t'end': end,\r\n\t\t\t'timeRange': timeRange*1000,\r\n\t\t\t'step': step*1000\r\n\t\t};\r\n\t}\r\n\t\r\n\tgetAxis(start, end) {\r\n\t\t\r\n\t\tconst { step, axisTimeFormat } = this.getTimeRange();\r\n\t\tlet axis = {};\r\n\t\t\r\n\t\tfor (let time = start; time <= end; time += step) {\r\n\t\t\taxis[time] = helpers.secondsToDateTime(time/1000, axisTimeFormat);\r\n\t\t}\r\n\t\t\r\n\t\treturn axis;\r\n\t}\r\n\t\r\n\tgroupChartData(chartData, axis) {\r\n\t\t\r\n\t\tlet prevMarker;\r\n\t\tlet data = [];\r\n\t\t\r\n\t\tlet markers = Object.keys(axis);\r\n\t\tmarkers.forEach((marker, i) => {\r\n\t\t\tprevMarker = markers[(i-1 > 0 ? i-1 : 0)];\r\n\t\t\t\r\n\t\t\tfor (let index in chartData) {\r\n\t\t\t\tlet entry = chartData[index];\r\n\t\t\t\tentry.val = parseFloat(entry.val);\r\n\t\t\t\t\r\n\t\t\t\t// \r\n\t\t\t\tif (!entry.ts || entry.val === null) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// before range, continue\r\n\t\t\t\tif (prevMarker > entry.ts) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// in range\r\n\t\t\t\telse if (prevMarker < entry.ts && entry.ts <= marker) {\r\n\t\t\t\t\tdata[i] = !data[i] ? [ entry.val ] : [ ...data[i], entry.val ]; // parseFloat((data[i] ? ((data[i]+entry.val)/2) : entry.val).toFixed(2));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// beyond range, so next marker\r\n\t\t\t\telse if (entry.ts > marker) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif (!data[i]) {\r\n\t\t\t\t// \r\n\t\t\t}\r\n\t\t\telse if (data[i].length === 1) {\r\n\t\t\t\tdata[i] = data[i][0];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdata[i] = data[i].reduce((a,b) => a + b, 0) / data[i].length;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn data;\r\n\t}\r\n\t\r\n\tupdateChartGraph(device, value, options) {\r\n\t\t\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex === -1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tthis.chartUpdates[chartIndex] = this.chartUpdates[chartIndex] || [];\r\n\t\tthis.chartUpdates[chartIndex].push({\r\n\t\t\t'ts': value.ts,\r\n\t\t\t'val': value.val\r\n\t\t});\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(this.chartUpdates[chartIndex], options.axis);\r\n\t\t\r\n\t\t//console.log(value);\r\n\t\t//console.log(options, options.axis, data);\r\n\t\t\r\n\t\t// update chart\r\n\t\tthis.chartRef.current.chartInstance.data.labels = [ ...this.state.chartData.labels, ...Object.values(options.axis) ];\r\n\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = [ ...this.state.chartData.datasets[chartIndex].data, ...data ];\r\n\t\tthis.chartRef.current.chartInstance.update();\r\n\t}\r\n\t\r\n\taddChartGraph(device, history, options) {\r\n\t\t\r\n\t\t// only add chart if data is given\r\n\t\tif (!history || !history.length) {\r\n\t\t\tlet error = i18n.t('No history data given for %s').replace('%s', device.label) + '!';\r\n\t\t\tthis.setState(prevStates => ({ errors: [ ...prevStates.errors, error ] }));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(history, options.axis);\r\n\t\t\r\n\t\t// update chart\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex > -1) {\r\n\t\t\tthis.chartRef.current.chartInstance.data.labels = Object.values(options.axis);\r\n\t\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = data;\r\n\t\t\tthis.chartRef.current.chartInstance.update();\r\n\t\t}\r\n\t\t\r\n\t\t// index chart\r\n\t\telse {\r\n\t\t\tthis.setState(prevStates => ({ chartLabels: [ ...prevStates.chartLabels, device.label ] }));\r\n\t\t\t\r\n\t\t\t// chart dataset\r\n\t\t\tlet dataSet = {\r\n\t\t\t\tlabel: device.label,\r\n\t\t\t\tunit: device.states[device.primaryStateKey].state.value.unit || '',\r\n\t\t\t\tfill: false,\r\n\t\t\t\t...device.options.graphConfig || {},\r\n\t\t\t\tdata: data\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t// add data to chart\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\taxisTimeFormat: options.axisTimeFormat,\r\n\t\t\t\tchartData: {\r\n\t\t\t\t\tlabels: Object.values(options.axis),\r\n\t\t\t\t\tdatasets: [ ...prevStates.chartData.datasets, dataSet ],\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\t\r\n\tlegendClickHandler(e, legendItem) {\r\n\t\t\r\n\t\tlet index = legendItem.datasetIndex;\r\n\t\tlet ci = this.chartRef.current.chartInstance;\r\n\t\tlet meta = ci.getDatasetMeta(index);\r\n\r\n\t\tmeta.hidden = meta.hidden === null ? !ci.data.datasets[index].hidden : null;\r\n\t\tci.update();\r\n\t\tci.resetZoom();\r\n\t}\r\n\t\r\n\tdisablePan() {\r\n\t\tlet pan = this.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled = (pan === false);\r\n\t\tthis.setState({ chartPan: (pan === false) });\r\n\t}\r\n\t\r\n\tdisableZoom() {\r\n\t\tlet zoom = this.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled = (zoom === false);\r\n\t\tthis.setState({ chartZoom: (zoom === false) });\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, settings } = this.props;\r\n\t\treturn (\r\n\r\n<div>\r\n\t<div className={classes.options}>\r\n\t\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('Period shown in Chart')}>\r\n\t\t\t\t<HistoryIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<InputBase\r\n\t\t\t\tinputRef={this.timeRangeRef}\r\n\t\t\t\tclassName={classes.input}\r\n\t\t\t\tvalue={this.state.selectedTimeRangeValue}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeValue: event.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<Select\r\n\t\t\t\tvalue={this.state.selectedTimeRangeUnit}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeUnit: event.target.value })}\r\n\t\t\t\tdisplayEmpty\r\n\t\t\t\tdisableUnderline\r\n\t\t\t\tclassName={classes.select}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<MenuItem value=\"seconds\">{i18n.t('Seconds')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"minutes\">{i18n.t('Minutes')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"hours\">{i18n.t('Hours')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"days\">{i18n.t('Days')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"months\">{i18n.t('Months')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"years\">{i18n.t('Years')}</MenuItem>\r\n\t\t\t</Select>\r\n\t\t\t\r\n\t\t\t{/*\r\n\t\t\t<IconButton className={classes.iconButton} onClick={() => this.timeRangeRef.current.focus()}>\r\n\t\t\t\t<CalendarIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t*/}\r\n\t\t</Paper>\r\n\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('End date')}>\r\n\t\t\t\t<FastRewindIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<MuiPickersUtilsProvider locale={deLocale} utils={DateFnsUtils}>\r\n\t\t\t\t<DateTimePicker\r\n\t\t\t\t\tclassName={classes.input}\r\n\t\t\t\t\tvalue={this.state.selectedDateTime}\r\n\t\t\t\t\tonChange={selectedDateTime => this.setState({ selectedDateTime: selectedDateTime, dateNow: false })}\r\n\t\t\t\t\t\r\n\t\t\t\t\topen={this.state.datePicker}\r\n\t\t\t\t\tonOpen={() => this.setState({ datePicker: true })}\r\n\t\t\t\t\tonClose={() => this.setState({ datePicker: false })}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvariant=\"inline\"\r\n\t\t\t\t\tampm={false}\r\n\t\t\t\t\tformat='dd.MM.yyyy HH:mm'\r\n\t\t\t\t\tInputProps={{\r\n\t\t\t\t\t\tdisableUnderline: true,\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</MuiPickersUtilsProvider>\r\n\t\t\t\r\n\t\t\t<Tooltip title={i18n.t('Select end date')}>\r\n\t\t\t\t<IconButton color=\"primary\" className={classes.iconButton} onClick={() => this.setState({ datePicker: true })}>\r\n\t\t\t\t\t<CalendarIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t\t<Divider className={classes.dividerVertical} orientation=\"vertical\" />\r\n\t\t\t<Tooltip title={i18n.t('Select today as end date')}>\r\n\t\t\t\t<IconButton className={classes.iconButton} onClick={() => this.setState({ selectedDateTime: new Date(), dateNow: true })}>\r\n\t\t\t\t\t<CalendarTodayIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t</Paper>\r\n\t\t\r\n\t\t<Tooltip title={i18n.t('Live updates are ' + (this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow ? 'on' : 'off'))} placement=\"top\" style={{ display: 'flex' }}>\r\n\t\t\t<span>\r\n\t\t\t\t<Button disabled={true} className={clsx(classes.datePicker, this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow ? classes.button : classes.buttonDisabled)}>\r\n\t\t\t\t\t<LiveUpdates />\r\n\t\t\t\t</Button>\r\n\t\t\t</span>\r\n\t\t</Tooltip>\r\n\t\t\r\n\t</div>\r\n\t<Divider className={classes.divider} />\r\n\t\r\n\t<div className={classes.toolbar}>\r\n\t\t<div className={classes.errorMessage}>\r\n\t\t\t{this.state.errors.length > 0 && <Alert severity=\"error\">{this.state.errors.map((error, i) => [ error, React.createElement('br', { key: 'br-error-' + i }) ])}</Alert>}\r\n\t\t</div>\r\n\t\t\r\n\t\t<ButtonGroup className={classes.toolbarButtons} color=\"primary\">\r\n\t\t{/*\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartPan ? 'contained' : 'outlined'} onClick={this.disablePan.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartPan ? 'Disable panning' : 'Enable panning')}>\r\n\t\t\t\t\t<DisablePan />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartZoom ? 'contained' : 'outlined'} onClick={this.disableZoom.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartZoom ? 'Disable Zoom' : 'Enable Zoom')}>\r\n\t\t\t\t\t<DisableZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t*/}\r\n\t\t\t<Button disableElevation={true} variant=\"contained\" onClick={() => this.chartRef.current.chartInstance.resetZoom()}>\r\n\t\t\t\t<Tooltip title={i18n.t('Reset Zoom')}>\r\n\t\t\t\t\t<ResetZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t</ButtonGroup>\r\n\t</div>\r\n\t\r\n\t<div className={'chart-container'} style={{ position: 'relative', height: settings.chartHeight || '500px' }}>\r\n\t\t{this.state.loading && <div className={classes.loading}>\r\n\t\t\t<CircularProgress />\r\n\t\t</div>}\r\n\t\t\r\n\t\t<Line\r\n\t\t\tref={this.chartRef}\r\n\t\t\tdata={this.state.chartData}\r\n\t\t\toptions={this.chartOptions}\r\n\t\t\t/>\r\n\t\t\t\r\n\t</div>\r\n</div>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Chart);\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport { format } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\nimport { getSunrise, getSunset } from 'sunrise-sunset-js'\r\n\r\nimport i18n from '../i18n'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\n\r\n\r\nexport default function DateTime(props) {\r\n\tconst { settings } = props;\r\n\t\r\n\tconst refTimer = useRef();\r\n\tconst [DateTime, setDateTime] = useState(format(new Date(), settings.format, { locale: de }));\r\n\tconst [city, setCity] = useState('');\r\n\tconst [sunrise, setSunrise] = useState('');\r\n\tconst [sunset, setSunset] = useState('');\r\n\t\r\n\t// https://date-fns.org/v2.9.0/docs/format\r\n\tsettings.style = { fontSize: '1.5rem', textAlign: 'center', ...settings.style };\r\n\tsettings.format = settings.format || 'dd.MM.yyyy HH:mm:ss';\r\n\tsettings.refresh = settings.format.indexOf('s') > -1 ? 1000 : (settings.format.indexOf('i') > -1 ? 60*1000 : 60*60*1000);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tclearTimeout(refTimer.current);\r\n\t\trefTimer.current = setTimeout(() => setDateTime(format(new Date(), settings.format, { locale: de })), settings.refresh);\r\n\t\t\r\n\t\t//\r\n\t\tif (settings._global.iobroker.latitude && settings._global.iobroker.longitude) {\r\n\t\t\tsetSunrise(getSunrise(settings._global.iobroker.latitude, settings._global.iobroker.longitude));\r\n\t\t\tsetSunset(getSunset(settings._global.iobroker.latitude, settings._global.iobroker.longitude));\r\n\t\t}\r\n\t\t\r\n\t\tif (settings._global.iobroker.city) {\r\n\t\t\tsetCity(settings._global.iobroker.city);\r\n\t\t}\r\n\t\t\r\n\t}, [settings]);\r\n\t\r\n\treturn (\r\n\r\n<div style={settings.style}>\r\n\t{i18n.t('%DateTime').replace(/%DateTime/, DateTime)}\r\n\t\r\n\t{settings.sun !== false && <div style={{ margin: '5px 0', fontSize: '1.2rem' }}>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-city-variant-outline\"></span> {city ? city : <CircularProgress size=\"1.2rem\" />}\r\n\t\t<span style={{ margin: '0 10px' }}></span>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-weather-sunset-up\"></span> {sunrise ? format(sunrise, 'HH:mm') : <CircularProgress size=\"1.2rem\" />}\r\n\t\t<span style={{ margin: '0 10px' }}></span>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-weather-sunset-down\"></span> {sunset ? format(sunset, 'HH:mm') : <CircularProgress size=\"1.2rem\" />}\r\n\t</div>\r\n\t}\r\n\t\r\n</div>\r\n\r\n\t);\r\n}\r\n\r\nexport const Settings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Time'),\r\n\ticon: 'clock-outline'\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport L from 'leaflet'\r\nimport { Map as LeafletMap, TileLayer, Marker as LeafletMarker, Tooltip as LeafletTooltip } from 'react-leaflet'\r\n\r\nimport i18n from '../i18n'\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tmap: {\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapOverview: {\r\n\t\tcolor: '#666',\r\n\t\tposition: 'absolute',\r\n\t\tleft: 0,\r\n\t\tbottom: 0,\r\n\t\twidth: '100%',\r\n\t\theight: '60px',\r\n\t\tzIndex: 999,\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\t\r\n\t\t'& > *': {\r\n\t\t\tmargin: theme.spacing(1),\r\n\t\t\tcursor: 'pointer',\r\n\t\t},\r\n\t},\r\n\t/*\r\n\t * MARKER WITH ICON\r\n\t *\r\n\tmapIconContainer: {\r\n\t\tbackgroundImage: 'url(\"https://unpkg.com/leaflet@1.6.0/dist/images/marker-icon-2x.png\")',\r\n\t\tbackgroundSize: '100% 100%'\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tborderRadius: '10px',\r\n\t\theight: '20px',\r\n\t\twidth: '20px',\r\n\t\tmargin: '3px auto',\r\n\t\ttextAlign: 'center'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '1.2rem',\r\n\t\tdisplay: 'block',\r\n\t\tmargin: '-4px 0 0 1px',\r\n\t\tcolor: '#f00',\r\n\t\tposition: 'absolute'\r\n\t}\r\n\t*/\r\n\tmapIconContainer: {\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tboxShadow: '0 0 0 8px rgba(255, 255, 255, 0.3)',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '2rem',\r\n\t\tcolor: theme.palette.primary.main,\r\n\t\ttransform: 'translate3d(4px, -4px,0)', /* for fontSize: '2.3rem' -> 'translate3d(2px, -8px,0)', */\r\n\t\tdisplay: 'block',\r\n\t\t\r\n\t\t'&:after': {\r\n\t\t\tcontent: '\"\"',\r\n\t\t\tdisplay: 'block',\r\n\t\t\tpadding: '50% 0%'\r\n\t\t}\r\n\t},\r\n\tmapTooltip: {\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Map(props) {\r\n\tconst { settings, devices } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [zoom,] = useState(settings.component.defaultZoom);\r\n\tconst [position,] = useState(settings.component.defaultPosition ? (Array.isArray(settings.component.defaultPosition) ? settings.component.defaultPosition : settings.component.defaultPosition.split(',')) : [ settings._global.iobroker.latitude, settings._global.iobroker.longitude ]);\r\n\tconst [markers, setMarkers] = useState({});\r\n\t\r\n\t// map instance\r\n\tconst map = useRef();\r\n\tconst memoizedMapInitialised = useCallback(function() {map.current = this}, [],);\r\n\t\r\n\t// Marker click in overview\r\n\tconst memoizedHandleClick = useCallback(flyTo => map.current.flyTo(flyTo.split(',')), [],);\r\n\t\r\n\t// get gps position coordinates\r\n\tuseEffect(() => {\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('position').catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\t\r\n\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\tif (!prevMarkers[device.id]) {\r\n\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: null };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('stateChange', (stateKey, state) => {\r\n\t\t\t\t\r\n\t\t\t\tif (stateKey === 'position') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\t\tif (!prevMarkers[device.id] || prevMarkers[device.id].position !== state.val) {\r\n\t\t\t\t\t\t\tdevice.options.position = state.val;\r\n\t\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: device };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\r\n\t}, [devices]);\r\n\t\r\n\t// add markers\r\n\tlet mapMarkers = [], mapOverview = [];\r\n\tif (devices.length > 0 && devices.length === Object.keys(markers).length) {\r\n\t\t\r\n\t\tfor (let key in markers) {\r\n\t\t\tlet device = markers[key];\r\n\t\t\tif (device !== null) {\r\n\t\t\t\tlet marker = <Marker key={'marker-' + device.id} position={device.options.position} device={device} settings={settings.component} />\r\n\t\t\t\tmapMarkers.push(marker);\r\n\t\t\t\t\r\n\t\t\t\tlet item = null;\r\n\t\t\t\tif (device.attributes.avatar) {\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} src={device.attributes.avatar} onClick={() => memoizedHandleClick(device.options.position)} />\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tconst icon = device.getIcon('position');\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} onClick={() => memoizedHandleClick(device.options.position)}><span className={clsx('mdi mdi-' + icon)}></span></Avatar>\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tmapOverview.push(<Tooltip key={'tooltip-' + device.id} title={device.name} aria-label={device.name} arrow>{item}</Tooltip>);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Box className={classes.mapOverview}>\r\n\t\t<Typography>{i18n.t('Jump to')}:</Typography>\r\n\t\t{mapOverview}\r\n\t</Box>\r\n\t<LeafletMap useFlyTo={true} center={position} zoom={zoom} className={classes.map} whenReady={memoizedMapInitialised}>\r\n\t\t<TileLayer\r\n\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n\t\t\turl='https://{s}.tile.osm.org/{z}/{x}/{y}.png'\r\n\t\t\t/>\r\n\t\t\r\n\t\t{mapMarkers}\r\n\t</LeafletMap>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nfunction Marker(props) {\r\n\tconst { position, device, settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tlet markerIcon = null, offset = 40;\r\n\tconsole.info('Marker for ' + device.function + ' ' + device.name + ' added to map.');\r\n\t\r\n\t// Marker with avatar / picture\r\n\tif (device.attributes && device.attributes.avatar && device.attributes.avatar.substr(0, 11) === 'data:image/') {\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<img src=\"' + device.attributes.avatar + '\" class=\"' + classes.mapIconParent + '\" />',\r\n\t\t\ticonSize: [ 64, 64 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker with Icon\r\n\telse {\r\n\t\toffset = 30;\r\n\t\tconst icon = device.getIcon('position');\r\n\t\t\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<div class=\"' + classes.mapIconParent + '\"><span class=\"' + clsx(classes.mapIcon, 'mdi mdi-' + icon) + '\"></span></div>',\r\n\t\t\ticonSize: [ 40, 40 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker MouseOver / MouseOut (bring tooltip to front if markers overlay)\r\n\tconst memoizedHandleMouseEvent = useCallback(function() {this.closeTooltip().openTooltip()}, [],);\r\n\r\n\treturn (\r\n\r\n<LeafletMarker riseOnHover={true} position={Array.isArray(position) ? position : position.split(',')} icon={markerIcon} onMouseOver={memoizedHandleMouseEvent}>\r\n\t<LeafletTooltip className={classes.mapTooltip} direction={settings.tooltipDirection || 'bottom'} permanent={settings.tooltipPermanent || true} offset={[0,offset]}>\r\n\t\t{device.name}\r\n\t</LeafletTooltip>\r\n</LeafletMarker>\r\n\r\n\t);\r\n}","import React from 'react'\r\n\r\nimport StateList from './StateList'\r\n\r\n\r\nexport default function StateListHorizontal(props) {\r\n\treturn (<StateList horizontal={true} {...props} />);\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\n\r\nimport Connection from '../Connection'\r\nimport i18n from '../i18n'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tpaper: {\r\n\t\twidth: 100,\r\n\t\theight: 160,\r\n\t\tpadding: 5,\r\n\t\ttextAlign: 'center',\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Weather(props) {\r\n\tconst { settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [data,setData] = useState(null);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tConnection.getConnection.getRemoteResource(settings.url).then(\r\n\t\t\tresponse => {\r\n\t\t\t\t\r\n\t\t\t\tif (response.statusCode === 200) {\r\n\t\t\t\t\tsetData(JSON.parse(response.body));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terror => console.error(error)\r\n\t\t);\r\n\t\t\r\n\t}, [settings.url]);\r\n\t\r\n\tlet weatherForecast = [];\r\n\t//console.log(data);\r\n\t\r\n\tif (!data) {\r\n\t\treturn null;\r\n\t}\r\n\telse {\r\n\t\tfor (let day in data.day) {\r\n\t\t\tlet forecast = data.day[day];\r\n\t\t\tforecast.title = day === 1 ? i18n.t('today') : (day === 2 ? i18n.t('tomorrow') : forecast.name);\r\n\t\t\t\r\n\t\t\tconst dailyForecast = (\r\n\r\n<Grid key={'day-' + day} item>\r\n\t<Paper className={classes.paper}>\r\n\t\t<Typography variant=\"body1\">\r\n\t\t\t{forecast.title}\r\n\t\t</Typography>\r\n\t\t<Typography variant=\"caption\">\r\n\t\t\t{forecast.date}\r\n\t\t</Typography>\r\n\r\n\r\n\t</Paper>\r\n</Grid>\r\n\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tweatherForecast.push(dailyForecast);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container justify=\"space-between\" spacing={1}>\r\n\t{weatherForecast}\r\n\t\r\n</Grid>\r\n\r\n\t);\r\n}\r\n\r\nexport const Settings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Weather'),\r\n\ticon: 'weather-partly-cloudy'\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\n//import IconButton from '@material-ui/core/IconButton'\r\nimport Fab from '@material-ui/core/Fab'\r\nimport PlayIcon from '@material-ui/icons/PlayArrow'\r\nimport PauseIcon from '@material-ui/icons/Pause'\r\nimport StopIcon from '@material-ui/icons/Stop'\r\nimport SkipPreviousIcon from '@material-ui/icons/SkipPrevious'\r\nimport SkipNextIcon from '@material-ui/icons/SkipNext'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdivider: {\r\n\t\tmargin: '15px -16px'\r\n\t},\r\n\tcontainer: {\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t},\r\n\tnoHeader: {\r\n\t\tmarginTop: theme.spacing(-4),\r\n\t},\r\n\timage: {\r\n\t\theight: '200px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'flex-end',\r\n\t\tbackgroundPosition: 'center',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tnoImage: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tdisplay: 'flex',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tinformation: {\r\n\t\tbackgroundColor: theme.palette.primary.main + '66',\r\n\t\tcolor: '#fff',\r\n\t\tpadding: '10px',\r\n\t\tmargin: 0,\r\n\t\twidth: '100%',\r\n\t\tminHeight: '45px'\r\n\t},\r\n\tinformationLeft: {\r\n\t\twidth: '80%',\r\n\t\tfloat: 'left',\r\n\t\tmargin: 0\r\n\t},\r\n\tinformationRight: {\r\n\t\twidth: '19%',\r\n\t\tfloat: 'right',\r\n\t\tmargin: 0,\r\n\t\ttextAlign: 'right'\r\n\t},\r\n\tlength: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\twidth: '100%',\r\n\t\theight: '7px',\r\n\t},\r\n\tlengthBar: {\r\n\t\tbackgroundColor: theme.palette.secondary.main,\r\n\t\theight: '100%',\r\n\t},\r\n\tcontrols: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'stretch'\r\n\t},\r\n\tcontrolsBox: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t\talignItems: 'center',\r\n\t\tpaddingTop: '30px'\r\n\t},\r\n\tcontrolsBoxLeft: {\r\n\t\tflex: 1,\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'baseline'\r\n\t},\r\n\tcontrolsBoxCenter: {\r\n\t\tflex: 3\r\n\t},\r\n\tcontrolsBoxRight: {\r\n\t\tflex: 1,\r\n\t\tjustifyContent: 'end'\r\n\t},\r\n\tcontrolButton: {\r\n\t\tmargin: '0 5px'\r\n\t},\r\n\tcontrolButtonSmall: {\r\n\t\tmargin: '0 10px',\r\n\t\tfontSize: '1.2rem',\r\n\t\theight: '32px',\r\n\t\twidth: '32px'\r\n\t}\r\n});\r\n\r\n\r\nclass Multimedia extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// get initial states\r\n\t\tfor (let stateKey in this.props.device.states) {\r\n\t\t\tthis.props.device.requestDeviceState(stateKey, true).catch(err => console.error(err));\r\n\t\t}\r\n\t\t\r\n\t\t// receive updates\r\n\t\tthis.props.device.on('stateChange', (stateKey, state) => {\r\n\t\t\t\r\n\t\t\t// duration\r\n\t\t\tif (stateKey === 'duration' && state && state.val.indexOf(':') === -1) {\r\n\t\t\t\tstate.val = helpers.timeToHoursMinutesSeconds(state.val);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// isRunning\r\n\t\t\tif (stateKey === 'isRunning' && state && typeof state.val === 'string') {\r\n\t\t\t\tstate.val = state.val.indexOf('play') > -1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.setState({ [stateKey]: state }, () => {\r\n\t\t\t\tthis.progress();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\tprogress() {\r\n\t\tclearTimeout(this.progressTimeout);\r\n\t\t\r\n\t\tif (this.state.isRunning && this.state.isRunning.val === true && this.state.progress && this.state.progress.val && this.state.duration && this.state.duration.val) {\r\n\t\t\tthis.progressTimeout = setTimeout(() => {\r\n\t\t\t\tthis.setState(prevState => ({ progress: { ...prevState.progress, val: helpers.timeToSeconds(prevState.progress.val) + 1 }}), () => this.progress());\r\n\t\t\t}, 1000);\r\n\t\t}\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\tsetDeviceState(stateKey, value) {\r\n\t\tthis.props.device.setDeviceState(stateKey, value).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, noHeader, index, device } = this.props;\r\n\t\tlet styleImage = {}, styleLength = {}, styleLengthBar = {};\r\n\t\t\r\n\t\t// background\r\n\t\tif (this.state.background && this.state.background.val !== '') {\r\n\t\t\tstyleImage.backgroundImage = 'url(' + ((device.options.backgroundUrlPrepend || '') + this.state.background.val) + ')';\r\n\t\t}\r\n\t\t\r\n\t\t// duration\r\n\t\tif (this.state.duration && this.state.duration.val) {\r\n\t\t\tstyleLengthBar.width = ((this.state.progress && this.state.progress.val) || 0) + 'px';\r\n\t\t}\r\n\t\t\r\n\t\tconst playIconElements = this.state.isRunning && this.state.isRunning.val ? [<PauseIcon onClick={this.setDeviceState.bind(this, 'pause', true)} />, <StopIcon />] : [<PlayIcon onClick={this.setDeviceState.bind(this, 'play', true)} />];\r\n\t\t//const repeatIcon = 'repeat'; // repeat, repeat-off, repeat-once\r\n\t\t//const shuffleIcon = 'shuffle-variant'; // shuffle-variant, shuffle-disabled\r\n\t\t//const volumeIcon = 'volume-high'; // volume-variant-off\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{index > 0 && <Divider className={classes.divider} />}\r\n\t<div className={clsx(classes.container, noHeader && classes.noHeader)}>\r\n\t\t\r\n\t\t<div className={clsx(this.state.background && this.state.background.val !== '' ? classes.image : classes.noImage)} style={ styleImage } onClick={this.openDialog.bind(this)}>\r\n\t\t\t\r\n\t\t\t<div className={classes.information}>\r\n\t\t\t\t<p className={classes.informationLeft}>\r\n\t\t\t\t\t{this.state.grandParent && this.state.grandParent.val && [this.state.grandParent.val, <br key={'br-' + device.id} />]}\r\n\t\t\t\t\t{this.state.parent && this.state.parent.val && this.state.parent.val + ' - '}{this.state.title && this.state.title.val}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p className={classes.informationRight}>\r\n\t\t\t\t\t{this.state.progress && helpers.timeToHoursMinutesSeconds(this.state.progress.val)} / {this.state.duration && this.state.duration.val}\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div className={classes.length} style={ styleLength }>\r\n\t\t\t<div className={classes.lengthBar} style={ styleLengthBar }></div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div className={classes.controls}>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxLeft)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + repeatIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + shuffleIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxCenter)}>\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipPreviousIcon onClick={this.setDeviceState.bind(this, 'previous', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t\t{playIconElements.map((icon, i) => \r\n\t\t\t\t<Fab key={'icon-' + i} className={classes.controlButton} size=\"large\" color=\"primary\">\r\n\t\t\t\t\t{icon}\r\n\t\t\t\t</Fab>\r\n\t\t\t\t)}\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipNextIcon onClick={this.setDeviceState.bind(this, 'next', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxRight)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + volumeIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t</div>\r\n\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Multimedia);\r\n","import React from 'react'\r\n\r\nimport MultimediaItem from './MultimediaItem'\r\n\r\n\r\nexport default function StateList(props) {\r\n\tconst { devices, settings } = props;\r\n\treturn devices.map((device, i) => <MultimediaItem key={'MultimediaItem-' + device.id} {...props} index={i} noHeader={i === 0 && settings.icon === null && settings.title === null} device={device} />)\r\n}\r\n","var map = {\n\t\"./de.js\": 337,\n\t\"./en.js\": 338\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 336;","export default {\r\n\t/*\r\n\t * LOADING SCREEN\r\n\t */\r\n\t\"Retrieving settings\": \"Einstellungen werden geladen\",\r\n\t\r\n\t/*\r\n\t * GENERAL\r\n\t */\r\n\t\"last update\": \"letzte Aktualisierung\",\r\n\t\"Updates available\": \"Aktualisierung verfügbar\",\r\n\t\r\n\t/*\r\n\t * STATES\r\n\t */\r\n\t\"on\": \"an\",\r\n\t\"off\": \"aus\",\r\n\t\r\n\t\"user\": \"User\",\r\n\t\"users\": \"Users\",\r\n\t\r\n\t\"door\": \"Tür\",\r\n\t\"window\": \"Fenster\",\r\n\t\r\n\t\"open\": \"offen\",\r\n\t\"closed\": \"geschlossen\",\r\n\t\r\n\t\"turn on\": \"anschalten\",\r\n\t\"power\": \"Geräte Status\",\r\n\t\"trigger\": \"Geräte Status\",\r\n\t\r\n\t\"brightness\": \"Helligkeit\",\r\n\t\"wind\": \"Wind\",\r\n\t\"battery\": \"Batterie\",\r\n\t\r\n\t\"%DateTime\": \"%DateTime Uhr\",\r\n\t\"boost\": \"Boost\",\r\n\t\r\n\t/*\r\n\t * BLINDS\r\n\t */\r\n\t\"blind#level\": \"Behanghöhe\",\r\n\t\"blind#level2\": \"Lamellenposition\",\r\n\t\r\n\t\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"light#power\": \"Licht\",\r\n\t\"light#level\": \"Helligkeit\",\r\n\t\"colorTemperature\": \"Farbtemperatur\",\r\n\t\"hue\": \"Farbe\",\r\n\t\"light#rgb\": \"Farbraum Rot-Grün-Blau (RGB)\",\r\n\t\"hex\": \"Farbe\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HEATING\r\n\t */\r\n\t\"temperature\": \"Temperatur\",\r\n\t\"humidity\": \"Luftfeuchtigkeit\",\r\n\t\"setTemperature\": \"eingestellte Temperatur\",\r\n\t\r\n\t\r\n\t/*\r\n\t * DOOR\r\n\t */\r\n\t\"bell\": \"Klingel\",\r\n\t\"lock\": \"Schloß\",\r\n\t\"presence\": \"Präsenz\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HOUSEHOLD\r\n\t */\r\n\t\"running\": \"Gerät läuft\",\r\n\t\"consumption\": \"Verbrauch\"\r\n}","export default {\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"level\": \"Brightness\",\r\n\t\"colorTemperature\": \"Color Temperature\",\r\n\t\"hue\": \"Color\",\r\n\t\"color\": \"Color\",\r\n\t\"hex\": \"Color\",\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction HeatingSetTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={0} max={35} {...props} />\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\ttemperature: {\r\n\t\t\tvalue: (val) => val.toFixed(1),\r\n\t\t\tunit: ' °C'\r\n\t\t},\r\n\t\tsetTemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer-chevron-up'\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tboost: {\r\n\t\t\ticon: 'radiator'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tsetTemperature: HeatingSetTemperatureComponent\r\n\t},\r\n\tactions: {\r\n\t\tboost: defaults.actions.PowerAction\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport Slider from '@material-ui/core/Slider'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport Button from '@material-ui/core/Button'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tprimaryAction: props => ({\r\n\t\t...props.styles\r\n\t}),\r\n\tsecondaryAction: props => ({\r\n\t\tcolor: '#999',\r\n\t\tfontSize: '14px',\r\n\t\t...props.styles\r\n\t}),\r\n});\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\tcomponent: {\r\n\t\tpadding: theme.spacing(2, 8, 2, 2)\r\n\t},\r\n\tsliderMarkLabel: {\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tdisplay: 'none',\r\n\t\t\t'&:nth-child(5)': { display: 'block' },\r\n\t\t\t'&:nth-child(15)': { display: 'block' },\r\n\t\t\t'&:nth-child(25)': { display: 'block' }\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nconst Action = withStyles(styles)(props => {\r\n\tconst { classes, device, state, stateKey } = props;\r\n\treturn (\r\n\r\n<span className={clsx((stateKey === device.primaryStateKey && classes.primaryAction) || (stateKey === device.secondaryStateKey && classes.secondaryAction))}>\r\n\t{state.value} {state.unit}\r\n</span>\r\n\r\n\t);\r\n});\r\n\r\nfunction PowerAction(props) {\r\n\tconst { device, stateKey, stateVal, onChange: parentOnChange } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal);\r\n\tuseEffect(() => setChecked(stateVal), [stateVal]);\r\n\t\r\n\treturn (\r\n\r\n<Switch\r\n\tchecked={checked}\r\n\tonChange={parentOnChange || onChange}\r\n\tvalue={checked !== true}\r\n\tcolor=\"primary\"\r\n\t/>\r\n\r\n\t);\r\n}\r\n\r\nfunction TriggerAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onClick = () => {\r\n\t\tdevice.setDeviceState(stateKey, true).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\t//\r\n\tif (stateVal === true || stateVal > 0) {\r\n\t\treturn <Action {...props} onChange={null} />;\r\n\t}\r\n\t\r\n\tconst icon = 'power';\r\n\treturn (\r\n\r\n<Button\r\n\tvariant=\"outlined\"\r\n\tcolor=\"primary\"\r\n\tsize=\"small\"\r\n\tstartIcon={<span className={'mdi mdi-' + icon}></span>}\r\n\tonClick={onClick}\r\n\t>\r\n\t\r\n\t{i18n.t('turn on')}\r\n</Button>\r\n\r\n\t);\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction Label(props) {\r\n\tconst { label, br } = props;\r\n\tconst linebreak = br || false;\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t{label}\r\n\t{linebreak && <br />}\r\n</React.Fragment>\r\n\t\r\n\t);\r\n}\r\n\r\nfunction Component(props) {\r\n\tconst { title, children } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Label label={title} />\r\n\t<div className={classes.component}>\r\n\t\t{children}\r\n\t\r\n\t</div>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\nfunction LevelComponent(props) {\r\n\tlet { device, stateKey, stateVal, title, min, max, step, markSteps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onChange = (e, val) => {\r\n\t\tsetLevel(val);\r\n\t\tdevice.setDeviceState(stateKey, val).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [level, setLevel] = useState(stateVal);\r\n\tuseEffect(() => setLevel(stateVal), [stateVal]);\r\n\t\r\n\t// default settings\r\n\tmin = min || 0;\r\n\tmax = max || 100;\r\n\tstep = step || 1;\r\n\tmarkSteps = markSteps || 11; // 0 to 10\r\n\tlet markStep = ((max-min)/(markSteps-1)) || 10;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<Slider\r\n\t\tclasses={{ markLabel: classes.sliderMarkLabel }}\r\n\t\t//onChange\r\n\t\tonChangeCommitted={onChange}\r\n\t\tdefaultValue={level}\r\n\t\tvalueLabelDisplay=\"auto\"\r\n\t\tmarks={[...Array(markSteps).keys()].map(number => ({ 'value': min+number*markStep, 'label': min+number*markStep }))}\r\n\t\tmin={min}\r\n\t\tmax={max}\r\n\t\tstep={step}\r\n\t/>\r\n\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\t_any: {\r\n\t\t\tvalue: (val) => val.toString(),\r\n\t\t\t//unit\r\n\t\t\t//icon\r\n\t\t\t//state\r\n\t\t},\r\n\t\tbattery: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'battery-medium'\r\n\t\t},\r\n\t\tdoor: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'water-percent'\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tpower: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\ttemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer'\r\n\t\t},\r\n\t\ttrigger: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\twind: {\r\n\t\t\tunit: ' km/h',\r\n\t\t\ticon: 'weather-windy'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tLabel,\r\n\t\tComponent,\r\n\t\tLevelComponent,\r\n\t\t\r\n\t\tlevel: LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tAction,\r\n\t\tPowerAction,\r\n\t\tTriggerAction,\r\n\t\t\r\n\t\tpower: PowerAction,\r\n\t\ttrigger: TriggerAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': {\r\n\t\t\t\t\t'color': '#090',\r\n\t\t\t\t\t'fontWeight': 'bold'\r\n\t\t\t\t},\r\n\t\t\t\t'false': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'home'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'account'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'window-open-variant',\r\n\t\t\t\t'false': 'window-closed-variant'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tgridContainer: {\r\n\t\tpaddingLeft: theme.spacing(1),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(0.4)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function GridContainer(props) {\r\n\tconst { contents = {} } = props;\r\n\t\r\n\tconst classes = useStyles();\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tlet grid = [];\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\t\r\n\t\tif (!contents[column]) {\r\n\t\t\tconsole.warn('No content for column #' + column + '!');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t\r\n\t\tgrid.push(\r\n\t\t\t<Grid key={column} item\t\t\t\t// @see https://material-ui.com/customization/breakpoints/\r\n\t\t\t\txs={12}\t\t\t\t\t\t\t//    0 -  600px\r\n\t\t\t\tsm={6}\t\t\t\t\t\t\t//  600 -  960px\r\n\t\t\t\tmd={6}\t\t\t\t\t\t\t//  960 - 1280px\r\n\t\t\t\tlg={Math.round(12/columns)}\t\t// 1280 - 1920px\r\n\t\t\t\txl={Math.round(12/columns)}\t\t// \t\t> 1920px\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{contents[column]}\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container spacing={0} className={classes.gridContainer}>\r\n\t{grid}\r\n</Grid>\r\n\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport WarningIcon from '@material-ui/icons/Warning';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { amber, green } from '@material-ui/core/colors';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tsuccess: {\r\n\t\tbackgroundColor: green[600],\r\n\t},\r\n\terror: {\r\n\t\tbackgroundColor: theme.palette.error.dark,\r\n\t},\r\n\tinfo: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t},\r\n\twarning: {\r\n\t\tbackgroundColor: amber[700],\r\n\t},\r\n\ticon: {\r\n\t\tfontSize: 20,\r\n\t},\r\n\ticonVariant: {\r\n\t\topacity: 0.9,\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tmessage: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t},\r\n}));\r\n\r\n\r\nconst variantIcon = {\r\n\tsuccess: CheckCircleIcon,\r\n\twarning: WarningIcon,\r\n\terror: ErrorIcon,\r\n\tinfo: InfoIcon,\r\n};\r\n\r\n\r\nexport default function StatusSnackbar(props) {\r\n\tconst classes = useStyles();\r\n\tlet { className, open, autoHideDuration, message, closeButton, onClose, variant, ...other } = props;\r\n\tconst Icon = variantIcon[variant];\r\n\t\r\n\topen = open || true;\r\n\tautoHideDuration = autoHideDuration || null;\r\n\treturn (\r\n\r\n<Snackbar\r\n\tanchorOrigin={{\r\n\t\tvertical: 'bottom',\r\n\t\thorizontal: 'center',\r\n\t}}\r\n\topen={open}\r\n\tautoHideDuration={autoHideDuration}\r\n\tonClose={onClose}\r\n\t>\r\n\t<SnackbarContent\r\n\t\tclassName={clsx(classes[variant], className)}\r\n\t\tmessage={\r\n\t\t\t<span id=\"client-snackbar\" className={classes.message}>\r\n\t\t\t\t<Icon className={clsx(classes.icon, classes.iconVariant)} />\r\n\t\t\t\t{message}\r\n\t\t\t</span>\r\n\t\t}\r\n\t\taction={closeButton && [\r\n\t\t\t<IconButton key=\"close\" aria-label=\"close\" color=\"inherit\" onClick={onClose}>\r\n\t\t\t\t<CloseIcon className={classes.icon} />\r\n\t\t\t</IconButton>,\r\n\t\t]}\r\n\t\t{...other}\r\n\t\t/>\r\n\t\t\r\n</Snackbar>\r\n\r\n\t);\r\n}","\r\nexport default {\r\n\tdefaults: require('./defaults').default,\r\n\t\r\n\tblind: require('./blind').default,\r\n\tdoor: require('./door').default,\r\n\theating: require('./heating').default,\r\n\tjalousie: require('./blind').default,\r\n\tlight: require('./light').default,\r\n\tlocation: require('./location').default,\r\n\tuser: require('./user').default,\r\n\twindow: require('./window').default\r\n}","import EventEmitter from 'events'\r\nimport functions from './functions'\r\n\r\n\r\n/**\r\n * Function\r\n *\r\n * @param\t{String}\t\tfunctionType\r\n * @return\t{Function}\r\n *\r\n */\r\nexport default class Function extends EventEmitter {\r\n\t\r\n\tconstructor(functionType) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.function = functionType;\r\n\t\t\r\n\t\tif (!this.function) {\t\r\n\t\t\tthrow new Error('No function given!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.functionId = this.function.toLowerCase();\r\n\t\t\r\n\t\t// configuration\r\n\t\tthis.defaults = functions['defaults'].configurations;\r\n\t\tthis.configurations = (functions[this.functionId] && functions[this.functionId].configurations) || {};\r\n\t\t\r\n\t\t// styles\r\n\t\tthis.defaultStyles = functions['defaults'].styles;\r\n\t\tthis.styles = (functions[this.functionId] && functions[this.functionId].styles) || {};\r\n\t\t\r\n\t\t// components and actions\r\n\t\tthis.components = { ...functions['defaults'].components, ...(functions[this.functionId] && functions[this.functionId].components) || {} };\r\n\t\tthis.actions = { ...functions['defaults'].actions, ...(functions[this.functionId] && functions[this.functionId].actions) || {} };\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Mixed}\r\n\t * @private\r\n\t */\r\n\t_applyFunction(key, val) {\r\n\t\treturn this._isFunction(key) ? key(val) : val;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{String}\r\n\t * @private\r\n\t */\r\n\t_getValueFromSettings(settings, defaults = '') {\r\n\t\t\r\n\t\tfor (let key in settings) {\r\n\t\t\tif (settings[key] !== undefined) {\r\n\t\t\t\treturn settings[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn defaults;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isFunction(key) {\r\n\t\treturn key && typeof key === 'function';\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isValue(val) {\r\n\t\treturn val !== undefined; // || val === null || val === false; // null is considered a value, so it can be used to actually null the output\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_setObjectStructure(obj, defaultValue = undefined) {\r\n\t\t\r\n\t\tif (!obj || typeof obj != 'object') {\r\n\t\t\tobj = { 'default': obj || defaultValue };\r\n\t\t}\r\n\t\telse if (typeof obj == 'object' && !obj.default) {\r\n\t\t\tobj.default = defaultValue;\r\n\t\t}\r\n\t\t\r\n\t\treturn obj;\r\n\t}\r\n}\r\n","export default {\r\n\t\"hm-rpc\": \"HomeMatic\",\r\n}","import React from 'react'\r\nimport i18n from './i18n'\r\nimport Function from './Function'\r\nimport Adapters from './Adapters'\r\n\r\nimport { formatDistanceToNow } from 'date-fns'\r\nimport { de } from 'date-fns/locale'\r\n\r\n\r\n/**\r\n * Device\r\n *\r\n * @param\t{Object}\tdeviceProperties\r\n * @param\t{String}\tdeviceProperties.id\r\n * @param\t{String}\tdeviceProperties.name\r\n * @param\t{String}\t[deviceProperties.room=null]\r\n * @param\t{String}\tdeviceProperties.function\r\n * @param\t{Object}\tdeviceProperties.states\r\n * @param\t{Object}\t[deviceProperties.attributes={}]\r\n * @param\t{Object}\tdeviceProperties.options\r\n * @param\t{Object}\tsocket\r\n * @return\t{Device}\r\n *\r\n */\r\nexport default class Device extends Function {\r\n\t\r\n\tconstructor(deviceProperties, socket, language = window.sysLang || 'en') {\r\n\t\ttry {\r\n\t\t\tsuper(deviceProperties.function);\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthrow new Error('No function given for device ' + deviceProperties.name + '!');\r\n\t\t}\r\n\t\t\r\n\t\t// initialise class data\r\n\t\tthis.id = deviceProperties.id;\r\n\t\tthis.name = deviceProperties.name;\r\n\t\t\r\n\t\tthis.room = deviceProperties.room || null;\r\n\t\t\r\n\t\tthis.states = deviceProperties.states;\r\n\t\tthis.options = deviceProperties.options;\r\n\t\tthis.attributes = deviceProperties.attributes || {};\r\n\t\t\r\n\t\tthis.socket = socket;\r\n\t\t\r\n\t\t// verify data\r\n\t\tif (!this.options || typeof this.options !== 'object' || Object.keys(this.options).length === 0) {\r\n\t\t\tthrow new Error('Device' + (deviceProperties.id || deviceProperties.name ? ' ' + (deviceProperties.name || deviceProperties.id) : '') + ' not defined for jarvis!');\r\n\t\t}\r\n\t\telse if (!this.states || typeof this.states !== 'object' || Object.keys(this.states).length === 0) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no states defined)!');\r\n\t\t}\r\n\t\telse if (!this.id || !this.name || !this.function) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no id, name or function defined)!');\r\n\t\t}\r\n\t\telse if (!this.socket) {\t\r\n\t\t\tthrow new Error('No socket given!');\r\n\t\t}\r\n\t\t\r\n\t\t// hierarchy\r\n\t\tthis.children = deviceProperties.children || [];\r\n\t\tthis.parent = deviceProperties.parent || null;\r\n\t\t\r\n\t\t// do some stuff\r\n\t\tthis._setProperties();\r\n\t\tthis.stateSubscriptions = [];\r\n\t\t\r\n\t\t// listen for errors of the device\r\n\t\tthis.on('error', err => console.error('Device error occured!', err));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object|String}\r\n\t * @private\r\n\t */\r\n\t_getStateFromKey(stateKey = null, stateType = 'state') {\r\n\t\t\r\n\t\t// already a state object\r\n\t\tif (stateKey && typeof stateKey === 'object') {\r\n\t\t\treturn stateKey;\r\n\t\t}\r\n\t\t\r\n\t\t// get state object\r\n\t\tlet s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\t// state not an object so far\r\n\t\tif (typeof s === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey] = { [stateType]: { 'node': s }};\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\telse if (typeof s[stateType] === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey][stateType] = { 'node': s[stateType] };\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\t\r\n\t\t// state not valid\r\n\t\tif (!s || !s[stateType]) {\r\n\t\t\treturn 'Incorrect or non-defined state key for device ' + this.name + '!';\r\n\t\t}\r\n\t\telse if (typeof s[stateType] == 'object' && !s[stateType].node) {\r\n\t\t\treturn 'No ' + stateType + ' specified for device ' + this.name + '!';\r\n\t\t}\r\n\t\t\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getConfigurationSetting(config, stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this[config][stateKey]) {\r\n\t\t\t\r\n\t\t\t// 1. if stateKey (e.g. level, power) is available, try to replace an attribute (e.g. icon, unit or for styles state, icon) based on current state (e.g. true, false)\r\n\t\t\tif (typeof this[config][stateKey][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config][stateKey][attribute][stateVal]) ? this[config][stateKey][attribute][stateVal] : this[config][stateKey][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 2. if #1 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config][stateKey][attribute])) {\r\n\t\t\t\treturn this[config][stateKey][attribute](stateVal);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 3. fallback to stateKey with attribute, if defined but neither an object (thus stateless) nor a function\r\n\t\t\telse if (typeof this[config][stateKey][attribute] === 'string') {\r\n\t\t\t\treturn this[config][stateKey][attribute];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (this[config]['_any']) {\r\n\t\t\t\r\n\t\t\t// 4. fallback to _any if no stateKey (e.g. level, power) is given, but consider attribute to be stateful (e.g. true, false)\r\n\t\t\tif (typeof this[config]['_any'][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config]['_any'][attribute][stateVal]) ? this[config]['_any'][attribute][stateVal] : this[config]['_any'][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 5. if #4 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config]['_any'][attribute])) {\r\n\t\t\t\treturn this[config]['_any'][attribute](stateVal);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// nothing, return undefined (not null, because this would mean take an empty value)\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getUserSetting(stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this.options[attribute][stateKey]) {\r\n\t\t\t\r\n\t\t\tif (typeof this.options[attribute][stateKey] === 'object') {\r\n\t\t\t\treturn super._isValue(this.options[attribute][stateKey][stateVal]) ? this.options[attribute][stateKey][stateVal] : this.options[attribute][stateKey]['default'];\r\n\t\t\t}\r\n\t\t\telse if (super._isFunction(this.options[attribute][stateKey])) {\r\n\t\t\t\treturn this.options[attribute][stateKey](stateVal);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn this.options[attribute][stateKey];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return void\r\n\t * @private\r\n\t *\r\n\t */\r\n\t_setProperties() {\r\n\t\t\r\n\t\tlet states = Object.keys(this.states);\r\n\t\t\r\n\t\t// delete ignored states\r\n\t\tif (this.options.ignoredStates) {\r\n\t\t\tthis.options.ignoredStates = Array.isArray(this.options.ignoredStates) ? this.options.ignoredStates : [this.options.ignoredStates];\r\n\t\t\t\r\n\t\t\tthis.options.ignoredStates.forEach(ignoredState => {\r\n\t\t\t\tif (this.states[ignoredState]) {\r\n\t\t\t\t\tdelete this.states[ignoredState];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get hidden states\r\n\t\tthis.options.hiddenStates = [];\r\n\t\tif (this.options.hideStates) {\r\n\t\t\tthis.options.hideStates = Array.isArray(this.options.hideStates) ? this.options.hideStates : [this.options.hideStates];\r\n\t\t\t\r\n\t\t\tthis.options.hideStates.forEach(hideState => {\r\n\t\t\t\tif (this.states[hideState]) {\r\n\t\t\t\t\tthis.options.hiddenStates.push(hideState);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// properties\r\n\t\tthis.primaryStateKey = this.options.primary || states[0];\r\n\t\tthis.secondaryStateKey = this.options.secondary || null;\r\n\t\t\r\n\t\t// bring user settings for value, state, unit, icon and styles in structure\r\n\t\t['value', 'state', 'unit', 'icon', 'styles'].forEach(key => {\r\n\t\t\t\r\n\t\t\tlet stateOrAttribute = this.options[key] && Object.keys(this.options[key])[0];\r\n\t\t\tthis.options[key] = !this.options[key] ? {} : super._setObjectStructure(stateOrAttribute && states.indexOf(stateOrAttribute) > -1 ? this.options[key] : { [this.primaryStateKey]: this.options[key] });\r\n\t\t});\r\n\t\t\r\n\t\t// manufacturer\r\n\t\tthis.states[this.primaryStateKey] = this._getStateFromKey(this.primaryStateKey);\r\n\t\tthis.options.manufacturer = (this.primaryStateKey && Adapters[this.states[this.primaryStateKey].state.node.substr(0, this.states[this.primaryStateKey].state.node.indexOf('.'))]) || 'unknown';\r\n\t\t\r\n\t\t// all options\r\n\t\tthis.options.groups = Array.isArray(this.options.group) ? this.options.group : [this.options.group];\r\n\t\tthis.options.sort = this.options.sort || 999;\r\n\t\t\r\n\t\tthis.options.label = (this.options.label && (typeof this.options.label === 'string' && this.options.label.replace(/%name%/g, this.name))) || this.options.label || this.name;\r\n\t\t//this.options.subtitle = this.options.subtitle;\r\n\t\tthis.options.divider = this.options.divider || false;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_updateDeviceState(stateKey, state) {\r\n\t\t\r\n\t\t// add time changed\r\n\t\tstate.timeChanged = formatDistanceToNow(new Date(state.lc-5*1000), { locale: de, includeSeconds: true, addSuffix: true })\r\n\t\t\r\n\t\t// add unit\r\n\t\tstate.unit = '';\r\n\t\t\r\n\t\t// assign value\r\n\t\tstate.value = state.val;\r\n\t\t\r\n\t\t// mapping of value to state values\r\n\t\t[{ 'value': 'value' }, { 'state': 'value' }, { 'unit': 'unit' }].forEach(pair => {\r\n\t\t\tlet attribute = Object.keys(pair).toString();\r\n\t\t\tlet option = Object.values(pair).toString();\r\n\t\t\tlet settings = {};\r\n\t\t\t\r\n\t\t\t// get user setting\r\n\t\t\tsettings['options'] = this._getUserSetting(stateKey, attribute, state.value);\r\n\t\t\t\r\n\t\t\t// get function setting or fallback to defaults\r\n\t\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, state.value);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tstate[option] = super._getValueFromSettings(settings, state[option]);\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\tstate.value = i18n.t(state.value);\r\n\t\treturn state;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tget(property) {\r\n\t\treturn this[property] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetAction(stateKey = null, forceDefault = false) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state.val;\r\n\t\t\r\n\t\tconst Action = (!forceDefault && this.actions[stateKey]) || this.actions.Action;\r\n\t\treturn <Action key={'action-' + this.id + '-' + stateKey} device={this} state={state} stateKey={stateKey} stateVal={stateVal} styles={this.getStyle('state', stateKey, stateVal)} />\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetComponent(stateKey) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tconst stateVal = this.states[stateKey].state.value.val;\r\n\t\t\r\n\t\tconst Component = this.components[stateKey];\r\n\t\treturn (Component && <Component title={i18n.t(this.function + '#' + stateKey)} device={this} stateKey={stateKey} stateVal={stateVal} />) || i18n.t(this.function + '#' + stateKey);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateProperty=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetDeviceState(stateKey = null, stateProperty = null) {\r\n\t\tconst s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tlet deviceState = null;\r\n\t\t\r\n\t\tif (s && s.state && stateProperty !== null && s.state.value !== undefined && s.state.value[stateProperty] !== undefined) {\r\n\t\t\tdeviceState = s.state.value[stateProperty];\r\n\t\t}\r\n\t\telse if (s && s.state && stateProperty === null && s.state.value !== undefined) {\r\n\t\t\tdeviceState = s.state.value;\r\n\t\t}\r\n\t\t\r\n\t\treturn deviceState;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get an icon based on the current device state (or falls back to a default).\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateVal=default]\r\n\t * @param\t{String}\t[defaultIcon=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetIcon(stateKey, stateVal = '', defaultIcon = '?') {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'icon', stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, 'icon', stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, defaultIcon);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetOption(option, stateVal = 'default') {\r\n\t\treturn (this.options[option] && (this.options[option][stateVal] || this.options[option]['default'])) || this.options[option] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetStyle(attribute, stateKey, stateVal = 'default') {\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'styles', attribute, stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['styles', 'defaultStyles'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, {});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests all state values from the backend.\r\n\t *\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Array<Promises>}\r\n\t *\r\n\t */\r\n\trequestDeviceStates(subscribe = false) {\r\n\t\t\r\n\t\tlet responses = [];\r\n\t\tfor (let stateKey in this.states) {\r\n\t\t\tresponses.push(this.requestDeviceState(stateKey, subscribe));\r\n\t\t}\r\n\t\t\r\n\t\treturn responses;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceState(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.value !== undefined && this.stateSubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getState(s.state.node)\r\n\t\t\t\t\t.then(state => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (state === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @return\t{Promise}\r\n\t * @see https://github.com/ioBroker/ioBroker.history#access-values-from-javascript-adapter\r\n\t *\r\n\t */\r\n\trequestDeviceStateHistory(stateKey = null, subscribe = false, options = {}) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\ts.state.historyCache = s.state.historyCache || {};\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (options.start && options.end && options.step && s.state.historyCache[options.start + '#' + options.end + '#' + options.step] !== undefined) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('historyChange', stateKey, s.state.historyCache[options.start + '#' + options.end + '#' + options.step], s.state);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getStateHistory(s.state.node, options)\r\n\t\t\t\t\t.then(history => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (history === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// cache result\r\n\t\t\t\t\t\tif (options.start && options.end && options.step) {\r\n\t\t\t\t\t\t\ts.state.historyCache[options.start + '#' + options.end + '#' + options.step] = history;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.history = history;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('historyChange', stateKey, s.state.history, s.state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetAction(action) {\r\n\t\tthis.options.action = action;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetComponent(component) {\r\n\t\tthis.options.label = component;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\tvalue\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsetDeviceState(stateKey = null, value) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey, 'action');\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.socket.setState(s.action.node, value)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\r\n\t\t\t\t\t// get state value if not subscribed\r\n\t\t\t\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\t\t\t\tthis.requestDeviceState(stateKey);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// resolve\r\n\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsubscribeDeviceState(stateKey = null) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\t// add subscription\t\r\n\t\tthis.stateSubscriptions.push(stateKey);\r\n\t\t\r\n\t\t// subscribe\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tthis.socket.subscribeState(s.state.node, (id, state, params) => {\r\n\t\t\t\t\r\n\t\t\t\tif (state && state.val !== this.getDeviceState(stateKey, 'val')) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// format value\r\n\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish state change\r\n\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish to children as well\r\n\t\t\t\t\tthis.children.forEach(child => child.emit('stateChange', stateKey, s.state.value));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t});\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport i18n from '../i18n'\r\n\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/tooltip'\r\n//import Badge from '@material-ui/core/Badge'\r\n//import NotificationsIcon from '@material-ui/icons/Notifications'\r\nimport StatusConnected from '@material-ui/icons/Wifi'\r\nimport StatusPending from '@material-ui/icons/PermScanWifi'\r\nimport StatusDisconnected from '@material-ui/icons/SignalWifiOff'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tappBar: {\r\n\t\tflexGrow: 1,\r\n\t\tboxShadow: 'none',\r\n\t\ttransform: 'none',\r\n\t},\r\n\ttoolbar: {\r\n\t\tbackgroundColor: theme.palette.primary.main\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2),\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingRight: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TopBar(props) {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { children, title, connectionStatus } = props;\r\n\tconst [ icon, label ] = title.indexOf('|') > -1 ? title.split('|') : [ null, title ];\r\n\t\r\n\tconst connectionStatusIcon = connectionStatus ? <StatusConnected /> : (connectionStatus === 'pending' ? <StatusPending /> : <StatusDisconnected />);\r\n\tconst connectionStatusTooltip = connectionStatus ? 'Connected to ioBroker' : (connectionStatus === 'pending' ? 'Not connected to ioBroker! Reconnecting..' : 'Not connected to ioBroker! Connection failed!');\r\n\treturn (\r\n\r\n<AppBar id=\"appBar\" position=\"static\" className={classes.appBar}>\r\n\r\n\t<Toolbar className={classes.toolbar}>\r\n\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t{icon && <span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>}\r\n\t\t\t{label !== 'null' && label}\r\n\t\t</Typography>\r\n\t\t<IconButton color=\"inherit\">\r\n\t\t\t<Tooltip title={i18n.t(connectionStatusTooltip)}>\r\n\t\t\t\t{connectionStatusIcon}\r\n\t\t\t</Tooltip>\r\n\t\t</IconButton>\r\n\t\t{/*\r\n\t\t<IconButton color=\"inherit\">\r\n\t\t\t<Badge badgeContent={17} color=\"secondary\">\r\n\t\t\t\t<NotificationsIcon />\r\n\t\t\t</Badge>\r\n\t\t</IconButton>\r\n\t\t*/}\r\n\t</Toolbar>\r\n\t\r\n\t{children}\r\n</AppBar>\r\n\r\n\t);\r\n}\r\n","/*\r\n * by QoP <https://stackoverflow.com/users/4484822/qop>\r\n * @see https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\r\n */\r\nimport { useState, useEffect } from 'react';\r\n\r\nfunction getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\nexport default function useWindowDimensions() {\r\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      setWindowDimensions(getWindowDimensions());\r\n    }\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return windowDimensions;\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport useWindowDimensions from '../helpers/useWindowDimensions'\r\n\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Box from '@material-ui/core/Box'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingBottom: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t},\r\n\ttabs: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tpaddingLeft: theme.spacing(),\r\n\t\tcolor: '#fff',\r\n\t\twidth: 'calc(100% - ' + theme.spacing() + 'px)',\r\n\t\tzIndex: 101,\r\n\t\tborderBottom: '5px solid #eee'\r\n\t},\r\n\tfixed: {\r\n\t\tposition: 'fixed',\r\n\t\ttop: 0\r\n\t},\r\n\tindicator: {\r\n\t\tbackgroundColor: '#fff',\r\n\t},\r\n\tfullscreen: {\r\n\t\tmarginLeft: -theme.spacing(),\r\n\t\tmarginTop: '-5px',\r\n\t},\r\n\tgrid: {\r\n\t\tpaddingBottom: '30px'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TabBar(props) {\r\n\tlet { tabs, selectTab } = props;\r\n\tconst classes = useStyles();\r\n\tlet tabBarProps = useRef({});\r\n\t\r\n\t// tab\r\n\tconst [tab, setTab] = useState(0);\r\n\tconst handleChange = (event, selectedTab) => {\r\n\t\tselectTab(selectedTab, tabs[selectedTab]);\r\n\t\tsetTab(selectedTab);\r\n\t}\r\n\t\r\n\t// scroll\r\n\tconst [fixed, setFixed] = useState(false);\r\n\tconst handleScroll = useCallback(() => {\r\n\t\tconst threshold = (tabBarProps.current.top + tabBarProps.current.height - 53);\r\n\t\tconst fixed = window.scrollY >= threshold;\r\n\t\t\r\n\t\tsetFixed(prevFixed => {\r\n\t\t\tif (prevFixed !== fixed) {\r\n\t\t\t\tdocument.getElementById('root').style.paddingTop = fixed ? (threshold-5-8) + 'px' : 0;\r\n\t\t\t\treturn fixed;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevFixed;\r\n\t\t});\r\n\t\t\r\n\t}, [tabBarProps]);\r\n\r\n\tuseEffect(() => {\r\n\t\ttabBarProps.current = {\r\n\t\t\ttop: document.getElementById('tabBar').offsetTop,\r\n\t\t\theight: document.getElementById('tabBar').offsetHeight\r\n\t\t}\r\n\t\t\r\n\t\twindow.addEventListener('scroll', handleScroll);\r\n\t\treturn () => window.removeEventListener('keydown', handleScroll, 0);\r\n\t\t\r\n\t}, [handleScroll]);\r\n\t\r\n\t// render tabs\r\n\tconst renderedTabs = tabs.map((tab, i) => {\r\n\t\tconst [ icon, label ] = tab.indexOf('|') > -1 ? tab.split('|') : [ null, tab ];\r\n\t\treturn <Tab key={'tab' + i} icon={<span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>} label={!fixed && label !== 'null' ? label : null} />\r\n\t});\r\n\t\r\n\treturn (\r\n\r\n<Tabs\r\n\tid=\"tabBar\"\r\n\tvalue={tab}\r\n\tonChange={handleChange}\r\n\tvariant=\"scrollable\"\r\n\tclasses={{\r\n\t\troot: clsx(classes.tabs, fixed && classes.fixed),\r\n\t\tindicator: classes.indicator\r\n\t}}>\r\n\t\r\n\t{renderedTabs}\r\n</Tabs>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport function TabPanel(props) {\r\n\tconst { children, selectedTab, renderedTab, fullscreen } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\t// get map height based on viewport\r\n\tconst { height } = useWindowDimensions();\r\n\tconst [mapHeight, setMapHeight] = useState(height);\r\n\tlet topBarHeight = useRef({});\r\n\t\r\n\tuseEffect(() => {\r\n\t\ttopBarHeight.current = document.getElementById('appBar').offsetHeight;\r\n\t\tsetMapHeight(height-topBarHeight.current+5);\r\n\t\t\r\n\t}, [height]);\r\n\t\r\n\t/*\r\n\t * Some components need to be visible upon loading, so proper initialise.\r\n\t * Due to the 'hidden' attribute though, they might be hidden.\r\n\t * This is a workaround to initially show everything for a short period of time and then hide according to tab settings.\r\n\t *\r\n\t */\r\n\tconst [hidden, setHidden] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tsetTimeout(() => setHidden(selectedTab !== renderedTab), 10);\r\n\t\t\r\n\t}, [selectedTab, renderedTab]);\r\n\t\r\n\treturn (\r\n\r\n<Box\r\n\trole=\"tabpanel\"\r\n\thidden={hidden}\r\n\tid={'tabpanel-' + renderedTab}\r\n\tclassName={clsx(fullscreen ? classes.fullscreen : classes.grid)}\r\n\tstyle={{ height: mapHeight + 'px' }}\r\n\t>\r\n\t\r\n\t{children}\r\n</Box>\r\n\r\n\t);\r\n}\r\n","\r\nexport const ModuleSettings = {\r\n\tAdapterStatus: require('./AdapterStatus').Settings || {},\r\n\tChart: require('./Chart').Settings || {},\r\n\tDateTime: require('./DateTime').Settings || {},\r\n\tMap: require('./Map').Settings || {},\r\n\tMultimedia: require('./Multimedia').Settings || {},\r\n\tStateList: require('./StateList').Settings || {},\r\n\tStateListHorizontal: require('./StateListHorizontal').Settings || {},\r\n\tWeather: require('./Weather').Settings || {}\r\n}\r\n\r\nexport default {\r\n\tAdapterStatus: require('./AdapterStatus').default,\r\n\tChart: require('./Chart').default,\r\n\tDateTime: require('./DateTime').default,\r\n\tMap: require('./Map').default,\r\n\tMultimedia: require('./Multimedia').default,\r\n\tStateList: require('./StateList').default,\r\n\tStateListHorizontal: require('./StateListHorizontal').default,\r\n\tWeather: require('./Weather').default\r\n}","import React from 'react';\r\nimport Connection from '../Connection';\r\nimport Device from '../Device';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\r\nimport MuiDialogContent from '@material-ui/core/DialogContent';\r\nimport MuiDialogActions from '@material-ui/core/DialogActions';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport Modules from '../modules';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n});\r\n\r\n\r\nconst DialogTitle = withStyles(styles)(props => {\r\n\tconst { children, classes, onClose, ...other } = props;\r\n\treturn (\r\n\r\n<MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n\t<Typography variant=\"h6\">{children}</Typography>\r\n\t{onClose ? (\r\n\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t<CloseIcon />\r\n\t</IconButton>\r\n\t) : null}\r\n</MuiDialogTitle>\r\n\r\n\t);\r\n});\r\n\r\nconst DialogContent = withStyles(theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(1)\r\n\t\t}\r\n\t},\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles(theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n}))(MuiDialogActions);\r\n\r\n\r\nexport default class Popup extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tchildren: []\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tlet device = this.props.contents && this.props.contents.device;\r\n\t\tif (device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\t\r\n\t\t\t// get from cache\r\n\t\t\tif (device.children.length) {\r\n\t\t\t\tconsole.info('Got ' + Object.keys(device.children).length + ' states for device ' + device.name + ' from cache.');\r\n\t\t\t\tthis.setState({ 'children': device.children }, () => this.forceUpdate());\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// retrieve new\r\n\t\t\telse {\r\n\t\t\t\t// loop through states and request status\r\n\t\t\t\tlet responses = [];\r\n\t\t\t\tlet children = [];\r\n\t\t\t\t\r\n\t\t\t\tfor (let stateKey in device.states) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (device.states[stateKey].state === undefined || device.options.hiddenStates.indexOf(stateKey) > -1) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet child = new Device({\r\n\t\t\t\t\t\t\t'parent': device,\r\n\t\t\t\t\t\t\t'id': device.id + '#' + stateKey,\r\n\t\t\t\t\t\t\t'name': device.name,\r\n\t\t\t\t\t\t\t'function': device.function,\r\n\t\t\t\t\t\t\t'states': { [stateKey]: device.states[stateKey] },\r\n\t\t\t\t\t\t\t'options': {\r\n\t\t\t\t\t\t\t\t'primary': stateKey,\r\n\t\t\t\t\t\t\t\t'divider': children.length !== 0,\r\n\t\t\t\t\t\t\t\t'subgroup': null,\r\n\t\t\t\t\t\t\t\t'subtitle': null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tConnection.getConnection,\r\n\t\t\t\t\t\twindow.language\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// add child to parent\r\n\t\t\t\t\tdevice.children.push(child);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// retrieve state\r\n\t\t\t\t\tresponses.push(child.requestDeviceState(null, true));\r\n\t\t\t\t\tchildren.push(child);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tPromise.allSettled(responses).then(() => {\r\n\t\t\t\t\tconsole.info('Retrieved ' + Object.keys(children).length + ' states for device ' + device.name + '.', responses);\r\n\t\t\t\t\tthis.setState({ 'children': children }, () => this.forceUpdate());\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\tthis.setState({ 'children': [] }, () => this.forceUpdate());\r\n\t\t}\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(nextProps, nextState) {\r\n\t\treturn !this.props.contents || this.props.contents.ts !== nextProps.contents.ts;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { open, closeDialog, contents } = this.props;\r\n\t\tconst { device } = contents;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog onClose={closeDialog} open={open || false} maxWidth={'md'} fullWidth={true}>\r\n\t<DialogTitle onClose={closeDialog}>\r\n\t\t{device.name}\r\n\t</DialogTitle>\r\n\t<DialogContent dividers style={{ padding: 0 }}>\r\n\t\t\r\n\t\t<Modules.StateList openDialog={null} devices={this.state.children} component={true} action={true} />\t\r\n\t\t\r\n\t</DialogContent>\r\n\t<DialogActions>\r\n\t\t<Button autoFocus onClick={closeDialog} color=\"primary\">\r\n\t\t\tClose\r\n\t\t</Button>\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t\t);\r\n\t};\r\n}\r\n","import React from 'react'\r\n\r\nimport Card from '@material-ui/core/Card'\r\nimport CardHeader from '@material-ui/core/CardHeader'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tcard: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t},\r\n\tcardHeaderNoContents: {\r\n\t\tpadding: theme.spacing(),\r\n\t},\r\n\tcardAvatar: props => ({\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff',\r\n\t\tfontSize: '24px',\r\n\t\t...props\r\n\t}),\r\n\tcardContent: {\r\n\t\tpadding: theme.spacing(0, 2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpadding: theme.spacing(0)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Widget(props) {\r\n\tconst { title, icon, iconStyle } = props;\r\n\tconst classes = useStyles(iconStyle);\r\n\t\r\n\treturn (\r\n\r\n<Card className={classes.card}>\r\n\t<CardHeader\r\n\t\tavatar={icon !== null &&\r\n\t\t\t<Avatar variant=\"rounded\" classes={{ root: classes.cardAvatar }}>\r\n\t\t\t\t{React.createElement('span', { 'className': 'mdi mdi-' + (icon || 'home') })}\r\n\t\t\t</Avatar>\r\n\t\t}\r\n\t\ttitle={title &&\r\n\t\t\t<Typography variant=\"h5\" component=\"h2\">\r\n\t\t\t\t{title}\r\n\t\t\t</Typography>\r\n\t\t}\r\n\t/>\r\n\t<CardContent className={classes.cardContent}>\r\n\t\t{props.children}\r\n\t</CardContent>\r\n</Card>\r\n\r\n\t);\r\n}\r\n","import { createMuiTheme } from '@material-ui/core/styles'\r\nimport { pink } from '@material-ui/core/colors'\r\nimport blue from '@material-ui/core/colors/blue'\r\n\r\nconst primary = blue[700]\r\nconst secondary = pink\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: {\r\n\t\t\tmain: primary \r\n\t\t},\r\n\t\tsecondary: secondary,\r\n\t},\r\n\tcomponents: {\r\n\t\ticon: {\r\n\t\t\tfontSize: '24px',\r\n\t\t\tcolor: primary\r\n\t\t},\r\n\t\t'finger': {\r\n\t\t\tcursor: 'pointer'\r\n\t\t}\r\n\t}\r\n});\r\n\r\n//console.debug(theme);\r\nexport default theme;","import React from 'react'\n\n//import Drawer from '@material-ui/core/Drawer'\n\nimport TopBar from './components/TopBar'\nimport TabBar, { TabPanel } from './components/TabBar'\nimport GridContainer from './components/GridContainer'\nimport Popup from './components/Popup'\nimport Widget from './components/Widget'\nimport Modules, { ModuleSettings } from './modules'\n\n\n/*\n * STYLES\n */\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport theme from './theme';\n\n\n/*\n *\n */\nconst getGroup = (groupId, group, props = {}) => {\n\t\n\t// group empty\n\tif (!group && ModuleSettings[group.settings.component.module].noDevicesAllowed !== true) {\n\t\tconsole.error('Group ' + groupId + ' defined in columns but not assigned to any devices!');\n\t\treturn null;\n\t}\n\t\n\t// get module for component\n\tgroup.settings._global = props.settings;\n\tgroup.settings.component = typeof group.settings.component === 'string' ? { 'module': group.settings.component } : (group.settings.component || {});\n\tconst Tag = Modules[group.settings.component.module || 'StateList'];\n\t\n\t// get tag\n\tif (Tag === undefined) {\n\t\tconsole.error('Undefined component \"' + group.settings.component.module + '\" used!');\n\t\treturn null;\n\t}\n\t\n\treturn <Tag key={'Tag' + groupId} devices={group.devices} openDialog={props.action ? props.action : null} settings={{ ...group.settings, ...props }} />\n}\n\n\n/*\n *\n */\nconst getGridContents = (contents, groups, props = {}) => {\n\t\n\tlet gridContents = {};\n\tconst columns = Object.keys(contents).length;\n\t\n\tfor (let column = 1; column <= columns; column++) {\n\t\t\n\t\tlet columnContents = contents[column];\n\t\tgridContents[column] = gridContents[column] || [];\n\t\t\n\t\t// no contents, thus add placeholder\n\t\tif (!columnContents || !Object.keys(columnContents).length) {\n\t\t\tgridContents[column].push(null);\n\t\t}\n\t\t\n\t\t// add contents\n\t\telse {\n\t\t\tfor (let groupId in columnContents) {\n\t\t\t\t\n\t\t\t\tlet group = groups[groupId] || {};\n\t\t\t\tgroup.settings = columnContents[groupId] || {};\n\t\t\t\tgroup.settings._global = props.settings;\n\t\t\t\tgroup.settings.component = typeof group.settings.component === 'string' ? { 'module': group.settings.component } : (group.settings.component || {});\n\t\t\t\t\n\t\t\t\tlet content = getGroup(groupId, group, props);\n\t\t\t\tif (content) {\n\t\t\t\t\tgridContents[column].push(\n\t\t\t\t\t\t<Widget key={'Box-' + groupId}\n\t\t\t\t\t\t\ttitle={group.settings.title === null ? null : (group.settings.title || group.name || (ModuleSettings[group.settings.component.module] && ModuleSettings[group.settings.component.module].title))}\n\t\t\t\t\t\t\ticon={group.settings.icon === null ? null : (group.settings.icon || (ModuleSettings[group.settings.component.module] && ModuleSettings[group.settings.component.module].icon))}\n\t\t\t\t\t\t\ticonStyle={group.settings.iconStyle}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t{content}\n\t\t\t\t\t\t</Widget>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn gridContents;\n}\n\n\nexport default class Jarvis extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tselectedTab: 0,\n\t\t\ttabTitle: '',\n\t\t\t\n\t\t\tnotificationDrawer: false,\n\t\t\tdialog: false,\n\t\t\tdialogContents: {\n\t\t\t\t'ts': 0,\n\t\t\t\t'device': {}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// bind methods\n\t\tthis.closeDialog = this.closeDialog.bind(this);\n\t\tthis.openDialog = this.openDialog.bind(this);\n\t\tthis.selectTab = this.selectTab.bind(this);\n\t\t//this.toggleDrawer = this.toggleDrawer.bind(this);\n\t\t\n\t\t// initialise\n\t\tthis.gridContents = {};\n\t\tthis.layout = this.props.settings.layout;\n\t\tthis.tabs = Object.keys(this.layout);\n\t\tthis.tabsEnabled = this.tabs[0] !== 1;\n\t\tthis.state.tabTitle = this.tabs[this.state.selectedTab];\n\t\t\n\t\t// no tabs defined, so layout wrap into default tab\n\t\tif (!this.tabsEnabled) {\n\t\t\tthis.layout = { 'Home': this.layout };\n\t\t\tthis.tabs.push('1');\n\t\t}\n\t\t\n\t\t// widget props\n\t\tthis.widgetProps = {}\n\t}\n\t\n\tgetTabPanels() {\n\t\t\n\t\tlet tab = 0;\n\t\tlet tabPanels = [];\n\t\tfor (let tabLabel in this.layout) {\n\t\t\tconst contents = this.layout[tabLabel];\n\t\t\t\n\t\t\t// fullscreen in component\n\t\t\tlet groupId = Object.keys(contents)[0];\n\t\t\tlet fullscreen = Number.isNaN(parseInt(groupId));\n\t\t\t\n\t\t\tif (!this.gridContents[tabLabel] && fullscreen) {\n\t\t\t\tthis.gridContents[tabLabel] = getGroup(contents, { ...this.props.groups[groupId], settings: contents[groupId] }, { settings: this.props.settings, action: this.openDialog, ...this.widgetProps });\n\t\t\t}\n\t\t\t\n\t\t\t// grid layout\n\t\t\telse if (!this.gridContents[tabLabel]) {\n\t\t\t\tthis.gridContents[tabLabel] = <GridContainer contents={getGridContents(contents, this.props.groups, { settings: this.props.settings, action: this.openDialog, ...this.widgetProps })} />\n\t\t\t}\n\t\t\t\n\t\t\tlet tabPanel = (\n\t\t\t\t<TabPanel key={'tabPanel-' + tab} renderedTab={tab} selectedTab={this.state.selectedTab} fullscreen={fullscreen}>\n\t\t\t\t\t{this.gridContents[tabLabel]}\n\t\t\t\t</TabPanel>\n\t\t\t);\n\t\t\t\n\t\t\ttabPanels.push(tabPanel);\n\t\t\ttab++;\n\t\t}\n\t\t\n\t\treturn tabPanels;\n\t}\n\t\n\tcloseDialog() {\n\t\tthis.setState({ 'dialog': false, 'dialogContents': { 'ts': Date.now(), 'device': {} } });\n\t}\n\t\n\topenDialog(device) {\n\t\tthis.setState({ 'dialog': true, 'dialogContents': { 'ts': Date.now(), 'device': device } });\n\t}\n\t\n\tselectTab(tab, title) {\n\t\tthis.setState({ selectedTab: tab, tabTitle: title });\n\t}\n\t\n\t/*\n\ttoggleDrawer(drawer, open) {\n\t\tthis.setState({ [drawer]: open });\n\t};\n\t*/\n\t\n    render() {\n        return (\n\n<ThemeProvider theme={theme}>\n\t<TopBar title={this.props.settings.topBarTitle || (this.tabsEnabled && this.state.tabTitle) || 'jarvis'} connectionStatus={this.props.connectionStatus}>\n\t\t{this.tabsEnabled && <TabBar tabs={this.tabs} selectTab={this.selectTab} />}\n\t</TopBar>\n\t\n\t{/*\n\t<Drawer anchor=\"right\" open={this.state.notificationDrawer} onClose={this.toggleDrawer('notificationDrawer', false)}>\n\t\t\n\t</Drawer>\n\t*/}\n\n\t<Popup open={this.state.dialog} contents={this.state.dialogContents} closeDialog={this.closeDialog} />\n\t{this.getTabPanels()}\n\t\n</ThemeProvider>\n\n\t\t)\n\t}\n}\n","import React from 'react'\nimport LogRocket from 'logrocket'\nimport uuid from 'uuid/v3'\n\nimport Grid from '@material-ui/core/Grid'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport Typography from '@material-ui/core/Typography'\nimport Skeleton from '@material-ui/lab/Skeleton'\n\nimport GridContainer from './components/GridContainer'\nimport StatusSnackbar from './components/StatusSnackbar'\n\nimport i18n from './i18n'\nimport Connection from './Connection'\nimport Device from './Device'\nimport Jarvis from './Jarvis'\n\n\n/*\n * STYLES\n */\nimport { withStyles } from '@material-ui/core/styles';\nconst styles = theme => ({\n\tloading: {\n\t\tmargin: '10px 0 0 0',\n\t\tcolor: '#999'\n\t},\n\tgridItem: {\n\t\tmargin: theme.spacing(1, 1, 0, 0),\n\t\t[theme.breakpoints.down('md')]: {\n\t\t\tmarginRight: theme.spacing(0.4, 0.4, 0, 0)\n\t\t}\n\t}\n});\n\n\n/*\n * CONSTANTS\n *\n */\nconst NODE_SETTINGS = 'jarvis.0.settings';\nconst NODE_DEVICES = 'jarvis.0.devices';\n\n\nclass App extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tloaded: [],\n\t\t\tconnected: false,\n\t\t\terror: false,\n\t\t\terrorMessage: ''\n\t\t}\n\t};\n\t\n\tcomponentDidMount() {\n\t\t\n\t\t// connect and get connection\n\t\tconst url = window.location.hostname === 'localhost' ? 'https://192.168.178.29:8082' : (window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : ''));\n\t\tconst listeners = [\n\t\t\t{ 'event': 'connect', 'callback': () => this.setState({ connected: true, error: false, errorMessage: '' }) },\n\t\t\t{ 'event': 'reconnect', 'callback': () => this.setState({ connected: 'pending', error: false, errorMessage: '' }) },\n\t\t\t{ 'event': 'disconnect', 'callback': reason => this.setState({ connected: false, error: true, errorMessage: reason + '..' })  },\n\t\t\t{ 'event': 'error', 'callback': err => this.setState({ connected: false, error: true, errorMessage: err + '..' }) }\n\t\t];\n\t\t\n\t\tthis.socket = Connection.connect(url, listeners);\n\t\t\n\t\t// retrieve settings\n\t\tthis.settings = {};\n\t\tthis.socket.getState(NODE_SETTINGS)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tif (state) {\n\t\t\t\t\t\tthis.settings = { ...this.settings, ...JSON.parse(state.val) || {} };\n\t\t\t\t\t\tthis.useSettings();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tthis.setState({ loaded: [ ...this.state.loaded, 'settings' ] });\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing settings!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: err\n\t\t\t\t});\n\t\t\t});\n\t\t\n\t\t// retrieve ioBroker config\n\t\tthis.settings.iobroker = {};\n\t\tthis.socket.getObject('system.config', (err, data) => {\n\t\t\tif (data && data.common) {\n\t\t\t\tthis.settings.iobroker = data.common;\n\t\t\t}\n\t\t});\n\t\t\n\t\t// retrieve devices\n\t\tthis.devices = {};\n\t\tthis.groups = {};\n\t\t\n\t\tthis.socket.getState(NODE_DEVICES)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.devices = JSON.parse(state.val);\n\t\t\t\t\tthis.processDevices(this.devices).then(groups => {\n\t\t\t\t\t\tthis.groups = groups;\n\t\t\t\t\t\tthis.setState({ loaded: [ ...this.state.loaded, 'groups' ] });\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing devices!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: 'Socket failed while getting devices!'\n\t\t\t\t});\n\t\t\t});\n    }\n\n\t/**\n\t *\n\t *\n\t */\n\tuseSettings() {\n\t\t\n\t\t// LogRocket\n\t\tif (this.settings.debug && this.settings.debug.name && this.settings.debug.email && this.settings.debug.email.indexOf('@') > -1) {\n\t\t\tLogRocket.init('36n1xl/jarvis');\n\t\t\t\n\t\t\tlet id = uuid(this.settings.debug.name + '#' + this.settings.debug.email, 'e63359dc-bc1c-476e-81cd-8f580d09a557');\n\t\t\tLogRocket.identify(id, {\n\t\t\t\tname: this.settings.debug.name,\n\t\t\t\temail: this.settings.debug.email\n\t\t\t});\n\t\t\t\n\t\t\tconsole.info('Opt-In for providing debugging details to the developer. Your ID is: ' + id);\n\t\t}\n\t\t\n\t\t// language\n\t\twindow.language = (this.settings.language || navigator.language || navigator.userLanguage || 'en').substr(0, 2);\n\t\ti18n.setLanguage(window.language);\n\t\ti18n.loadTranslations(['en', 'de']);\n\t\t\n\t\t// page title\n\t\tif (this.settings.pageTitle) {\n\t\t\tdocument.title = this.settings.pageTitle;\n\t\t}\n\t\t\n\t\t// favicon\n\t\tif (this.settings.pageFavicon && this.settings.pageFavicon.substr(0, 5) === 'data:') {\n\t\t\tdocument.getElementById('favicon').href = this.settings.pageFavicon;\n\t\t}\n\t\t\n\t\t// translations\n\t\tif (this.settings.translations) {\n\t\t\t\n\t\t\tlet translations = this.settings.translations;\n\t\t\tfor (let language in translations) {\n\t\t\t\ti18n.setTranslation(language, translations[language]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tgroupDevice(groups, device) {\n\t\t\n\t\t// add device to group(s)\n\t\tlet options = device.get('options');\n\t\toptions.groups.forEach(group => {\n\t\t\t\n\t\t\tlet groupId = group.toLowerCase().replace(/ /g, '');\n\t\t\tif (!groups[groupId]) {\n\t\t\t\tgroups[groupId] = { 'id': groupId, 'name': group, 'devices': [device] };\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgroups[groupId].devices.push(device);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn groups;\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevice(deviceProperties) {\n\t\t\n\t\tlet promises = [];\n\t\tlet device = null;\n\t\ttry {\n\t\t\tdevice = new Device(deviceProperties, this.socket, window.language);\n\t\t\t\n\t\t\t// request primary state value\n\t\t\tpromises.push(device.requestDeviceState(null, true));\n\t\t\t\n\t\t\t// request secondary state value\n\t\t\tif (device.secondaryStateKey) {\n\t\t\t\tpromises.push(device.requestDeviceState(device.secondaryStateKey, true));\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tcatch(err) {\n\t\t\tconsole.warn(err.message);\n\t\t}\n\t\t\n\t\treturn new Promise(resolve => {\n\t\t\tPromise.allSettled(promises).then(results => {\n\t\t\t\t\n\t\t\t\tresults.forEach(result => {\n\t\t\t\t\tif (result.status === 'rejected') {\n\t\t\t\t\t\tconsole.error(result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tresolve(device);\n\t\t\t});\n\t\t});\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevices(deviceList) {\n\t\t\n\t\t// loop through all devices of in the device list\n\t\tlet promises = [];\n\t\tlet groups = {};\n\t\t\n\t\tlet devices = 0, groupedDevices = 0;\n\t\tfor (let deviceId in deviceList) {\n\t\t\tdevices++;\n\t\t\t\n\t\t\tdeviceList[deviceId].options = deviceList[deviceId].jarvis;\n\t\t\tdelete deviceList[deviceId].jarvis;\n\t\t\t\n\t\t\tlet deviceProperties = { ...deviceList[deviceId], 'id': deviceId };\n\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\n\t\t\t\tthis.processDevice(deviceProperties).then(device => {\n\t\t\t\n\t\t\t\t\tif (device !== null) {\n\t\t\t\t\t\tgroupedDevices++;\n\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t\t\t\tresolve(deviceId);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treject(deviceId);\n\t\t\t\t});\n\t\t\t}));\n\t\t\t\n\t\t\t// check states for own device settings\n\t\t\tfor (let stateKey in deviceProperties.states) {\n\t\t\t\t\n\t\t\t\tlet state = deviceProperties.states[stateKey];\n\t\t\t\tif (state && state.jarvis !== undefined) {\n\t\t\t\t\t\n\t\t\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.processDevice({ ...deviceProperties, 'id': deviceId + '#' + stateKey, 'states': { [stateKey]: state }, 'options': state.jarvis }).then(device => {\n\t\t\t\t\t\n\t\t\t\t\t\t\tif (device !== null) {\n\t\t\t\t\t\t\t\tgroupedDevices++;\n\t\t\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t\t\t\t\t\tresolve(deviceId);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treject(deviceId);\n\t\t\t\t\t\t});\n\t\t\t\t\t}));\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn new Promise(resolve => Promise.allSettled(promises).then(res => {\n\t\t\t\n\t\t\t// sort groups\n\t\t\tfor (let groupId in groups) {\n\t\t\t\tgroups[groupId].devices.sort((item1, item2) => {\n\t\t\t\t\tif (item1.options.sort > item2.options.sort) return 1;\n\t\t\t\t\telse if (item2.options.sort > item1.options.sort) return -1;\n\t\t\t\t\telse return 0;\n\t\t\t\t});\n\t\t\t}\n\t\t\n\t\t\t// return\n\t\t\tconsole.info('Processed ' + devices + ' devices. Added ' + groupedDevices + ' devices in ' + Object.keys(groups).length + ' groups.', res, groups);\n\t\t\tresolve(groups);\n\t\t}));\n\t};\n\t\n\trenderError() {\n\t\tconsole.error(JSON.stringify(this.state.errorMessage));\n\t\treturn (\n\n<StatusSnackbar\n\tkey={'StatusSnackbar'}\n\tvariant=\"error\"\n\tcloseButton={false}\n\tmessage={this.state.errorMessage.toString()}\n\t/>\n\n\t\t);\n\t}\n\t\n\trenderLoadingProgress() {\n\t\tconst { classes } = this.props;\n\t\treturn (\n\n<Grid\n\tkey=\"loadingProcess\" \n\tcontainer\n\tspacing={0}\n\tdirection=\"column\"\n\tjustify=\"center\"\n\talignItems=\"center\"\n\tstyle={{ minHeight: \"100vh\" }}\n\t>\n\n\t<CircularProgress />\n\t<Typography className={classes.loading}>{i18n.t('Retrieving settings')}...</Typography>\n\n</Grid>\n\n\t\t);\n\t};\n\t\n\trenderLoadingSkeleton(props) {\n\t\tconst { classes } = this.props;\n\t\tconst { topBar, tabBar, gridColumns } = props;\n\t\t\n\t\tconst SkeletonLoader = (props) => <Skeleton animation=\"wave\" variant=\"rect\" className={classes.gridItem} height={props.height} />;\n\t\t\n\t\tlet gridContents = {}\n\t\tfor (let column = 1; column <= gridColumns; column++) {\n\t\t\tgridContents[column] = gridContents[column] || [];\n\t\t\t\n\t\t\tlet loaders = Math.random() * (5 - 2) + 2;\n\t\t\tfor (let loader = 1; loader <= loaders; loader++) {\n\t\t\t\tgridContents[column].push(<SkeletonLoader key={column + '#' + loader} height={(Math.random() * (400 - 100) + 100)} />);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn (\n\n<React.Fragment>\n\t{topBar && <Skeleton animation=\"wave\" variant=\"rect\" height={64} />}\n\t{tabBar && <Skeleton animation=\"wave\" variant=\"rect\" height={48} />}\n\t<GridContainer key=\"loadingSkeleton\" contents={gridContents} />\n</React.Fragment>\n\n\t\t);\n\t}\n\t\n    render() {\n\t\t\n\t\t// error message\n\t\tconst error = this.state.error ? this.renderError() : null;\n\t\t\n\t\t// loading screens\n\t\tif (this.state.error && this.state.loaded.length < 2) {\n\t\t\treturn error;\n\t\t}\n\t\telse if (this.state.loaded.indexOf('settings') === -1) {\n\t\t\treturn this.renderLoadingProgress();\n\t\t}\n\t\telse if (this.state.loaded.indexOf('groups') === -1) {\n\t\t\tconst tab = Object.keys(this.settings.layout)[0];\n\t\t\treturn this.renderLoadingSkeleton({ topBar: true, tabBar: tab !== 1, gridColumns: (tab !== 1 ? Object.keys(this.settings.layout[tab]).length : tab.length) });\n\t\t}\n\t\t\n\t\t// App\n\t\treturn [ error, <Jarvis key=\"jarvis\" connectionStatus={this.state.connected} settings={this.settings} groups={this.groups} /> ];\n\t};\n}\n\nexport default withStyles(styles)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport './index.css'\r\nimport App from './App'\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","/**\r\n *\r\n *\r\n */\r\nfunction HsvToRgb(h, s = 1, v = 1) {\r\n\tif (Array.isArray(h)) {\r\n\t\tv = h[2];\r\n\t\ts = h[1];\r\n\t\th = h[0];\r\n\t}\r\n\telse if (typeof h === 'string' && h.indexOf(',')) {\r\n\t\t[h, s, v] = h.split(',');\r\n\t}\r\n\t\r\n\tif (h > 1) {\r\n\t\th = h/360;\r\n\t}\r\n\t\r\n\tlet r, g, b, i, f, p, q, t;\r\n\t\r\n\ti = Math.floor(h * 6);\r\n\tf = h * 6 - i;\r\n\tp = v * (1 - s);\r\n\tq = v * (1 - f * s);\r\n\tt = v * (1 - (1 - f) * s);\r\n\t\r\n\tswitch (i % 6) {\r\n\t\tcase 0:\r\n\t\t\tr = v;\r\n\t\t\tg = t;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\t\r\n\t\tcase 1:\r\n\t\t\tr = q;\r\n\t\t\tg = v;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 2:\r\n\t\t\tr = p;\r\n\t\t\tg = v;\r\n\t\t\tb = t;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 3:\r\n\t\t\tr = p;\r\n\t\t\tg = q;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 4:\r\n\t\t\tr = t;\r\n\t\t\tg = p;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 5:\r\n\t\t\tr = v;\r\n\t\t\tg = p;\r\n\t\t\tb = q;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault: // for webpack\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn [\r\n\t\tMath.round(r * 255),\r\n\t\tMath.round(g * 255),\r\n\t\tMath.round(b * 255)\r\n\t];\r\n}\r\n\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction RgbToHex(r, g, b) {\r\n\tif (Array.isArray(r)) {\r\n\t\tb = r[2];\r\n\t\tg = r[1];\r\n\t\tr = r[0];\r\n\t}\r\n\telse if (typeof r === 'string' && r.indexOf(',')) {\r\n\t\t[r, g, b] = r.split(',');\r\n\t}\r\n\t\r\n\tr = parseInt(r).toString(16);\r\n\tg = parseInt(g).toString(16);\r\n\tb = parseInt(b).toString(16);\r\n\t\r\n\tif (r.length === 1) r = '0' + r;\r\n\tif (g.length === 1) g = '0' + g;\r\n\tif (b.length === 1) b = '0' + b;\r\n\t\r\n\treturn \"#\" + r + g + b;\r\n}\r\n\r\n\r\nexport default {\r\n\tHsvToRgb,\r\n\tRgbToHex\r\n}","import React, { useState, useEffect } from 'react'\r\nimport { HuePicker, SketchPicker as ColorPicker } from 'react-color'\r\n\r\nimport helpers from '../helpers/colorConverter'\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction LightLevelAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked ? 100 : 0).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal > 0);\r\n\tuseEffect(() => setChecked(stateVal > 0), [stateVal]);\r\n\t\r\n\t// only show percentage if device has a switch itself\r\n\tif (device.parent && device.parent.states.power) {\r\n\t\treturn <defaults.actions.Action {...props} stateVal={checked} onChange={onChange} />;\r\n\t}\r\n\t\r\n\treturn <defaults.actions.PowerAction {...props} stateVal={checked} onChange={onChange} />\r\n}\r\n\r\nfunction LightColorAction(props) {\r\n\tconst { stateKey, stateVal } = props;\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(stateVal);\r\n\tuseEffect(() => setColorSpace(stateVal), [stateVal]);\r\n\t\r\n\tlet colors, labels = {};\r\n\tif (stateKey === 'rgb' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Red: colors[0], Green: colors[1], Blue: colors[2] };\r\n\t\t\r\n\t}\r\n\telse if (stateKey === 'hsv' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Hue: colors[0], Saturation: colors[1], Brightness: colors[2] };\r\n\t}\r\n\t\r\n\tconst Label = defaults.components.Label;\r\n\tlet label = [];\r\n\tfor (let key in labels) {\r\n\t\tlabel.push(<Label key={key} label={key + ' ' + labels[key]} br={true} />);\r\n\t}\r\n\t\r\n\treturn label;\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction LightColorTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={2000} max={6500} step={10} {...props} />\r\n\t);\r\n}\r\n\r\nfunction LightHueComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tsetHue(Math.round(color.hsl.h));\r\n\t\tdevice.setDeviceState(stateKey, Math.round(color.hsl.h)).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [hue, setHue] = useState(stateVal);\r\n\tuseEffect(() => setHue(stateVal), [stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\tconst color = helpers.RgbToHex(helpers.HsvToRgb(hue));\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<HuePicker\r\n\t\tcolor={color}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\nfunction LightColorComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tcolor = color[stateKey];\r\n\t\t\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tcolor = [color.r, color.g, color.b].join(',');\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tcolor = [color.h, color.s, color.v].join(',');\r\n\t\t}\r\n\t\t\r\n\t\tdevice.setDeviceState(stateKey, color).catch(err => console.error(err));\r\n\t};\r\n\t\r\n\tlet initialColor = stateVal || '#ffffff';\r\n\t\r\n\t// RGB\r\n\tif (stateKey === 'rgb') {\r\n\t\tinitialColor = helpers.RgbToHex(initialColor);\r\n\t}\r\n\t// HSV\r\n\telse if (stateKey === 'hsv') {\r\n\t\tinitialColor = helpers.RgbToHex(helpers.HsvToRgb(initialColor));\r\n\t}\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(initialColor);\r\n\tuseEffect(() => {\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(stateVal));\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(helpers.HsvToRgb(stateVal)));\r\n\t\t}\r\n\t\t// HEX\r\n\t\telse if (stateKey === 'hex') {\r\n\t\t\tsetColorSpace(stateVal);\r\n\t\t}\r\n\t}, [stateKey, stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<ColorPicker\r\n\t\tcolor={colorSpace}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\nconst color = {\r\n\ticon: {\r\n\t\t'default': 'palette',\r\n\t},\r\n\tunit: ' °'\r\n}\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tpower: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'lightbulb-on',\r\n\t\t\t\t'false': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tvalue: (val) => val > 0 && val <= 1 ? val * 100 : val,\r\n\t\t\tunit: (value) => value !== 'off' ? ' %' : null,\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'lightbulb-on',\r\n\t\t\t\t'0': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': 'off'\r\n\t\t\t},\r\n\t\t},\r\n\t\tcolorTemperature: {\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'thermometer',\r\n\t\t\t},\r\n\t\t\tunit: ' °K'\r\n\t\t},\r\n\t\thue: color,\r\n\t\trgb: color,\r\n\t\thsv: color,\r\n\t\thex: color\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel: defaults.components.LevelComponent,\r\n\t\tcolorTemperature: LightColorTemperatureComponent,\r\n\t\trgb: LightColorComponent,\r\n\t\thsv: LightColorComponent,\r\n\t\thex: LightColorComponent,\r\n\t\thue: LightHueComponent\r\n\t},\r\n\tactions: {\r\n\t\tpower: defaults.actions.PowerAction,\r\n\t\tlevel: LightLevelAction,\r\n\t\trgb: LightColorAction,\r\n\t\thsv: LightColorAction,\r\n\t\thex: LightColorAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import EventEmitter from 'events'\r\nimport io from 'socket.io-client'\r\n\r\n\r\n/**\r\n * Class for Socket.io conncetion handling.\r\n *\r\n * @description This is based on an implementation @GermanBluefox (https://github.com/GermanBluefox), see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\t\t\t\tOnly required functions are taken from source class. Major change is that all events are emitted, so proper error handling is possible in the App.\r\n *\r\n *\r\n * @param\t{String}\t\turl\r\n * @param\t{Object}\t\toptions\r\n * @return\t{Socket}\r\n * @see https://github.com/ioBroker/ioBroker.socketio/blob/master/lib/socket.js https://github.com/ioBroker/ioBroker.js-controller/blob/master/lib/adapter.js#L635\r\n *\r\n */\r\nexport default class Socket extends EventEmitter {\r\n\t\r\n\tconstructor(url = null, options = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\t// socket connection\r\n\t\tthis.socket = io(url, { timeout: 10000, ...options, query: 'ws=true' });\r\n\t\tthis.statesSubscribes = {}; // subscribed states\r\n\t\t\r\n\t\t/*\r\n\t\t * API events\r\n\t\t * @see https://github.com/socketio/socket.io-client/blob/HEAD/docs/API.md#socket\r\n\t\t *\r\n\t\t */\r\n\t\t// connect\r\n\t\tthis.socket.on('connect', () => this.emit('connect'));\r\n\t\t\r\n\t\t// reconnect: Fired upon a successful reconnection.\r\n\t\tthis.socket.on('reconnect', attempts => this.emit('reconnect', attempts));\r\n\t\t\r\n\t\t// reconnect_error: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_error', error => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// reconnect_failed: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_failed', () => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_failed', 'message': 'Reconnection failed!' }));\r\n\t\t\r\n\t\t// discconect\r\n\t\tthis.socket.on('disconnect', reason => this.emit('disconnect', reason));\r\n\t\t\r\n\t\t// connect_error\r\n\t\tthis.socket.on('connect_error', error => this.emit('error', { 'type': 'connect', 'event': 'connect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// connect_timeout\r\n\t\tthis.socket.on('connect_timeout', () => this.emit('error', { 'type': 'connect', 'event': 'connect_timeout', 'message': 'Connect ran into timeout!' }));\r\n\t\t\r\n\t\t// error\r\n\t\tthis.socket.on('error', error => this.emit('error', { 'type': 'error', 'event': 'error', 'message': error.message }));\r\n\t\t\r\n\t\t/*\r\n\t\t * ioBroker events\r\n\t\t *\r\n\t\t */\r\n\t\tthis.socket.on('stateChange', (id, state) => setTimeout(() => this.stateChange(id, state), 0));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to multiple states by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeStates(ids, cb) {\r\n\t\tids = Array.isArray(ids) ? ids : [ids];\r\n\t\tids.forEach(id => this.subscribeState(id, cb));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to a state by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeState(id, cb) {\r\n\t\t\r\n\t\tif (!this.statesSubscribes[id]) {\r\n\t\t\tlet reg = id\r\n\t\t\t\t.replace(/\\./g, '\\\\.')\r\n\t\t\t\t.replace(/\\*/g, '.*')\r\n\t\t\t\t.replace(/\\(/g, '\\\\(')\r\n\t\t\t\t.replace(/\\)/g, '\\\\)')\r\n\t\t\t\t.replace(/\\+/g, '\\\\+')\r\n\t\t\t\t.replace(/\\[/g, '\\\\[');\r\n\r\n\t\t\tif (reg.indexOf('*') === -1) {\r\n\t\t\t\treg += '$';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.statesSubscribes[id] = { reg: new RegExp(reg), cbs: [cb] };\r\n\t\t\t\r\n\t\t\tif (this.socket.connected) {\r\n\t\t\t\tthis.socket.emit('subscribe', id);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.statesSubscribes[id].cbs.indexOf(cb) === -1 && this.statesSubscribes[id].cbs.push(cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Fires pre-registered callbacks (via subscribeState) upon state change.\r\n\t *\r\n\t */\r\n\tstateChange(id, state) {\r\n\t\t\r\n\t\tid = id ? id.replace(/[\\s'\"]/g, '_') : '';\r\n\t\tfor (const task in this.statesSubscribes) {\r\n\t\t\tif (this.statesSubscribes.hasOwnProperty(task) && this.statesSubscribes[task].reg.test(id)) {\r\n\t\t\t\tthis.statesSubscribes[task].cbs.forEach(cb => cb(id, state));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetAdapterInstances(adapter, cb) {\r\n\t\t\r\n\t\tif (typeof adapter === 'function') {\r\n\t\t\tcb = adapter;\r\n\t\t\tadapter = null;\r\n\t\t}\r\n\t\t\r\n\t\treturn this.getObjectView('system', 'instance', { 'startkey': 'system.adapter.' + (adapter ? adapter + '.' : ''), 'endkey': 'system.adapter.' + (adapter ? adapter + '.999' : 'zzz') }, cb);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object.\r\n\t *\r\n\t */\r\n\tgetObject(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getObject(id, (err, obj) => err ? reject(err) : resolve(obj)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getObject', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetObjectView(design, search, params, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getObjectView(design, search, params, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getObjectView', design, search, params, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a remote ressource.\r\n\t *\r\n\t */\r\n\tgetRemoteResource(url, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getRemoteResource(url, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('httpGet', url, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a state.\r\n\t *\r\n\t */\r\n\tgetState(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getState(id, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getState', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets multiple states at once.\r\n\t *\r\n\t */\r\n\tgetStates(pattern, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStates(pattern, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getStates', pattern, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the state history.\r\n\t *\r\n\t */\r\n\tgetStateHistory(id, options, cb) {\r\n\t\t\r\n\t\tif (typeof options === 'function') {\r\n\t\t\tcb = options;\r\n\t\t\toptions = {};\r\n\t\t}\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStateHistory(id, options, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getHistory', id, options, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a state.\r\n\t *\r\n\t */\r\n\tsetState(id, val, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.setState(id, val, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('setState', id, val, cb);\r\n\t\t}\r\n\t}\r\n}\r\n","import Socket from './Socket'\r\n\r\n/**\r\n * Connection\r\n +\r\n *\r\n */\r\nexport default class Connection {\r\n\r\n\t/*\r\n\t * URL\r\n\t */\r\n\tstatic url = window.location.hostname;\r\n\t\r\n\t/*\r\n\t * Connection\r\n\t */\r\n\tstatic connection = null;\r\n\t\r\n\t/**\r\n\t * Connects to the Socket.\r\n\t *\r\n\t * @param\t{String}\turl\r\n\t * @param\t{Array}\t\tlisteners\r\n\t * @return\t{Connection}\r\n\t */\r\n\tstatic connect(url = null, listeners = null) {\r\n\t\t\r\n\t\t// set URL\r\n\t\tif (url) {\r\n\t\t\tConnection.setUrl = url;\r\n\t\t}\r\n\t\t\r\n\t\t// connect\r\n\t\tConnection.connection = new Socket(Connection.url);\r\n\t\t\r\n\t\t// set listeners\r\n\t\tif (listeners) {\r\n\t\t\tConnection.setListeners = listeners;\r\n\t\t}\r\n\t\t\r\n\t\t// return connection\r\n\t\treturn Connection.connection;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the current Connection.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Connection}\tCurrent Connection\r\n\t */\r\n\tstatic get getConnection() {\r\n\t\treturn Connection.connection || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get the current URL.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get getUrl() {\r\n\t\treturn Connection.url;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets an event listener.\r\n\t *\r\n\t * @param\t{Object}\t\t\tlistener\r\n\t * @param\t{String}\t\t\tlistener.event\r\n\t * @param\t{Function}\t\t\tlistener.callback\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setListener(listener) {\r\n\t\tConnection.connection.on(listener.event, listener.callback);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set event listeners.\r\n\t *\r\n\t * @param\t{Array<Object>}\t\tlisteners\r\n\t * @return \t{Boolean}\r\n\t */\r\n\tstatic set setListeners(listeners = []) {\r\n\t\t\r\n\t\tif (!listeners || !Array.isArray(listeners)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tlisteners.forEach(listener => Connection.setListener = listener);\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a new URL (has to be set before calling connect()).\r\n\t *\r\n\t * @param\t{String}\tURL\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setUrl(url) {\r\n\t\tConnection.url = url;\r\n\t}\r\n}\r\n"],"sourceRoot":""}