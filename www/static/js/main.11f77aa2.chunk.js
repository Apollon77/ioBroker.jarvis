(this.webpackJsonpjarvis=this.webpackJsonpjarvis||[]).push([[0],{129:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(497),r=n(21),s=n(15),c=n(28),l=n(14),u=n(29),d=n(9),f=n(6),p=n(2),h=n(512),g=n(494),m=n(496),v=n(495),b=n(42),y=n(5),j=function(e){return{defaultListDivider:{margin:"0 0 5px 0"},defaultListSectionDivider:{margin:"5px 0 0 0"},defaultListSectionText:Object(f.a)({margin:"5px 0 0 0"},e.breakpoints.down("md"),{margin:"5px 0 0 10px"}),defaultListIcon:function(t){return Object(d.a)({},e.components.icon,{},t.styles)},horizontalListItem:{display:"inline-block",textAlign:"center",paddingRight:"16px",width:"140px",marginTop:"10px"},horizontalListItemIcon:{minWidth:"auto"},horizontalListItemAction:{textAlign:"center",top:0,right:0,position:"static",transform:"none"},verticalListItemAction:{textAlign:"right"}}},O=Object(y.a)(j)((function(e){var t=e.classes,n=e.title;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h.a,{divider:!0,className:t.defaultListSectionDivider}),o.a.createElement("li",null,o.a.createElement(b.a,{className:t.defaultListSectionText,display:"block",variant:"caption"},n)))})),S=Object(y.a)(j)((function(e){var t=e.customClassNames,n=e.children,a=e.classes,i=Array.isArray(t)?t:[t];return i=i.map((function(e){return a[e]?a[e]:e})),o.a.createElement("span",{className:Object(p.a)(i)},n)})),k=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={},n.state[n.props.device.primaryStateKey]=n.props.device.getDeviceState()||{},n.props.device.secondaryStateKey&&(n.state[n.props.device.secondaryStateKey]=n.props.device.getDeviceState(n.props.device.secondaryStateKey)||{}),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.device.on("stateChange",(function(t,n){t!==e.props.device.primaryStateKey&&t!==e.props.device.secondaryStateKey||e.setState(Object(f.a)({},t,n))}))}},{key:"openDialog",value:function(){this.props.openDialog(this.props.device)}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.horizontal,a=e.prevSubgroup,i=e.device,r=e.component,s=e.action,c=this.state[i.primaryStateKey],l=i.get("options"),u=i.getIcon(i.primaryStateKey,c.val),d=i.getAction(),f=s&&this.state[i.secondaryStateKey]?i.getAction(i.secondaryStateKey):null;return o.a.createElement(o.a.Fragment,null,l.divider&&"after"!==l.divider&&o.a.createElement(h.a,{divider:!0,className:t.defaultListDivider}),null!==a&&null!==l.subgroup&&l.subgroup!==a&&o.a.createElement(O,{title:l.subgroup}),o.a.createElement(h.a,{className:Object(p.a)(this.props.openDialog&&t.finger,n&&t.horizontalListItem),button:null!==this.props.openDialog,onClick:this.props.openDialog&&this.openDialog.bind(this)},o.a.createElement(g.a,{className:Object(p.a)(n&&t.horizontalListItemIcon)},null===u?o.a.createElement(o.a.Fragment,null):o.a.createElement(S,{customClassNames:["defaultListIcon","mdi mdi-"+u],styles:i.getStyle("icon",i.primaryStateKey,c.val)})),o.a.createElement(v.a,{primary:r&&i.getComponent()||i.getOption("label"),secondary:null!==l.subtitle&&(l.subtitle||c&&c.timeChanged)||null}),o.a.createElement(m.a,{className:n?t.horizontalListItemAction:t.verticalListItemAction},f?[d,o.a.createElement("br",{key:"br_"+i.id}),f]:d)),l.divider&&"after"===l.divider&&o.a.createElement(h.a,{divider:!0,style:{margin:"5px 0"}}))}}]),t}(o.a.Component),E=Object(y.a)(j)(k),w=n(133);n.d(t,"default",(function(){return x}));var C=Object(w.a)((function(e){return{horizontalList:{display:"flex",flexDirection:"row",flexWrap:"wrap"}}}));function x(e){var t,n=e.horizontal,a=e.openDialog,r=e.devices,s=e.component,c=e.action,l=C();return o.a.createElement(i.a,{dense:!0,className:n&&l.horizontalList},r.map((function(e){var i=o.a.createElement(E,{key:e.get("id"),horizontal:n,openDialog:a,prevSubgroup:t,device:e,component:s||!1,action:c||!0});return t=e.getOption("subgroup"),i})))}},156:function(e,t,n){"use strict";n.r(t);var a=n(30);t.default={configurations:{level:{icon:{default:"window-shutter-open",">90":"window-shutter-open","<=90":"window-shutter"}},level2:{unit:" %",icon:{default:"window-shutter-open",">90":"window-shutter-open","<=90":"window-shutter"}}},components:{level2:a.default.components.LevelComponent},actions:{},styles:{}}},157:function(e,t,n){"use strict";n.r(t),t.default={configurations:{open:{icon:{true:"door-open",false:"door-closed"},state:{true:"open",false:"closed"}}},components:{},actions:{},styles:{}}},214:function(e,t,n){e.exports=n(431)},219:function(e,t,n){},227:function(e,t,n){var a={"./de.js":228,"./en.js":229};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=i,e.exports=o,o.id=227},228:function(e,t,n){"use strict";n.r(t),t.default={"Retrieving settings":"Einstellungen werden geladen",on:"an",off:"aus",user:"User",users:"Users",door:"T\xfcr",window:"Fenster",open:"offen",closed:"geschlossen",power:"Ger\xe4t an",brightness:"Helligkeit",wind:"Wind",battery:"Batterie","blind#level":"Behangh\xf6he","blind#level2":"Lamellenposition","light#power":"Licht","light#level":"Helligkeit",colorTemperature:"Farbtemperatur",hue:"Farbe","light#rgb":"Farbraum Rot-Gr\xfcn-Blau (RGB)",hex:"Farbe",temperature:"Temperatur",humidity:"Luftfeuchtigkeit",setTemperature:"eingestellte Temperatur",bell:"Klingel",lock:"Schlo\xdf",presence:"Pr\xe4senz",running:"Ger\xe4t l\xe4uft",consumption:"Verbrauch"}},229:function(e,t,n){"use strict";n.r(t),t.default={level:"Brightness",colorTemperature:"Color Temperature",hue:"Color",color:"Color",hex:"Color"}},257:function(e,t){},260:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(30);t.default={configurations:{temperature:{value:function(e){return e.toFixed(1)},unit:" \xb0C"},setTemperature:{unit:" \xb0C",icon:"thermometer-chevron-up"},humidity:{unit:" %"}},components:{setTemperature:function(e){var t=i.default.components.LevelComponent;return o.a.createElement(t,Object.assign({min:0,max:35},e))}},actions:{},styles:{}}},30:function(e,t,n){"use strict";n.r(t);var a=n(22),o=n(12),i=n(6),r=n(9),s=n(0),c=n.n(s),l=n(2),u=n(42),d=n(441),f=n(436),p=n(133),h=n(5),g=Object(p.a)((function(e){return{component:{padding:e.spacing(2,8,2,2)},sliderMarkLabel:Object(i.a)({},e.breakpoints.down("md"),{display:"none","&:nth-child(5)":{display:"block"},"&:nth-child(15)":{display:"block"},"&:nth-child(25)":{display:"block"}})}})),m=Object(h.a)((function(e){return{primaryAction:function(e){return Object(r.a)({},e.styles)},secondaryAction:function(e){return Object(r.a)({color:"#999",fontSize:"14px"},e.styles)}}}))((function(e){var t=e.classes,n=e.device,a=e.state,o=e.stateKey;return c.a.createElement("span",{className:Object(l.a)(o===n.primaryStateKey&&t.primaryAction||o===n.secondaryStateKey&&t.secondaryAction)},a.value," ",a.unit)}));function v(e){var t=e.device,n=e.stateKey,a=e.stateVal,i=e.onChange,r=Object(s.useState)(a),l=Object(o.a)(r,2),u=l[0],d=l[1];return Object(s.useEffect)((function(){return d(a)}),[a]),c.a.createElement(c.a.Fragment,null,c.a.createElement(f.a,{checked:u,onChange:i||function(e){d(e.target.checked),t.setDeviceState(n,e.target.checked).catch((function(e){return console.error(e)}))},value:!0!==u,color:"primary"}))}function b(e){var t=e.label,n=e.br||!1;return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.a,null,t),n&&c.a.createElement("br",null))}function y(e){var t=e.title,n=e.children,a=g();return c.a.createElement(c.a.Fragment,null,c.a.createElement(b,{label:t}),c.a.createElement("div",{className:a.component},n))}function j(e){var t=e.device,n=e.stateKey,i=e.stateVal,r=e.title,l=e.min,u=e.max,f=e.step,p=e.markSteps,h=g(),m=Object(s.useState)(i),v=Object(o.a)(m,2),b=v[0],j=v[1];Object(s.useEffect)((function(){return j(i)}),[i]),f=f||1;var O=((u=u||100)-(l=l||0))/((p=p||11)-1)||10;return c.a.createElement(y,{title:r||n},c.a.createElement(d.a,{classes:{markLabel:h.sliderMarkLabel},onChangeCommitted:function(e,a){j(a),t.setDeviceState(n,a).catch((function(e){return console.error(e)}))},defaultValue:b,valueLabelDisplay:"auto",marks:Object(a.a)(Array(p).keys()).map((function(e){return{value:l+e*O,label:l+e*O}})),min:l,max:u,step:f}))}t.default={configurations:{_any:{value:function(e){return e.toString()}},battery:{unit:" %",icon:"battery-medium"},door:{icon:{true:"door-open",false:"door-closed"},state:{true:"open",false:"closed"}},humidity:{unit:" %",icon:"water-percent"},level:{unit:" %"},position:{icon:"map-marker"},power:{state:{true:"on",false:"off"},icon:"power"},temperature:{unit:" \xb0C",icon:"thermometer"},wind:{unit:" km/h",icon:"weather-windy"}},components:{Label:b,Component:y,LevelComponent:j,level:j},actions:{Action:m,PowerAction:v,power:v},styles:{_any:{state:{true:{color:"#090",fontWeight:"bold"},false:{color:"#999"}}}}}},36:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(9),o=n(21),i=n(15),r=function(){function e(){Object(o.a)(this,e)}return Object(i.a)(e,null,[{key:"setLanguage",value:function(t){return!!t&&(e.language=t,console.log("i18n: Set language to "+t+"."),!0)}},{key:"loadTranslations",value:function(t){return!!t&&((t=Array.isArray(t)?t:[t]).forEach((function(t){return e.loadTranslation(t)})),!0)}},{key:"loadTranslation",value:function(t){if(t){var a;try{a=n(227)("./"+t+".js").default}catch(o){return console.error(o.message),!1}return e.setTranslation(t,a),!0}return!1}},{key:"setTranslation",value:function(t,n){return!(!t||!n)&&(e.translations[t]=Object(a.a)({},e.translations[t]||{},{},n),console.log("i18n: Set translations for language "+t+"."),!0)}},{key:"getLanguage",value:function(){return e.lang}},{key:"t",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.language;if(t=t.toString(),e.translations[o])if(t.indexOf("#")>-1){for(var i=t.split("#");i.length>0&&!e.translations[o][i.join("#")];)i.shift();t=e.translations[o][i.join("#")]||t}else t=e.translations[o][t]||t;for(var r in a)t=t.replace(RegExp("%"+r+"%","g"),a[r]);return n.ucFirst&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t}}]),e}();r.translations={},r.language=navigator.language||navigator.userLanguage||"en"},422:function(e,t,n){"use strict";n.r(t),t.default={configurations:{position:{icon:"home"}},components:{},actions:{},styles:{}}},423:function(e,t,n){"use strict";n.r(t),t.default={configurations:{position:{icon:"account"}},components:{},actions:{},styles:{}}},424:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return r}));var a=n(0),o=n.n(a),i=n(129);function r(e){return o.a.createElement(i.default,Object.assign({horizontal:!0},e))}},425:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var a=n(6),o=n(9),i=n(12),r=n(0),s=n.n(r),c=n(2),l=n(24),u=n.n(l),d=n(437),f=n(439),p=n(433),h=n(438),g=n(36),m=n(435),v=n(42),b=n(440),y=n(203),j=n(133),O=Object(j.a)((function(e){return{map:{width:"100%",height:"100%"},mapOverview:{color:"#666",position:"absolute",left:0,bottom:0,width:"100%",height:"60px",zIndex:999,display:"flex",alignItems:"center","& > *":{margin:e.spacing(1),cursor:"pointer"}},mapIconContainer:{},mapIconParent:{backgroundColor:"#fff",boxShadow:"0 0 0 8px rgba(255, 255, 255, 0.3)",borderRadius:"50%",width:"100%",height:"100%"},mapIcon:{fontSize:"2rem",color:e.palette.primary.main,transform:"translate3d(4px, -4px,0)",display:"block","&:after":{content:'""',display:"block",padding:"50% 0%"}},mapTooltip:{}}}));function S(e){var t=e.settings,n=e.devices,l=O(),u=Object(r.useState)(t.component.defaultZoom),p=Object(i.a)(u,1)[0],h=Object(r.useState)(Array.isArray(t.component.defaultPosition)?t.component.defaultPosition:t.component.defaultPosition.split(",")),j=Object(i.a)(h,1)[0],S=Object(r.useState)({}),E=Object(i.a)(S,2),w=E[0],C=E[1],x=Object(r.useRef)(),D=Object(r.useCallback)((function(){x.current=this}),[]),T=Object(r.useCallback)((function(e){return x.current.flyTo(e.split(","))}),[]);Object(r.useEffect)((function(){n.forEach((function(e){e.requestDeviceState("position").catch((function(t){console.error(t),C((function(t){return t[e.id]?t:Object(o.a)({},t,Object(a.a)({},e.id,null))}))})),e.on("stateChange",(function(t,n){"position"===t&&C((function(t){return t[e.id]&&t[e.id].position===n.val?t:(e.options.position=n.val,Object(o.a)({},t,Object(a.a)({},e.id,e)))}))}))}))}),[n]);var K=[],L=[];if(n.length>0&&n.length===Object.keys(w).length){var I=function(e){var n=w[e];if(null!==n){var a=s.a.createElement(k,{key:"marker-"+n.id,position:n.options.position,device:n,settings:t.component});K.push(a);var o=null;if(n.attributes.avatar)o=s.a.createElement(y.a,{key:"overview-"+n.id,alt:n.name,src:n.attributes.avatar,onClick:function(){return T(n.options.position)}});else{var i=n.getIcon("position");o=s.a.createElement(y.a,{key:"overview-"+n.id,alt:n.name,onClick:function(){return T(n.options.position)}},s.a.createElement("span",{className:Object(c.a)("mdi mdi-"+i)}))}L.push(s.a.createElement(b.a,{key:"tooltip-"+n.id,title:n.name,"aria-label":n.name,arrow:!0},o))}};for(var _ in w)I(_)}return s.a.createElement(s.a.Fragment,null,s.a.createElement(m.a,{className:l.mapOverview},s.a.createElement(v.a,null,g.a.t("Jump to"),":"),L),s.a.createElement(d.a,{useFlyTo:!0,center:j,zoom:p,className:l.map,whenReady:D},s.a.createElement(f.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png"}),K))}function k(e){var t=e.position,n=e.device,a=e.settings,o=O(),i=null,l=40;if(console.info("Marker for "+n.function+" "+n.name+" added to map."),n.attributes&&n.attributes.avatar&&"data:image/"===n.attributes.avatar.substr(0,11))i=u.a.divIcon({className:o.mapIconContainer,html:'<img src="'+n.attributes.avatar+'" class="'+o.mapIconParent+'" />',iconSize:[64,64]});else{l=30;var d=n.getIcon("position");i=u.a.divIcon({className:o.mapIconContainer,html:'<div class="'+o.mapIconParent+'"><span class="'+Object(c.a)(o.mapIcon,"mdi mdi-"+d)+'"></span></div>',iconSize:[40,40]})}var f=Object(r.useCallback)((function(){this.closeTooltip().openTooltip()}),[]);return s.a.createElement(p.a,{riseOnHover:!0,position:Array.isArray(t)?t:t.split(","),icon:i,onMouseOver:f},s.a.createElement(h.a,{className:o.mapTooltip,direction:a.tooltipDirection||"bottom",permanent:a.tooltipPermanent||!0,offset:[0,l]},n.name))}},426:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var a=n(6),o=n(9),i=n(12),r=n(0),s=n.n(r),c=(n(2),n(198)),l=n(133),u=Object(l.a)((function(e){return{}}));function d(e){e.component;var t=e.devices,n=(u(),Object(r.useState)({})),l=Object(i.a)(n,2),d=l[0],f=l[1];Object(r.useEffect)((function(){t.forEach((function(e){e.requestDeviceStateHistory().catch((function(t){console.error(t),f((function(t){return t[e.id]?t:Object(o.a)({},t,Object(a.a)({},e.id,null))}))})),e.on("historyChange",(function(e,t){var n={};d[e]||(n[e]={labels:[],data:[]},t.forEach((function(t){n[e].labels.push(t.ts),n[e].data.push(t.val)})),f((function(t){return Object(o.a)({},t,Object(a.a)({},e,n[e]))})))}))}))}),[t]);var p={};return console.log(d),d&&d.brightness&&(p={labels:d.brightness.labels,datasets:[{label:"My First dataset",fill:!1,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:d.brightness.data}]}),s.a.createElement("div",{className:"chart-container",style:{position:"relative"}},s.a.createElement(c.a,{data:p}))}},431:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(18),r=n.n(i),s=(n(219),n(9)),c=n(22),l=n(21),u=n(15),d=n(28),f=n(14),p=n(29),h=n(6),g=n(130),m=n.n(g),v=n(191),b=n.n(v),y=n(485),j=n(507),O=n(42),S=n(508),k=n(133),E=Object(k.a)((function(e){return{gridContainer:Object(h.a)({paddingLeft:e.spacing(1)},e.breakpoints.down("md"),{paddingLeft:e.spacing(.4)})}}));function w(e){for(var t=e.contents,n=void 0===t?{}:t,a=E(),i=Object.keys(n).length,r=[],s=1;s<=i;s++)n[s]?r.push(o.a.createElement(y.a,{key:s,item:!0,xs:12,sm:6,md:6,lg:Math.round(12/i),xl:Math.round(12/i)},n[s])):console.warn("No content for column #"+s+"!");return o.a.createElement(y.a,{container:!0,spacing:0,className:a.gridContainer},r)}var C=n(3),x=n(2),D=n(511),T=n(489),K=n(490),L=n(96),I=n.n(L),_=n(192),N=n.n(_),A=n(193),P=n.n(A),B=n(194),F=n.n(B),H=n(195),z=n.n(H),R=n(103),M=n(487),V=Object(k.a)((function(e){return{success:{backgroundColor:R.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.main},warning:{backgroundColor:M.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}})),U={success:N.a,warning:P.a,error:F.a,info:z.a};function G(e){var t=V(),n=e.className,a=e.open,i=e.autoHideDuration,r=e.message,s=e.closeButton,c=e.onClose,l=e.variant,u=Object(C.a)(e,["className","open","autoHideDuration","message","closeButton","onClose","variant"]),d=U[l];return a=a||!0,i=i||null,o.a.createElement(D.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:a,autoHideDuration:i,onClose:c},o.a.createElement(T.a,Object.assign({className:Object(x.a)(t[l],n),message:o.a.createElement("span",{id:"client-snackbar",className:t.message},o.a.createElement(d,{className:Object(x.a)(t.icon,t.iconVariant)}),r),action:s&&[o.a.createElement(K.a,{key:"close","aria-label":"close",color:"inherit",onClick:c},o.a.createElement(I.a,{className:t.icon}))]},u)))}var q=n(36),W=n(97),J=n.n(W),Y=n(196),$=n.n(Y),Z=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(l.a)(this,t),(e=Object(d.a)(this,Object(f.a)(t).call(this))).socket=$()(n,Object(s.a)({timeout:1e4},a,{query:"ws=true"})),e.statesSubscribes={},e.socket.on("connect",(function(){return e.emit("connect")})),e.socket.on("reconnect",(function(t){return e.emit("reconnect",t)})),e.socket.on("reconnect_error",(function(t){return e.emit("error",{type:"reconnect",event:"reconnect_error",message:t.message})})),e.socket.on("reconnect_failed",(function(){return e.emit("error",{type:"reconnect",event:"reconnect_failed",message:"Reconnection failed!"})})),e.socket.on("disconnect",(function(t){return e.emit("disconnect",t)})),e.socket.on("connect_error",(function(t){return e.emit("error",{type:"connect",event:"connect_error",message:t.message})})),e.socket.on("connect_timeout",(function(){return e.emit("error",{type:"connect",event:"connect_timeout",message:"Connect ran into timeout!"})})),e.socket.on("error",(function(t){return e.emit("error",{type:"error",event:"error",message:t.message})})),e.socket.on("stateChange",(function(t,n){return setTimeout((function(){return e.stateChange(t,n)}),0)})),e}return Object(p.a)(t,e),Object(u.a)(t,[{key:"subscribeState",value:function(e,t){if(this.statesSubscribes[e])-1===this.statesSubscribes[e].cbs.indexOf(t)&&this.statesSubscribes[e].cbs.push(t);else{var n=e.replace(/\./g,"\\.").replace(/\*/g,".*").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\+/g,"\\+").replace(/\[/g,"\\[");-1===n.indexOf("*")&&(n+="$"),this.statesSubscribes[e]={reg:new RegExp(n),cbs:[t]},this.socket.connected&&this.socket.emit("subscribe",e)}}},{key:"stateChange",value:function(e,t){for(var n in e=e?e.replace(/[\s'"]/g,"_"):"",this.statesSubscribes)this.statesSubscribes.hasOwnProperty(n)&&this.statesSubscribes[n].reg.test(e)&&this.statesSubscribes[n].cbs.forEach((function(n){return n(e,t)}))}},{key:"getState",value:function(e,t){var n=this;if(!t)return new Promise((function(t,a){return n.getState(e,(function(e,n){return e?a(e):t(n)}))}));this.socket.emit("getState",e,t)}},{key:"getStateHistory",value:function(e,t,n){var a=this;if("function"===typeof t&&(n=t,t={}),!n)return new Promise((function(n,o){return a.getStateHistory(e,t,(function(e,t){return e?o(e):n(t)}))}));this.socket.emit("getHistory",e,t,n)}},{key:"setState",value:function(e,t,n){var a=this;if(!n)return new Promise((function(n,o){return a.setState(e,t,(function(e){return e?o(e):n()}))}));this.socket.emit("setState",e,t,n)}}]),t}(J.a),Q=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"connect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t&&(e.setUrl=t),e.connection=new Z(e.url),n&&(e.setListeners=n),e.connection}},{key:"getConnection",get:function(){return e.connection||null}},{key:"getUrl",get:function(){return e.url}},{key:"setListener",set:function(t){e.connection.on(t.event,t.callback)}},{key:"setListeners",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return!(!t||!Array.isArray(t))&&(t.forEach((function(t){return e.setListener=t})),!0)}},{key:"setUrl",set:function(t){e.url=t}}]),e}();Q.url=window.location.hostname,Q.connection=null;var X=n(41),ee={defaults:n(30).default,blind:n(156).default,door:n(157).default,heating:n(260).default,jalousie:n(156).default,light:n(432).default,location:n(422).default,user:n(423).default,window:n(157).default},te=function(e){function t(e){var n;if(Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this))).function=e,!n.function)throw new Error("No function given!");return n.functionId=n.function.toLowerCase(),n.defaults=ee.defaults.configurations,n.configurations=ee[n.functionId]&&ee[n.functionId].configurations||{},n.defaultStyles=ee.defaults.styles,n.styles=ee[n.functionId]&&ee[n.functionId].styles||{},n.components=Object(s.a)({},ee.defaults.components,{},ee[n.functionId]&&ee[n.functionId].components||{}),n.actions=Object(s.a)({},ee.defaults.actions,{},ee[n.functionId]&&ee[n.functionId].actions||{}),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"_applyFunction",value:function(e,t){return this._isFunction(e)?e(t):t}},{key:"_getValueFromSettings",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";for(var n in e)if(void 0!==e[n])return e[n];return t}},{key:"_isFunction",value:function(e){return e&&"function"===typeof e}},{key:"_isValue",value:function(e){return void 0!==e}},{key:"_setObjectStructure",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e&&"object"==typeof e?"object"!=typeof e||e.default||(e.default=t):e={default:e||t},e}}]),t}(J.a),ne=n(132),ae=function(e){function t(e,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.sysLang||"en";Object(l.a)(this,t);try{a=Object(d.a)(this,Object(f.a)(t).call(this,e.function))}catch(i){throw new Error("No function given for device "+e.name+"!")}if(a.id=e.id,a.name=e.name,a.room=e.room||null,a.states=e.states,a.options=e.options,a.attributes=e.attributes||{},a.socket=n,!a.options||"object"!==typeof a.options||0===Object.keys(a.options).length)throw new Error("Device"+(e.id||e.name?" "+(e.name||e.id):"")+" not defined for jarvis!");if(!a.states||"object"!==typeof a.states||0===Object.keys(a.states).length)throw new Error("Insufficent properties provided"+(e.id||e.name?" for device "+(e.name||e.id):"")+" (no states defined)!");if(!(a.id&&a.name&&a.function))throw new Error("Insufficent properties provided"+(e.id||e.name?" for device "+(e.name||e.id):"")+" (no id, name or function defined)!");if(!a.socket)throw new Error("No socket given!");return a.children=e.children||[],a.parent=e.parent||null,a._setProperties(),a.stateSubscriptions=[],a.historySubscriptions=[],ne.locale(o),a.on("error",(function(e){return console.error("Device error occured!",e)})),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"_getStateFromKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"state";if(e&&"object"===typeof e)return e;var n=this.states[e||this.primaryStateKey];if(!n||!n[t])return"Incorrect or non-defined state key for device "+this.name+"!";if("string"==typeof n[t])this.states[e||this.primaryStateKey][t]={node:n[t]},n=this.states[e||this.primaryStateKey];else if("object"==typeof n[t]&&!n[t].node)return"No "+t+" specified for device "+this.name+"!";return n}},{key:"_getConfigurationSetting",value:function(e,n,a,o){if(this[e][n]){if("object"===typeof this[e][n][a])return Object(X.a)(Object(f.a)(t.prototype),"_isValue",this).call(this,this[e][n][a][o])?this[e][n][a][o]:this[e][n][a].default;if(Object(X.a)(Object(f.a)(t.prototype),"_isFunction",this).call(this,this[e][n][a]))return this[e][n][a](o);if("string"===typeof this[e][n][a])return this[e][n][a]}else if(this[e]._any){if("object"===typeof this[e]._any[a])return Object(X.a)(Object(f.a)(t.prototype),"_isValue",this).call(this,this[e]._any[a][o])?this[e]._any[a][o]:this[e]._any[a].default;if(Object(X.a)(Object(f.a)(t.prototype),"_isFunction",this).call(this,this[e]._any[a]))return this[e]._any[a](o)}}},{key:"_getUserSetting",value:function(e,n,a){if(this.options[n][e])return"object"===typeof this.options[n][e]?Object(X.a)(Object(f.a)(t.prototype),"_isValue",this).call(this,this.options[n][e][a])?this.options[n][e][a]:this.options[n][e].default:Object(X.a)(Object(f.a)(t.prototype),"_isFunction",this).call(this,this.options[n][e])?this.options[n][e](a):this.options[n][e]}},{key:"_setProperties",value:function(){var e=this,n=Object.keys(this.states);this.options.ignoredStates&&(this.options.ignoredStates=Array.isArray(this.options.ignoredStates)?this.options.ignoredStates:[this.options.ignoredStates],this.options.ignoredStates.forEach((function(t){e.states[t]&&delete e.states[t]}))),this.options.hiddenStates=[],this.options.hideStates&&(this.options.hideStates=Array.isArray(this.options.hideStates)?this.options.hideStates:[this.options.hideStates],this.options.hideStates.forEach((function(t){e.states[t]&&e.options.hiddenStates.push(t)}))),this.primaryStateKey=this.options.primary||n[0],this.secondaryStateKey=this.options.secondary||null,["value","state","unit","icon","styles"].forEach((function(a){var o=e.options[a]&&Object.keys(e.options[a])[0];e.options[a]=e.options[a]?Object(X.a)(Object(f.a)(t.prototype),"_setObjectStructure",e).call(e,o&&n.indexOf(o)>-1?e.options[a]:Object(h.a)({},e.primaryStateKey,e.options[a])):{}})),this.options.groups=Array.isArray(this.options.group)?this.options.group:[this.options.group],this.options.sort=this.options.sort||999,this.options.label=this.options.label&&"string"===typeof this.options.label&&this.options.label.replace(/%name%/g,this.name)||this.options.label||this.name,this.options.divider=this.options.divider||!1}},{key:"_updateDeviceState",value:function(e,n){var a=this;return n.timeChanged=ne(n.lc-2e3).fromNow(),n.unit="",n.value=n.val,[{value:"value"},{state:"value"},{unit:"unit"}].forEach((function(o){var i=Object.keys(o).toString(),r=Object.values(o).toString(),s={};s.options=a._getUserSetting(e,i,n.value),["configurations","defaults"].forEach((function(t){s[t]=a._getConfigurationSetting(t,e,i,n.value)})),n[r]=Object(X.a)(Object(f.a)(t.prototype),"_getValueFromSettings",a).call(a,s,n[r])})),n.value=q.a.t(n.value),n}},{key:"get",value:function(e){return this[e]||null}},{key:"getAction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=e||this.primaryStateKey;var t=this.states[e].state.value,n=t.val,a=this.actions[e]||this.actions.Action;return o.a.createElement(a,{key:"action-"+this.id+"-"+e,device:this,state:t,stateKey:e,stateVal:n,styles:this.getStyle("state",e,n)})}},{key:"getComponent",value:function(e){e=e||this.primaryStateKey;var t=this.states[e].state.value.val,n=this.components[e];return n&&o.a.createElement(n,{title:q.a.t(this.function+"#"+e),device:this,stateKey:e,stateVal:t})||q.a.t(this.function+"#"+e)}},{key:"getDeviceState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.states[e||this.primaryStateKey],a=null;return n&&n.state&&null!==t&&void 0!==n.state.value&&void 0!==n.state.value[t]?a=n.state.value[t]:n&&n.state&&null===t&&void 0!==n.state.value&&(a=n.state.value),a}},{key:"getIcon",value:function(e){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"?";e=e||this.primaryStateKey;var i={};return i.options=this._getUserSetting(e,"icon",a),["configurations","defaults"].forEach((function(t){i[t]=n._getConfigurationSetting(t,e,"icon",a)})),Object(X.a)(Object(f.a)(t.prototype),"_getValueFromSettings",this).call(this,i,o)}},{key:"getOption",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";return this.options[e]&&(this.options[e][t]||this.options[e].default)||this.options[e]||null}},{key:"getStyle",value:function(e,n){var a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",i={};return i.options=this._getUserSetting(n,"styles",e,o),["styles","defaultStyles"].forEach((function(t){i[t]=a._getConfigurationSetting(t,n,e,o)})),Object(X.a)(Object(f.a)(t.prototype),"_getValueFromSettings",this).call(this,i,{})}},{key:"requestDeviceStates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[];for(var n in this.states)t.push(this.requestDeviceState(n,e));return t}},{key:"requestDeviceState",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=t||this.primaryStateKey;var a=this._getStateFromKey(t);return"string"==typeof a?Promise.reject({success:!1,stateKey:t,error:a}):new Promise((function(o,i){void 0!==a.state.value&&e.stateSubscriptions.indexOf(t)>-1?(e.emit("stateChange",t,a.state.value),o({success:!0,stateKey:t,cached:!0})):e.socket.getState(a.state.node).then((function(r){null===r&&i({success:!1,stateKey:t,error:"State "+a.state.node+" not found!"}),a.state.value=e._updateDeviceState(t,r),e.emit("stateChange",t,a.state.value),n&&e.subscribeDeviceState(t).catch((function(e){return i(e)})),o({success:!0,stateKey:t,cached:!1})})).catch((function(e){return i({success:!1,stateKey:t,error:e})}))}))}},{key:"requestDeviceStateHistory",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=t||this.primaryStateKey;var n=this._getStateFromKey(t);return"string"==typeof n?Promise.reject({success:!1,stateKey:t,error:n}):new Promise((function(a,o){void 0!==n.state.history&&e.historySubscriptions.indexOf(t)>-1?(e.emit("historyChange",t,n.state.history),a({success:!0,stateKey:t,cached:!0})):e.socket.getStateHistory(n.state.node).then((function(i){null===i&&o({success:!1,stateKey:t,error:"State "+n.state.node+" not found!"}),n.state.history=i,e.emit("historyChange",t,n.state.history),a({success:!0,stateKey:t,cached:!1})})).catch((function(e){return o({success:!1,stateKey:t,error:e})}))}))}},{key:"setAction",value:function(e){this.options.action=e}},{key:"setComponent",value:function(e){this.options.label=e}},{key:"setDeviceState",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;t=t||this.primaryStateKey;var a=this._getStateFromKey(t,"action");return"string"==typeof a?Promise.reject({success:!1,stateKey:t,error:a}):new Promise((function(o,i){e.socket.setState(a.action.node,n).then((function(n){-1===e.stateSubscriptions.indexOf(t)&&e.requestDeviceState(t),o({success:!0,stateKey:t})})).catch((function(e){return i({success:!1,stateKey:t,error:e})}))}))}},{key:"subscribeDeviceState",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t=t||this.primaryStateKey;var n=this._getStateFromKey(t);return"string"==typeof n?Promise.reject({success:!1,stateKey:t,error:n}):(this.stateSubscriptions.push(t),new Promise((function(a){e.socket.subscribeState(n.state.node,(function(a,o,i){o&&o.val!==e.getDeviceState(t,"val")&&(n.state.value=e._updateDeviceState(t,o),e.emit("stateChange",t,n.state.value),e.children.forEach((function(e){return e.emit("stateChange",t,n.state.value)})))})),a({success:!0,stateKey:t})})))}}]),t}(te),oe=n(35),ie=n(12),re=n(491),se=n(492),ce=Object(k.a)((function(e){return{appBar:{flexGrow:1,boxShadow:"none",transform:"none"},toolbar:{backgroundColor:e.palette.primary.main},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},icon:Object(s.a)({},e.components.icon,{color:"#fff",paddingRight:"6px",width:"1em",height:"1em",display:"inline-block",fontSize:"1.5rem",transition:"fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",flexShrink:0,userSelect:"none"})}}));function le(e){var t=ce(),n=e.children,a=e.title,i=a.indexOf("|")>-1?a.split("|"):[null,a],r=Object(ie.a)(i,2),s=r[0],c=r[1];return o.a.createElement(re.a,{id:"appBar",position:"static",className:t.appBar},o.a.createElement(se.a,{className:t.toolbar},o.a.createElement(O.a,{variant:"h6",className:t.title},s&&o.a.createElement("span",{className:Object(x.a)(t.icon,"mdi mdi-"+s)}),"null"!==c&&c)),n)}function ue(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var de=n(509),fe=n(493),pe=n(435),he=Object(k.a)((function(e){return{icon:Object(s.a)({},e.components.icon,{color:"#fff",paddingBottom:"6px",width:"1em",height:"1em",display:"inline-block",fontSize:"1.5rem",transition:"fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",flexShrink:0,userSelect:"none"}),tabs:{backgroundColor:e.palette.primary.main,paddingLeft:e.spacing(),color:"#fff",width:"calc(100% - "+e.spacing()+"px)",zIndex:101,borderBottom:"5px solid #eee"},fixed:{position:"fixed",top:0},indicator:{backgroundColor:"#fff"},fullscreen:{marginLeft:-e.spacing(),marginTop:"-5px"},grid:{paddingBottom:"30px"}}}));function ge(e){var t=e.tabs,n=e.selectTab,i=he(),r=Object(a.useRef)({}),s=Object(a.useState)(0),c=Object(ie.a)(s,2),l=c[0],u=c[1],d=Object(a.useState)(!1),f=Object(ie.a)(d,2),p=f[0],h=f[1],g=Object(a.useCallback)((function(){var e=r.current.top+r.current.height-53,t=window.scrollY>=e;h((function(n){return n!==t?(document.getElementById("root").style.paddingTop=t?e-5-8+"px":0,t):n}))}),[r]);Object(a.useEffect)((function(){return r.current={top:document.getElementById("tabBar").offsetTop,height:document.getElementById("tabBar").offsetHeight},window.addEventListener("scroll",g),function(){return window.removeEventListener("keydown",g,0)}}),[g]);var m=t.map((function(e,t){var n=e.indexOf("|")>-1?e.split("|"):[null,e],a=Object(ie.a)(n,2),r=a[0],s=a[1];return o.a.createElement(fe.a,{key:"tab"+t,icon:o.a.createElement("span",{className:Object(x.a)(i.icon,"mdi mdi-"+r)}),label:p||"null"===s?null:s})}));return o.a.createElement(de.a,{id:"tabBar",value:l,onChange:function(e,a){n(a,t[a]),u(a)},variant:"scrollable",classes:{root:Object(x.a)(i.tabs,p&&i.fixed),indicator:i.indicator}},m)}function me(e){var t=e.children,n=e.selectedTab,i=e.renderedTab,r=e.fullscreen,s=he(),c=function(){var e=Object(a.useState)(ue()),t=Object(ie.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){function e(){o(ue())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}().height,l=Object(a.useState)(c),u=Object(ie.a)(l,2),d=u[0],f=u[1],p=Object(a.useRef)({});Object(a.useEffect)((function(){p.current=document.getElementById("appBar").offsetHeight,f(c-p.current+5)}),[c]);var h=Object(a.useState)(null),g=Object(ie.a)(h,2),m=g[0],v=g[1];return Object(a.useEffect)((function(){setTimeout((function(){return v(n!==i)}),10)}),[n,i]),o.a.createElement(pe.a,{role:"tabpanel",hidden:m,id:"tabpanel-"+i,className:Object(x.a)(r?s.fullscreen:s.grid),style:{height:d+"px"}},t)}var ve=n(502),be=n(510),ye=n(499),je=n(500),Oe=n(501),Se={StateList:n(129).default,StateListHorizontal:n(424).default,Map:n(425).default,Chart:n(426).default},ke=n(5),Ee=Object(ke.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,n=e.classes,a=e.onClose,i=Object(C.a)(e,["children","classes","onClose"]);return o.a.createElement(ye.a,Object.assign({disableTypography:!0,className:n.root},i),o.a.createElement(O.a,{variant:"h6"},t),a?o.a.createElement(K.a,{"aria-label":"close",className:n.closeButton,onClick:a},o.a.createElement(I.a,null)):null)})),we=Object(ke.a)((function(e){return{root:Object(h.a)({padding:e.spacing(2)},e.breakpoints.down("md"),{paddingLeft:e.spacing(1)})}}))(je.a),Ce=Object(ke.a)((function(e){return{root:{margin:0,padding:e.spacing(1)}}}))(Oe.a),xe=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={children:[]},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e,t){var n=this,a=this.props.contents&&this.props.contents.device;if(a.id&&this.props.contents.ts!==e.contents.ts)if(a.children.length)console.info("Got "+Object.keys(a.children).length+" states for device "+a.name+" from cache."),this.setState({children:a.children},(function(){return n.forceUpdate()}));else{var o=[],i=[];for(var r in a.states)if(!(void 0===a.states[r].state||a.options.hiddenStates.indexOf(r)>-1)){var s=new ae({parent:a,id:a.id+"#"+r,name:a.name,function:a.function,states:Object(h.a)({},r,a.states[r]),options:{primary:r,divider:0!==i.length,subgroup:null,subtitle:null}},Q.getConnection,window.language);a.children.push(s),o.push(s.requestDeviceState(null,!0)),i.push(s)}Promise.allSettled(o).then((function(){console.info("Retrieved "+Object.keys(i).length+" states for device "+a.name+".",o),n.setState({children:i},(function(){return n.forceUpdate()}))}))}else a.id||this.props.contents.ts===e.contents.ts||this.setState({children:[]},(function(){return n.forceUpdate()}))}},{key:"shouldComponentUpdate",value:function(e,t){return!this.props.contents||this.props.contents.ts!==e.contents.ts}},{key:"render",value:function(){var e=this.props,t=e.open,n=e.closeDialog,a=e.contents.device;return o.a.createElement(be.a,{onClose:n,open:t||!1,maxWidth:"md",fullWidth:!0},o.a.createElement(Ee,{onClose:n},a.name),o.a.createElement(we,{dividers:!0,style:{padding:0}},o.a.createElement(Se.StateList,{openDialog:null,devices:this.state.children,component:!0,action:!0})),o.a.createElement(Ce,null,o.a.createElement(ve.a,{autoFocus:!0,onClick:n,color:"primary"},"Close")))}}]),t}(o.a.Component),De=n(503),Te=n(504),Ke=n(505),Le=n(203),Ie=Object(k.a)((function(e){return{card:Object(h.a)({margin:e.spacing(1,1,0,0)},e.breakpoints.down("md"),{margin:e.spacing(.4,.4,0,0)}),cardHeaderNoContents:{padding:e.spacing()},cardAvatar:function(t){return Object(s.a)({backgroundColor:e.palette.primary.main,color:"#fff",fontSize:"24px"},t)},cardContent:Object(h.a)({padding:e.spacing(0,2)},e.breakpoints.down("md"),{padding:e.spacing(0)})}}));function _e(e){var t=e.title,n=e.icon,a=e.iconStyle,i=Ie(a);return o.a.createElement(De.a,{className:i.card},o.a.createElement(Te.a,{avatar:null!==n&&o.a.createElement(Le.a,{variant:"rounded",classes:{root:i.cardAvatar}},o.a.createElement("span",{className:"mdi mdi-"+(n||"home")})),title:t&&o.a.createElement(O.a,{variant:"h5",component:"h2"},t)}),o.a.createElement(Ke.a,{className:i.cardContent},e.children))}var Ne=n(506),Ae=n(201),Pe=n(102),Be=n(200),Fe=n.n(Be).a[700],He=Pe.a,ze=Object(Ae.a)({palette:{primary:{main:Fe},secondary:He},components:{icon:{fontSize:"24px",color:Fe},finger:{cursor:"pointer"}}});console.debug(ze);var Re=ze,Me=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return console.error("Group "+e+" defined in columns but not assigned to any devices!"),null;t.settings.component="string"===typeof t.settings.component?{module:t.settings.component}:t.settings.component||{};var a=Se[t.settings.component.module||"StateList"];return void 0===a?(console.error('Undefined component "'+t.settings.component+'" used!'),null):o.a.createElement(a,{key:"Tag"+e,devices:t.devices,openDialog:n.action?n.action:null,settings:Object(s.a)({},t.settings,{},n)})},Ve=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={},i=Object.keys(e).length,r=1;r<=i;r++){var s=e[r];if(a[r]=a[r]||[],s&&0!==s.length)for(var c in s){var l=s[c],u=t[l],d=Me(l,u,n);d&&a[r].push(o.a.createElement(_e,{key:"Box-"+l+"-"+c,title:null!==u.settings.title?u.settings.title||u.name:null,icon:u.settings.icon,iconStyle:u.settings.iconStyle},d))}else a[r].push(null)}return a},Ue=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={selectedTab:0,tabTitle:"",notificationDrawer:!1,dialog:!1,dialogContents:{ts:0,device:{}}},n.closeDialog=n.closeDialog.bind(Object(oe.a)(n)),n.openDialog=n.openDialog.bind(Object(oe.a)(n)),n.selectTab=n.selectTab.bind(Object(oe.a)(n)),n.gridContents={},n.layout=n.props.settings.layout,n.tabs=Object.keys(n.layout),n.tabsEnabled=1!==n.tabs[0],n.state.tabTitle=n.tabs[n.state.selectedTab],n.tabsEnabled||(n.layout={Home:n.layout},n.tabs.push("1")),n.widgetProps={},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"getTabPanels",value:function(){var e=0,t=[];for(var n in this.layout){var a=this.layout[n];this.gridContents[n]||"string"!==typeof a?this.gridContents[n]||(this.gridContents[n]=o.a.createElement(w,{contents:Ve(a,this.props.groups,Object(s.a)({action:this.openDialog},this.widgetProps))})):this.gridContents[n]=Me(a,this.props.groups[a],Object(s.a)({action:this.openDialog},this.widgetProps));var i=o.a.createElement(me,{key:"tabPanel-"+e,renderedTab:e,selectedTab:this.state.selectedTab,fullscreen:"string"===typeof a},this.gridContents[n]);t.push(i),e++}return t}},{key:"closeDialog",value:function(){this.setState({dialog:!1,dialogContents:{ts:Date.now(),device:{}}})}},{key:"openDialog",value:function(e){this.setState({dialog:!0,dialogContents:{ts:Date.now(),device:e}})}},{key:"selectTab",value:function(e,t){this.setState({selectedTab:e,tabTitle:t})}},{key:"render",value:function(){return o.a.createElement(Ne.a,{theme:Re},o.a.createElement(le,{title:this.props.settings.topBarTitle||this.tabsEnabled&&this.state.tabTitle||"jarvis"},this.tabsEnabled&&o.a.createElement(ge,{tabs:this.tabs,selectTab:this.selectTab})),o.a.createElement(xe,{open:this.state.dialog,contents:this.state.dialogContents,closeDialog:this.closeDialog}),this.getTabPanels())}}]),t}(o.a.Component),Ge=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={loaded:[],error:!1,errorMessage:""},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=function(){return e.setState({error:!1,errorMessage:""})},n="localhost"===window.location.hostname?"https://192.168.178.29:8082":window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),a=[{event:"connect",callback:t},{event:"reconnect",callback:t},{event:"disconnect",callback:t},{event:"error",callback:function(t){return e.setState({error:!0,errorMessage:q.a.t("Connection lost! Trying to reconnect")+".."})}}];this.socket=Q.connect(n,a),this.settings={},this.socket.getState("jarvis.0.settings").then((function(t){try{e.settings=t&&JSON.parse(t.val),e.useSettings(),e.setState({loaded:[].concat(Object(c.a)(e.state.loaded),["settings"])})}catch(n){console.error("GET_SETTINGS: "+n.message),e.setState({error:!0,errorMessage:"Error parsing settings!"})}})).catch((function(t){console.error("GET_SETTINGS: "+t.message),e.setState({error:!0,errorMessage:t})})),this.devices={},this.groups={},this.socket.getState("jarvis.0.devices").then((function(t){try{e.devices=JSON.parse(t.val),e.processDevices(e.devices).then((function(t){e.groups=t,e.setState({loaded:[].concat(Object(c.a)(e.state.loaded),["groups"])})}))}catch(n){console.error("GET_DEVICES: "+n.message),e.setState({error:!0,errorMessage:"Error parsing devices!"})}})).catch((function(t){console.error("GET_DEVICES: "+t.message),e.setState({error:!0,errorMessage:"Socket failed while getting devices!"})}))}},{key:"useSettings",value:function(){if(this.settings.debug&&this.settings.debug.name&&this.settings.debug.email&&this.settings.debug.email.indexOf("@")>-1){m.a.init("36n1xl/jarvis");var e=b()(this.settings.debug.name+"#"+this.settings.debug.email,"e63359dc-bc1c-476e-81cd-8f580d09a557");m.a.identify(e,{name:this.settings.debug.name,email:this.settings.debug.email}),console.info("Opt-In for providing debugging details to the developer. Your ID is: "+e)}if(window.language=(this.settings.language||navigator.language||navigator.userLanguage||"en").substr(0,2),q.a.setLanguage(window.language),q.a.loadTranslations(["en","de"]),this.settings.pageTitle&&(document.title=this.settings.pageTitle),this.settings.pageFavicon&&"data:"===this.settings.pageFavicon.substr(0,5)&&(document.getElementById("favicon").href=this.settings.pageFavicon),this.settings.translations){var t=this.settings.translations;for(var n in t)q.a.setTranslation(n,t[n])}}},{key:"groupDevice",value:function(e,t){var n=this;return t.get("options").groups.forEach((function(a){var o=a.toLowerCase().replace(/ /g,"");e[o]?e[o].devices.push(t):e[o]={id:o,name:a,settings:n.settings.groups&&n.settings.groups[o]||{},devices:[t]}})),e}},{key:"processDevice",value:function(e){var t=[],n=null;try{n=new ae(e,this.socket,window.language),t.push(n.requestDeviceState(null,!0)),n.secondaryStateKey&&t.push(n.requestDeviceState(n.secondaryStateKey,!0))}catch(a){console.warn(a.message)}return new Promise((function(e){Promise.allSettled(t).then((function(t){t.forEach((function(e){"rejected"===e.status&&console.error(e)})),e(n)}))}))}},{key:"processDevices",value:function(e){var t=this,n=[],a={},o=0,i=0,r=function(r){o++,e[r].options=e[r].jarvis,delete e[r].jarvis;var c=Object(s.a)({},e[r],{id:r});n.push(new Promise((function(e,n){t.processDevice(c).then((function(o){null!==o&&(i++,a=t.groupDevice(a,o),e(r)),n(r)}))})));var l=function(e){var o=c.states[e];o&&void 0!==o.jarvis&&n.push(new Promise((function(n,l){t.processDevice(Object(s.a)({},c,{id:r+"#"+e,states:Object(h.a)({},e,o),options:o.jarvis})).then((function(e){null!==e&&(i++,a=t.groupDevice(a,e),n(r)),l(r)}))})))};for(var u in c.states)l(u)};for(var c in e)r(c);return new Promise((function(e){return Promise.allSettled(n).then((function(t){for(var n in a)a[n].devices.sort((function(e,t){return e.options.sort>t.options.sort?1:t.options.sort>e.options.sort?-1:0}));console.info("Processed "+o+" devices. Added "+i+" devices in "+Object.keys(a).length+" groups.",t,a),e(a)}))}))}},{key:"renderError",value:function(){return console.error(JSON.stringify(this.state.errorMessage)),o.a.createElement(G,{key:"StatusSnackbar",variant:"error",closeButton:!1,message:this.state.errorMessage.toString()})}},{key:"renderLoadingProgress",value:function(){var e=this.props.classes;return o.a.createElement(y.a,{key:"loadingProcess",container:!0,spacing:0,direction:"column",justify:"center",alignItems:"center",style:{minHeight:"100vh"}},o.a.createElement(j.a,null),o.a.createElement(O.a,{className:e.loading},q.a.t("Retrieving settings"),"..."))}},{key:"renderLoadingSkeleton",value:function(e){for(var t=this.props.classes,n=e.topBar,a=e.tabBar,i=e.gridColumns,r=function(e){return o.a.createElement(S.a,{animation:"wave",variant:"rect",className:t.gridItem,height:e.height})},s={},c=1;c<=i;c++){s[c]=s[c]||[];for(var l=3*Math.random()+2,u=1;u<=l;u++)s[c].push(o.a.createElement(r,{key:c+"#"+u,height:300*Math.random()+100}))}return o.a.createElement(o.a.Fragment,null,n&&o.a.createElement(S.a,{animation:"wave",variant:"rect",height:64}),a&&o.a.createElement(S.a,{animation:"wave",variant:"rect",height:48}),o.a.createElement(w,{key:"loadingSkeleton",contents:s}))}},{key:"render",value:function(){var e=this.state.error?this.renderError():null;if(this.state.error&&this.state.loaded.length<2)return e;if(-1===this.state.loaded.indexOf("settings"))return this.renderLoadingProgress();if(-1===this.state.loaded.indexOf("groups")){var t=Object.keys(this.settings.layout)[0];return this.renderLoadingSkeleton({topBar:!0,tabBar:1!==t,gridColumns:1!==t?Object.keys(this.settings.layout[t]).length:t.length})}return[e,o.a.createElement(Ue,{key:"jarvis",settings:this.settings,groups:this.groups})]}}]),t}(o.a.Component),qe=Object(ke.a)((function(e){return{loading:{margin:"10px 0 0 0",color:"#999"},gridItem:Object(h.a)({margin:e.spacing(1,1,0,0)},e.breakpoints.down("md"),{marginRight:e.spacing(.4,.4,0,0)})}}))(Ge);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(qe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},432:function(e,t,n){"use strict";n.r(t);var a=n(12),o=n(0),i=n.n(o),r=n(131);var s={HsvToRgb:function(e){var t,n,o,i,r,s,c,l,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(Array.isArray(e))d=e[2],u=e[1],e=e[0];else if("string"===typeof e&&e.indexOf(",")){var f=e.split(","),p=Object(a.a)(f,3);e=p[0],u=p[1],d=p[2]}switch(e>1&&(e/=360),s=d*(1-u),c=d*(1-(r=6*e-(i=Math.floor(6*e)))*u),l=d*(1-(1-r)*u),i%6){case 0:t=d,n=l,o=s;break;case 1:t=c,n=d,o=s;break;case 2:t=s,n=d,o=l;break;case 3:t=s,n=c,o=d;break;case 4:t=l,n=s,o=d;break;case 5:t=d,n=s,o=c}return[Math.round(255*t),Math.round(255*n),Math.round(255*o)]},RgbToHex:function(e,t,n){if(Array.isArray(e))n=e[2],t=e[1],e=e[0];else if("string"===typeof e&&e.indexOf(",")){var o=e.split(","),i=Object(a.a)(o,3);e=i[0],t=i[1],n=i[2]}return e=parseInt(e).toString(16),t=parseInt(t).toString(16),n=parseInt(n).toString(16),1===e.length&&(e="0"+e),1===t.length&&(t="0"+t),1===n.length&&(n="0"+n),"#"+e+t+n}},c=n(30);function l(e){var t=e.stateKey,n=e.stateVal,r=Object(o.useState)(n),s=Object(a.a)(r,2),l=s[0],u=s[1];Object(o.useEffect)((function(){return u(n)}),[n]);var d,f={};"rgb"===t&&l?f={Red:(d=l.split(","))[0],Green:d[1],Blue:d[2]}:"hsv"===t&&l&&(f={Hue:(d=l.split(","))[0],Saturation:d[1],Brightness:d[2]});var p=c.default.components.Label,h=[];for(var g in f)h.push(i.a.createElement(p,{key:g,label:g+" "+f[g],br:!0}));return h}function u(e){var t=e.device,n=e.stateKey,l=e.stateVal,u=e.title,d=l||"#ffffff";"rgb"===n?d=s.RgbToHex(d):"hsv"===n&&(d=s.RgbToHex(s.HsvToRgb(d)));var f=Object(o.useState)(d),p=Object(a.a)(f,2),h=p[0],g=p[1];Object(o.useEffect)((function(){"rgb"===n?g(s.RgbToHex(l)):"hsv"===n?g(s.RgbToHex(s.HsvToRgb(l))):"hex"===n&&g(l)}),[n,l]);var m=c.default.components.Component;return i.a.createElement(m,{title:u||n},i.a.createElement(r.SketchPicker,{color:h,width:"100%",onChangeComplete:function(e,a){e=e[n],"rgb"===n?e=[e.r,e.g,e.b].join(","):"hsv"===n&&(e=[e.h,e.s,e.v].join(",")),t.setDeviceState(n,e).catch((function(e){return console.error(e)}))}}))}var d={icon:{default:"palette"},unit:" \xb0"};t.default={configurations:{power:{icon:{true:"lightbulb-on",false:"lightbulb-off-outline"}},level:{value:function(e){return e>0&&e<=1?100*e:e},unit:function(e){return"off"!==e?" %":null},icon:{default:"lightbulb-on",0:"lightbulb-off-outline"},state:{0:"off"}},colorTemperature:{icon:{default:"thermometer"},unit:" \xb0K"},hue:d,rgb:d,hsv:d,hex:d},components:{level:c.default.components.LevelComponent,colorTemperature:function(e){var t=c.default.components.LevelComponent;return i.a.createElement(t,Object.assign({min:2e3,max:6500,step:10},e))},rgb:u,hsv:u,hex:u,hue:function(e){var t=e.device,n=e.stateKey,l=e.stateVal,u=e.title,d=Object(o.useState)(l),f=Object(a.a)(d,2),p=f[0],h=f[1];Object(o.useEffect)((function(){return h(l)}),[l]);var g=c.default.components.Component,m=s.RgbToHex(s.HsvToRgb(p));return i.a.createElement(g,{title:u||n},i.a.createElement(r.HuePicker,{color:m,width:"100%",onChangeComplete:function(e,a){h(Math.round(e.hsl.h)),t.setDeviceState(n,Math.round(e.hsl.h)).catch((function(e){return console.error(e)}))}}))}},actions:{power:c.default.actions.PowerAction,level:function(e){var t=e.device,n=e.state,r=e.stateKey,s=e.stateVal,l=function(e){p(e.target.checked),t.setDeviceState(r,e.target.checked?100:0).catch((function(e){return console.error(e)}))},u=Object(o.useState)(s>0),d=Object(a.a)(u,2),f=d[0],p=d[1];return Object(o.useEffect)((function(){return p(s>0)}),[s]),t.parent&&t.parent.states.power?i.a.createElement(c.default.actions.Action,{device:t,state:n,stateKey:r,stateVal:f,onChange:l}):i.a.createElement(c.default.actions.PowerAction,{device:t,state:n,stateKey:r,stateVal:f,onChange:l})},rgb:l,hsv:l,hex:l},styles:{_any:{state:{0:{color:"#999"}}}}}}},[[214,1,2]]]);
//# sourceMappingURL=main.11f77aa2.chunk.js.map