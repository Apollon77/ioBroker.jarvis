{"version":3,"sources":["components/Dialog.js","components/inputs/Field.js","components/inputs/Text.js","modules/StateListItem.js","modules/StateList.js","helpers/timeConverter.js","Log.js","components/EnhancedTableToolbar.js","components/EnhancedTableHead.js","components/EnhancedTableBody.js","components/EnhancedTable.js","functions/door/door.js","functions/heating/heating.js","functions/location/location.js","functions/user/user.js","functions/window/window.js","components/inputs/Chips.js","components/inputs/Fieldset.js","modules/AdapterStatus.js","modules/Chart.js","modules/DateTime.js","modules/Map.js","modules/StateListHorizontal.js","modules/Weather.js","functions/blind/blind.js","functions/blind/blind-manufacturers.js","helpers/colorConverter.js","functions/light/light.js","modules/MultimediaItem.js","modules/Multimedia.js","Settings.js","functions/blind/index.js","functions/blind/blind.de.js","functions/blind/blind.en.js","functions/door/door.de.js","functions/door/door.en.js","functions/heating/heating.de.js","functions/heating/heating.en.js","i18n.js","functions/light/light.de.js","functions/light/light.en.js","functions/location/location.de.js","functions/location/location.en.js","functions/user/user.de.js","functions/user/user.en.js","functions/window/window.de.js","functions/window/window.en.js","components/inputs/Switch.js","i18n sync /^/.*/.js$","i18n/de.js","i18n/en.js","functions/blind sync /^/blind/..*$","functions/door/index.js","functions/door sync /^/door/..*$","functions/heating/index.js","functions/heating sync /^/heating/..*$","functions/light/index.js","functions/defaults.js","Devices.js","functions/light sync /^/light/..*$","functions/location/index.js","functions/location sync /^/location/..*$","functions/user/index.js","functions/user sync /^/user/..*$","functions/window/index.js","functions/window sync /^/window/..*$","components/inputs/Button.js","components/inputs/Number.js","components/inputs/Select.js","config/config.js","pages/LogsPage/LogsPage.js","config/config.dev.js","Function.js","config/adapters.js","Device.js","pages/index.js","components/TopBar.js","helpers/useWindowDimensions.js","components/TabBar.js","components/Notifications.js","components/GridContainer.js","components/Popup.js","components/Widget.js","Jarvis.js","components/StatusSnackbar.js","App.js","serviceWorker.js","index.js","components/Inputs.js","pages/ConfigurationPage/DevicesPage/Devices.config.js","pages/ConfigurationPage/DevicesPage/DevicesPage.js","helpers/utils.js","pages/ConfigurationPage/DevicesPage/DevicesListPage.js","pages/ConfigurationPage/LayoutsPage/Layouts.config.js","pages/ConfigurationPage/LayoutsPage/LayoutsPage.js","pages/ConfigurationPage/SettingsPage/Settings.config.js","pages/ConfigurationPage/SettingsPage/SettingsPage.js","pages/ConfigurationPage/ConfigurationPage.js","Socket.js","Connection.js","modules/index.js","functions/index.js"],"names":["useStyles","makeStyles","theme","closeButton","position","right","spacing","top","color","palette","grey","Dialog","DialogDense","padding","CustomDialog","DialogTitle","CustomDialogTitle","DialogTitleTypography","DialogContent","backgroundColor","CustomDialogContent","DialogActions","margin","CustomDialogActions","props","header","onClose","children","actions","dense","disableBackdropClick","disableEscapeKeyDown","classes","paper","clsx","fullWidth","maxWidth","open","root","disableTypography","className","variant","aria-label","onClick","id","dividers","Field","display","marginLeft","marginRight","CustomField","info","link","width","key","style","container","item","i18n","t","target","rel","href","title","Text","options","TextAutoComplete","TextInput","onChange","required","label","type","select","shrink","disabled","size","placeholder","errorMessage","autoFocus","multiline","val","onEnter","disableUnderline","icon","InputProps","attributes","otherProps","useState","value","setValue","error","setError","useEffect","inputId","toLowerCase","replace","TextField","rows","onKeyPress","e","preventDefault","helperText","Array","isArray","map","lbl","join","startAdornment","InputLabelProps","showMaxResults","filterOptions","createFilterOptions","limit","undefined","objectify","Input","option","AutoCompleteOption","popupIcon","name","getOptionSelected","renderInput","params","styles","defaultListDivider","defaultListIcon","components","horizontalListItem","textAlign","paddingRight","marginTop","horizontalListItemIcon","minWidth","horizontalListItemAction","transform","verticalListItemAction","ListItemIconElement","withStyles","customClassNames","classNames","StateListItem","stateChange","stateKey","state","device","primaryStateKey","secondaryStateKey","setState","ListItemTextWidth","getDeviceState","ListItemText","React","createRef","ListItemSecondaryAction","this","Math","floor","current","offsetWidth","resizeComponent","listen","unlisten","ListItemSecondaryActionWidth","openDialog","horizontal","component","action","get","getIcon","primaryComponent","getComponent","primaryAction","getAction","secondaryAction","Fragment","divider","ListItem","finger","button","bind","ListItemIcon","getStyle","ref","primary","getOption","secondary","subtitle","timeChanged","flex","Component","defaultListSectionDivider","defaultListSectionDividerItem","defaultListSectionText","breakpoints","down","horizontalList","flexDirection","flexWrap","ListDivider","getDevicesBySubgroup","subgroup","subgroupActions","handleChange","targetStatus","forEach","status","setDeviceState","ButtonGroup","Button","StateList","devices","push","settings","List","i","listSection","listItem","ModuleDescription","ModuleScreenshots","ModuleConfig","timeToSeconds","time","toString","indexOf","split","length","hours","minutes","seconds","parseInt","timeToHoursMinutesSeconds","withHours","Number","isNaN","substr","secondsToDateTime","dateTimeFormat","format","Date","locale","locales","getLanguage","Log","module","message","criticality","printToConsole","stack","entry","log","console","useToolbarStyles","paddingLeft","highlight","main","lighten","light","text","dark","EnhancedTableToolbar","rowCount","numSelected","rightActionButton","Toolbar","Typography","Tooltip","IconButton","EnhancedTableHead","headCells","onSelectAllClick","selectable","sortable","order","orderBy","onRequestSort","TableHead","TableRow","TableCell","Checkbox","indeterminate","checked","inputProps","headCell","align","disablePadding","sortDirection","TableSortLabel","active","direction","property","event","noWrap","whiteSpace","nestedObjects","seen","EnhancedTable","columns","sortedRows","emptyRows","rowStyles","selected","row","index","isItemSelected","labelId","columnId","rowStyle","Object","keys","hover","role","aria-checked","tabIndex","column","scope","content","JSON","stringify","showTableContent","height","colSpan","table","descendingComparator","a","b","orderByCase","orderA","orderB","tmpA","tmpB","err","getComparator","stableSort","array","comparator","stabilizedThis","el","sort","CustomTableBody","toolbar","pagination","defaultOrder","defaultOrderBy","defaultSelected","defaultPage","defaultRowsPerPage","toolbarRightActionButton","setOrder","setOrderBy","setSelected","page","setPage","rowsPerPage","setRowsPerPage","TableBody","EnhancedTableBody","TableContainer","Table","aria-labelledby","stickyHeader","newSelecteds","n","slice","min","selectedIndex","newSelected","concat","TablePagination","rowsPerPageOptions","count","onChangePage","newPage","onChangeRowsPerPage","translations","require","default","setTranslation","description","configurations","true","false","lock","temperature","toFixed","unit","setTemperature","humidity","boost","Level","defaults","LevelComponent","max","PowerAction","presence","users","location","battery","chip","InputChip","onDelete","deleteIcon","InputChips","list","InputChipsField","optionKey","multiple","freeSolo","getOptionLabel","noPadding","Fieldset","FieldsetItem","Legend","fontSize","FieldsetLegend","xs","Form","utils","getLocaleDateAdapter","getLocale","AdapterStatus","adapterInformation","adapterAliveStatus","newUpdates","updatesJson","lastUpdateCheck","socket","Connection","getConnection","blacklist","updateStates","adapterStates","updates","getStates","states","subscribeStates","update","lastIndexOf","getAdapterInstances","instances","adapters","instance","common","item1","item2","aliveStatus","prevState","unsubscribeStates","updateList","parse","adapterList","loading","adapter","enabled","alive","connected","connection","tooltip","alt","src","extIcon","small","version","availableVersion","UpdateAvailable","runAsCompactMode","compactGroup","StatusIndicator","notAlive","noUpdates","UpdatesListItem","UpdatesIndicator","fontStyle","borderRadius","ModuleSettings","noDevicesAllowed","Chart","historyChange","history","addChartGraph","axis","getAxis","start","end","updateChartGraph","chartFilter","chartConfig","yAxes","unshift","ticks","callback","yLeftAxisUnitBefore","parseFloat","yLeftAxisUnitAfter","errors","datePicker","selectedTimeRangeValue","selectedTimeRangeUnit","selectedDateTime","dateNow","chartLabels","chartData","labels","datasets","chartPan","chartZoom","timer","timeRangeRef","chartRef","chartUpdates","chartOptions","maintainAspectRatio","spanGaps","legend","legendClickHandler","tooltips","callbacks","data","datasetIndex","scales","plugins","colorschemes","scheme","zoom","pan","mode","getTimeRange","requestDeviceStateHistory","step","catch","_","liveUpdates","prevProps","clearTimeout","setTimeout","getTime","timeRange","axisTimeFormat","helpers","prevMarker","markers","marker","ts","reduce","chartIndex","findIndex","groupChartData","chartInstance","values","prevStates","dataSet","fill","graphConfig","legendItem","ci","meta","getDatasetMeta","hidden","resetZoom","inputRef","input","displayEmpty","DateFnsUtils","onOpen","ampm","iconButton","dividerVertical","orientation","placement","buttonDisabled","severity","createElement","toolbarButtons","disableElevation","chartHeight","alignItems","justifyContent","marginBottom","DateTime","refTimer","useRef","setDateTime","city","setCity","sunrise","setSunrise","sunset","setSunset","refresh","Settings","getSetting","latitude","longitude","getSunrise","getSunset","sun","mapOverview","left","bottom","zIndex","cursor","mapIconContainer","mapIconParent","boxShadow","mapIcon","mapTooltip","Map","defaultZoom","defaultPosition","setMarkers","memoizedMapInitialised","useCallback","memoizedHandleClick","flyTo","prevMarkers","requestDeviceState","mapMarkers","Marker","avatar","arrow","useFlyTo","center","whenReady","attribution","url","markerIcon","offset","function","L","divIcon","html","iconSize","memoizedHandleMouseEvent","closeTooltip","openTooltip","riseOnHover","onMouseOver","tooltipDirection","permanent","tooltipPermanent","StateListHorizontal","StateListConfig","Weather","setData","getRemoteResource","then","response","statusCode","body","weatherForecast","day","forecast","dailyForecast","date","justify","float","lineHeight","borderLeftTransparent","borderLeftColor","alpha","rgb","borderRightTransparent","borderRightColor","borderRightColorSecondary","level","round","level2","activity","manufacturer","getActivityType","setLevel","sKey","s","d","setActivity","HsvToRgb","h","r","g","f","p","q","v","RgbToHex","LightColorAction","stateVal","colorSpace","setColorSpace","colors","Red","Green","Blue","Hue","Saturation","Brightness","Label","br","LightColorComponent","initialColor","onChangeComplete","power","stateStyle","colorTemperature","hue","hsv","hex","setHue","hsl","setChecked","parent","Action","Multimedia","progress","progressTimeout","isRunning","duration","noHeader","styleImage","styleLengthBar","background","backgroundImage","backgroundUrlPrepend","playIconElements","Divider","image","noImage","information","informationLeft","grandParent","informationRight","lengthBar","controls","controlsBox","controlsBoxLeft","controlsBoxCenter","Fab","controlButton","controlsBoxRight","backgroundPosition","minHeight","paddingTop","controlButtonSmall","MultimediaItem","language","setLanguage","loadTranslation","pageTitle","document","pageFavicon","getElementById","setting","de","languages","translation","isoLong","word","placeholders","parts","shift","RegExp","ucFirst","charAt","toUpperCase","navigator","userLanguage","FormControl","InputLabel","Switch","SwitchSmall","SwitchInline","InputSwitch","userInput","InputSwitchInline","control","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","resolve","exports","sliderMarkLabel","parentOnChange","TriggerAction","startIcon","linebreak","markSteps","markStep","markLabel","onChangeCommitted","valueLabelDisplay","marks","number","_any","door","trigger","wind","_copy","Devices","rawDevices","deviceId","groups","groupId","Groups","addGroupId","GroupIds","GroupList","raw","copy","InputButton","NumberInput","InputSelect","selection","menuOptions","DEFAULTS","LogsPage","logs","getLog","pinToTop","navigate","Function","functionType","functionId","functions","_isFunction","obj","defaultValue","EventEmitter","Device","deviceProperties","room","group","_setProperties","stateSubscriptions","on","stateType","node","config","attribute","stateValKeys","stateValKey","stateValValue","ignoredStates","ignoredState","hiddenStates","_getStateFromKey","Adapters","formatDistanceToNow","lc","includeSeconds","addSuffix","_getConfigurationSetting","pair","_getUserSetting","forceDefault","stateProperty","deviceState","defaultIcon","eventName","listeners","listener","subscribe","responses","Promise","reject","emit","getState","_updateDeviceState","subscribeDeviceState","historyCache","getStateHistory","res","subscribeState","child","off","configuration","appBar","flexGrow","menuButton","transition","flexShrink","userSelect","notConnected","TopBar","connectionStatus","toggleDrawer","notifications","connectionStatusIcon","connectionStatusTooltip","AppBar","Hidden","smDown","getWindowDimensions","window","innerWidth","innerHeight","paddingBottom","tabs","borderBottom","fixed","indicator","fullscreen","grid","TabBar","selectedTab","onSelectTab","tabBarProps","tab","setTab","setFixed","handleScroll","threshold","scrollY","prevFixed","offsetTop","offsetHeight","addEventListener","removeEventListener","renderedTabs","Tab","Tabs","TabPanel","renderedTab","windowDimensions","setWindowDimensions","handleResize","useWindowDimensions","mapHeight","setMapHeight","topBarHeight","setHidden","Box","Notifications","Drawer","anchor","drawer","gridContainer","GridContainer","contents","Grid","sm","md","lg","xl","other","MuiDialogContent","MuiDialogActions","Popup","forceUpdate","allSettled","nextProps","nextState","closeDialog","card","cardHeaderNoContents","cardAvatar","cardContent","Widget","iconStyle","Card","CardHeader","Avatar","CardContent","getGroup","Tag","Modules","getGridContents","gridContents","columnContents","moduleSettings","Jarvis","tabTitle","notificationDrawer","notificationsUnread","dialog","dialogContents","getDevices","layout","tabsEnabled","widgetProps","filter","notification","unread","NODE_NOTIFICATIONS","getGroups","tabPanels","tabLabel","tabPanel","now","Page","Pages","getTabPanels","topBarTitle","success","green","warning","amber","iconVariant","opacity","variantIcon","CheckCircleIcon","WarningIcon","ErrorIcon","InfoIcon","StatusSnackbar","autoHideDuration","Icon","Snackbar","anchorOrigin","vertical","SnackbarContent","App","loaded","errorHandler","port","protocol","hostname","connect","NODE_SETTINGS","setSettings","applySettings","iobroker","getObject","NODE_DEVICES","processDevices","set","setDevices","setGroups","promises","results","result","deviceList","processedDevices","groupedDevices","jarvis","processDevice","groupDevice","CircularProgress","topBar","tabBar","gridColumns","SkeletonLoader","Skeleton","animation","gridItem","loaders","random","loader","renderError","ThemeProvider","renderLoadingSkeleton","renderLoadingProgress","Boolean","match","ReactDOM","render","serviceWorker","ready","registration","unregister","Chip","Chips","ChipsField","Select","DevicesStates","SettingsPage","_save","savedDevice","groupEditor","base","characteristic","_created","onSave","_deleteDevice","_onChange","json","nextErrors","_addState","newStateKey","_moveState","sorted","sortedArray","sortedObject","_deleteState","nextDevice","str","Inputs","iconContainer","renderedStates","renderDeviceState","parameter","renderedOptions","DevicesConfig","renderDeviceOption","renderDeviceStates","renderDeviceOptions","alignRight","FUNCTIONS","func","getGroupList","_saveDevices","_saveDevice","selectedDevice","scrollTop","nextDevices","renderDevices","DevicesPage","uuid","deleteButton","hr","CustomTextInput","verticalAlign","ModuleList","LayoutsPage","_addColumn","tabKey","newColumn","_addTab","newTabIndex","1","_changeTab","tKey","prevTab","_closePopup","popup","columnKey","selectedColumn","groupKey","selectedGroup","ModuleConfigurations","field","tabLayout","col","tabColumnGroups","componentKey","_deleteColumn","_deleteGroup","_deleteTab","_moveGroup","stopPropagation","_moveTab","_openPopup","groupIds","tabColumnComponentsNodes","entries","MODULE","renderTabColumnGroup","tabIcon","groupsInFirstColumn","tabColumnsNodes","renderTabColumns","lastTab","LayoutsConfig","tabFullscreen","columnContainer","tabsNodes","tabsTotal","renderTab","renderTabs","filtered","groupName","Paper","tabsHideLabels","autoComplete","autoHighlight","groupTitle","groupIcon","groupIconStyle","groupModule","borderRight","borderLeft","_handleSettingsChange","setSetting","getSettings","_handlePanelChange","panel","isExpanded","inputKey","inputSettings","Accordion","expanded","AccordionSummary","expandIcon","heading","secondaryHeading","AccordionDetails","SettingsConfig","renderPanel","typography","pxToRem","flexBasis","ConfigurationPage","_onDevicesChange","_onSettingsChange","_onLayoutsChange","onRawChange","_handleTabChange","_cancel","all","reload","expertMode","rawEditor","scrollHeight","rawEditorHeight","indicatorColor","textColor","DevicesListPage","fontFamily","Socket","io","timeout","query","statesSubscribes","attempts","reason","pattern","ids","cb","cbs","reg","_getPatternFromId","task","hasOwnProperty","test","getObjectView","design","search","unsubscribeState","setUrl","setListeners","setListener","blind","heating","jalousie","user"],"mappings":"kGAAA,6IAiBMA,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACtCC,YAAa,CACZC,SAAU,WACVC,MAAOH,EAAMI,QAAQ,GACrBC,IAAKL,EAAMI,QAAQ,GACnBE,MAAON,EAAMO,QAAQC,KAAK,MAE3BC,OAAQ,GAERC,YAAa,CACZC,QAASX,EAAMI,QAAQ,EAAG,IAE3BQ,aAAc,GAEdC,YAAa,GAEbC,kBAAmB,GAEnBC,sBAAuB,GAGvBC,cAAe,CACdC,gBAAiB,WAElBC,oBAAqB,GAErBC,cAAe,CACdC,OAAQ,EACRT,QAASX,EAAMI,QAAQ,IAExBiB,oBAAqB,OAKP,SAAST,EAAaU,GAAQ,IACpCC,EAA0FD,EAA1FC,OAAQC,EAAkFF,EAAlFE,QAASC,EAAyEH,EAAzEG,SAAUC,EAA+DJ,EAA/DI,QAASC,EAAsDL,EAAtDK,MAAOC,EAA+CN,EAA/CM,qBAAsBC,EAAyBP,EAAzBO,qBACnEC,EAAUhC,EAAUwB,GAE1B,OAED,kBAAC,IAAD,CACCQ,QAAS,CAAEC,MAAOC,YAAKF,EAAQrB,OAAQqB,EAAQlB,eAC/CqB,UAAWX,EAAMW,UACjBC,SAAUZ,EAAMY,SAEhBN,qBAAsBA,IAA8C,EACpEC,qBAAsBA,IAA8C,EAEpEM,KAAMb,EAAMa,KACZX,QAASF,EAAME,SAGf,kBAAC,IAAD,CACCM,QAAS,CAAEM,KAAMJ,YAAKF,EAAQjB,YAAaiB,EAAQhB,oBACnDuB,mBAAiB,GAGE,kBAAXd,EAAsBA,EAAS,kBAAC,IAAD,CAAYe,UAAWR,EAAQf,sBAAuBwB,QAAQ,MACnGhB,GAEF,kBAAC,IAAD,CAAYiB,aAAW,QAAQF,UAAWR,EAAQ7B,YAAawC,QAASjB,GACvE,kBAAC,IAAD,QAIF,kBAAC,IAAD,CAAekB,GAAG,gBAAgBJ,UAAWN,YAAKF,EAAQd,cAAec,EAAQZ,oBAAqBS,GAASG,EAAQpB,aAAciC,UAAQ,GAC3IlB,GAGF,kBAAC,IAAD,CAAeK,QAAS,CAAEM,KAAMJ,YAAKF,EAAQX,cAAeW,EAAQT,uBAClEK,M,iCCxFH,gHAaM5B,EAAYC,aAAW,SAACC,GAAD,MAAY,CACxC4C,MAAO,CACNC,QAAS,cACTC,WAAY9C,EAAMI,QAAQ,GAC1B2C,YAAa/C,EAAMI,QAAQ,GAC3BO,QAAS,gBAEVqC,YAAa,OAQC,SAASJ,EAAMtB,GAAQ,IAC7BG,EAAoCH,EAApCG,SAAUiB,EAA0BpB,EAA1BoB,GAAIO,EAAsB3B,EAAtB2B,KAAMC,EAAgB5B,EAAhB4B,KAAMC,EAAU7B,EAAV6B,MAC5BrB,EAAUhC,EAAUwB,GAE1B,OACC,kBAAC,IAAD,CACC8B,IAAK,QAAUV,EACfJ,UAAWN,YAAKF,EAAQc,MAAOd,EAAQkB,aACvCK,MAAO,CAAEF,MAAOA,GAAS,KACzBG,WAAS,EACTC,MAAI,GAGHC,IAAKC,EAAER,IAAS,kBAAC,IAAD,CAAMM,MAAI,EAACF,MAAO,CAAEF,MAAO,KAC3C,uBAAGO,OAAO,SAASC,IAAI,sBAAsBC,KAAMV,GAClD,kBAAC,IAAD,CAASW,MAAOL,IAAKC,EAAER,IACtB,kBAAC,IAAD,CAAU3C,MAAM,eAInB,kBAAC,IAAD,CAAMiD,MAAI,EAACF,MAAO,CAAEF,MAAOF,EAAO,IAAS,SACzCxB,M,kRCnCC3B,EAAYC,aAAW,SAACC,GAAD,MAAY,MAO1B,SAAS8D,EAAKxC,GAC5B,OAAOA,EAAMyC,QAAUC,EAAiB1C,GAAS2C,EAAU3C,GAMrD,SAAS2C,EAAU3C,GAAQ,IACzB4C,EAAgN5C,EAAhN4C,SAAUxB,EAAsMpB,EAAtMoB,GAAIyB,EAAkM7C,EAAlM6C,SAAUC,EAAwL9C,EAAxL8C,MAAOC,EAAiL/C,EAAjL+C,KAAM5C,EAA2KH,EAA3KG,SAAU6C,EAAiKhD,EAAjKgD,OAAQC,EAAyJjD,EAAzJiD,OAAQC,EAAiJlD,EAAjJkD,SAAUC,EAAuInD,EAAvImD,KAAMC,EAAiIpD,EAAjIoD,YAAaC,EAAoHrD,EAApHqD,aAAcC,EAAsGtD,EAAtGsD,UAAWC,EAA2FvD,EAA3FuD,UAAWC,EAAgFxD,EAAhFwD,IAAKC,EAA2EzD,EAA3EyD,QAASC,EAAkE1D,EAAlE0D,iBAAkBC,EAAgD3D,EAAhD2D,KAAMC,EAA0C5D,EAA1C4D,WAAYC,EAA8B7D,EAA9B6D,WAAeC,EADzK,YACwL9D,EADxL,qNAE1BQ,EAAUhC,IAFgB,EAIPuF,mBAASP,GAAO,IAJT,mBAIzBQ,EAJyB,KAInBC,EAJmB,OAKPF,mBAAS/D,EAAMkE,MAAQlE,EAAMkE,MAASrB,IAAaW,GAL5C,mBAKzBU,EALyB,KAKnBC,EALmB,KAMhCC,qBAAU,kBAAMD,EAASnE,EAAMkE,SAAQ,CAAClE,EAAMkE,QAE9C,IAAMG,EAAUjD,GAAM,SAAW0B,EAAMwB,cAAcC,QAAQ,KAAM,IAEnE,OACC,kBAAC,IAAD,iBAAWvE,EAAW6D,GACrB,kBAAC,IAAD,eACCrD,QAAS,CAAEM,KAAMN,EAAQgE,WAEzBpD,GAAIiD,EACJtB,KAAMA,GAAQ,OACdF,SAAUA,EACVG,OAAQA,EAERO,UAAWA,EACXkB,KAAM,EACNtB,KAAMA,EACND,SAAUA,EAEVvC,WAAW,EACXyC,YAAaA,GAAe,GAC5BE,UAAWA,IAAwB,EAEnCoB,WAAY,SAAAC,GACG,UAAVA,EAAE7C,KAAoByB,IACzBoB,EAAEC,iBACFnB,GAAWA,MAIbS,MAAOA,EACPW,WAAYxB,EAAenB,IAAKC,EAAEkB,GAAiBR,GAAYqB,GAAShC,IAAKC,EAAE,kBAE/EW,MAAOgC,MAAMC,QAAQjC,GAASA,EAAMkC,KAAI,SAAAC,GAAG,OAAI/C,IAAKC,EAAE8C,MAAMC,KAAK,IAAMhD,IAAKC,EAAEW,GAC9EkB,MAAOA,EACPpB,SAAU,SAAA+B,GACTR,EAAStB,IAAa8B,EAAEvC,OAAO4B,OAC/BC,EAASU,EAAEvC,OAAO4B,OAClBpB,GAAYA,EAAS5C,EAAO2E,EAAEvC,OAAO4B,QAGtCJ,WAAU,aACTF,iBAAkBA,EAClByB,eAAgBxB,GACf,kBAAC,IAAD,CAAgB/E,SAAS,SACxB,0BAAMoC,UAAW,WAAa2C,MAG7BC,GAAc,IAGlBwB,gBAAiB,CAChBnC,OAAQA,IAAkB,IAGvBa,GAGH3D,GAAsB,QAWpB,SAASuC,EAAiB1C,GAChC,IAAMQ,EAAUhC,IACR0F,EACwDlE,EADxDkE,MAAOrB,EACiD7C,EADjD6C,SAAUS,EACuCtD,EADvCsD,UAAWF,EAC4BpD,EAD5BoD,YAAaN,EACe9C,EADf8C,MAC9CuC,EAA6DrF,EAA7DqF,eAAgBzC,EAA6C5C,EAA7C4C,SAAUY,EAAmCxD,EAAnCwD,IAAKK,EAA8B7D,EAA9B6D,WAAeC,EAHV,YAGyB9D,EAHzB,yGAKd+D,mBAASP,GAAO,IALF,mBAKhCQ,EALgC,KAK1BC,EAL0B,KAOjCqB,EAAgBD,GAAkBA,EAAiB,EAAIE,YAAoB,CAAEC,MAAOH,SAAoBI,EACxGC,EAAY1F,EAAMyC,SAAWzC,EAAMyC,QAAQ,IAAMzC,EAAMyC,QAAQ,GAAGrB,GAExE,OACC,kBAAC,IAAD,iBAAWpB,EAAW6D,GACrB,kBAAC,IAAD,eACCrD,QAAS,CAAEM,KAAMN,EAAQmF,MAAOC,OAAQpF,EAAQqF,oBAChDC,UAAW,KAEX9B,MAAOA,EAKPpB,SAAU,SAAC+B,EAAGiB,GACbA,EAASA,EAAOZ,KAAI,SAAAxB,GAAG,MAAmB,kBAARA,GAAoBkC,EAAY,CAAEtE,GAAIoC,EAAIc,cAAcC,QAAQ,KAAM,IAAKwB,KAAMvC,GAAQA,KAC3HS,EAAS2B,GACThD,GAAYA,EAAS5C,EAAO4F,IAG7BI,kBAAmB,SAACJ,EAAQ5B,GAAT,SAAmB4B,IAAU5B,KAAS0B,EAAYE,EAAOxE,KAAO4C,EAAM5C,GAAKwE,IAAW5B,IACzGsB,cAAeA,EAEfW,YAAa,SAAAC,GAAM,OAAI,kBAAC,IAAD,iBACbA,EADa,CAEjBhC,MAAOA,EACPrB,SAAUA,EACVS,UAAWA,IAAwB,EACnCR,MAAOZ,IAAKC,EAAEW,IAAUZ,IAAKC,EAAEiB,QAGjCU,O,uUChIFqC,EAAS,SAAAzH,GAAK,MAAK,CACxB0H,mBAAoB,CACnBtG,OAAQ,aAETuG,gBAAiB,SAAArG,GAAK,kCAClBtB,EAAM4H,WAAW3C,MACjB3D,EAAMmG,SAEVI,mBAAoB,CACnBhF,QAAS,eACTiF,UAAW,SACXC,aAAc,OACd5E,MAAO,QACP6E,UAAW,QAEZC,uBAAwB,CACvBC,SAAU,QAEXC,yBAA0B,CACzBL,UAAW,SACXzH,IAAK,EACLF,MAAO,EACPD,SAAU,SACVkI,UAAW,QAEZC,uBAAwB,CACvBP,UAAW,WAKPQ,EAAsBC,YAAWd,EAAXc,EAAmB,SAAAjH,GAAU,IAChDkH,EAAwClH,EAAxCkH,iBAAkB/G,EAAsBH,EAAtBG,SAAUK,EAAYR,EAAZQ,QAEhC2G,EAAarC,MAAMC,QAAQmC,GAAoBA,EAAmB,CAACA,GAGvE,OAFAC,EAAaA,EAAWnC,KAAI,SAAAhE,GAAS,OAAKR,EAAQQ,GAAaR,EAAQQ,GAAaA,KAE7E,0BAAMA,UAAWN,YAAKyG,IAAchH,MAItCiH,E,kDAEL,WAAYpH,GAAQ,IAAD,8BAClB,cAAMA,IAgCPqH,YAAc,SAACC,EAAUC,GACpBD,IAAa,EAAKtH,MAAMwH,OAAOC,iBAAmBH,IAAa,EAAKtH,MAAMwH,OAAOE,mBACpF,EAAKC,SAAL,eAAiBL,EAAWC,KAhC7B,EAAKA,MAAQ,CACZK,kBAAmB,QAGpB,EAAKL,MAAM,EAAKvH,MAAMwH,OAAOC,iBAAmB,EAAKzH,MAAMwH,OAAOK,kBAAoB,GAElF,EAAK7H,MAAMwH,OAAOE,oBACrB,EAAKH,MAAM,EAAKvH,MAAMwH,OAAOE,mBAAqB,EAAK1H,MAAMwH,OAAOK,eAAe,EAAK7H,MAAMwH,OAAOE,oBAAsB,IAG5H,EAAKI,aAAeC,IAAMC,YAC1B,EAAKC,wBAA0BF,IAAMC,YAdnB,E,gEAkBlBE,KAAKN,kBAAoBO,KAAKC,MAAMF,KAAKJ,aAAaO,QAAQC,aAC9DJ,KAAKK,kBAGLL,KAAKlI,MAAMwH,OAAOgB,OAAON,KAAKb,e,6CAI9Ba,KAAKlI,MAAMwH,OAAOiB,SAASP,KAAKb,e,2CAIhCa,KAAKK,oB,wCAUL,IAAMG,EAA+BP,KAAKC,MAAuD,KAAjDF,KAAKD,wBAAwBI,QAAQC,aAEjFJ,KAAKX,MAAMmB,+BAAiCA,GAC/CR,KAAKP,SAAS,CACbe,6BAA8BA,EAC9Bd,kBAAmBM,KAAKN,kBAAkBc,EAA+B,S,mCAM3ER,KAAKlI,MAAM2I,WAAWT,KAAKlI,MAAMwH,U,+BAGxB,IAAD,EACmDU,KAAKlI,MAAxDQ,EADA,EACAA,QAASoI,EADT,EACSA,WAAYpB,EADrB,EACqBA,OAAQqB,EAD7B,EAC6BA,UAAWC,EADxC,EACwCA,OAE1CvB,EAAQW,KAAKX,MAAMC,EAAOC,iBAC1BhF,EAAU+E,EAAOuB,IAAI,WAErBpF,EAAO6D,EAAOwB,QAAQxB,EAAOC,gBAAiBF,EAAM/D,MAAQgE,EAAOwB,QAAQxB,EAAOC,gBAAiBF,EAAMvD,OACzGiF,EAAmBJ,GAAarB,EAAO0B,eACvCC,EAAgB3B,EAAO4B,UAAU5B,EAAOC,iBAAkD,IAAjCD,EAAO/E,QAAQ0G,eACxEE,EAAkBP,GAAUZ,KAAKX,MAAMC,EAAOE,mBAAqBF,EAAO4B,UAAU5B,EAAOE,mBAAqB,KAEtH,OAEF,kBAAC,IAAM4B,SAAP,KAEE7G,EAAQ8G,SAA+B,UAApB9G,EAAQ8G,SAAuB,kBAACC,EAAA,EAAD,CAAUD,SAAO,EAACvI,UAAWR,EAAQ4F,qBAExF,kBAACoD,EAAA,EAAD,CACCxI,UAAWN,YAAKwH,KAAKlI,MAAM2I,YAAcnI,EAAQiJ,OAAQb,GAAcpI,EAAQ+F,oBAC/EmD,OAAkC,OAA1BxB,KAAKlI,MAAM2I,WACnBxH,QAAS+G,KAAKlI,MAAM2I,YAAcT,KAAKS,WAAWgB,KAAKzB,OAGvD,kBAAC0B,EAAA,EAAD,CAAc5I,UAAWN,YAAKkI,GAAcpI,EAAQmG,yBAC1C,OAAThD,EAAgB,kBAAC,IAAM2F,SAAP,MAChB,kBAACtC,EAAD,CAAqBE,iBAAkB,CAAC,kBAAkB,WAAavD,GAAOwC,OAAQqB,EAAOqC,SAAS,OAAQrC,EAAOC,gBAAiBF,EAAM/D,QAI7I,kBAACsE,EAAA,EAAD,CACCgC,IAAK5B,KAAKJ,aACV/G,mBAAwC,IAArBkI,EACnBc,QAASd,GAAoBzB,EAAOwC,UAAU,SAC9CC,UAAiC,OAArBxH,EAAQyH,WAAqBzH,EAAQyH,UAAa3C,GAASA,EAAM4C,cAAwB,KACrGpI,MAAO,CAAEqI,KAAM,UAAWvI,MAAOqG,KAAKX,MAAMK,qBAG7C,kBAACK,EAAA,EAAD,CACC6B,IAAK5B,KAAKD,wBACVjH,UAAY4H,EAAapI,EAAQqG,yBAA2BrG,EAAQuG,wBAGlEsC,EAAkC,CAAEF,EAAe,wBAAIrH,IAAK,MAAQ0F,EAAOpG,KAAQiI,GAAjEF,IAIrB1G,EAAQ8G,SAA+B,UAApB9G,EAAQ8G,SAAuB,kBAACC,EAAA,EAAD,CAAUD,SAAO,EAACxH,MAAO,CAACjC,OAAQ,gB,GAtG1DiI,IAAMsC,WA8GnBpD,cAAWd,EAAXc,CAAmBG,G,kBCpJ5BjB,EAAS,SAAAzH,GAAK,MAAK,CACxB4L,0BAA2B,CAC1BxK,OAAQ,aAETyK,8BAA+B,CAC9BzK,OAAQ,cACRT,QAAS,qBAEVmL,uBAAuB,aACtB1K,OAAQ,GACPpB,EAAM+L,YAAYC,KAAK,MAAQ,CAC/B5K,OAAQ,eAGV6K,eAAgB,CACfpJ,QAAS,OACTqJ,cAAe,MACfC,SAAU,UAKNC,EAAc7D,YAAWd,EAAXc,EAAmB,SAAAjH,GAAU,IACxCQ,EAAoER,EAApEQ,QAASuK,EAA2D/K,EAA3D+K,qBAAsBC,EAAqChL,EAArCgL,SAAUzI,EAA2BvC,EAA3BuC,MAAO0I,EAAoBjL,EAApBiL,gBAIlDC,EAAe,SAAAC,GAEJJ,EAAqBC,GAC7BI,SAAQ,SAAA5D,GAEf,IAAI6D,EAASF,EACkB,UAA3B3D,EAAOC,kBACV4D,EAASA,EAAU7D,EAAOwC,UAAU,iBAAmB,IAAO,GAG/DxC,EAAO8D,eAAe,KAAMD,OAI9B,OAED,kBAAC,IAAM/B,SAAP,KACC,kBAACE,EAAA,EAAD,CAAUD,SAAO,EAACvI,UAAWR,EAAQ8J,4BACrC,kBAACd,EAAA,EAAD,CAAUxI,UAAWR,EAAQ+J,+BAC5B,kBAACzC,EAAA,EAAD,CACC9G,UAAWR,EAAQgK,uBACnBT,QAASxH,IAGV,kBAAC0F,EAAA,EAAD,KACqB,OAApBgD,IAAgD,IAApBA,EAA4B,KACxD,kBAACM,EAAA,EAAD,CAAavM,MAAM,UAAUmE,KAAK,SACjC,kBAACqI,EAAA,EAAD,CAAQrK,QA7BY,kBAAM+J,GAAa,KA6BLhJ,IAAKC,EAAE,OACzC,kBAACqJ,EAAA,EAAD,CAAQrK,QA7Ba,kBAAM+J,GAAa,KA6BLhJ,IAAKC,EAAE,eAWxCsJ,E,mLAEgBT,GAEpB,IAAIU,EAAU,GAQd,OAPAxD,KAAKlI,MAAM0L,QAAQN,SAAQ,SAAA5D,GAEtBwD,IAAaxD,EAAOwC,UAAU,aACjC0B,EAAQC,KAAKnE,MAIRkE,I,+BAGE,IAELV,EAFI,SACwE9C,KAAKlI,MAA7EQ,EADA,EACAA,QAASoI,EADT,EACSA,WAAY8C,EADrB,EACqBA,QAASE,EAD9B,EAC8BA,SAAU/C,EADxC,EACwCA,UAAWC,EADnD,EACmDA,OAAW9I,EAD9D,kFAIR,OAEF,kBAAC6L,EAAA,EAAD,CAAMxL,OAAO,EAAMW,UAAW4H,GAAcpI,EAAQmK,gBAClDe,EAAQ1G,KAAI,SAACwC,EAAQsE,GAErB,IAAMC,EAA2B,OAAbf,GAAiD,OAA5BxD,EAAO/E,QAAQuI,UAAqBxD,EAAO/E,QAAQuI,WAAaA,GAAY,kBAACF,EAAD,CACvFhJ,IAAK,eAAiB0F,EAAOuB,IAAI,MACjCgC,qBAAsB,EAAKA,qBAAqBpB,KAAK,GACrDqB,SAAUxD,EAAOwC,UAAU,YAC3BzH,MAAOiF,EAAO/E,QAAQuI,SACtBC,gBAAiBW,EAASX,iBAAmBzD,EAAO/E,QAAQwI,kBAGpFe,EAAW,kBAAC,EAAD,iBACRhM,EADQ,CAEZ8B,IAAK,iBAAmB0F,EAAOuB,IAAI,MACnCH,WAAYA,EACZpB,OAAQA,EACRqB,UAAWA,IAAa,EACxBC,OAAQA,IAAU,KAIvB,OADAkC,EAAWxD,EAAOwC,UAAU,YACrB,CAAE+B,EAAaC,W,GA1CAjE,IAAMsC,WAqDjB4B,GAHEhF,sBAAWd,EAAXc,CAAmBwE,GAGD,mCACpBS,EAAoB,CAAC,iBAAkB,iBAAkB,iBAAkB,kBAE3EC,EAAe,CAC3B,CACC,UAAa,kBACb,MAAS,CACR,GAAM,mCACN,GAAM,iDAEP,KAAQ,SACR,KAAO,K,6DC9FM,KACdC,cA9CD,SAAuBC,GAEtB,GAAIA,EAAKC,WAAWC,QAAQ,MAAQ,EAAG,CAEtC,IAFsC,GACtCF,EAAOA,EAAKC,YACME,MAAM,KAAKC,OAAO,EACO,EAAIJ,EAAKG,MAAM,MAAQ,KAAOH,GAAMG,MAAM,KAH/C,mBAGhCE,EAHgC,KAGzBC,EAHyB,KAGhBC,EAHgB,KAItCP,EAAyB,KAAlBQ,SAASH,GAAoC,GAApBG,SAASF,GAAgBE,SAASD,GAGnE,OAAOC,SAASR,IAsChBS,0BA/BD,SAAmCT,GAA0B,IAApBU,EAAmB,wDAE3D,GAAIV,EAAKC,WAAWC,QAAQ,MAAQ,EACnC,OAAOF,EAMR,GAHAA,EAAOQ,SAASR,GAChBU,EAAYA,GAAcV,EAAO,KAE7BW,OAAOC,MAAMZ,GAChB,OAAOU,EAAY,WAAa,QAGjC,IAAIL,EAAQ,IAAMvE,KAAKC,MAAMiE,EAAK,MAC9BM,EAAU,IAAMxE,KAAKC,MAAMiE,EAAK,IAChCO,EAAU,IAAOP,EAAO,GAE5B,OAAOU,EAAY,CAAEL,EAAMQ,QAAQ,GAAIP,EAAQO,QAAQ,GAAIN,EAAQM,QAAQ,IAAKhI,KAAK,KAAO,CAAEyH,EAAQO,QAAQ,GAAIN,EAAQM,QAAQ,IAAKhI,KAAK,MAe5IiI,kBARD,SAA2BP,GAAkD,IAAzCQ,EAAwC,uDAAvB,sBACpD,OAAOC,YAAO,IAAIC,KAAa,IAARV,GAAeQ,EAAgB,CAAEG,OAAQC,IAAQtL,IAAKuL,oB,8FC3CzDC,E,+FAiBXC,EAAQC,GAAmE,IAY/D,EAZKC,EAAyD,uDAA3C,OAAQC,IAAmC,yDAAZC,EAAY,uDAAJ,KAC9EH,EAAU9I,MAAMC,QAAQ6I,GAAWA,EAAU,CAACA,IACtCxC,SAAQ,SAAA4C,GACfN,EAAIO,IAAItC,KAAK,CACZU,KAAM,IAAIiB,KACVK,OAAQA,EACRE,YAAaA,EACbD,QAASI,EACTD,MAAOA,OAILD,KACHF,EAAQ,GAAKD,EAAS,MAAQC,EAAQ,IACtC,EAAAM,SAAQL,GAAR,oBAAwBD,O,+BAWzB,OAAOF,EAAIO,Q,KA1CQP,EAKbO,IAAM,I,oNCORE,EAAmB1P,aAAW,SAAAC,GAAK,MAAK,CAC5CoC,KAAM,CACJsN,YAAa1P,EAAMI,QAAQ,GAC3B2H,aAAc/H,EAAMI,QAAQ,IAE9BuP,UACyB,UAAvB3P,EAAMO,QAAQ8D,KACV,CACE/D,MAAON,EAAMO,QAAQgL,UAAUqE,KAC/B3O,gBAAiB4O,YAAQ7P,EAAMO,QAAQgL,UAAUuE,MAAO,MAE1D,CACExP,MAAON,EAAMO,QAAQwP,KAAK1E,QAC1BpK,gBAAiBjB,EAAMO,QAAQgL,UAAUyE,MAEjDnM,MAAO,CACL6H,KAAM,gBAIK,SAASuE,EAAqB3O,GAC3C,IAAMQ,EAAU2N,IACR5L,EAAoDvC,EAApDuC,MAAOqM,EAA6C5O,EAA7C4O,SAAUC,EAAmC7O,EAAnC6O,YAAaC,EAAsB9O,EAAtB8O,kBAEtC,OACE,kBAACC,EAAA,EAAD,CACE/N,UAAWN,YAAKF,EAAQM,KAAT,eACZN,EAAQ6N,UAAYQ,EAAc,KAGpCA,EAAc,EACb,kBAACG,EAAA,EAAD,CAAYhO,UAAWR,EAAQ+B,MAAOvD,MAAM,UAAUiC,QAAQ,aAC3D4N,EADH,aAIA,kBAACG,EAAA,EAAD,CAAYhO,UAAWR,EAAQ+B,MAAOtB,QAAQ,KAAKG,GAAG,mBAChDqE,IAAVlD,GAAwBA,EAAQ,KAAOqM,EAAW,KAI/CC,EAAc,EACb,kBAACI,EAAA,EAAD,CAAS1M,MAAM,UACb,kBAAC2M,EAAA,EAAD,CAAYhO,aAAW,UACrB,kBAAC,IAAD,QAIP4N,G,iDCjDU,SAASK,EAAkBnP,GAAQ,IACxCoP,EAA4GpP,EAA5GoP,UAAWC,EAAiGrP,EAAjGqP,iBAAkBC,EAA+EtP,EAA/EsP,WAAYC,EAAmEvP,EAAnEuP,SAAUC,EAAyDxP,EAAzDwP,MAAOC,EAAkDzP,EAAlDyP,QAASZ,EAAyC7O,EAAzC6O,YAAaD,EAA4B5O,EAA5B4O,SAAUc,EAAkB1P,EAAlB0P,cAKlG,OACE,kBAACC,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,MACY,IAAfN,GACA,kBAACO,EAAA,EAAD,CAAWxQ,QAAQ,YACjB,kBAACyQ,EAAA,EAAD,CACDC,cAAelB,EAAc,GAAKA,EAAcD,EAChDoB,QAASpB,EAAW,GAAKC,IAAgBD,EACzChM,SAAUyM,EACVY,WAAY,CAAE,aAAc,iBAKvBb,EAAUpK,KAAI,SAAAkL,GAAQ,OACrB,kBAACL,EAAA,EAAD,CACE/N,IAAKoO,EAAS9O,GACd+O,MAAOD,EAASC,OAAS,OACzB9Q,QAAS6Q,EAASE,eAAiB,OAAS,UAC5CC,cAAed,GAAaE,IAAYS,EAAS9O,IAAKoO,EAC/DzN,MAAO,CAAEF,MAAOqO,EAASrO,OAAS,SAEhC0N,EACO,kBAACe,EAAA,EAAD,CACEC,OAAQd,IAAYS,EAAS9O,GAC7BoP,UAAWf,IAAYS,EAAS9O,GAAKoO,EAAQ,MAC7CrO,SA9BcsP,EA8BaP,EAAST,SAAWS,EAAS9O,GA9B9B,SAAAsP,GACpChB,EAAcgB,EAAOD,MA+BX,gCAASP,EAASpN,QAG5B,gCAASoN,EAASpN,QAnCM,IAAA2N,O,sBCEtBjS,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACtCiS,OAAQ,CACPC,WAAY,cAMd,SAASC,EAAc/O,EAAK0B,EAAKsN,GAEhC,GAAY,OAARtN,GAA+B,kBAARA,EAAkB,CAC5C,GAAIsN,EAAKvE,QAAQ/I,IAAQ,EACxB,OAGDsN,EAAKnF,KAAKnI,GAGX,OAAOA,EAwBO,SAASuN,EAAc/Q,GAAQ,IACrCgR,EAA6EhR,EAA7EgR,QAASC,EAAoEjR,EAApEiR,WAAYC,EAAwDlR,EAAxDkR,UAAWC,EAA6CnR,EAA7CmR,UAAW7B,EAAkCtP,EAAlCsP,WAAY8B,EAAsBpR,EAAtBoR,SAAUjQ,EAAYnB,EAAZmB,QACnEX,EAAUhC,IAGhB,OAED,kBAAC,IAAD,KACEyS,EAAWjM,KAAI,SAACqM,EAAKC,GACrB,IANkBlQ,EAMZmQ,GANYnQ,EAMgBiQ,EAAIjQ,IANY,IAA1BgQ,EAAS7E,QAAQnL,IAOnCoQ,EAAO,kCAA8BF,GAEvCnL,EAAS,GACb,IAAK,IAAIsL,KAAYN,EAAW,CAC/B,IAAIO,EAAWP,EAAUM,GAErBJ,EAAII,IAAaE,OAAOC,KAAKF,GAAUnF,QAAQ8E,EAAII,KAAc,IACpEtL,EAAM,2BAAQA,GAAWuL,EAASL,EAAII,MAIxC,OAED,kBAAC7B,EAAA,EAAD,CACC9N,IAAK,YAAcwP,EACnBO,OAAK,EACL1Q,QAASA,EAAW,SAAAuP,GAAK,OAAIvP,EAAQuP,EAAOW,EAAIjQ,UAAOqE,EACvDqM,KAAK,WACLC,eAAcR,EACdS,UAAW,EACXZ,SAAUG,IAGM,IAAfjC,GACD,kBAACO,EAAA,EAAD,CACC/N,IAAK,aAAewP,EAAQ,YAC5BvP,MAAOoE,EACP9G,QAAQ,YAGR,kBAACyQ,EAAA,EAAD,CACCE,QAASuB,EACTtB,WAAY,CAAE,kBAAmBuB,MAMlCR,EAAQhM,KAAI,SAAAiN,GAAM,OACnB,kBAACpC,EAAA,EAAD,CACC/N,IAAK,aAAewP,EAAQ,IAAMW,EAAO7Q,GACzCZ,QAAS,CAAEM,KAAMJ,YAAKuR,EAAOtB,QAAUnQ,EAAQmQ,SAC/C5O,MAAOoE,EACP+L,MAAM,MACN7S,QAAS4S,EAAO7B,eAAiB,OAAS,WA3E7C,SAA0B+B,GAAqB,IAAZpP,EAAW,uDAAJ,GAEzC,QAAgB0C,IAAZ0M,GAAqC,OAAZA,EAC5B,MAAO,GAGR,IAAIrB,EAAO,GACX,OAAO/N,EAAKuB,eACX,IAAK,OACJ6N,EAAU9E,YAAO8E,EAAS,uBAC1B,MAED,QAECA,EAA6B,mBAD7BA,EAAUrN,MAAMC,QAAQoN,IAA+B,kBAAZA,EAAuBC,KAAKC,UAAUF,GAAS,SAACrQ,EAAK0B,GAAN,OAAcqN,EAAc/O,EAAK0B,EAAKsN,MAASqB,GAChGA,EAAQ7F,WAAa6F,EAIhE,OAAOA,EA4DJG,CAAiBjB,EAAIY,EAAO7Q,IAAK6Q,EAAOlP,eAU1CmO,EAAY,GACb,kBAACtB,EAAA,EAAD,CAAU7N,MAAO,CAAEwQ,OAAQ,GAAKrB,IAC/B,kBAACrB,EAAA,EAAD,CAAW2C,QAAS,MCjHtB,IAAMhU,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACrC+T,MAAO,CACL7L,SAAU,SAKd,SAAS8L,EAAqBC,EAAGC,EAAGnD,EAASoD,GAE5C,IAAIC,EAAQC,EACZ,IAA8B,IAA1BtD,EAAQlD,QAAQ,KACnBuG,EAASH,EAAElD,IAAY,GACvBsD,EAASH,EAAEnD,IAAY,OAEnB,CAMJ,IALA,IAGI6B,EAHA0B,EAAI,eAAQL,GACZM,EAAI,eAAQL,GACZ9Q,EAAM2N,EAGH3N,EAAIyK,QAAQ,MAAQ,GAE1B,IACC+E,EAAQxP,EAAIoL,OAAO,EAAGpL,EAAIyK,QAAQ,MAClCzK,EAAMA,EAAIoL,OAAOpL,EAAIyK,QAAQ,KAAK,GAClCyG,EAAOA,EAAK1B,GACZ2B,EAAOA,EAAK3B,GAEb,MAAM4B,GACLhF,QAAQhK,MAAMgP,EAAItF,SAIpBkF,EAASE,EAAKlR,IAAQ,GACtBiR,EAASE,EAAKnR,IAAQ,GAStB,OANmB,IAAhB+Q,IACHC,EAA2B,kBAAXA,EAAsBV,KAAKC,UAAUS,GAAUA,EAAOxO,cACtEyO,EAA2B,kBAAXA,EAAsBX,KAAKC,UAAUU,GAAUA,EAAOzO,eAIlEyO,EAASD,GACH,EAENC,EAASD,EACJ,EAEF,EAGT,SAASK,EAAc3D,EAAOC,EAASoD,GACrC,MAAiB,SAAVrD,EACH,SAACmD,EAAGC,GAAJ,OAAUF,EAAqBC,EAAGC,EAAGnD,EAASoD,IAC9C,SAACF,EAAGC,GAAJ,OAAWF,EAAqBC,EAAGC,EAAGnD,EAASoD,IAGrD,SAASO,EAAWC,EAAOC,GACzB,IAAMC,EAAiBF,EAAMrO,KAAI,SAACwO,EAAIlC,GAAL,MAAe,CAACkC,EAAIlC,MAMrD,OALAiC,EAAeE,MAAK,SAACd,EAAGC,GACtB,IAAMpD,EAAQ8D,EAAWX,EAAE,GAAIC,EAAE,IACjC,OAAc,IAAVpD,EAAoBA,EACjBmD,EAAE,GAAKC,EAAE,MAEXW,EAAevO,KAAI,SAAAwO,GAAE,OAAIA,EAAG,MAGtB,SAASzC,EAAc/Q,GACpC,IAAMQ,EAAUhC,IAER+D,EAA0MvC,EAA1MuC,MAAO6M,EAAmMpP,EAAnMoP,UAAWjM,EAAwLnD,EAAxLmD,KAAMuQ,EAAkL1T,EAAlL0T,gBAAiBjP,EAAiKzE,EAAjKyE,KAAMkP,EAA2J3T,EAA3J2T,QAASrE,EAAkJtP,EAAlJsP,WAAYsE,EAAsI5T,EAAtI4T,WAAYC,EAA0H7T,EAA1H6T,aAAcC,EAA4G9T,EAA5G8T,eAAgBjB,EAA4F7S,EAA5F6S,YAAakB,EAA+E/T,EAA/E+T,gBAAiBC,EAA8DhU,EAA9DgU,YAAaC,EAAiDjU,EAAjDiU,mBAAoBC,EAA6BlU,EAA7BkU,yBAH1I,EAKjBnM,IAAMhE,SAAS8P,GAAgB,OALd,mBAKpCrE,EALoC,KAK7B2E,EAL6B,OAMbpM,IAAMhE,SAAS+P,GAAkB1E,EAAU,GAAGK,SAAWL,EAAU,GAAGhO,IANzD,mBAMpCqO,EANoC,KAM3B2E,EAN2B,OAOXrM,IAAMhE,SAASgQ,GAAmB,IAPvB,mBAOpC3C,EAPoC,KAO1BiD,EAP0B,OAQnBtM,IAAMhE,SAASiQ,GAAe,GARX,mBAQpCM,EARoC,KAQ9BC,EAR8B,OASLxM,IAAMhE,SAAS6P,EAAcK,GAAsB,EAAKxP,EAAKgI,QATxD,mBASpC+H,EAToC,KASvBC,EATuB,KAW7CrQ,qBAAU,kBAAMqQ,EAAeb,EAAcK,GAAsB,EAAKxP,EAAKgI,UAAS,CAAChI,EAAKgI,OAAQmH,EAAYK,IAG9G,IA4CMS,EAAYhB,GAAmBiB,EACrC,OACD,kBAAC,IAAMrL,SAAP,MACc,IAAZqK,GACK,kBAAChF,EAAD,CACJpM,MAAOA,EACDqM,SAAUnK,EAAKgI,OACrBoC,YAAauC,EAAS3E,QAAU,EAChCqC,kBAAmBoF,IAGf,kBAACU,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,CACE7T,UAAWR,EAAQiS,MACnBqC,kBAAgB,aAChB5T,aAAW,iBACpBiC,KAAMA,EACN4R,cAAc,GAEL,kBAAC5F,EAAD,eACE3O,QAASA,EACTqO,YAAauC,EAAS3E,OACtB+C,MAAOA,EACPC,QAASA,EACTJ,iBA9DiB,SAAAqB,GAC3B,GAAIA,EAAMtO,OAAO4N,QAAjB,CACE,IAAMgF,EAAevQ,EAAKO,KAAI,SAAAiQ,GAAC,OAAIA,EAAE7T,MACrCiT,EAAYW,QAGdX,EAAY,KAyDF3E,cArEc,SAACgB,EAAOD,GAEhC0D,EADc1E,IAAYgB,GAAsB,QAAVjB,EACrB,OAAS,OAC1B4E,EAAW3D,IAmED7B,SAAUnK,EAAKgI,QACpBzM,IAGN,kBAAC0U,EAAD,eACC1D,QAAS5B,EACT6B,WAAYmC,EAAW3O,EAAM0O,EAAc3D,EAAOC,EAASoD,IAAcqC,MAAMZ,EAAOE,EAAaF,EAAOE,EAAcA,GACxHtD,UAAWsD,EAAcrM,KAAKgN,IAAIX,EAAa/P,EAAKgI,OAAS6H,EAAOE,GACpErT,SAAwB,IAAfmO,GAtDO,SAACoB,EAAOtP,GACxB,IAAMgU,EAAgBhE,EAAS7E,QAAQnL,GACnCiU,EAAc,IAEK,IAAnBD,EACFC,EAAcA,EAAYC,OAAOlE,EAAUhQ,GAChB,IAAlBgU,EACTC,EAAcA,EAAYC,OAAOlE,EAAS8D,MAAM,IACvCE,IAAkBhE,EAAS3E,OAAS,EAC7C4I,EAAcA,EAAYC,OAAOlE,EAAS8D,MAAM,GAAI,IAC3CE,EAAgB,IACzBC,EAAcA,EAAYC,OACxBlE,EAAS8D,MAAM,EAAGE,GAClBhE,EAAS8D,MAAME,EAAgB,KAInCf,EAAYgB,IAsCZjE,SAAUA,GACNpR,MAKL4T,GAAc,kBAAC2B,EAAA,EAAD,CACPC,mBAAoB,CAAC,EAAG,GAAI,IAC5B3M,UAAU,MACV4M,MAAOhR,EAAKgI,OACZ+H,YAAaA,EACbF,KAAMA,EACNoB,aA5EiB,SAAChF,EAAOiF,GAC/BpB,EAAQoB,IA4EFC,oBAzEwB,SAAAlF,GAC9B+D,EAAe5H,SAAS6D,EAAMtO,OAAO4B,MAAO,KAC5CuQ,EAAQ,S,iCCxHZ,kBAKIsB,EAAeC,OAAQ,UAAY5T,IAAKuL,eAAesI,QAC3D7T,IAAK8T,eAAe9T,IAAKuL,cAAeoI,GAGzB,WACdI,YAAa,CACZ,GAAM,QACN,GAAM,YAEPC,eAAgB,CACfrV,KAAM,CACL8C,KAAM,CACLwS,KAAM,YACNC,MAAO,eAER7U,QAAS,CACR4U,KAAMjU,IAAKC,EAAE,kBACbiU,MAAOlU,IAAKC,EAAE,qBAGhBkU,KAAM,IAGP/P,WAAY,GAEZlG,QAAS,K,iCC9BV,0CASIyV,EAAeC,OAAQ,aAAe5T,IAAKuL,eAAesI,QAC9D7T,IAAK8T,eAAe9T,IAAKuL,cAAeoI,GAgBzB,WACdI,YAAa,CACZ,GAAM,UACN,GAAM,WAEPC,eAAgB,CACfI,YAAa,CACZtS,MAAO,SAAAR,GAAG,OAAIA,EAAI+S,QAAQ,IAC1BC,KAAM,SACN7S,KAAM,YAEP8S,eAAgB,CACfD,KAAM,SACN7S,KAAM,0BAEP+S,SAAU,CACTF,KAAM,MAEPG,MAAO,CACNhT,KAAM,aAGR2C,WAAY,CACXmQ,eAhCF,SAAwCzW,GACvC,IAAM4W,EAAQC,UAASvQ,WAAWwQ,eAClC,OACC,kBAACF,EAAD,eAAOzB,IAAK,EAAG4B,IAAK,IAAQ/W,OA+B7BI,QAAS,CACRuW,MAAOE,UAASzW,QAAQ4W,e,iCCpD1B,kBAMInB,EAAeC,OAAQ,cAAgB5T,IAAKuL,eAAesI,QAC/D7T,IAAK8T,eAAe9T,IAAKuL,cAAeoI,GAGzB,WACdI,YAAa,CACZ,GAAM,YACN,GAAM,QAEPC,eAAgB,CACftX,SAAU,CACT+E,KAAM,cAEPsT,SAAU,CACTtT,KAAM,CACLwS,KAAM,oBACNC,MAAO,6BAER7U,QAAS,CACR4U,KAAMjU,IAAKC,EAAE,0BACbiU,MAAOlU,IAAKC,EAAE,6BAGhB+U,MAAO,CACNvT,KAAM,CACL,GAAI,wBACJ,QAAW,iBAEZpC,QAAS,CACR,GAAIW,IAAKC,EAAE,2BAIdmE,WAAY,GAEZlG,QAAS,K,iCCzCV,kBAMIyV,EAAeC,OAAQ,UAAY5T,IAAKuL,eAAesI,QAC3D7T,IAAK8T,eAAe9T,IAAKuL,cAAeoI,GAGzB,WACdI,YAAa,CACZ,GAAM,QACN,GAAM,YAEPC,eAAgB,CACftX,SAAU,CACT+E,KAAM,cAEPwT,SAAU,CACTxT,KAAM,WAEPyT,QAAS,IAGV9Q,WAAY,GAEZlG,QAAS,K,iCC3BV,kBAMIyV,EAAeC,OAAQ,YAAc5T,IAAKuL,eAAesI,QAC7D7T,IAAK8T,eAAe9T,IAAKuL,cAAeoI,GAGzB,WACdI,YAAa,CACZ,GAAM,UACN,GAAM,WAEPC,eAAgB,CACfrV,KAAM,CACL8C,KAAM,CACLwS,KAAM,sBACNC,MAAO,yBAER7U,QAAS,CACR4U,KAAMjU,IAAKC,EAAE,oBACbiU,MAAOlU,IAAKC,EAAE,wBAIjBmE,WAAY,GAEZlG,QAAS,K,wOCnBJ5B,EAAYC,aAAW,SAACC,GAAD,MAAY,CACxC2Y,KAAM,CACLvX,OAAQpB,EAAMI,QAAQ,SAQT,SAASwY,EAAUtX,GAAQ,IACjC2D,EAA6C3D,EAA7C2D,KAAM3E,EAAuCgB,EAAvChB,MAAO8D,EAAgC9C,EAAhC8C,MAAOyU,EAAyBvX,EAAzBuX,SAAUC,EAAexX,EAAfwX,WAChChX,EAAUhC,EAAUwB,GAG1B,OACC,kBAAC,IAAD,CACCgB,UAAWR,EAAQ6W,KACnB1T,KAAMA,EACN3E,MAAOA,EACP8D,MAAOA,EACPyU,SAPmB,kBAAMA,GAAYA,KAQrCC,WAAYA,IAQR,SAASC,EAAWzX,GAAQ,IAC1B0X,EAAwB1X,EAAxB0X,KAAS5T,EADgB,YACD9D,EADC,UAIjC,OADc8E,MAAMC,QAAQ2S,GAAQA,EAAOA,EAAKlL,MAAM,MACzCxH,KAAI,SAAAqS,GAAI,OAA+BC,EAAX,kBAATD,EAA8B,aAAEvU,MAAOuU,GAASvT,GAA0B,2BAAKuT,GAASvT,OAMlH,SAAS6T,EAAgB3X,GAAQ,IAC/B4X,EAA6B5X,EAA7B4X,UAAc9T,EADgB,YACD9D,EADC,eAGtC,OACC,kBAAC,mBAAD,eACC6X,UAAQ,EACRC,UAAQ,EACRC,eAAgB,SAAAnS,GAAM,OAAIgS,EAAYhS,EAAOgS,GAAahS,IACtD9B,O,sSC7CDtF,EAAYC,aAAW,SAACC,GAAD,MAAY,CACxCsZ,UAAW,CACV3Y,QAAS,gBAEV4Y,SAAU,CACT5Y,QAASX,EAAMI,QAAQ,GAAK,EAAG,EAAG,IAEnCoZ,aAAc,CACb7Y,QAASX,EAAMI,QAAQ,EAAG,EAAG,EAAG,IAEjCqZ,OAAQ,CACPC,SAAU,SACVpZ,MAAON,EAAMO,QAAQ8K,QAAQ2E,KAC7BrP,QAASX,EAAMI,QAAQ,EAAG,QAOb,SAASmZ,EAASjY,GAAQ,IAChCG,EAAuCH,EAAvCG,SAAU6X,EAA6BhY,EAA7BgY,UAAclU,EADO,YACQ9D,EADR,0BAEjCQ,EAAUhC,IAEhB,OACC,oCACC,kBAAC6Z,EAAmBvU,GACpB,kBAAC,IAAD,eAAM9B,WAAS,EAAChB,UAAWN,YAAKF,EAAQyX,SAAUD,GAAaxX,EAAQwX,YAAgBlU,GACrF3D,IASE,SAAS+X,EAAalY,GAAQ,IAC5BgC,EAAiChC,EAAjCgC,UAAW7B,EAAsBH,EAAtBG,SAAU6Q,EAAYhR,EAAZgR,QACvBxQ,EAAUhC,IAEhB,OACC,kBAAC,IAAD,eACCwD,UAAWA,IAAa,EACxBC,MAAI,EACJjB,UAAWR,EAAQ0X,aACnBI,GAAItH,GAAW,IACXhR,GAGHG,GAQG,SAASkY,EAAerY,GAC9B,IAAMQ,EAAUhC,IAChB,OAAQwB,EAAM8C,MACb,oCACC,kBAAC,IAAD,CAAY9B,UAAWR,EAAQ2X,OAAQlX,QAAQ,MAAMjB,EAAM8C,OAC3D,kBAAC,IAAD,OAHoB,KAWhB,SAASyV,EAAKvY,GAAQ,IACpBG,EAAaH,EAAbG,SAER,OACC,kBAAC,IAAD,CAAyBqY,MAAOtW,IAAKuW,uBAAwBlL,OAAQrL,IAAKwW,aACxEvY,M,mbClBEwY,E,kDAEL,WAAY3Y,GAAQ,IAAD,8BAClB,cAAMA,IAEDuH,MAAQ,CACZqR,mBAAoB,GACpBC,mBAAoB,GACpBC,YAAY,EACZC,YAAa,GACbC,gBAAiB,IAGlB,EAAKC,OAASC,IAAWC,cACzB,EAAKzB,KAAO,EAAK1X,MAAM4L,SAAS8L,KAAQ5S,MAAMC,QAAQ,EAAK/E,MAAM4L,SAAS8L,MAAQ,EAAK1X,MAAM4L,SAAS8L,KAAO,EAAK1X,MAAM4L,SAAS8L,KAAKlL,MAAM,KAAQ,KACpJ,EAAK4M,UAAY,EAAKpZ,MAAM4L,SAASwN,UAAatU,MAAMC,QAAQ,EAAK/E,MAAM4L,SAASwN,WAAa,EAAKpZ,MAAM4L,SAASwN,UAAY,EAAKpZ,MAAM4L,SAASwN,UAAU5M,MAAM,KAAQ,KAE7K,EAAK6M,aAAe,CAAC,0BAA2B,+BAAgC,4BAChF,EAAKC,cAAgB,GAhBH,E,gEAmBE,IAAD,QAGiB,IAAhCpR,KAAKlI,MAAM4L,SAAS2N,SAEvBrR,KAAK+Q,OAAOO,UAAUtR,KAAKmR,cAAc,SAACnG,EAAKuG,GAE9C,EAAK9R,SAAS,CACbmR,WAAYW,EAAO,2BAA2BjW,IAC9CwV,gBAAiBS,EAAO,gCAAgCjW,IACxDuV,YAAaU,EAAO,4BAA4BjW,MAIjD,EAAKyV,OAAOS,gBAAgB,EAAKL,cAAc,SAACjY,EAAIuY,GAEnDvY,EAAKA,EAAG8L,OAAO9L,EAAGwY,YAAY,KAAK,GAC/B,EAAKrS,MAAMnG,KAAQuY,EAAOnW,KAC7B,EAAKmE,SAAL,eAAiBvG,EAAKuY,EAAOnW,YAOjC0E,KAAK+Q,OAAOY,qBAAoB,SAAC3G,EAAK4G,GAErC,GAAIA,GAAaA,EAAUrV,KAAM,CAChC,IAAIsV,EAAW,GAGfD,EAAUrV,KAAK2G,SAAQ,SAAC4O,EAAUlO,KAG3B,EAAK4L,MAAS,EAAKA,MAAQ,EAAKA,KAAKnL,QAAQyN,EAAShW,MAAMiW,OAAOlU,OAAS,MAAS,EAAKqT,WAAc,EAAKA,YAAqE,IAAxD,EAAKA,UAAU7M,QAAQyN,EAAShW,MAAMiW,OAAOlU,SAE5KgU,EAASpO,KAAKqO,GACd,EAAKV,cAAgB,EAAKA,cAAchE,OAAO,CAC9C0E,EAAS5Y,GAAK,SACd4Y,EAAS5Y,GAAK,aACd4Y,EAAS5Y,GAAGmD,QAAQ,kBAAmB,IAAM,yBAMhD,EAAKoD,SAAS,CAAEiR,mBAAoBmB,EAAStG,MAAK,SAACyG,EAAOC,GACxD,OAAID,EAAM9Y,GAAK+Y,EAAM/Y,GAAW,EACvB+Y,EAAM/Y,GAAK8Y,EAAM9Y,IAAY,EAC1B,OAKd,EAAK6X,OAAOO,UAAU,EAAKF,eAAe,SAACpG,EAAK2F,GAC/C,EAAKlR,SAAS,CAAEkR,uBAGhB,EAAKI,OAAOS,gBAAgB,EAAKJ,eAAe,SAAClY,EAAIgZ,IAEhDA,GAAiB,EAAK7S,MAAMsR,mBAAmBzX,IAAQgZ,EAAY5W,MAAQ,EAAK+D,MAAMsR,mBAAmBzX,GAAIoC,KAChH,EAAKmE,UAAS,SAAA0S,GAAS,MAAK,CAAExB,mBAAmB,2BAAMwB,EAAUxB,oBAAjB,kBAAsCzX,EAAKgZ,oB,6CAShGlS,KAAK+Q,OAAOqB,kBAAZ,sBAAmCpS,KAAKmR,cAAxC,YAAyDnR,KAAKoR,mB,+BAGrD,IAAD,OACA9Y,EAAY0H,KAAKlI,MAAjBQ,QAGF+Z,EAAcrS,KAAKX,MAAMwR,aAAe3G,KAAKoI,MAAMtS,KAAKX,MAAMwR,cAAiB,GAC/EQ,EAAU5H,OAAOC,KAAK2I,GAAY9N,OAGpCgO,EAAc,kBAAC,IAAD,CAAU3Y,IAAI,UAAUd,UAAWR,EAAQka,SAAS,kBAAC,IAAD,CAAkBvX,KAAM,MAwC9F,OAtCI+E,KAAKX,MAAMqR,mBAAmBnM,OAAS,IAE1CgO,EAAcvS,KAAKX,MAAMqR,mBAAmB5T,KAAI,SAAA2V,GAC/CA,EAAQhB,OAASY,EAAWI,EAAQ3W,MAAMiW,OAAOlU,QAAS,EAE1D,IAAM6U,EAAUD,EAAQ3W,MAAMiW,OAAOW,QAC/BC,EAAS,EAAKtT,MAAMsR,mBAAmB8B,EAAQvZ,GAAK,WAAa,EAAKmG,MAAMsR,mBAAmB8B,EAAQvZ,GAAK,UAAUoC,MAAQ,EAC9HsX,EAAa,EAAKvT,MAAMsR,mBAAmB8B,EAAQvZ,GAAK,eAAiB,EAAKmG,MAAMsR,mBAAmB8B,EAAQvZ,GAAK,cAAcoC,MAAQ,EAC1IuX,GAAa,EAAKxT,MAAMsR,mBAAmB8B,EAAQvZ,GAAGmD,QAAQ,kBAAmB,IAAM,qBAAsB,EAAKgD,MAAMsR,mBAAmB8B,EAAQvZ,GAAGmD,QAAQ,kBAAmB,IAAM,oBAAoBf,IAE3MwX,EAAU9Y,IAAKC,EAAE,WAAa,KAAOyY,EAAWC,GAASC,GAAaC,EAAa7Y,IAAKC,EAAE,SAAWD,IAAKC,EAAE,aAAgBD,IAAKC,EAAE,aAEzI,OAEC,kBAAC,IAAD,CAAUL,IAAK,WAAa6Y,EAAQvZ,IACnC,kBAAC,IAAD,KACC,kBAAC,IAAD,CAAQ6Z,IAAKN,EAAQ3W,MAAMiW,OAAOlU,KAAMmV,IAAKP,EAAQ3W,MAAMiW,OAAOkB,QAASna,UAAWR,EAAQ4a,SAE/F,kBAAC,IAAD,CACCrR,QAAS4Q,EAAQ3W,MAAMiW,OAAO1X,MAC9B0H,UAAW,CACV,IAAM0Q,EAAQ3W,MAAMiW,OAAOoB,QAC1BV,EAAQhB,QAAUgB,EAAQ3W,MAAMiW,OAAOoB,UAAYV,EAAQhB,OAAO2B,kBAAqB,0BAAMxZ,IAAK,WAAa6Y,EAAQvZ,IAAhC,KAAsC,0BAAMJ,UAAWR,EAAQ+a,iBAAkBrZ,IAAKC,EAAE,oBAAsB,KAAOwY,EAAQhB,OAAO2B,mBAC3NX,EAAQ3W,MAAMiW,OAAOuB,kBAAoB,KAAOtZ,IAAKC,EAAE,gBAAkB,IAAMD,IAAKC,EAAE,MAAQ,KAAOD,IAAKC,EAAE,SAAW,IAAMwY,EAAQ3W,MAAMiW,OAAOwB,aAAe,OAIpK,kBAAC,IAAD,CAAyBza,UAAWN,YAAKF,EAAQkb,gBAAiBd,EAAWC,GAASC,GAAaC,EAAava,EAAQqa,MAAQra,EAAQmb,SAAYnb,EAAQ0C,WAC3J,kBAAC,IAAD,CAASX,MAAOyY,GACf,0BAAMha,UAAW4Z,EAAWC,GAASC,GAAaC,EAAa,uBAAyB,gBAAmB,yBAWnH,kBAAC,IAAD,CAAM1a,OAAK,IACiB,IAA1B6H,KAAKX,MAAMuR,WAAwB5Q,KAAKX,MAAMyR,iBAC/C,kBAAC,IAAD,CAAUlX,IAAI,UAAUtB,QAAS,CAAEM,KAAMN,EAAQob,YAChD,kBAAC,IAAD,CACC7R,QAAS7H,IAAKC,EAAE,eAAiB,KAAOkL,YAAO,IAAIC,KAAKpF,KAAKX,MAAMyR,iBAAkB,sBAAuB,CAAEzL,OAAQC,IAAQtL,IAAKuL,oBAKrI,kBAAC,IAAD,CAAU3L,IAAI,UAAUtB,QAAS,CAAEwB,UAAWxB,EAAQqb,kBACrD,kBAAC,IAAD,KACC,kBAAC,IAAD,OAED,kBAAC,IAAD,CACC9R,QAAS7H,IAAKC,EAAE,qBAAuB,MAGxC,kBAAC,IAAD,CAAyBnB,UAAWN,YAAKF,EAAQkb,gBAAiBlb,EAAQsb,mBACxEvC,IAKFkB,O,GAvK0B1S,IAAMsC,WA+KnBpD,uBA/NA,SAAAvI,GAAK,MAAK,CACxBkd,UAAW,CACVG,UAAW,SACXvV,UAAW,QACXxH,MAAO,uBAERuc,gBAAiB,CAChBvc,MAAO,WAER6c,gBAAiB,CAChBlc,gBAAiB,UACjBX,MAAO,OACPc,OAAQpB,EAAMI,QAAQ,GAAI,GAC1BsP,YAAa1P,EAAMI,QAAQ,IAE5Bgd,iBAAkB,CACjBjd,MAAOH,EAAMI,QAAQ,MACrBa,gBAAiB,UACjBqc,aAAc,MACdna,MAAOnD,EAAMI,QAAQ,GACrByT,OAAQ7T,EAAMI,QAAQ,GACtBE,MAAO,OACPwH,UAAW,SACX4R,SAAU,mBAEXsD,gBAAiB,CAChBtD,SAAU,UAEXsC,QAAS,CACRlU,UAAW,SACXE,UAAW,OAEZ0U,MAAO,CACNvZ,MAAOnD,EAAMI,QAAQ,GACrByT,OAAQ7T,EAAMI,QAAQ,IAEvB+b,MAAO,CACN7b,MAAO,WAER2c,SAAU,CACT3c,MAAO,WAERkE,SAAU,CACTlE,MAAO,cAoLMiI,CAAmB0R,GAE3B,IAAMsD,EAAiB,CAC7BC,kBAAkB,EAClB3Z,MAAOL,IAAKC,EAAE,kBACdwB,KAAM,iBAGMsI,EAAoB,wIACpBC,EAAoB,CAAC,sBAErBC,EAAe,CAC3B,CACC,UAAa,UACb,MAAS,kBACT,YAAe,CACd,GAAM,kCACN,GAAM,6CAEP,KAAQ,SACR,KAAO,GAER,CACC,UAAa,OACb,MAAS,CACR,GAAM,oBACN,GAAM,6BAEP,YAAe,CACd,GAAM,sDACN,GAAM,4EAEP,OAAU,CACT,GAAM,mCACN,GAAM,0CAGR,CACC,UAAa,YACb,MAAS,CACR,GAAM,4BACN,GAAM,mCAEP,YAAe,CACd,GAAM,iDACN,GAAM,qDAEP,OAAU,CACT,GAAM,mCACN,GAAM,4C,0lBC7LHgQ,E,kDAEL,WAAYnc,GAAQ,IAAD,8BAClB,cAAMA,IAoIPoc,cAAgB,SAAA3Z,GAAO,OAAI,SAAC6E,EAAU+U,EAAS9U,EAAOC,GACrD,EAAK8U,cAAc9U,EAAQ6U,EAA3B,2BAAyC5Z,GAAzC,IAAkD8Z,KAAM,EAAKC,QAAQ/Z,EAAQga,MAAOha,EAAQia,QAC5F,EAAK/U,SAAS,CAAE+S,SAAS,MAvIP,EA0InBrT,YAAc,SAAA5E,GAAO,OAAI,SAAC6E,EAAU9D,EAAK+D,EAAOC,GAAvB,OAAkC,EAAKmV,iBAAiBnV,EAAQhE,EAA9B,2BAAwCf,GAAxC,IAAiD8Z,KAAM,EAAKC,QAAQ/Z,EAAQia,IAAK,IAAIpP,WAtI/I,EAAKsP,YAAc,EAAK5c,MAAM4L,SAASgR,aAAe,GACtD,EAAKC,YAAc,EAAK7c,MAAM4L,SAASiR,aAAe,GAEtD,EAAKA,YAAYC,MAAQ,EAAKD,YAAYC,OAAS,GACnD,EAAKD,YAAYC,MAAMC,QAAQ,CAC9B3b,GAAI,OACJ2B,KAAM,SACNnE,SAAU,OACVoe,MAAO,CACNC,SAAU,SAAAjZ,GAAK,OAAK,EAAK6Y,YAAYK,qBAAuB,IAAMlQ,OAAOmQ,WAAWnZ,GAAOuS,QAAQ,IAAM,EAAKsG,YAAYO,oBAAsB,QAKlJ,EAAK7V,MAAQ,CACZmT,SAAS,EACT2C,OAAQ,GAERC,YAAY,EACZC,uBAAyB,EAAKX,aAAe,EAAKA,YAAYW,wBAA2B,EACzFC,sBAAwB,EAAKZ,aAAe,EAAKA,YAAYY,uBAA0B,OACvFC,iBAAmB,EAAKb,aAAe,EAAKA,YAAYa,kBAAoB,IAAInQ,KAAK,EAAKsP,YAAYa,mBAAsB,IAAInQ,KAChIoQ,SAAS,EAAKd,cAAe,EAAKA,YAAYa,iBAE9CE,YAAa,GACbC,UAAW,CACVC,OAAQ,GACRC,SAAU,IAGXC,UAAU,EACVC,WAAW,GAIZ,EAAKC,MAAQ,KACb,EAAKC,aAAenW,IAAMC,YAG1B,EAAKmW,SAAWpW,IAAMC,YACtB,EAAKoW,aAAe,GACpB,EAAKC,aAAe,CACnBC,qBAAqB,EACrBC,UAAU,EACVC,OAAQ,CACPrd,QAAS,EAAKsd,mBAAmB9U,KAAxB,iBAEV+U,SAAU,CACTC,UAAW,CACV7b,MAAO,SAACb,EAAM2c,GAAP,OAAgBA,EAAKd,SAAS7b,EAAK4c,cAAc/b,MAAQ,KAAOb,EAAK+B,MAAQ4a,EAAKd,SAAS7b,EAAK4c,cAAcrI,QAGvHsI,OAAQ,CACPhC,MAAO,EAAKD,YAAYC,OAGzBiC,QAAS,CACRC,aAAc,CACbC,OAAQ,kBAETC,KAAM,CAELC,IAAK,CAEJvE,SAAS,EAGTwE,KAAM,MAIPF,KAAM,CAELtE,SAAS,EAGTwE,KAAM,SAhFQ,E,gEAuFE,IAAD,OAGf3c,EAAO,2BAAQyF,KAAKmX,gBAAb,IAA6B9C,KAAMrU,KAAKsU,YAEnDtU,KAAKlI,MAAM0L,QAAQN,SAAQ,SAAA5D,GAC1BA,EAAO1E,MAAQ0E,EAAOzB,KAAO,KAAO7D,IAAKC,EAAEqF,EAAOC,iBAAmB,IACrED,EAAO8X,0BAA0B9X,EAAO/E,QAAQ4Z,SAAW,MAAM,EAAM,CAAE,MAAS5Z,EAAQga,MAAO,IAAOha,EAAQia,IAAK,KAAQja,EAAQ8c,KAAM,UAAa,UAAW,YAAc,IAAQC,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,kBAAmBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,UAG/PvG,EAAOgB,OAAO,iBAAiB,SAAC/F,GAAD,OAAa,EAAK2Z,iBAGT,OAApC,EAAKpc,MAAM4L,SAAS8T,cAA4D,IAApC,EAAK1f,MAAM4L,SAAS8T,aAAyB,EAAKnY,MAAMmW,SACvGlW,EAAOgB,QAAO,SAAC/F,GAAD,OAAa,EAAK4E,oB,6CAKX,IAAD,OACtBa,KAAKlI,MAAM0L,QAAQN,SAAQ,SAAA5D,GAC1BA,EAAOiB,SAAS,EAAKpB,kB,yCAIJsY,EAAWtF,GAAY,IAAD,QAEpCnS,KAAKX,MAAMgW,wBACZlD,EAAUoD,mBAAqBvV,KAAKX,MAAMkW,kBAAoBpD,EAAUkD,yBAA2BrV,KAAKX,MAAMgW,wBAA0BlD,EAAUmD,wBAA0BtV,KAAKX,MAAMiW,wBAIzLtV,KAAKP,SAAS,CAAE+S,SAAS,EAAM2C,OAAQ,KAEvCuC,aAAa1X,KAAK+V,OAClB/V,KAAK+V,MAAQ4B,YAAW,WAEvB,IAAMpd,EAAU,EAAK4c,eACrB,EAAKrf,MAAM0L,QAAQN,SAAQ,SAAA5D,GAC1BA,EAAO8X,0BAA0B9X,EAAO/E,QAAQ4Z,SAAW,MAAM,EAAM,CAAE,MAAS5Z,EAAQga,MAAO,IAAOha,EAAQia,IAAK,KAAQja,EAAQ8c,KAAM,UAAa,UAAW,YAAc,IAAQC,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,kBAAmBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,eAG9P,Q,qCAaJ,IAAM2O,EAAMxU,KAAKX,MAAMkW,iBAAiBqC,UACpCC,EAAY7X,KAAKX,MAAMgW,uBACvBgC,EAAO,EACPS,EAAiB,sBAErB,OAAO9X,KAAKX,MAAMiW,uBACjB,QACC,MAED,IAAK,UACJwC,EAAiB,yBACjB,MAED,IAAK,UACJA,EAAiB,yBACjBD,GAAsB,GAEtB,MAED,IAAK,QACJC,EAAiB,sBACjBD,EAAsB,GAAVA,EAAa,GACzBR,GAAY,GACZ,MAED,IAAK,OACJS,EAAiB,sBACjBD,EAAsB,GAAVA,EAAa,GAAG,GAC5BR,EAAY,GAALA,EAAQ,GACf,MAED,IAAK,SACJS,EAAiB,eACjBD,EAAsB,GAAVA,EAAa,GAAG,GAAG,GAC/BR,EAAY,GAALA,EAAQ,GAAG,GAClB,MAED,IAAK,QACJS,EAAiB,eACjBD,EAAsB,GAAVA,EAAa,GAAG,GAAG,IAC/BR,EAAY,GAALA,EAAQ,GAAG,GAAG,GAIvB,MAAO,CACN,eAAkBS,EAClB,MAAStD,EAAc,IAAVqD,EACb,IAAOrD,EACP,UAAuB,IAAVqD,EACb,KAAa,IAALR,K,8BAIF9C,EAAOC,GAKd,IALoB,IAAD,EAEcxU,KAAKmX,eAA9BE,EAFW,EAEXA,KAAMS,EAFK,EAELA,eACVzD,EAAO,GAEFlQ,EAAOoQ,EAAOpQ,GAAQqQ,EAAKrQ,GAAQkT,EAC3ChD,EAAKlQ,GAAQ4T,IAAQ9S,kBAAkBd,EAAK,IAAM2T,GAGnD,OAAOzD,I,qCAGOqB,EAAWrB,GAEzB,IAAI2D,EACAtB,EAAO,GAEPuB,EAAUxO,OAAOC,KAAK2K,GAyC1B,OAxCA4D,EAAQ/U,SAAQ,SAACgV,EAAQtU,GAGxB,IAAK,IAAIwF,KAFT4O,EAAaC,EAASrU,EAAE,EAAI,EAAIA,EAAE,EAAI,GAEpB8R,EAAW,CAC5B,IAAI5P,EAAQ4P,EAAUtM,GAItB,GAHAtD,EAAMxK,IAAM2Z,WAAWnP,EAAMxK,KAGxBwK,EAAMqS,IAAoB,OAAdrS,EAAMxK,OAKnB0c,EAAalS,EAAMqS,IAKlB,GAAIH,EAAalS,EAAMqS,IAAMrS,EAAMqS,IAAMD,EAC7CxB,EAAK9S,GAAM8S,EAAK9S,GAAN,sBAAgC8S,EAAK9S,IAArC,CAAyCkC,EAAMxK,MAApC,CAAEwK,EAAMxK,UAIzB,GAAIwK,EAAMqS,GAAKD,EACnB,MAKGxB,EAAK9S,KAGkB,IAAnB8S,EAAK9S,GAAGW,OAChBmS,EAAK9S,GAAK8S,EAAK9S,GAAG,GAGlB8S,EAAK9S,GAAK8S,EAAK9S,GAAGwU,QAAO,SAAC3N,EAAEC,GAAH,OAASD,EAAIC,IAAG,GAAKgM,EAAK9S,GAAGW,WAIjDmS,I,uCAGSpX,EAAQxD,EAAOvB,GAE/B,IAAM8d,EAAarY,KAAKX,MAAMoW,YAAY6C,WAAU,SAAAxS,GAAK,OAAIA,IAAUxG,EAAO1E,SAC9E,IAAoB,IAAhByd,EACH,OAAO,EAGRrY,KAAKkW,aAAamC,GAAcrY,KAAKkW,aAAamC,IAAe,GACjErY,KAAKkW,aAAamC,GAAY5U,KAAK,CAClC,GAAM3H,EAAMqc,GACZ,IAAOrc,EAAMR,MAId,IAAMob,EAAO1W,KAAKuY,eAAevY,KAAKkW,aAAamC,GAAa9d,EAAQ8Z,MAMxErU,KAAKiW,SAAS9V,QAAQqY,cAAc9B,KAAKf,OAAzC,sBAAuD3V,KAAKX,MAAMqW,UAAUC,QAA5E,YAAuFlM,OAAOgP,OAAOle,EAAQ8Z,QAC7GrU,KAAKiW,SAAS9V,QAAQqY,cAAc9B,KAAKd,SAASyC,GAAY3B,KAA9D,sBAA0E1W,KAAKX,MAAMqW,UAAUE,SAASyC,GAAY3B,MAApH,YAA6HA,IAC7H1W,KAAKiW,SAAS9V,QAAQqY,cAAc/G,W,oCAGvBnS,EAAQ6U,EAAS5Z,GAG9B,IAAK4Z,IAAYA,EAAQ5P,OAAQ,CAChC,IAAIvI,EAAQhC,IAAKC,EAAE,gCAAgCoC,QAAQ,KAAMiD,EAAO1E,OAAS,IAEjF,OADAoF,KAAKP,UAAS,SAAAiZ,GAAU,MAAK,CAAEvD,OAAO,GAAD,mBAAOuD,EAAWvD,QAAlB,CAA0BnZ,SACxD,EAIR,IAAM0a,EAAO1W,KAAKuY,eAAepE,EAAS5Z,EAAQ8Z,MAG5CgE,EAAarY,KAAKX,MAAMoW,YAAY6C,WAAU,SAAAxS,GAAK,OAAIA,IAAUxG,EAAO1E,SAC9E,GAAIyd,GAAc,EACjBrY,KAAKiW,SAAS9V,QAAQqY,cAAc9B,KAAKf,OAASlM,OAAOgP,OAAOle,EAAQ8Z,MACxErU,KAAKiW,SAAS9V,QAAQqY,cAAc9B,KAAKd,SAASyC,GAAY3B,KAAOA,EACrE1W,KAAKiW,SAAS9V,QAAQqY,cAAc/G,aAIhC,CACJzR,KAAKP,UAAS,SAAAiZ,GAAU,MAAK,CAAEjD,YAAY,GAAD,mBAAOiD,EAAWjD,aAAlB,CAA+BnW,EAAO1E,YAGhF,IAAI+d,EAAO,yBACV/d,MAAO0E,EAAO1E,MACd0T,KAAMhP,EAAOiS,OAAOjS,EAAOC,iBAAiBF,MAAMvD,MAAMwS,MAAQ,GAChEsK,MAAM,GACHtZ,EAAO/E,QAAQse,aAAe,IAJvB,IAKVnC,KAAMA,IAIP1W,KAAKP,UAAS,SAAAiZ,GAAU,MAAK,CAC5BZ,eAAgBvd,EAAQud,eACxBpC,UAAW,CACVC,OAAQlM,OAAOgP,OAAOle,EAAQ8Z,MAC9BuB,SAAS,GAAD,mBAAO8C,EAAWhD,UAAUE,UAA5B,CAAsC+C,Y,yCAM/Blc,EAAGqc,GAErB,IAAI1P,EAAQ0P,EAAWnC,aACnBoC,EAAK/Y,KAAKiW,SAAS9V,QAAQqY,cAC3BQ,EAAOD,EAAGE,eAAe7P,GAE7B4P,EAAKE,OAAyB,OAAhBF,EAAKE,QAAmBH,EAAGrC,KAAKd,SAASxM,GAAO8P,OAAS,KACvEH,EAAGtH,SACHsH,EAAGI,c,mCAIH,IAAIlC,EAAMjX,KAAKiW,SAAS9V,QAAQqY,cAAcje,QAAQsc,QAAQG,KAAKC,IAAIvE,QACvE1S,KAAKiW,SAAS9V,QAAQqY,cAAcje,QAAQsc,QAAQG,KAAKC,IAAIvE,SAAmB,IAARuE,EACxEjX,KAAKP,SAAS,CAAEoW,UAAmB,IAARoB,M,oCAI3B,IAAID,EAAOhX,KAAKiW,SAAS9V,QAAQqY,cAAcje,QAAQsc,QAAQG,KAAKA,KAAKtE,QACzE1S,KAAKiW,SAAS9V,QAAQqY,cAAcje,QAAQsc,QAAQG,KAAKA,KAAKtE,SAAoB,IAATsE,EACzEhX,KAAKP,SAAS,CAAEqW,WAAqB,IAATkB,M,+BAGnB,IAAD,SACsBhX,KAAKlI,MAA3BQ,EADA,EACAA,QAASoL,EADT,EACSA,SACjB,OAEF,6BACC,yBAAK5K,UAAWR,EAAQiC,SAEvB,kBAAC,IAAD,CAAOzB,UAAWR,EAAQ8c,YACzB,kBAAC,IAAD,CAAS/a,MAAOL,IAAKC,EAAE,0BACtB,kBAAC,IAAD,CAAanB,UAAWR,EAAQmD,QAGjC,kBAAC,IAAD,CACC2d,SAAUpZ,KAAKgW,aACfld,UAAWR,EAAQ+gB,MACnBvd,MAAOkE,KAAKX,MAAMgW,uBAClB3a,SAAU,SAAA8N,GAAK,OAAI,EAAK/I,SAAS,CAAE4V,uBAAwB7M,EAAMtO,OAAO4B,WAGzE,kBAAC,IAAD,CACCA,MAAOkE,KAAKX,MAAMiW,sBAClB5a,SAAU,SAAA8N,GAAK,OAAI,EAAK/I,SAAS,CAAE6V,sBAAuB9M,EAAMtO,OAAO4B,SACvEwd,cAAY,EACZ9d,kBAAgB,EAChB1C,UAAWR,EAAQwC,QAGnB,kBAAC,IAAD,CAAUgB,MAAM,WAAW9B,IAAKC,EAAE,YAClC,kBAAC,IAAD,CAAU6B,MAAM,WAAW9B,IAAKC,EAAE,YAClC,kBAAC,IAAD,CAAU6B,MAAM,SAAS9B,IAAKC,EAAE,UAChC,kBAAC,IAAD,CAAU6B,MAAM,QAAQ9B,IAAKC,EAAE,SAC/B,kBAAC,IAAD,CAAU6B,MAAM,UAAU9B,IAAKC,EAAE,WACjC,kBAAC,IAAD,CAAU6B,MAAM,SAAS9B,IAAKC,EAAE,YAUlC,kBAAC,IAAD,CAAOnB,UAAWR,EAAQ8c,YACzB,kBAAC,IAAD,CAAS/a,MAAOL,IAAKC,EAAE,aACtB,kBAAC,IAAD,CAAgBnB,UAAWR,EAAQmD,QAGpC,kBAAC,IAAD,CAAyB4J,OAAQC,IAAQtL,IAAKuL,eAAgB+K,MAAOiJ,KACpE,kBAAC,IAAD,CACCzgB,UAAWR,EAAQ+gB,MACnBvd,MAAOkE,KAAKX,MAAMkW,iBAClB7a,SAAU,SAAA6a,GAAgB,OAAI,EAAK9V,SAAS,CAAE8V,iBAAkBA,EAAkBC,SAAS,KAE3F7c,KAAMqH,KAAKX,MAAM+V,WACjBoE,OAAQ,kBAAM,EAAK/Z,SAAS,CAAE2V,YAAY,KAC1Cpd,QAAS,kBAAM,EAAKyH,SAAS,CAAE2V,YAAY,KAE3Crc,QAAQ,SACR0gB,MAAM,EACNtU,OAAO,mBACPzJ,WAAY,CACXF,kBAAkB,MAMrB,kBAAC,IAAD,CAASnB,MAAOL,IAAKC,EAAE,oBACtB,kBAAC,IAAD,CAAYnD,MAAM,UAAUgC,UAAWR,EAAQohB,WAAYzgB,QAAS,kBAAM,EAAKwG,SAAS,CAAE2V,YAAY,MACrG,kBAAC,IAAD,QAGF,kBAAC,IAAD,CAAStc,UAAWR,EAAQqhB,gBAAiBC,YAAY,aACzD,kBAAC,IAAD,CAASvf,MAAOL,IAAKC,EAAE,6BACtB,kBAAC,IAAD,CAAYnB,UAAWR,EAAQohB,WAAYzgB,QAAS,kBAAM,EAAKwG,SAAS,CAAE8V,iBAAkB,IAAInQ,KAAQoQ,SAAS,MAChH,kBAAC,IAAD,SAKH,kBAAC,IAAD,CAASnb,MAAOL,IAAKC,EAAE,qBAA2D,OAApC+F,KAAKlI,MAAM4L,SAAS8T,cAA4D,IAApCxX,KAAKlI,MAAM4L,SAAS8T,aAAyBxX,KAAKX,MAAMmW,QAAU,KAAO,QAASqE,UAAU,MAAMhgB,MAAO,CAAER,QAAS,SAC7M,8BACC,kBAAC,IAAD,CAAQ2B,UAAU,EAAMlC,UAAWN,YAAKF,EAAQ8c,WAAgD,OAApCpV,KAAKlI,MAAM4L,SAAS8T,cAA4D,IAApCxX,KAAKlI,MAAM4L,SAAS8T,aAAyBxX,KAAKX,MAAMmW,QAAUld,EAAQkJ,OAASlJ,EAAQwhB,iBAClM,kBAAC,IAAD,UAMJ,kBAAC,IAAD,CAAShhB,UAAWR,EAAQ+I,UAE5B,yBAAKvI,UAAWR,EAAQmT,SACvB,yBAAK3S,UAAWR,EAAQ6C,cACtB6E,KAAKX,MAAM8V,OAAO5Q,OAAS,GAAK,kBAAC,IAAD,CAAOwV,SAAS,SAAS/Z,KAAKX,MAAM8V,OAAOrY,KAAI,SAACd,EAAO4H,GAAR,MAAc,CAAE5H,EAAO6D,IAAMma,cAAc,KAAM,CAAEpgB,IAAK,YAAcgK,UAGvJ,kBAAC,IAAD,CAAa9K,UAAWR,EAAQ2hB,eAAgBnjB,MAAM,WAarD,kBAAC,IAAD,CAAQojB,kBAAkB,EAAMnhB,QAAQ,YAAYE,QAAS,kBAAM,EAAKgd,SAAS9V,QAAQqY,cAAcW,cACtG,kBAAC,IAAD,CAAS9e,MAAOL,IAAKC,EAAE,eACtB,kBAAC,IAAD,UAMJ,yBAAKnB,UAAW,kBAAmBe,MAAO,CAAEnD,SAAU,WAAY2T,OAAQ3G,EAASyW,aAAe,UAChGna,KAAKX,MAAMmT,SAAW,yBAAK1Z,UAAWR,EAAQka,SAC9C,kBAAC,IAAD,OAGD,kBAAC,IAAD,CACC5Q,IAAK5B,KAAKiW,SACVS,KAAM1W,KAAKX,MAAMqW,UACjBnb,QAASyF,KAAKmW,qB,GA3dGtW,IAAMsC,WAqeXpD,uBAriBA,SAAAvI,GAAK,MAAK,CACxBgc,QAAS,CACR9b,SAAU,WACVe,gBAAiB,qBACjBkC,MAAO,OACP0Q,OAAQ,OACRhR,QAAS,OACT+gB,WAAY,SACZC,eAAgB,UAEjBlf,aAAc,CACbmf,aAAc,EACd/gB,YAAa,GACbI,MAAO,QAER8R,QAAS,CACRpS,QAAS,QAEV4gB,eAAgB,CACf5gB,QAAS,UACTqP,WAAY,UAEbnO,QAAS,CACRlB,QAAS,OACTghB,eAAgB,UAEjBjF,WAAY,CACXje,QAAS,UACTkC,QAAS,OACT+gB,WAAY,SACZxiB,OAAQ,GAETyhB,MAAO,CACN/f,WAAY9C,EAAMI,QAAQ,GAC1BsL,KAAM,GAEPpH,OAAQ,CACPnB,MAAO,KAER8B,KAAM,CACL7D,OAAQ,IAET8hB,WAAY,CACXviB,QAAS,IAEVkK,QAAS,CACRzJ,OAAQ,UAET+hB,gBAAiB,CAChBtP,OAAQ,GACRzS,OAAQ,GAET4J,OAAQ,CACP/J,gBAAiBjB,EAAMO,QAAQ8K,QAAQuE,KACvCtP,MAAO,kBACPc,OAAQ,OAETkiB,eAAgB,CACfriB,gBAAiB,OACjBG,OAAQ,UA0eKmH,CAAmBkV,GAE3B,IAAMF,EAAiB,CAE7B1Z,MAAOL,IAAKC,EAAE,kBACdwB,KAAM,iBAGMsI,EAAoB,gGACpBC,EAAoB,CAAC,cAErBC,EAAe,I,6VChlBb,SAASsW,EAASziB,GAAQ,IAChC4L,EAAa5L,EAAb4L,SAEF8W,EAAWC,mBAHsB,EAIP5e,mBAASsJ,YAAO,IAAIC,KAAQ1B,EAASyB,OAAQ,CAAEE,OAAQC,IAAQtL,IAAKuL,kBAJ7D,mBAIhCgV,EAJgC,KAItBG,EAJsB,OAKf7e,mBAAS,IALM,mBAKhC8e,EALgC,KAK1BC,EAL0B,OAMT/e,mBAAS,IANA,mBAMhCgf,EANgC,KAMvBC,EANuB,OAOXjf,mBAAS,IAPE,mBAOhCkf,EAPgC,KAOxBC,EAPwB,KA8BvC,OApBAtX,EAAS7J,MAAT,aAAmBqW,SAAU,SAAU5R,UAAW,UAAaoF,EAAS7J,OACxE6J,EAASyB,OAASzB,EAASyB,QAAU,sBACrCzB,EAASuX,QAAUvX,EAASyB,OAAOd,QAAQ,MAAQ,EAAI,IAAQX,EAASyB,OAAOd,QAAQ,MAAQ,EAAI,IAAU,KAE7GnI,qBAAU,WACTwb,aAAa8C,EAASra,SACtBqa,EAASra,QAAUwX,YAAW,kBAAM+C,EAAYvV,YAAO,IAAIC,KAAQ1B,EAASyB,OAAQ,CAAEE,OAAQC,IAAQtL,IAAKuL,oBAAoB7B,EAASuX,SAGpIC,IAASC,WAAW,YAAYC,UAAYF,IAASC,WAAW,YAAYE,YAC/EP,EAAWQ,qBAAWJ,IAASC,WAAW,YAAYC,SAAUF,IAASC,WAAW,YAAYE,YAChGL,EAAUO,oBAAUL,IAASC,WAAW,YAAYC,SAAUF,IAASC,WAAW,YAAYE,aAG3FH,IAASC,WAAW,YAAYR,MACnCC,EAAQM,IAASC,WAAW,YAAYR,QAGvC,CAACjX,IAIL,yBAAK7J,MAAO6J,EAAS7J,OACnBG,IAAKC,EAAE,aAAaoC,QAAQ,YAAake,IAExB,IAAjB7W,EAAS8X,KAAiB,yBAAK3hB,MAAO,CAAEjC,OAAQ,QAASsY,SAAU,WAEnE,0BAAMpX,UAAU,iCAFU,IAE8B6hB,GAAc,kBAAC,IAAD,CAAkB1f,KAAK,WAC7F,0BAAMpB,MAAO,CAAEjC,OAAQ,YAEvB,0BAAMkB,UAAU,8BALU,IAK2B+hB,EAAU1V,YAAO0V,EAAS,SAAW,kBAAC,IAAD,CAAkB5f,KAAK,WACjH,0BAAMpB,MAAO,CAAEjC,OAAQ,YAEvB,0BAAMkB,UAAU,gCARU,IAQ6BiiB,EAAS5V,YAAO4V,EAAQ,SAAW,kBAAC,IAAD,CAAkB9f,KAAK,aAS5G,IAAM8Y,EAAiB,CAC7BC,kBAAkB,EAClB3Z,MAAOL,IAAKC,EAAE,QACdwB,KAAM,iBAGMsI,EAAoB,6DACpBC,EAAoB,CAAC,iBAErBC,EAAe,CAC3B,CACC,UAAa,QACb,MAAS,CACR,GAAM,oBACN,GAAM,oBAEP,YAAe,CACd,GAAM,wCACN,GAAM,wCAEP,IAAO,+CAER,CACC,UAAa,SACb,MAAS,CACR,GAAM,mBACN,GAAM,+BAEP,YAAe,CACd,GAAM,yDACN,GAAM,0DAEP,KAAQ,0CACR,IAAO,uBAER,CACC,UAAa,MACb,MAAS,CACR,GAAM,iCACN,GAAM,iDAEP,KAAQ,SACR,KAAO,K,0YCpFH3N,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACtCsG,IAAK,CACJnD,MAAO,OACP0Q,OAAQ,QAEToR,YAAa,CACZ3kB,MAAO,OACPJ,SAAU,WACVglB,KAAM,EACNC,OAAQ,EACRhiB,MAAO,OACP0Q,OAAQ,OACRuR,OAAQ,IACRviB,QAAS,OACT+gB,WAAY,SAEZ,QAAS,CACRxiB,OAAQpB,EAAMI,QAAQ,GACtBilB,OAAQ,YAGVC,iBAAkB,GAElBC,cAAe,CACdtkB,gBAAiB,OACjBukB,UAAW,qCACXlI,aAAc,MACdna,MAAO,OACP0Q,OAAQ,QAET4R,QAAS,CACR/L,SAAU,OACVpZ,MAAON,EAAMO,QAAQ8K,QAAQuE,KAC7BxH,UAAW,2BACXvF,QAAS,QAET,UAAW,CACV4Q,QAAS,KACT5Q,QAAS,QACTlC,QAAS,WAGX+kB,WAAY,OAKE,SAASC,EAAIrkB,GAAQ,IAC3B4L,EAAsB5L,EAAtB4L,SAAUF,EAAY1L,EAAZ0L,QACZlL,EAAUhC,IAFkB,EAIlBuF,mBAAS6H,EAAS0Y,aAA3BpF,EAJ2B,sBAKdnb,mBAAS6H,EAAS2Y,gBAAmBzf,MAAMC,QAAQ6G,EAAS2Y,iBAAmB3Y,EAAS2Y,gBAAkB3Y,EAAS2Y,gBAAgB/X,MAAM,KAAQ,CAAE4W,IAASC,WAAW,YAAYC,SAAUF,IAASC,WAAW,YAAYE,YAA1O3kB,EAL2B,sBAMJmF,mBAAS,IANL,mBAM3Boc,EAN2B,KAMlBqE,EANkB,KAS5Bxf,EAAM2d,mBACN8B,EAAyBC,uBAAY,WAAY1f,EAAIqD,QAAUH,OAAO,IAGtEyc,EAAsBD,uBAAY,SAAAE,GAAK,OAAI5f,EAAIqD,QAAQuc,MAAMA,EAAMpY,MAAM,QAAO,IAGhFnF,EAAc,SAACC,EAAUC,EAAOC,GAEpB,aAAbF,GAEHkd,GAAW,SAAAK,GACV,OAAKA,EAAYrd,EAAOpG,KAAOyjB,EAAYrd,EAAOpG,IAAIxC,WAAa2I,EAAM/D,IAKlEqhB,GAJNrd,EAAO/E,QAAQ7D,SAAW2I,EAAM/D,IACzB,2BAAKqhB,GAAZ,kBAA0Brd,EAAOpG,GAAKoG,SAS1CpD,qBAAU,WAqBT,OApBAsH,EAAQN,SAAQ,SAAA5D,GAGfA,EAAOsd,mBAAmB,YAAYtF,OAAM,SAAAtM,GAC3CxF,IAAI+R,EAAE,gBAAiBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,OAEvDyW,GAAW,SAAAK,GACV,OAAKA,EAAYrd,EAAOpG,IAIjByjB,EAHC,2BAAKA,GAAZ,kBAA0Brd,EAAOpG,GAAK,aAQzCoG,EAAOgB,OAAOnB,MAIR,kBAAMqE,EAAQN,SAAQ,SAAA5D,GAAM,OAAIA,EAAOiB,SAASpB,SAErD,CAACqE,IAGJ,IAAIqZ,EAAa,GAAIpB,EAAc,GACnC,GAAIjY,EAAQe,OAAS,GAAKf,EAAQe,SAAWkF,OAAOC,KAAKuO,GAAS1T,OAAQ,CAAC,IAAD,WAEhE3K,GACR,IAAI0F,EAAS2Y,EAAQre,GACrB,GAAe,OAAX0F,EAAiB,CACpB,IAAI4Y,EAAS,kBAAC4E,EAAD,CAAQljB,IAAK,UAAY0F,EAAOpG,GAAIxC,SAAU4I,EAAO/E,QAAQ7D,UAAY,GAAI4I,OAAQA,EAAQoE,SAAUA,EAAS/C,YAC7Hkc,EAAWpZ,KAAKyU,GAEhB,IAAIne,EAAO,KACX,GAAIuF,EAAO3D,WAAWohB,OACrBhjB,EAAO,kBAAC,IAAD,CAAQH,IAAK,YAAc0F,EAAOpG,GAAI6Z,IAAKzT,EAAOzB,KAAMmV,IAAK1T,EAAO3D,WAAWohB,OAAQ9jB,QAAS,kBAAMwjB,EAAoBnd,EAAO/E,QAAQ7D,iBAE5I,CACJ,IAAI2I,EAAQC,EAAOK,iBACblE,EAAO6D,EAAOwB,QAAQ,KAAMzB,QAAuB9B,IAAd8B,EAAM/D,IAAoB+D,EAAM/D,IAAM,MAC3E2C,EAASqB,EAAOqC,SAAS,OAAQ,KAAMtC,QAAuB9B,IAAd8B,EAAM/D,IAAoB+D,EAAM/D,IAAM,MAE5F0K,QAAQD,IAAI1G,QAAuB9B,IAAd8B,EAAM/D,IAAoB+D,EAAM/D,IAAM,MAC3D0K,QAAQD,IAAI9H,GAEZlE,EAAO,kBAAC,IAAD,CAAQF,MAAOoE,EAAQrE,IAAK,YAAc0F,EAAOpG,GAAI6Z,IAAKzT,EAAOzB,KAAM5E,QAAS,kBAAMwjB,EAAoBnd,EAAO/E,QAAQ7D,YAAW,0BAAMoC,UAAWN,YAAK,WAAaiD,MAG/KggB,EAAYhY,KAAK,kBAAC,IAAD,CAAS7J,IAAK,WAAa0F,EAAOpG,GAAImB,MAAOiF,EAAOzB,KAAM7E,aAAYsG,EAAOzB,KAAMmf,OAAK,GAAEjjB,MArB7G,IAAK,IAAIH,KAAOqe,EAAU,EAAjBre,GA0BV,OAED,kBAAC,IAAMwH,SAAP,KACC,kBAAC,IAAD,CAAKtI,UAAWR,EAAQmjB,aACvB,kBAAC,IAAD,KAAazhB,IAAKC,EAAE,WAApB,KACCwhB,GAEF,kBAAC,IAAD,CAAYwB,UAAU,EAAMC,OAAQxmB,EAAUsgB,KAAMA,EAAMle,UAAWR,EAAQwE,IAAKqgB,UAAWZ,GAC5F,kBAAC,IAAD,CACCa,YAAY,0EACZC,IAAI,6CAGJR,KAQH,SAASC,EAAOhlB,GAAQ,IACfpB,EAA+BoB,EAA/BpB,SAAU4I,EAAqBxH,EAArBwH,OAAQoE,EAAa5L,EAAb4L,SACpBpL,EAAUhC,IAEZgnB,EAAa,KAAMC,EAAS,GAIhC,GAHA/X,IAAI+R,EAAE,gBAAiB,cAAgBjY,EAAOke,SAAW,IAAMle,EAAOzB,KAAO,kBAGzEyB,EAAO3D,YAAc2D,EAAO3D,WAAWohB,QAAqD,gBAA3Czd,EAAO3D,WAAWohB,OAAO/X,OAAO,EAAG,IACvFsY,EAAaG,IAAEC,QAAQ,CACtB5kB,UAAWR,EAAQwjB,iBACnB6B,KAAM,aAAere,EAAO3D,WAAWohB,OAAS,YAAczkB,EAAQyjB,cAAgB,OACtF6B,SAAU,CAAE,GAAI,UAKb,CACJL,EAAS,GACT,IAAIle,EAAQC,EAAOK,iBACblE,EAAO6D,EAAOwB,QAAQ,KAAMzB,QAAuB9B,IAAd8B,EAAM/D,IAAoB+D,EAAM/D,IAAM,MAC3E2C,EAASqB,EAAOqC,SAAS,OAAQ,KAAMtC,QAAuB9B,IAAd8B,EAAM/D,IAAoB+D,EAAM/D,IAAM,MAE5F0K,QAAQD,IAAI9H,GACZ,IAAM3H,EAAYC,YAAW,CAACqC,KAAMqF,GAAS,CAACJ,KAAK,UACnDmI,QAAQD,IAAIzP,EAAUsC,MAEtB0kB,EAAaG,IAAEC,QAAQ,CACtB5kB,UAAWR,EAAQwjB,iBACnB6B,KAAM,eAAiBnlB,YAAKF,EAAQyjB,eAAiB,kBAAoBvjB,YAAKF,EAAQ2jB,QAAS,WAAaxgB,GAAQ,kBACpHmiB,SAAU,CAAE,GAAI,MAKlB,IAAMC,EAA2BrB,uBAAY,WAAYxc,KAAK8d,eAAeC,gBAAgB,IAE7F,OAED,kBAAC,IAAD,CAAeC,aAAa,EAAMtnB,SAAUkG,MAAMC,QAAQnG,GAAYA,EAAWA,EAAS4N,MAAM,KAAM7I,KAAM6hB,EAAYW,YAAaJ,GACpI,kBAAC,IAAD,CAAgB/kB,UAAWR,EAAQ4jB,WAAY5T,UAAW5E,EAASwa,kBAAoB,SAAUC,UAAWza,EAAS0a,mBAAoB,EAAMb,OAAQ,CAAC,EAAEA,IACxJje,EAAOzB,QAQH,IAAMkG,EAAoB,sCACpBC,EAAoB,GAEpBC,EAAe,CAC3B,CACC,UAAa,cACb,MAAS,CACR,GAAM,mBACN,GAAM,4BAEP,KAAQ,SACR,IAAO,IAER,CACC,UAAa,kBACb,MAAS,CACR,GAAM,uBACN,GAAM,mCAEP,YAAe,CACd,GAAM,uEACN,GAAM,0EAEP,IAAO,IAER,CACC,UAAa,mBACb,MAAS,CACR,GAAM,8BACN,GAAM,yCAEP,YAAe,CACd,GAAM,wEACN,GAAM,+DAEP,IAAO,IAER,CACC,UAAa,mBACb,MAAS,CACR,GAAM,oBACN,GAAM,uBAEP,YAAe,CACd,GAAM,oFACN,GAAM,6GAEP,KAAQ,SACR,KAAO,K,iCChRT,6NAKe,SAASoa,EAAoBvmB,GAC3C,OAAO,kBAAC,UAAD,eAAW4I,YAAY,GAAU5I,IAIlC,IAAMiM,EAAoB,4CACpBC,EAAoB,CAAC,4BAErBC,EAAeqa,gB,oWCEtBhoB,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACtC+B,MAAO,CACNoB,MAAO,IACP0Q,OAAQ,IACRlT,QAAS,EACTmH,UAAW,cAKE,SAASigB,EAAQzmB,GAAQ,IAC/B4L,EAAa5L,EAAb4L,SACFpL,EAAUhC,IAFsB,EAIfuF,mBAAS,MAJM,mBAI/B6a,EAJ+B,KAI1B8H,EAJ0B,KAKtCtiB,qBAAU,WAET8U,IAAWC,cAAcwN,kBAAkB/a,EAAS2Z,KAAKqB,MACxD,SAAAC,GAE6B,MAAxBA,EAASC,YACZJ,EAAQtU,KAAKoI,MAAMqM,EAASE,UAG9B,SAAA7T,GAAG,OAAIxF,IAAI+R,EAAE,oBAAqBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,YAGjE,CAACnC,EAAS2Z,MAEb,IAAIyB,EAAkB,GAGtB,IAAKpI,EACJ,OAAO,KAGP,IAAK,IAAIqI,KAAOrI,EAAKqI,IAAK,CACzB,IAAIC,EAAWtI,EAAKqI,IAAIA,GACxBC,EAAS3kB,MAAgB,IAAR0kB,EAAY/kB,IAAKC,EAAE,SAAoB,IAAR8kB,EAAY/kB,IAAKC,EAAE,YAAc+kB,EAASnhB,KAE1F,IAAMohB,EAET,kBAAC,IAAD,CAAMrlB,IAAK,OAASmlB,EAAKhlB,MAAI,GAC5B,kBAAC,IAAD,CAAOjB,UAAWR,EAAQC,OACzB,kBAAC,IAAD,CAAYQ,QAAQ,SAClBimB,EAAS3kB,OAEX,kBAAC,IAAD,CAAYtB,QAAQ,WAClBimB,EAASE,QASVJ,EAAgBrb,KAAKwb,GAIvB,OAED,kBAAC,IAAD,CAAMnlB,WAAS,EAACqlB,QAAQ,gBAAgBvoB,QAAS,GAC/CkoB,IAOK,IAAM/K,EAAiB,CAC7BC,kBAAkB,EAClB3Z,MAAOL,IAAKC,EAAE,WACdwB,KAAM,yBAIMsI,EAAoB,gCACpBC,EAAoB,GAEpBC,EAAe,I,yMC7EtB3N,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACtCsF,MAAO,SAAAhE,GAAK,MAAK,CAChBsnB,MAAO,OACPC,WAAY,OACZ9lB,YAAa,SAEd+lB,sBAAuB,CACtBC,gBAAiB,0BAElBA,gBAAiB,CAChBA,gBAAiBzoB,IAAMN,EAAMO,QAAQ8K,QAAQuE,MAAMoZ,MAAM,IAAKC,MAAMrb,WAAc,cAEnFsb,uBAAwB,CACvBC,iBAAkB,0BAEnBA,iBAAkB,CACjBA,iBAAkB7oB,IAAMN,EAAMO,QAAQ8K,QAAQuE,MAAMoZ,MAAM,IAAKC,MAAMrb,WAAc,cAEpFwb,0BAA2B,CAC1BD,iBAAkB7oB,IAAMN,EAAMO,QAAQgL,UAAUqE,MAAMoZ,MAAM,IAAKC,MAAMrb,WAAc,kBAQnFuJ,EAAeC,OAAQ,WAAa5T,IAAKuL,eAAesI,QAC5D7T,IAAK8T,eAAe9T,IAAKuL,cAAeoI,GA8EzB,WACdI,YAAa,CACZ,GAAM,sBACN,GAAM,yBAEPC,eAAgB,CACf6R,MAAO,CACN/jB,MAAO,SAAAR,GAAG,OAAI2E,KAAK6f,MAAMxkB,IACzBG,KAAM,CACL,QAAW,sBACX,MAAO,sBACP,OAAQ,mBAGVskB,OAAQ,CACPjkB,MAAO,SAAAR,GAAG,OAAI2E,KAAK6f,MAAMxkB,IACzBgT,KAAM,KACN7S,KAAM,CACL,QAAW,sBACX,MAAO,sBACP,OAAQ,mBAGVukB,SAAU,CACT1kB,IAAK,SAACA,EAAK8D,EAAUE,GAAhB,OCrJO,SAAyB2gB,EAAc3kB,GAGrD,GAAqB,cAAjB2kB,EAEH,OAAO3kB,GACN,KAAK,EACL,KAAK,EACJA,GAAM,EACN,MAED,KAAK,EACJA,GAAM,EACN,MAED,QACCA,EAAM,UAMJ,GAAqB,WAAjB2kB,EAER,OAAO3kB,GACN,IAAK,OACL,IAAK,QACJA,GAAM,EACN,MAED,IAAK,OACJA,GAAM,EACN,MAED,QACCA,EAAM,KAKT,OAAOA,ED6G2B4kB,CAAgB5gB,EAAO/E,QAAQ0lB,aAAc3kB,IAC7EG,KAAM,CACLwS,KAAM,eACNC,MAAO,iBAER7U,QAAS,CACR4U,KAAMjU,IAAKC,EAAE,uBACbiU,MAAOlU,IAAKC,EAAE,2BAIjBmE,WAAY,CACX2hB,OAAQpR,UAASvQ,WAAWwQ,gBAE7B1W,QAAS,CACR2nB,MA9GF,SAA0B/nB,GAAQ,IACzBwH,EAA4BxH,EAA5BwH,OAAQD,EAAoBvH,EAApBuH,MAAOD,EAAatH,EAAbsH,SACjB9G,EAAUhC,IAFgB,EAsBNuF,mBAASwD,EAAMvD,OAtBT,mBAsBzB+jB,EAtByB,KAsBlBM,EAtBkB,KAuBhCjkB,qBAAU,kBAAMikB,EAAS9gB,EAAMvD,SAAQ,CAACuD,IAGxC,IAAMF,EAAc,SAACihB,EAAMC,EAAGC,GAEhB,aAATF,GACHG,EAAYF,EAAE/kB,MA7BgB,EAkCAO,oBAAS,GAlCT,mBAkCzBmkB,EAlCyB,KAkCfO,EAlCe,KAoDhC,OAjBArkB,qBAAU,WAaT,OAXIoD,EAAOiS,OAAOyO,UAAY1gB,EAAOiS,OAAOyO,SAAS3gB,QACpDC,EAAOiS,OAAOyO,SAAS3gB,MAAgD,kBAAjCC,EAAOiS,OAAOyO,SAAS3gB,MAAqB,CAAE,KAAQC,EAAOiS,OAAOyO,SAAS3gB,OAAUC,EAAOiS,OAAOyO,SAAS3gB,MAGpJC,EAAOsd,mBAAmB,YAAY,GAAMtF,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,mBAAoBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,UAGnHvG,EAAOgB,OAAOnB,IAIR,kBAAMG,EAAOiB,SAASpB,MAE3B,CAACG,EAAQD,IAIb,kBAAC,IAAM+B,SAAP,KAEC,yBAAKtI,UAAWR,EAAQwD,OACtB+jB,EAAQxgB,EAAMiP,MAGhB,kBAACjL,EAAA,EAAD,CAAapI,KAAK,SACjB,kBAACqI,EAAA,EAAD,CAAQxM,MAAM,UAAUgC,UAAWN,YAAkB,OAAbwnB,IAAuBA,EAAsC1nB,EAAQonB,uBAAnCpnB,EAAQqnB,mBAAqD1mB,QAzDzH,WACdknB,EAAS,KACTI,GAAY,GACZjhB,EAAO8D,eAAehE,EAAU,KAAKkY,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,mBAAoBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,YAsD4C,kBAAC,IAAD,OAC1I,OAAbma,GAAqB,kBAAC1c,EAAA,EAAD,CAAQxM,MAAM,YAAYgC,UAAWN,YAAMwnB,EAA+E1nB,EAAQsnB,0BAA5E,CAAEtnB,EAAQgnB,sBAAuBhnB,EAAQonB,yBAA+DzmB,QA9CtK,WACdsnB,GAAY,GACZjhB,EAAO8D,eAAe,YAAY,GAAMkU,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,mBAAoBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,WA4CsF7K,UAAWglB,GAAU,kBAAC,IAAD,OAC1N,kBAAC1c,EAAA,EAAD,CAAQxM,MAAM,UAAUgC,UAAWN,YAAkB,OAAbwnB,IAAuBA,EAAqC1nB,EAAQgnB,sBAAlChnB,EAAQinB,kBAAmDtmB,QArDrH,WAChBknB,EAAS,GACTI,GAAY,GACZjhB,EAAO8D,eAAehE,EAAU,GAAGkY,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,mBAAoBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,YAkD8C,kBAAC,IAAD,a,4FEhB3I,OACd2a,SAlGD,SAAkBC,GAAkB,IAc/BC,EAAGC,EAAGjW,EAAG9G,EAAGgd,EAAGC,EAAGC,EAAG7mB,EAdLomB,EAAc,uDAAV,EAAGU,EAAO,uDAAH,EAC/B,GAAInkB,MAAMC,QAAQ4jB,GACjBM,EAAIN,EAAE,GACNJ,EAAII,EAAE,GACNA,EAAIA,EAAE,QAEF,GAAiB,kBAANA,GAAkBA,EAAEpc,QAAQ,KAAM,CAAC,IAAD,EACrCoc,EAAEnc,MAAM,KAD6B,mBAChDmc,EADgD,KAC7CJ,EAD6C,KAC1CU,EAD0C,KAgBlD,OAZIN,EAAI,IACPA,GAAM,KAOPI,EAAIE,GAAK,EAAIV,GACbS,EAAIC,GAAK,GAFTH,EAAQ,EAAJH,GADJ7c,EAAI3D,KAAKC,MAAU,EAAJugB,KAGEJ,GACjBpmB,EAAI8mB,GAAK,GAAK,EAAIH,GAAKP,GAEfzc,EAAI,GACX,KAAK,EACJ8c,EAAIK,EACJJ,EAAI1mB,EACJyQ,EAAImW,EACJ,MAED,KAAK,EACJH,EAAII,EACJH,EAAII,EACJrW,EAAImW,EACJ,MAED,KAAK,EACJH,EAAIG,EACJF,EAAII,EACJrW,EAAIzQ,EACJ,MAED,KAAK,EACJymB,EAAIG,EACJF,EAAIG,EACJpW,EAAIqW,EACJ,MAED,KAAK,EACJL,EAAIzmB,EACJ0mB,EAAIE,EACJnW,EAAIqW,EACJ,MAED,KAAK,EACJL,EAAIK,EACJJ,EAAIE,EACJnW,EAAIoW,EAON,MAAO,CACN7gB,KAAK6f,MAAU,IAAJY,GACXzgB,KAAK6f,MAAU,IAAJa,GACX1gB,KAAK6f,MAAU,IAAJpV,KAiCZsW,SAxBD,SAAkBN,EAAGC,EAAGjW,GACvB,GAAI9N,MAAMC,QAAQ6jB,GACjBhW,EAAIgW,EAAE,GACNC,EAAID,EAAE,GACNA,EAAIA,EAAE,QAEF,GAAiB,kBAANA,GAAkBA,EAAErc,QAAQ,KAAM,CAAC,IAAD,EACrCqc,EAAEpc,MAAM,KAD6B,mBAChDoc,EADgD,KAC7CC,EAD6C,KAC1CjW,EAD0C,KAYlD,OARAgW,EAAI/b,SAAS+b,GAAGtc,SAAS,IACzBuc,EAAIhc,SAASgc,GAAGvc,SAAS,IACzBsG,EAAI/F,SAAS+F,GAAGtG,SAAS,IAER,IAAbsc,EAAEnc,SAAcmc,EAAI,IAAMA,GACb,IAAbC,EAAEpc,SAAcoc,EAAI,IAAMA,GACb,IAAbjW,EAAEnG,SAAcmG,EAAI,IAAMA,GAEvB,IAAMgW,EAAIC,EAAIjW,I,QCrFlBiD,EAAeC,OAAQ,WAAa5T,IAAKuL,eAAesI,QA2B5D,SAASoT,EAAiBnpB,GAAQ,IACzBsH,EAAuBtH,EAAvBsH,SAAU8hB,EAAappB,EAAbopB,SADc,EAGIrlB,mBAASqlB,GAHb,mBAGzBC,EAHyB,KAGbC,EAHa,KAIhCllB,qBAAU,kBAAMklB,EAAcF,KAAW,CAACA,IAE1C,IAAIG,EAAQ1L,EAAS,GACJ,QAAbvW,GAAsB+hB,EAEzBxL,EAAS,CAAE2L,KADXD,EAASF,EAAW7c,MAAM,MACH,GAAIid,MAAOF,EAAO,GAAIG,KAAMH,EAAO,IAGrC,QAAbjiB,GAAsB+hB,IAE9BxL,EAAS,CAAE8L,KADXJ,EAASF,EAAW7c,MAAM,MACH,GAAIod,WAAYL,EAAO,GAAIM,WAAYN,EAAO,KAGtE,IAAMO,EAAQjT,UAASvQ,WAAWwjB,MAC9BhnB,EAAQ,GACZ,IAAK,IAAIhB,KAAO+b,EACf/a,EAAM6I,KAAK,kBAACme,EAAD,CAAOhoB,IAAKA,EAAKgB,MAAOhB,EAAM,IAAM+b,EAAO/b,GAAMioB,IAAI,KAGjE,OAAOjnB,EA0CR,SAASknB,EAAoBhqB,GAAQ,IAC5BwH,EAAsCxH,EAAtCwH,OAAQF,EAA8BtH,EAA9BsH,SAAU8hB,EAAoBppB,EAApBopB,SAAU7mB,EAAUvC,EAAVuC,MAiBhC0nB,EAAeb,GAAY,UAGd,QAAb9hB,EACH2iB,EAAehK,EAAQiJ,SAASe,GAGX,QAAb3iB,IACR2iB,EAAehK,EAAQiJ,SAASjJ,EAAQyI,SAASuB,KA1Bf,MA6BClmB,mBAASkmB,GA7BV,mBA6B5BZ,EA7B4B,KA6BhBC,EA7BgB,KA8BnCllB,qBAAU,WAEQ,QAAbkD,EACHgiB,EAAcrJ,EAAQiJ,SAASE,IAGV,QAAb9hB,EACRgiB,EAAcrJ,EAAQiJ,SAASjJ,EAAQyI,SAASU,KAG3B,QAAb9hB,GACRgiB,EAAcF,KAEb,CAAC9hB,EAAU8hB,IAEd,IAAM/e,EAAYwM,UAASvQ,WAAW+D,UACtC,OAED,kBAACA,EAAD,CAAW9H,MAAOA,GAAS+E,GAC1B,kBAAC,eAAD,CACCtI,MAAOqqB,EACPxnB,MAAO,OACPqoB,iBAjDwB,SAAClrB,EAAO2F,GAChC3F,EAAQA,EAAMsI,GAGG,QAAbA,EACHtI,EAAQ,CAACA,EAAM4pB,EAAG5pB,EAAM6pB,EAAG7pB,EAAM4T,GAAG1N,KAAK,KAGpB,QAAboC,IACRtI,EAAQ,CAACA,EAAM2pB,EAAG3pB,EAAMupB,EAAGvpB,EAAMiqB,GAAG/jB,KAAK,MAG1CsC,EAAO8D,eAAehE,EAAUtI,GAAOwgB,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,mBAAoBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,eA1GhH7L,IAAK8T,eAAe9T,IAAKuL,cAAeoI,GAwJxC,IAAM7W,EAAQ,CACb2E,KAAM,CACL,QAAW,WAEZ6S,KAAM,SAGQ,WACdP,YAAa,CACZ,GAAM,SACN,GAAM,WAEPC,eAAgB,CACfiU,MAAO,CACNxmB,KAAM,CACL,KAAQ,eACR,MAAS,0BAGXokB,MAAO,CACN/jB,MAAO,SAAAR,GAAG,OAAIA,EAAM,GAAKA,GAAO,EAAU,IAANA,EAAYA,GAChDgT,KAAM,SAAAhT,GAAG,OAAIA,EAAM,EAAI,KAAO,MAC9B4mB,WAAY,CACX,EAAK,CACJ,MAAS,SAGXzmB,KAAM,CACL,QAAW,eACX,EAAK,yBAENpC,QAAS,CACR,EAAKW,IAAKC,EAAE,qBAGdkoB,iBAAkB,CACjB1mB,KAAM,CACL,QAAW,eAEZ6S,KAAM,UAEP8T,IAAKtrB,EACL2oB,IAAK3oB,EACLurB,IAAKvrB,EACLwrB,IAAKxrB,GAENsH,WAAY,CACXyhB,MAAOlR,UAASvQ,WAAWwQ,eAC3BuT,iBA/IF,SAAwCrqB,GACvC,IAAM4W,EAAQC,UAASvQ,WAAWwQ,eAClC,OACC,kBAACF,EAAD,eAAOzB,IAAK,IAAM4B,IAAK,KAAMwI,KAAM,IAAQvf,MA6I3C2nB,IAAKqC,EACLO,IAAKP,EACLQ,IAAKR,EACLM,IA5IF,SAA2BtqB,GAAQ,IAC1BwH,EAAsCxH,EAAtCwH,OAAQF,EAA8BtH,EAA9BsH,SAAU8hB,EAAoBppB,EAApBopB,SAAU7mB,EAAUvC,EAAVuC,MADH,EAQXwB,mBAASqlB,GARE,mBAQ1BkB,EAR0B,KAQrBG,EARqB,KASjCrmB,qBAAU,kBAAMqmB,EAAOrB,KAAW,CAACA,IAEnC,IAAM/e,EAAYwM,UAASvQ,WAAW+D,UAChCrL,EAAQihB,EAAQiJ,SAASjJ,EAAQyI,SAAS4B,IAChD,OAED,kBAACjgB,EAAD,CAAW9H,MAAOA,GAAS+E,GAC1B,kBAAC,YAAD,CACCtI,MAAOA,EACP6C,MAAO,OACPqoB,iBAhBwB,SAAClrB,EAAO2F,GAChC8lB,EAAOtiB,KAAK6f,MAAMhpB,EAAM0rB,IAAI/B,IAC5BnhB,EAAO8D,eAAehE,EAAUa,KAAK6f,MAAMhpB,EAAM0rB,IAAI/B,IAAInJ,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,mBAAoBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,gBAyIjI3N,QAAS,CACR+pB,MAAOtT,UAASzW,QAAQ4W,YACxB+Q,MAzMF,SAA0B/nB,GAAQ,IACzBwH,EAA+BxH,EAA/BwH,OAAQF,EAAuBtH,EAAvBsH,SAAU8hB,EAAappB,EAAbopB,SAEpBxmB,EAAW,SAAC+B,GACjBgmB,EAAWhmB,EAAEvC,OAAO4N,SACpBxI,EAAO8D,eAAehE,EAAU3C,EAAEvC,OAAO4N,QAAYxI,EAAOwC,UAAU,iBAAoB,IAAO,GAAGwV,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,mBAAoBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,WAL5I,EAQFhK,mBAASqlB,EAAW,GARlB,mBAQzBpZ,EARyB,KAQhB2a,EARgB,KAYhC,OAHAvmB,qBAAU,kBAAMumB,EAAWvB,EAAW,KAAI,CAACA,IAGvC5hB,EAAOojB,QAAUpjB,EAAOojB,OAAOnR,OAAO0Q,MAClC,kBAACtT,EAAA,QAASzW,QAAQyqB,OAAlB,iBAA6B7qB,EAA7B,CAAoCopB,SAAUpZ,EAASpN,SAAUA,KAGlE,kBAACiU,EAAA,QAASzW,QAAQ4W,YAAlB,iBAAkChX,EAAlC,CAAyCopB,SAAUpZ,EAASpN,SAAUA,MA0L5E+kB,IAAKwB,EACLoB,IAAKpB,EACLqB,IAAKrB,K,gbCvHD2B,E,kDAEL,WAAY9qB,GAAQ,IAAD,8BAClB,cAAMA,IAoBPqH,YAAc,SAACC,EAAUC,GAGP,aAAbD,GAA2BC,IAAqC,IAA5BA,EAAM/D,IAAI+I,QAAQ,OACzDhF,EAAM/D,IAAMyc,IAAQnT,0BAA0BvF,EAAM/D,MAIpC,cAAb8D,GAA4BC,GAA8B,kBAAdA,EAAM/D,MACrD+D,EAAM/D,IAAM+D,EAAM/D,IAAI+I,QAAQ,SAAW,GAG1C,EAAK5E,SAAL,eAAiBL,EAAWC,IAAS,WACpC,EAAKwjB,eA/BN,EAAKxjB,MAAQ,GAHK,E,gEASlB,IAAK,IAAID,KAAYY,KAAKlI,MAAMwH,OAAOiS,OACtCvR,KAAKlI,MAAMwH,OAAOsd,mBAAmBxd,GAAU,GAAMkY,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,2BAA4BvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,UAIrI7F,KAAKlI,MAAMwH,OAAOgB,OAAON,KAAKb,e,6CAI9Ba,KAAKlI,MAAMwH,OAAOiB,SAASP,KAAKb,e,iCAoBrB,IAAD,OACVuY,aAAa1X,KAAK8iB,iBAEd9iB,KAAKX,MAAM0jB,YAA0C,IAA7B/iB,KAAKX,MAAM0jB,UAAUznB,KAAgB0E,KAAKX,MAAMwjB,UAAY7iB,KAAKX,MAAMwjB,SAASvnB,KAAO0E,KAAKX,MAAM2jB,UAAYhjB,KAAKX,MAAM2jB,SAAS1nB,MAC7J0E,KAAK8iB,gBAAkBnL,YAAW,WACjC,EAAKlY,UAAS,SAAA0S,GAAS,MAAK,CAAE0Q,SAAS,2BAAM1Q,EAAU0Q,UAAjB,IAA2BvnB,IAAKyc,IAAQ7T,cAAciO,EAAU0Q,SAASvnB,KAAO,QAAO,kBAAM,EAAKunB,gBACtI,Q,mCAKJ7iB,KAAKlI,MAAM2I,WAAWT,KAAKlI,MAAMwH,U,qCAGnBF,EAAUtD,GACxBkE,KAAKlI,MAAMwH,OAAO8D,eAAehE,EAAUtD,GAAOwb,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,2BAA4BvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,Y,+BAGxH,IAAD,EACqC7F,KAAKlI,MAA1CQ,EADA,EACAA,QAAS2qB,EADT,EACSA,SAAU7Z,EADnB,EACmBA,MAAO9J,EAD1B,EAC0BA,OAC9B4jB,EAAa,GAAsBC,EAAiB,GAGpDnjB,KAAKX,MAAM+jB,YAA4C,KAA9BpjB,KAAKX,MAAM+jB,WAAW9nB,MAClD4nB,EAAWG,gBAAkB,SAAW/jB,EAAO/E,QAAQ+oB,sBAAwB,IAAMtjB,KAAKX,MAAM+jB,WAAW9nB,KAAO,KAI/G0E,KAAKX,MAAM2jB,UAAYhjB,KAAKX,MAAM2jB,SAAS1nB,MAC9C6nB,EAAexpB,OAAUqG,KAAKX,MAAMwjB,UAAY7iB,KAAKX,MAAMwjB,SAASvnB,KAAQ,GAAK,MAGlF,IAAMioB,EAAmBvjB,KAAKX,MAAM0jB,WAAa/iB,KAAKX,MAAM0jB,UAAUznB,IAAM,CAAC,kBAAC,IAAD,CAAWrC,QAAS+G,KAAKoD,eAAe3B,KAAKzB,KAAM,SAAS,KAAW,kBAAC,IAAD,OAAgB,CAAC,kBAAC,IAAD,CAAU/G,QAAS+G,KAAKoD,eAAe3B,KAAKzB,KAAM,QAAQ,MAK/N,OAEF,kBAAC,IAAMoB,SAAP,KAEEgI,EAAQ,GAAK,kBAACoa,EAAA,EAAD,CAAS1qB,UAAWR,EAAQ+I,UAC1C,yBAAKvI,UAAWN,YAAKF,EAAQwB,UAAWmpB,GAAY3qB,EAAQ2qB,WAE3D,yBAAKnqB,UAAWN,YAAKwH,KAAKX,MAAM+jB,YAA4C,KAA9BpjB,KAAKX,MAAM+jB,WAAW9nB,IAAahD,EAAQmrB,MAAQnrB,EAAQorB,SAAU7pB,MAAQqpB,EAAajqB,QAAS+G,KAAKS,WAAWgB,KAAKzB,OAErK,yBAAKlH,UAAWR,EAAQqrB,aACvB,uBAAG7qB,UAAWR,EAAQsrB,iBACpB5jB,KAAKX,MAAMwkB,aAAe7jB,KAAKX,MAAMwkB,YAAYvoB,KAAO,CAAC0E,KAAKX,MAAMwkB,YAAYvoB,IAAK,wBAAI1B,IAAK,MAAQ0F,EAAOpG,MAC7G8G,KAAKX,MAAMqjB,QAAU1iB,KAAKX,MAAMqjB,OAAOpnB,KAAO0E,KAAKX,MAAMqjB,OAAOpnB,IAAM,MAAO0E,KAAKX,MAAMhF,OAAS2F,KAAKX,MAAMhF,MAAMiB,KAEpH,uBAAGxC,UAAWR,EAAQwrB,kBACpB9jB,KAAKX,MAAMwjB,UAAY9K,IAAQnT,0BAA0B5E,KAAKX,MAAMwjB,SAASvnB,KAD/E,MACwF0E,KAAKX,MAAM2jB,UAAYhjB,KAAKX,MAAM2jB,SAAS1nB,OAKrI,yBAAKxC,UAAWR,EAAQiM,OAAQ1K,MArCG,IAsClC,yBAAKf,UAAWR,EAAQyrB,UAAWlqB,MAAQspB,KAG5C,yBAAKrqB,UAAWR,EAAQ0rB,UACvB,yBAAKlrB,UAAWN,YAAKF,EAAQ2rB,YAAa3rB,EAAQ4rB,mBAWlD,yBAAKprB,UAAWN,YAAKF,EAAQ2rB,YAAa3rB,EAAQ6rB,oBAEjD,kBAACC,EAAA,EAAD,CAAKtrB,UAAWR,EAAQ+rB,cAAeppB,KAAK,QAAQnE,MAAM,aACzD,kBAAC,IAAD,CAAkBmC,QAAS+G,KAAKoD,eAAe3B,KAAKzB,KAAM,YAAY,MAGtEujB,EAAiBzmB,KAAI,SAACrB,EAAMmI,GAAP,OACtB,kBAACwgB,EAAA,EAAD,CAAKxqB,IAAK,QAAUgK,EAAG9K,UAAWR,EAAQ+rB,cAAeppB,KAAK,QAAQnE,MAAM,WAC1E2E,MAIF,kBAAC2oB,EAAA,EAAD,CAAKtrB,UAAWR,EAAQ+rB,cAAeppB,KAAK,QAAQnE,MAAM,aACzD,kBAAC,IAAD,CAAcmC,QAAS+G,KAAKoD,eAAe3B,KAAKzB,KAAM,QAAQ,OAIhE,yBAAKlH,UAAWN,YAAKF,EAAQ2rB,YAAa3rB,EAAQgsB,4B,GAlI5BzkB,IAAMsC,WAoJhBpD,eAxOA,SAAAvI,GAAK,MAAK,CACxB6K,QAAS,CACRzJ,OAAQ,cAETkC,UAAW,CACVlC,OAAQpB,EAAMI,QAAQ,GAAI,IAE3BqsB,SAAU,CACTzkB,UAAWhI,EAAMI,SAAS,IAE3B6sB,MAAO,CACNpZ,OAAQ,QACRhR,QAAS,OACT+gB,WAAY,WACZmK,mBAAoB,SACpB1I,OAAQ,WAET6H,QAAS,CACRjsB,gBAAiBjB,EAAMO,QAAQ8K,QAAQuE,KACvC/M,QAAS,OACTwiB,OAAQ,WAET8H,YAAa,CACZlsB,gBAAiBjB,EAAMO,QAAQ8K,QAAQuE,KAAO,KAC9CtP,MAAO,OACPK,QAAS,OACTS,OAAQ,EACR+B,MAAO,OACP6qB,UAAW,QAEZZ,gBAAiB,CAChBjqB,MAAO,MACPylB,MAAO,OACPxnB,OAAQ,GAETksB,iBAAkB,CACjBnqB,MAAO,MACPylB,MAAO,QACPxnB,OAAQ,EACR0G,UAAW,SAEZiG,OAAQ,CACP9M,gBAAiBjB,EAAMO,QAAQ8K,QAAQuE,KACvCzM,MAAO,OACP0Q,OAAQ,OAET0Z,UAAW,CACVtsB,gBAAiBjB,EAAMO,QAAQgL,UAAUqE,KACzCiE,OAAQ,QAET2Z,SAAU,CACT3qB,QAAS,OACT+gB,WAAY,WAEb6J,YAAa,CACZ5qB,QAAS,OACTghB,eAAgB,SAChBD,WAAY,SACZqK,WAAY,QAEbP,gBAAiB,CAChBhiB,KAAM,EACNQ,cAAe,SACf0X,WAAY,YAEb+J,kBAAmB,CAClBjiB,KAAM,GAEPoiB,iBAAkB,CACjBpiB,KAAM,EACNmY,eAAgB,OAEjBgK,cAAe,CACdzsB,OAAQ,SAET8sB,mBAAoB,CACnB9sB,OAAQ,SACRsY,SAAU,SACV7F,OAAQ,OACR1Q,MAAO,WAyJMoF,CAAmB6jB,GCxPnB,SAASrf,EAAUzL,GAAQ,IACjC0L,EAAsB1L,EAAtB0L,QAASE,EAAa5L,EAAb4L,SACjB,OAAOF,EAAQ1G,KAAI,SAACwC,EAAQsE,GAAT,OAAe,kBAAC+gB,EAAD,eAAgB/qB,IAAK,kBAAoB0F,EAAOpG,IAAQpB,EAAxD,CAA+DsR,MAAOxF,EAAGqf,SAAgB,IAANrf,GAA6B,OAAlBF,EAASjI,MAAoC,OAAnBiI,EAASrJ,MAAgBiF,OAAQA,QAIrL,IAAMyE,EAAoB,iDACpBC,EAAoB,GAEpBC,EAAe,I,4GCLPiX,E,6GAmCnB,GAnBIA,EAASxX,SAASkhB,UACrB5qB,IAAK6qB,YAAY3J,EAASxX,SAASkhB,UACnC5qB,IAAK8qB,gBAAgB5J,EAASxX,SAASkhB,WAGvC5qB,IAAK8qB,kBAIF5J,EAASxX,SAASqhB,YACrBC,SAAS3qB,MAAQ6gB,EAASxX,SAASqhB,WAIhC7J,EAASxX,SAASuhB,aAA8D,UAA/C/J,EAASxX,SAASuhB,YAAYjgB,OAAO,EAAG,KAC5EggB,SAASE,eAAe,WAAW9qB,KAAO8gB,EAASxX,SAASuhB,aAIzD/J,EAASxX,SAASiK,aAAc,CAEnC,IAAIA,EAAeuN,EAASxX,SAASiK,aACrC,IAAK,IAAIiX,KAAYjX,EACpB3T,IAAK8T,eAAe8W,EAAUjX,EAAaiX,O,iCAW5BO,GACjB,OAAOjK,EAASxX,SAASyhB,IAAY,K,oCAUrC,OAAOjK,EAASxX,UAAY,K,iCAUXyhB,EAAS7pB,GAE1B,SAAI6pB,QAAmB5nB,IAARjC,KACd4f,EAASxX,SAASyhB,GAAW7pB,GACtB,K,kCAYUoI,GAClB,QAAIA,IACHwX,EAASxX,SAAT,2BAAyBwX,EAASxX,UAAaA,GAAY,IAC3D8B,IAAI+R,EAAE,WAAY,CAAE,eAAgB2D,EAASxX,YACtC,O,KA3FWwX,EAKbxX,SAAW,I,iCCdnB,qE,iCCAA,OAAe,WAEd,iBAAkB,eAClB,cAAe,gBACf,eAAgB,mBAGhB,sBAAuB,cACvB,uBAAwB,U,iCCRzB,OAAe,WAEd,iBAAkB,WAClB,cAAe,QACf,eAAgB,UAGhB,sBAAuB,SACvB,uBAAwB,S,iCCRzB,OAAe,WAEd,YAAa,UACb,YAAa,YACb,YAAa,SAGb,iBAAkB,QAClB,kBAAmB,gB,iCCRpB,OAAe,WAEd,YAAa,OACb,YAAa,OACb,YAAa,OAGb,iBAAkB,OAClB,kBAAmB,W,iCCRpB,OAAe,WACd,gBAAiB,QACjB,mBAAoB,mBACpB,yBAA0B,0BAC1B,sBAAuB,e,iCCJxB,OAAe,WACd,gBAAiB,QACjB,mBAAoB,WACpB,yBAA0B,kBAC1B,sBAAuB,gB,sICFX4B,EAAU,CAAE8f,G,OAAAA,GAYJprB,E,yGAkBD4qB,GAClB,QAAIA,IACH5qB,EAAK4qB,SAAWA,EAChBpf,IAAI+R,EAAE,OAAQ,mBAAqBqN,EAAW,IAAK,UAC5C,K,uCAYeS,GAEvB,QAAIA,KACHA,EAAYzoB,MAAMC,QAAQwoB,GAAaA,EAAY,CAACA,IAC1CniB,SAAQ,SAAA0hB,GAAQ,OAAI5qB,EAAK8qB,gBAAgBF,OAE5C,K,wCAY8C,IAAhCA,EAA+B,uDAApB5qB,EAAKuL,cAEtC,GAAIqf,EAAU,CACb,IAAIU,EACJ,IACCA,EAAc1X,OAAQ,KAAYgX,EAAW,OAAO/W,QACpD7T,EAAK8T,eAAe8W,EAAUU,GAE/B,MAAMta,GAEL,OADAxF,IAAI+R,EAAE,OAAQvM,EAAItF,QAAS,SAAS,EAAOsF,EAAInF,QACxC,EAGR,OAAO,EAGR,OAAO,I,qCAWc+e,EAAUU,GAC/B,SAAIV,IAAYU,KACftrB,EAAK2T,aAAaiX,GAAlB,2BAAmC5qB,EAAK2T,aAAaiX,IAAa,IAAOU,GACzE9f,IAAI+R,EAAE,OAAQ,iCAAmCqN,EAAW,IAAK,UAC1D,K,oCAY4B,IAAlBW,EAAiB,wDACnC,OAAOvrB,EAAK4qB,SAAS5f,OAAO,EAAGugB,EAAU,EAAI,K,0BAauC,IAA5EC,EAA2E,uDAApE,GAAIjrB,EAAgE,uDAAtD,GAAIkrB,EAAkD,uDAAnC,GAAIb,EAA+B,uDAApB5qB,EAAKuL,cAGpE,GAAoB,kBAATigB,QAAwCjoB,IAAnBioB,EAAKZ,GACpCY,EAAOA,EAAKZ,QAGR,GAAIY,EAER,GADAA,EAAOA,EAAKphB,WACRpK,EAAK2T,aAAaiX,GAAW,CAGhC,GAAIY,EAAKnhB,QAAQ,MAAQ,EAAG,CAG3B,IADA,IAAIqhB,EAAQF,EAAKlhB,MAAM,KAChBohB,EAAMnhB,OAAS,IAAMvK,EAAK2T,aAAaiX,GAAUc,EAAM1oB,KAAK,OAClE0oB,EAAMC,QAGPH,EAAOE,EAAM1oB,KAAK,KAGfhD,EAAK2T,aAAaiX,GAAUY,GAC/BA,EAAOxrB,EAAK2T,aAAaiX,GAAUY,GAE3BxrB,EAAK2T,aAAaiX,GAAUY,EAAKppB,eACzCopB,EAAOxrB,EAAK2T,aAAaiX,GAAUY,EAAKppB,eAGxCoJ,IAAI+R,EAAE,OAAQ,SAAWiO,EAAO,2BAA6BZ,EAAW,IAAK,SAAS,QAIvFpf,IAAI+R,EAAE,OAAQ,YAAcqN,EAAW,wBAA0BY,EAAO,IAAK,SAK/E,IAAK,IAAI5rB,KAAO6rB,EACfD,EAAOA,EAAKnpB,QAAQupB,OAAO,IAAMhsB,EAAM,IAAK,KAAM6rB,EAAa7rB,IAQhE,OAJIW,EAAQsrB,UACXL,EAAOA,EAAKM,OAAO,GAAGC,cAAgBP,EAAKxY,MAAM,IAG3CwY,M,KA5JYxrB,EAKb2T,aAAe,GALF3T,EAUb4qB,SAAYoB,UAAUpB,UAAYoB,UAAUC,cAAgB,S,iCCxBpE,OAAe,WAEd,yBAA0B,iBAC1B,YAAa,cACb,YAAa,sCACb,YAAa,cACb,cAAe,aACf,cAAe,QACf,YAAa,kCAGb,kBAAmB,kB,iCCXpB,OAAe,WAEd,yBAA0B,oBAC1B,YAAa,cACb,YAAa,wCACb,YAAa,cACb,cAAe,aACf,cAAe,QACf,YAAa,kCAGb,kBAAmB,Q,iCCXpB,OAAe,WAEd,oBAAqB,WACrB,oBAAqB,cACrB,iBAAkB,WAGlB,yBAA0B,WAC1B,0BAA2B,WAC3B,uBAAwB,qB,iCCTzB,OAAe,WAEd,oBAAqB,WACrB,oBAAqB,WACrB,iBAAkB,QAGlB,yBAA0B,UAC1B,0BAA2B,SAC3B,uBAAwB,mB,iCCTzB,OAAe,WACd,gBAAiB,WACjB,gBAAiB,a,iCCFlB,OAAe,WACd,gBAAiB,WACjB,gBAAiB,a,iCCFlB,OAAe,WAEd,cAAe,UAGf,mBAAoB,QACpB,oBAAqB,gB,iCCNtB,OAAe,WAEd,cAAe,SAGf,mBAAoB,OACpB,oBAAqB,W,0NCShB3vB,EAAYC,aAAW,SAACC,GAAD,MAAY,CACxC0vB,YAAa,CACZvsB,MAAO,QAERwsB,WAAY,CACXxsB,MAAO,QAERysB,OAAQ,CACP5nB,UAAW,QAEZ6nB,YAAa,CACZ7nB,UAAW,OAEZ8nB,aAAc,CACbhtB,WAAY,WAQC,SAASitB,EAAYzuB,GAAQ,IACnCoB,EAA6CpB,EAA7CoB,GAAI0B,EAAyC9C,EAAzC8C,MAAOU,EAAkCxD,EAAlCwD,IAAKL,EAA6BnD,EAA7BmD,KAAMD,EAAuBlD,EAAvBkD,SAAUN,EAAa5C,EAAb4C,SAClCpC,EAAUhC,EAAUwB,GAFgB,EAIZ+D,mBAASP,IAAO,GAJJ,mBAInCwM,EAJmC,KAI1B2a,EAJ0B,KAY1C,OACC,kBAAC,IAAU3qB,EACV,kBAAC,IAAD,CACC8B,IAAK,eAAiBV,EACtBZ,QAAS,CAAEM,KAAMN,EAAQ4tB,cAGzB,kBAAC,IAAD,CAAY5tB,QAAS,CAAEM,KAAMN,EAAQ6tB,YAAcprB,QAAQ,GAAOf,IAAKC,EAAEW,IACzE,kBAAC,IAAD,CACCtC,QAAS,CAAEM,KAAe,UAATqC,EAAmB3C,EAAQ+tB,YAAc/tB,EAAQ8tB,QAClEte,QAASA,EACT9M,SAAUA,EACVN,SAnBuB,SAAA8N,GAC1B,IAAIge,EAAahe,GAASA,EAAMtO,QAAUsO,EAAMtO,OAAO4N,UAAY,EAEnE2a,EAAW+D,GACX9rB,GAAYA,EAAS5C,EAAO0uB,IAgBzBvrB,KAAMA,MAYJ,SAASwrB,EAAkB3uB,GAAQ,IACjC8C,EAAyC9C,EAAzC8C,MAAOU,EAAkCxD,EAAlCwD,IAAKL,EAA6BnD,EAA7BmD,KAAMD,EAAuBlD,EAAvBkD,SAAUN,EAAa5C,EAAb4C,SAC9BpC,EAAUhC,EAAUwB,GAFc,EAIV+D,mBAASP,IAAO,GAJN,mBAIjCwM,EAJiC,KAIxB2a,EAJwB,KAYxC,OACC,kBAAC,IAAU3qB,EACV,kBAAC,IAAD,CACCQ,QAAS,CAAEM,KAAMN,EAAQguB,cACzB1rB,MAAOZ,IAAKC,EAAEW,GACd8rB,QAAS,kBAAC,IAAD,CACRpuB,QAAS,CAAEM,KAAe,UAATqC,EAAmB3C,EAAQ+tB,YAAc/tB,EAAQ8tB,QAClEte,QAASA,EACT9M,SAAUA,EACVN,SAhBuB,SAAA8N,GAC1B,IAAIge,EAAahe,GAASA,EAAMtO,QAAUsO,EAAMtO,OAAO4N,UAAY,EAEnE2a,EAAW+D,GACX9rB,GAAYA,EAAS5C,EAAO0uB,IAazBvrB,KAAMA,S,gFChGX,IAAI6B,EAAM,CACT,UAAW,IACX,UAAW,KAIZ,SAAS6pB,EAAeC,GACvB,IAAI1tB,EAAK2tB,EAAsBD,GAC/B,OAAOE,EAAoB5tB,GAE5B,SAAS2tB,EAAsBD,GAC9B,IAAIE,EAAoBC,EAAEjqB,EAAK8pB,GAAM,CACpC,IAAInqB,EAAI,IAAIuqB,MAAM,uBAAyBJ,EAAM,KAEjD,MADAnqB,EAAEwqB,KAAO,mBACHxqB,EAEP,OAAOK,EAAI8pB,GAEZD,EAAejd,KAAO,WACrB,OAAOD,OAAOC,KAAK5M,IAEpB6pB,EAAeO,QAAUL,EACzBphB,EAAO0hB,QAAUR,EACjBA,EAAeztB,GAAK,K,iCCvBpB,OAAe,WACd,QAAW,SAKX,sBAAuB,+BAKvB,cAAe,wBACf,oBAAqB,8BAKrB,GAAM,KACN,IAAO,MAEP,KAAQ,OACR,MAAS,QAET,KAAQ,SACR,OAAU,UAEV,KAAQ,QACR,OAAU,cAEV,UAAW,aACX,MAAS,mBACT,QAAW,mBAEX,WAAc,aACd,KAAQ,OACR,QAAW,WAEX,YAAa,gBAKb,QAAW,oBACX,YAAe,c,iCC3ChB,OAAe,c,wCCAf,IAAI4D,EAAM,CACT,aAAc,IACd,gBAAiB,IACjB,aAAc,IACd,gBAAiB,IACjB,aAAc,KAIf,SAAS6pB,EAAeC,GACvB,IAAI1tB,EAAK2tB,EAAsBD,GAC/B,OAAOE,EAAoB5tB,GAE5B,SAAS2tB,EAAsBD,GAC9B,IAAIE,EAAoBC,EAAEjqB,EAAK8pB,GAAM,CACpC,IAAInqB,EAAI,IAAIuqB,MAAM,uBAAyBJ,EAAM,KAEjD,MADAnqB,EAAEwqB,KAAO,mBACHxqB,EAEP,OAAOK,EAAI8pB,GAEZD,EAAejd,KAAO,WACrB,OAAOD,OAAOC,KAAK5M,IAEpB6pB,EAAeO,QAAUL,EACzBphB,EAAO0hB,QAAUR,EACjBA,EAAeztB,GAAK,K,iCC1BpB,qE,oBCAA,IAAI4D,EAAM,CACT,YAAa,IACb,eAAgB,IAChB,YAAa,IACb,eAAgB,IAChB,YAAa,KAId,SAAS6pB,EAAeC,GACvB,IAAI1tB,EAAK2tB,EAAsBD,GAC/B,OAAOE,EAAoB5tB,GAE5B,SAAS2tB,EAAsBD,GAC9B,IAAIE,EAAoBC,EAAEjqB,EAAK8pB,GAAM,CACpC,IAAInqB,EAAI,IAAIuqB,MAAM,uBAAyBJ,EAAM,KAEjD,MADAnqB,EAAEwqB,KAAO,mBACHxqB,EAEP,OAAOK,EAAI8pB,GAEZD,EAAejd,KAAO,WACrB,OAAOD,OAAOC,KAAK5M,IAEpB6pB,EAAeO,QAAUL,EACzBphB,EAAO0hB,QAAUR,EACjBA,EAAeztB,GAAK,K,iCC1BpB,qE,oBCAA,IAAI4D,EAAM,CACT,eAAgB,IAChB,kBAAmB,IACnB,eAAgB,IAChB,kBAAmB,IACnB,eAAgB,KAIjB,SAAS6pB,EAAeC,GACvB,IAAI1tB,EAAK2tB,EAAsBD,GAC/B,OAAOE,EAAoB5tB,GAE5B,SAAS2tB,EAAsBD,GAC9B,IAAIE,EAAoBC,EAAEjqB,EAAK8pB,GAAM,CACpC,IAAInqB,EAAI,IAAIuqB,MAAM,uBAAyBJ,EAAM,KAEjD,MADAnqB,EAAEwqB,KAAO,mBACHxqB,EAEP,OAAOK,EAAI8pB,GAEZD,EAAejd,KAAO,WACrB,OAAOD,OAAOC,KAAK5M,IAEpB6pB,EAAeO,QAAUL,EACzBphB,EAAO0hB,QAAUR,EACjBA,EAAeztB,GAAK,K,iCC1BpB,qE,2JC0BM5C,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACtCmK,UAAW,CACVxJ,QAASX,EAAMI,QAAQ,EAAG,EAAG,EAAG,IAEjCwwB,gBAAgB,eACd5wB,EAAM+L,YAAYC,KAAK,MAAQ,CAC/BnJ,QAAS,OACT,iBAAkB,CAAEA,QAAS,SAC7B,kBAAmB,CAAEA,QAAS,SAC9B,kBAAmB,CAAEA,QAAS,eAU3BspB,EAAS5jB,aA9BA,SAAAvI,GAAK,MAAK,CACxByK,cAAe,SAAAnJ,GAAK,sBAChBA,EAAMmG,SAEVkD,gBAAiB,SAAArJ,GAAK,oBACrBhB,MAAO,OACPoZ,SAAU,QACPpY,EAAMmG,YAuBIc,EAAmB,SAAAjH,GAAU,IACnCQ,EAAqCR,EAArCQ,QAASgH,EAA4BxH,EAA5BwH,OAAQD,EAAoBvH,EAApBuH,MAAOD,EAAatH,EAAbsH,SAChC,OAED,0BAAMtG,UAAWN,YAAM4G,IAAaE,EAAOC,iBAAmBjH,EAAQ2I,eAAmB7B,IAAaE,EAAOE,mBAAqBlH,EAAQ6I,kBACxI9B,GAASA,EAAMvD,MADjB,IACyBuD,GAASA,EAAMiP,UAMxC,SAASQ,EAAYhX,GAAQ,IACpBwH,EAAyDxH,EAAzDwH,OAAQF,EAAiDtH,EAAjDsH,SAAU8hB,EAAuCppB,EAAvCopB,SAAoBmG,EAAmBvvB,EAA7B4C,SADT,EAQGmB,mBAASqlB,GARZ,mBAQpBpZ,EARoB,KAQX2a,EARW,KAW3B,OAFAvmB,qBAAU,kBAAMumB,EAAWvB,KAAW,CAACA,IAIxC,kBAAC,IAAD,CACCpZ,QAASA,EACTpN,SAAU2sB,GAZO,SAAC5qB,GACjBgmB,EAAWhmB,EAAEvC,OAAO4N,SACpBxI,EAAO8D,eAAehE,EAAU3C,EAAEvC,OAAO4N,SAASwP,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,sBAAuBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,WAW7H/J,OAAmB,IAAZgM,EACPhR,MAAM,YAMP,SAASwwB,EAAcxvB,GAAQ,IACtBwH,EAA+BxH,EAA/BwH,OAAQF,EAAuBtH,EAAvBsH,SAAU8hB,EAAappB,EAAbopB,SAO1B,IAAiB,IAAbA,GAAqBA,EAAW,EACnC,OAAO,kBAACyB,EAAD,iBAAY7qB,EAAZ,CAAmB4C,SAAU,QAIrC,OAED,kBAAC,IAAD,CACC3B,QAAQ,WACRjC,MAAM,UACNmE,KAAK,QACLssB,UAAW,0BAAMzuB,UAAW,kBAC5BG,QAjBgB,WACfqG,EAAO8D,eAAehE,GAAU,GAAMkY,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,sBAAuBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,YAmBhH7L,IAAKC,EAAE,YAWT,SAAS2nB,EAAM9pB,GAAQ,IACd8C,EAAc9C,EAAd8C,MACF4sB,EADgB1vB,EAAP+pB,KACS,EAExB,OAED,kBAAC,IAAMzgB,SAAP,KACExG,EACA4sB,GAAa,8BAMf,SAASrlB,EAAUrK,GAAQ,IAClBuC,EAAoBvC,EAApBuC,MAAOpC,EAAaH,EAAbG,SACTK,EAAUhC,IAEhB,OAED,kBAAC,IAAM8K,SAAP,KACC,kBAACwgB,EAAD,CAAOhnB,MAAOP,IACd,yBAAKvB,UAAWR,EAAQqI,WACtB1I,IAOH,SAAS2W,EAAe9W,GAAQ,IACzBwH,EAAiExH,EAAjEwH,OAAQF,EAAyDtH,EAAzDsH,SAAU8hB,EAA+CppB,EAA/CopB,SAAU7mB,EAAqCvC,EAArCuC,MAAO4S,EAA8BnV,EAA9BmV,IAAK4B,EAAyB/W,EAAzB+W,IAAKwI,EAAoBvf,EAApBuf,KAAMoQ,EAAc3vB,EAAd2vB,UACnDnvB,EAAUhC,IAFc,EAUJuF,mBAASqlB,GAVL,mBAUvBrB,EAVuB,KAUhBM,EAVgB,KAW9BjkB,qBAAU,kBAAMikB,EAASe,KAAW,CAACA,IAKrC7J,EAAOA,GAAQ,EAEf,IAAIqQ,IAHJ7Y,EAAMA,GAAO,MADb5B,EAAMA,GAAO,MAGbwa,EAAYA,GAAa,IACY,IAAO,GAC5C,OAED,kBAACtlB,EAAD,CAAW9H,MAAOA,GAAS+E,GAC1B,kBAAC,IAAD,CACC9G,QAAS,CAAEqvB,UAAWrvB,EAAQ8uB,iBAC9B1sB,SApBgB,SAAC+B,EAAGnB,GAAJ,OAAY6kB,EAAS7kB,IAqBrCssB,kBApByB,SAACnrB,EAAGnB,GAC7B6kB,EAAS7kB,GACTgE,EAAO8D,eAAehE,EAAU9D,GAAKgc,OAAM,SAAAtM,GAAG,OAAIxF,IAAI+R,EAAE,sBAAuBvM,EAAItF,QAAS,SAAS,EAAMsF,EAAInF,WAmB/G/J,MAAO+jB,EACPgI,kBAAkB,OAClBC,MAAO,YAAIlrB,MAAM6qB,GAAW/d,QAAQ5M,KAAI,SAAAirB,GAAM,MAAK,CAAE,MAAS9a,EAAI8a,EAAOL,EAAU,MAASza,EAAI8a,EAAOL,MACvGza,IAAKA,EACL4B,IAAKA,EACLwI,KAAMA,MAUO,WACdtJ,YAAa,CACZ,GAAM,qCACN,GAAM,8CAEPC,eAAgB,CACfga,KAAM,CACLlsB,MAAO,SAACR,GAAD,OAASA,EAAI8I,YAMpB8d,WAAY,CACXjU,KAAM,CACL,MAAS,OACT,WAAc,QAEfC,MAAO,CACN,MAAS,UAIZgB,QAAS,CACRZ,KAAM,KACN7S,KAAM,kBAEPwsB,KAAM,CACLxsB,KAAM,CACL,KAAQ,YACR,MAAS,eAEVpC,QAAS,CACR,KAAQ,OACR,MAAS,WAGXmV,SAAU,CACTF,KAAM,KACN7S,KAAM,iBAEPokB,MAAO,CACNvR,KAAM,MAEP5X,SAAU,CACT+E,KAAM,cAEPwmB,MAAO,CACN5oB,QAAS,CACR,KAAQ,KACR,MAAS,OAEVoC,KAAM,SAEP2S,YAAa,CACZE,KAAM,SACN7S,KAAM,eAEPysB,QAAS,CACR7uB,QAAS,CACR,KAAQ,KACR,MAAS,OAEVoC,KAAM,SAEP0sB,KAAM,CACL7Z,KAAM,QACN7S,KAAM,kBAGR2C,WAAY,CACXwjB,QACAzf,YACAyM,iBAEAiR,MAAOjR,GAER1W,QAAS,CACRyqB,SACA7T,cACAwY,gBAEArF,MAAOnT,EACPoZ,QAASZ,K,6FC3QLc,EAAQxa,EAAQ,IAARA,GAOOya,E,iGAiCTC,GAEV,IAAK,IAAIC,KAAYD,EACpBD,EAAQC,WAAWC,GAAnB,2BAAoCD,EAAWC,IAA/C,IAA0DrvB,GAAIqvB,IAG/D,OAAOF,I,iCASU7kB,GAGjB,OADA6kB,EAAQA,QAAU7kB,EACX6kB,I,gCASSG,GAMhB,IAAK,IAAIC,KAHTJ,EAAQK,OAASF,EAGGA,EACnBH,EAAQM,WAAWF,EAASD,EAAOC,GAAS5qB,MAG7C,OAAOwqB,I,iCAUUnvB,EAAI2E,GAOrB,OALI3E,IAAwC,IAAlCmvB,EAAQO,SAASvkB,QAAQnL,KAClCmvB,EAAQQ,UAAUplB,KAAK,CAAEvK,KAAI2E,SAC7BwqB,EAAQO,SAASnlB,KAAKvK,IAGhBmvB,I,mCASyB,IAAf9tB,EAAc,uDAAJ,GAEJ,mBAAZA,IACVA,EAAU,CAAEuuB,IAAKvuB,IAGlB,IAAMiJ,EAAUjJ,EAAQuuB,IAAMT,EAAQC,WAAaD,EAAQA,QAC3D,OAAO9tB,EAAQwuB,KAAOX,EAAM5kB,GAAWA,I,kCAWvC,OAAO6kB,EAAQK,S,qCAWf,OAAOL,EAAQQ,c,KA7HIR,EAKbC,WAAa,GALAD,EAUbA,QAAU,GAVGA,EAebK,OAAS,GAfIL,EAoBbQ,UAAY,GApBCR,EAyBbO,SAAW,I,oBChCnB,IAAI9rB,EAAM,CACT,aAAc,IACd,gBAAiB,IACjB,aAAc,IACd,gBAAiB,IACjB,aAAc,KAIf,SAAS6pB,EAAeC,GACvB,IAAI1tB,EAAK2tB,EAAsBD,GAC/B,OAAOE,EAAoB5tB,GAE5B,SAAS2tB,EAAsBD,GAC9B,IAAIE,EAAoBC,EAAEjqB,EAAK8pB,GAAM,CACpC,IAAInqB,EAAI,IAAIuqB,MAAM,uBAAyBJ,EAAM,KAEjD,MADAnqB,EAAEwqB,KAAO,mBACHxqB,EAEP,OAAOK,EAAI8pB,GAEZD,EAAejd,KAAO,WACrB,OAAOD,OAAOC,KAAK5M,IAEpB6pB,EAAeO,QAAUL,EACzBphB,EAAO0hB,QAAUR,EACjBA,EAAeztB,GAAK,K,iCC1BpB,qE,oBCAA,IAAI4D,EAAM,CACT,gBAAiB,IACjB,mBAAoB,IACpB,gBAAiB,IACjB,mBAAoB,IACpB,gBAAiB,KAIlB,SAAS6pB,EAAeC,GACvB,IAAI1tB,EAAK2tB,EAAsBD,GAC/B,OAAOE,EAAoB5tB,GAE5B,SAAS2tB,EAAsBD,GAC9B,IAAIE,EAAoBC,EAAEjqB,EAAK8pB,GAAM,CACpC,IAAInqB,EAAI,IAAIuqB,MAAM,uBAAyBJ,EAAM,KAEjD,MADAnqB,EAAEwqB,KAAO,mBACHxqB,EAEP,OAAOK,EAAI8pB,GAEZD,EAAejd,KAAO,WACrB,OAAOD,OAAOC,KAAK5M,IAEpB6pB,EAAeO,QAAUL,EACzBphB,EAAO0hB,QAAUR,EACjBA,EAAeztB,GAAK,K,iCC1BpB,qE,oBCAA,IAAI4D,EAAM,CACT,YAAa,IACb,eAAgB,IAChB,YAAa,IACb,eAAgB,IAChB,YAAa,KAId,SAAS6pB,EAAeC,GACvB,IAAI1tB,EAAK2tB,EAAsBD,GAC/B,OAAOE,EAAoB5tB,GAE5B,SAAS2tB,EAAsBD,GAC9B,IAAIE,EAAoBC,EAAEjqB,EAAK8pB,GAAM,CACpC,IAAInqB,EAAI,IAAIuqB,MAAM,uBAAyBJ,EAAM,KAEjD,MADAnqB,EAAEwqB,KAAO,mBACHxqB,EAEP,OAAOK,EAAI8pB,GAEZD,EAAejd,KAAO,WACrB,OAAOD,OAAOC,KAAK5M,IAEpB6pB,EAAeO,QAAUL,EACzBphB,EAAO0hB,QAAUR,EACjBA,EAAeztB,GAAK,K,iCC1BpB,qE,oBCAA,IAAI4D,EAAM,CACT,cAAe,IACf,iBAAkB,IAClB,cAAe,IACf,iBAAkB,IAClB,cAAe,KAIhB,SAAS6pB,EAAeC,GACvB,IAAI1tB,EAAK2tB,EAAsBD,GAC/B,OAAOE,EAAoB5tB,GAE5B,SAAS2tB,EAAsBD,GAC9B,IAAIE,EAAoBC,EAAEjqB,EAAK8pB,GAAM,CACpC,IAAInqB,EAAI,IAAIuqB,MAAM,uBAAyBJ,EAAM,KAEjD,MADAnqB,EAAEwqB,KAAO,mBACHxqB,EAEP,OAAOK,EAAI8pB,GAEZD,EAAejd,KAAO,WACrB,OAAOD,OAAOC,KAAK5M,IAEpB6pB,EAAeO,QAAUL,EACzBphB,EAAO0hB,QAAUR,EACjBA,EAAeztB,GAAK,K,iCC1BpB,sHAaM5C,EAAYC,aAAW,SAACC,GAAD,MAAY,CACxCwyB,YAAa,CACZrvB,MAAO,YAQM,SAAS2J,EAAOxL,GAAQ,IAC9BoB,EAA4DpB,EAA5DoB,GAAI0B,EAAwD9C,EAAxD8C,MAAO9D,EAAiDgB,EAAjDhB,MAAOiC,EAA0CjB,EAA1CiB,QAASiC,EAAiClD,EAAjCkD,SAAUusB,EAAuBzvB,EAAvByvB,UAAWtuB,EAAYnB,EAAZmB,QAClDX,EAAUhC,EAAUwB,GAE1B,OACC,kBAAC,IAAUA,EACV,kBAAC,IAAD,CACC8B,IAAKV,EACLZ,QAAS,CAAEM,KAAMN,EAAQ0wB,aACzBjwB,QAASA,GAAW,YACpBjC,MAAOA,GAAS,UAChBkE,SAAUA,EACVusB,UAAWA,GAAa,kBAAC,IAAD,MACxBtuB,QAASA,GAGRe,IAAKC,EAAEW,O,oGCjCG,SAASquB,EAAYnxB,GACnC,OAAO2C,kBAAU,2BAAK3C,GAAN,IAAa+C,KAAM,c,iCCPpC,4FAWe,SAASquB,EAAYpxB,GAAQ,IACnCoB,EAAuBpB,EAAvBoB,GAAIiwB,EAAmBrxB,EAAnBqxB,UAAW7tB,EAAQxD,EAARwD,IAEnBQ,EAAQ,GACNstB,EAAcD,EAAUrsB,KAAI,SAAAY,GACjC,IAAM9D,EAAM6P,OAAOC,KAAKhM,GAAQioB,QAMhC,OAJI/rB,IAAQ0B,IACXQ,EAAQR,GAGF,kBAAC,IAAD,CAAU1B,IAAK,YAAcV,EAAK,IAAMU,EAAKkC,MAAOlC,GAAMI,IAAKC,EAAEyD,EAAO9D,QAGhF,OACC,kBAAC,UAAD,iBACK9B,EADL,CAECwD,IAAKQ,EACLhB,QAAQ,IAGPsuB,K,gCC/BJ,kCAAO,IAAMC,EAAW,CACvB,OAAU,YACV,cAAiB,oBACjB,aAAgB,mBAChB,mBAAsB,2B,qJCoBjBniB,EAAY,CACjB,CAAEhO,GAAI,OAAQgP,gBAAgB,EAAOrN,KAAM,OAAQD,MAAOZ,IAAKC,EAAE,QAASwO,QAAQ,GAClF,CAAEvP,GAAI,SAAUgP,gBAAgB,EAAOtN,MAAOZ,IAAKC,EAAE,UAAWwO,QAAQ,GACxE,CAAEvP,GAAI,cAAegP,gBAAgB,EAAOtN,MAAOZ,IAAKC,EAAE,eAAgBwO,QAAQ,GAClF,CAAEvP,GAAI,UAAWgP,gBAAgB,EAAOtN,MAAOZ,IAAKC,EAAE,YACtD,CAAEf,GAAI,QAASgP,gBAAgB,EAAOrN,KAAM,SAAUD,MAAOZ,IAAKC,EAAE,iBAG/DgP,EAAY,CACjB,YAAe,CACd,MAAS,CACRnS,MAAO,qBACPW,gBAAiB,sBAElB,KAAQ,CACPX,MAAO,kBACPW,gBAAiB,sBAElB,KAAQ,CACPX,MAAO,kBACPW,gBAAiB,sBAElB,MAAS,CACRX,MAAO,kBACPW,gBAAiB,sBAElB,QAAW,CACVX,MAAO,kBACPW,gBAAiB,wBAMd6xB,E,uKAEK,IAAD,OACAhxB,EAAY0H,KAAKlI,MAAjBQ,QAEFixB,EAAO/jB,IAAIgkB,SACjB,OAEF,kBAAC,IAAD,CACClxB,QAAS,CAAElB,aAAckB,EAAQmxB,UACjChxB,WAAW,EACXC,SAAU,KAEVC,KAA2B,SAApBqH,KAAKlI,MAAMsU,KAClBpU,QAAS,kBAAM,EAAKF,MAAM4xB,SAAS,SAEnC3xB,OAAO,OACPG,QACC,kBAAC,IAAD,CAAQkD,WAAS,EAACnC,QAAS,kBAAM,EAAKnB,MAAM4xB,SAAS,SAAS5yB,MAAM,WAClEkD,IAAKC,EAAE,WAKV,kBAAC,IAAD,CAAOnB,UAAWR,EAAQC,OACzB,kBAAC,IAAD,CACC2O,UAAWA,EACX3K,KAAMgtB,EACNtgB,UAAWA,EAEX7B,YAAY,EACZC,UAAU,EACVoE,SAAS,EACToB,cAAY,U,GAjCQhN,IAAMsC,WA4CdpD,uBAvFA,SAAAvI,GAAK,MAAK,CACxBizB,SAAU,CACT/yB,SAAU,WACVG,IAAK,EACL6kB,KAAM,MAmFO3c,CAAmBuqB,I,qJCvGnB,EACW,8B,iFCULK,E,kDAEpB,WAAYC,GAAe,IAAD,EAKzB,GALyB,qBACzB,gBAEKpM,SAAWoM,GAEX,EAAKpM,SACT,MAAM,IAAIwJ,MAAM,sBANQ,OASzB,EAAK6C,WAAa,EAAKrM,SAASphB,cAGhC,EAAKuS,SAAWmb,IAAS,SAAa9b,eACtC,EAAKA,eAAkB8b,IAAU,EAAKD,aAAeC,IAAU,EAAKD,YAAY7b,gBAAmB,GAGnG,EAAK5P,WAAL,2BAAuB0rB,IAAS,SAAa1rB,YAAgB0rB,IAAU,EAAKD,aAAeC,IAAU,EAAKD,YAAYzrB,YAAe,IACrI,EAAKlG,QAAL,2BAAoB4xB,IAAS,SAAa5xB,SAAa4xB,IAAU,EAAKD,aAAeC,IAAU,EAAKD,YAAY3xB,SAAY,IAjBnG,E,2DA0BX0B,EAAK0B,GACnB,OAAO0E,KAAK+pB,YAAYnwB,GAAOA,EAAI0B,GAAOA,I,4CASrBoI,GAA0B,IAAhBiL,EAAe,uDAAJ,GAE1C,IAAK,IAAI/U,KAAO8J,EACf,QAAsBnG,IAAlBmG,EAAS9J,GACZ,OAAO8J,EAAS9J,GAIlB,OAAO+U,I,kCASI/U,GACX,OAAOA,GAAsB,oBAARA,I,+BASb0B,GACR,YAAeiC,IAARjC,I,0CASY0uB,GAAgC,IAA3BC,EAA0B,4DAAX1sB,EASvC,OAPKysB,GAAqB,iBAAPA,EAGI,iBAAPA,GAAoBA,EAAInc,UACvCmc,EAAInc,QAAUoc,GAHdD,EAAM,CAAE,QAAWA,GAAOC,GAMpBD,M,GApF6BE,KCXvB,GACd,SAAU,YACV,OAAU,SACV,OAAU,U,SCuBUC,E,kDAEpB,WAAYC,EAAkBrZ,GAAS,IAAD,sBACrC,IACC,cAAMqZ,EAAiB5M,UAExB,MAAMxS,GACL,MAAM,IAAIgc,MAAM,gCAAkCoD,EAAiBvsB,KAAO,KAgB3E,GAZA,EAAK3E,GAAKkxB,EAAiBlxB,GAC3B,EAAK2E,KAAOusB,EAAiBvsB,KAE7B,EAAKwsB,KAAOD,EAAiBC,MAAQ,KAErC,EAAK9Y,OAAS6Y,EAAiB7Y,OAC/B,EAAKhX,QAAU6vB,EAAiB7vB,QAChC,EAAKoB,WAAayuB,EAAiBzuB,YAAc,GAEjD,EAAKoV,OAASA,GAGT,EAAKxW,SAAmC,kBAAjB,EAAKA,SAA6D,IAArCkP,OAAOC,KAAK,EAAKnP,SAASgK,aAAuChH,IAAvB,EAAKhD,QAAQ+vB,MAC/G,MAAM,IAAItD,MAAM,UAAYoD,EAAiBlxB,IAAMkxB,EAAiBvsB,KAAO,KAAOusB,EAAiBvsB,MAAQusB,EAAiBlxB,IAAM,IAAM,4BAEpI,IAAK,EAAKqY,QAAiC,kBAAhB,EAAKA,QAA2D,IAApC9H,OAAOC,KAAK,EAAK6H,QAAQhN,OACpF,MAAM,IAAIyiB,MAAM,mCAAqCoD,EAAiBlxB,IAAMkxB,EAAiBvsB,KAAO,gBAAkBusB,EAAiBvsB,MAAQusB,EAAiBlxB,IAAM,IAAM,yBAExK,KAAK,EAAKA,IAAO,EAAK2E,MAAS,EAAK2f,UACxC,MAAM,IAAIwJ,MAAM,mCAAqCoD,EAAiBlxB,IAAMkxB,EAAiBvsB,KAAO,gBAAkBusB,EAAiBvsB,MAAQusB,EAAiBlxB,IAAM,IAAM,uCAExK,IAAK,EAAK6X,OACd,MAAM,IAAIiW,MAAM,oBA/BoB,OAmCrC,EAAK/uB,SAAWmyB,EAAiBnyB,UAAY,GAC7C,EAAKyqB,OAAS0H,EAAiB1H,QAAU,KAGzC,EAAK6H,iBACL,EAAKC,mBAAqB,GAG1B,EAAKC,GAAG,SAAS,SAAAzf,GAAG,OAAIxF,IAAI+R,EAAE,SAAU,CAAE,wBAAyBvM,EAAItF,SAAW,SAAS,EAAOsF,EAAInF,UA3CjE,E,+DAoDkB,IAAvCzG,EAAsC,uDAA3B,KAAMsrB,EAAqB,uDAAT,QAG7C,GAAItrB,GAAgC,kBAAbA,EACtB,OAAOA,EAIR,IAAIihB,EAAIrgB,KAAKuR,OAAOnS,GAAYY,KAAKT,iBAGrC,YAAUhC,IAAN8iB,EACIrmB,IAAKC,EAAE,2CAA2CoC,QAAQ,YAAa2D,KAAKnC,MAAQ,KAItE,kBAANwiB,GACfrgB,KAAKuR,OAAOnS,GAAYY,KAAKT,iBAA7B,eAAmDmrB,EAAY,CAAE,KAAQrK,IACzEA,EAAIrgB,KAAKuR,OAAOnS,GAAYY,KAAKT,kBAED,kBAAjB8gB,EAAEqK,KACjB1qB,KAAKuR,OAAOnS,GAAYY,KAAKT,iBAAiBmrB,GAAa,CAAE,KAAQrK,EAAEqK,IACvErK,EAAIrgB,KAAKuR,OAAOnS,GAAYY,KAAKT,kBAI7B8gB,GAAMA,EAAEqK,GAGmB,iBAAhBrK,EAAEqK,IAA2BrK,EAAEqK,GAAWC,KAInDtK,EAHCrmB,IAAKC,EAAE,gDAAgDoC,QAAQ,YAAa2D,KAAKnC,MAAMxB,QAAQ,eAAgBquB,GAAa,IAH5H1wB,IAAKC,EAAE,0DAA0DoC,QAAQ,YAAa2D,KAAKnC,MAAMxB,QAAQ,eAAgBquB,GAAa,O,+CActHE,EAAQxrB,EAAUyrB,EAAW3J,GAAW,IAAD,OAG/D,GAAIlhB,KAAK4qB,GAAQxrB,IAAaY,KAAK4qB,GAAQxrB,GAAUyrB,GAAY,CAGhE,GAAiD,kBAAtC7qB,KAAK4qB,GAAQxrB,GAAUyrB,GAAyB,CAE1D,IAAMC,EAAerhB,OAAOC,KAAK1J,KAAK4qB,GAAQxrB,GAAUyrB,IACxD,GAAIC,EAAa1mB,WAAWC,QAAQ,MAAQ,GAAKymB,EAAa1mB,WAAWC,QAAQ,MAAQ,GAAKymB,EAAa1mB,WAAWC,QAAQ,OAAS,EAAG,CAEzI,IAAI/I,EAAM0E,KAAK4qB,GAAQxrB,GAAUyrB,GAAvB,QAqBV,OApBAC,EAAa5nB,SAAQ,SAAA6nB,GAEpB,IAAIC,EAAgBD,EAAY1uB,QAAQ,KAAM,IAAIA,QAAQ,IAAK,IAAIA,QAAQ,KAAM,IAAIA,QAAQ,IAAK,IAAIA,QAAQ,KAAM,IAChH0uB,EAAY1mB,QAAQ,OAAS,GAAK6c,GAAY8J,EACjD1vB,EAAM,EAAKsvB,GAAQxrB,GAAUyrB,GAAWE,GAEhCA,EAAY1mB,QAAQ,MAAQ,GAAK6c,EAAW8J,EACpD1vB,EAAM,EAAKsvB,GAAQxrB,GAAUyrB,GAAWE,GAEhCA,EAAY1mB,QAAQ,OAAS,GAAK6c,GAAY8J,EACtD1vB,EAAM,EAAKsvB,GAAQxrB,GAAUyrB,GAAWE,GAEhCA,EAAY1mB,QAAQ,MAAQ,GAAK6c,EAAW8J,EACpD1vB,EAAM,EAAKsvB,GAAQxrB,GAAUyrB,GAAWE,GAEhCD,EAAa1mB,WAAWC,QAAQ,OAAS,GAAK6c,GAAY8J,IAClE1vB,EAAM,EAAKsvB,GAAQxrB,GAAUyrB,GAAWE,OAInCzvB,EAGP,OAAO,gEAAe0E,KAAK4qB,GAAQxrB,GAAUyrB,GAAW3J,IAAalhB,KAAK4qB,GAAQxrB,GAAUyrB,GAAW3J,GAAYlhB,KAAK4qB,GAAQxrB,GAAUyrB,GAAvB,QAKhH,sEAAsB7qB,KAAK4qB,GAAQxrB,GAAUyrB,IACjD,OAAO7qB,KAAK4qB,GAAQxrB,GAAUyrB,GAAW3J,EAAU9hB,EAAUY,MAIzD,GAAiD,kBAAtCA,KAAK4qB,GAAQxrB,GAAUyrB,GACtC,OAAO7qB,KAAK4qB,GAAQxrB,GAAUyrB,QAG3B,GAAI7qB,KAAK4qB,GAAL,MAAwB5qB,KAAK4qB,GAAL,KAAqBC,GAAY,CAGjE,GAA+C,kBAApC7qB,KAAK4qB,GAAL,KAAqBC,GAC/B,OAAO,gEAAe7qB,KAAK4qB,GAAL,KAAqBC,GAAW3J,IAAalhB,KAAK4qB,GAAL,KAAqBC,GAAW3J,GAAYlhB,KAAK4qB,GAAL,KAAqBC,GAArB,QAI3G,sEAAsB7qB,KAAK4qB,GAAL,KAAqBC,IAC/C,OAAO7qB,KAAK4qB,GAAL,KAAqBC,GAAW3J,EAAU9hB,EAAUY,S,sCAa9CZ,EAAUyrB,EAAW3J,GAEpC,IAAI3mB,EAAUyF,KAAKuR,OACnB,GAAIhX,EAAQ6E,IAAa7E,EAAQ6E,GAAUyrB,GAC1C,MAA4C,kBAAjCtwB,EAAQ6E,GAAUyrB,GACrB,gEAAetwB,EAAQ6E,GAAUyrB,GAAW3J,IAAa3mB,EAAQ6E,GAAUyrB,GAAW3J,GAAY3mB,EAAQ6E,GAAUyrB,GAAlB,QAErG,mEAAsBtwB,EAAQ6E,GAAUyrB,IACrCtwB,EAAQ6E,GAAUyrB,GAAW3J,EAAU9hB,EAAUY,MAGjDzF,EAAQ6E,GAAUyrB,K,uCAeV,IAAD,OAEZtZ,EAAS9H,OAAOC,KAAK1J,KAAKuR,QAG1BvR,KAAKzF,QAAQ0wB,gBAChBjrB,KAAKzF,QAAQ0wB,cAAgBruB,MAAMC,QAAQmD,KAAKzF,QAAQ0wB,eAAiBjrB,KAAKzF,QAAQ0wB,cAAgB,CAACjrB,KAAKzF,QAAQ0wB,eAEpHjrB,KAAKzF,QAAQ0wB,cAAc/nB,SAAQ,SAAAgoB,GAC9B,EAAK3Z,OAAO2Z,WACR,EAAK3Z,OAAO2Z,OAMtBlrB,KAAKzF,QAAQ4wB,aAAenrB,KAAKzF,QAAQ4wB,aAAgBvuB,MAAMC,QAAQmD,KAAKzF,QAAQ4wB,cAAgBnrB,KAAKzF,QAAQ4wB,aAAe,CAACnrB,KAAKzF,QAAQ4wB,cAAiB,GAG/JnrB,KAAKT,gBAAkBS,KAAKzF,QAAQsH,SAAW0P,EAAO,GACtDvR,KAAKR,kBAAoBQ,KAAKzF,QAAQwH,WAAa,KAGnD/B,KAAKuR,OAAOvR,KAAKT,iBAAmBS,KAAKorB,iBAAiBprB,KAAKT,iBAC/DS,KAAKzF,QAAQ0lB,aAAgBjgB,KAAKT,iBAAmB8rB,EAASrrB,KAAKuR,OAAOvR,KAAKT,iBAAiBF,MAAMsrB,KAAK3lB,OAAO,EAAGhF,KAAKuR,OAAOvR,KAAKT,iBAAiBF,MAAMsrB,KAAKtmB,QAAQ,QAAW,GAGrLrE,KAAKzF,QAAQ+vB,MAAQ1tB,MAAMC,QAAQmD,KAAKzF,QAAQ+vB,OAAStqB,KAAKzF,QAAQ+vB,MAAQ,CAACtqB,KAAKzF,QAAQ+vB,OAC5FtqB,KAAKzF,QAAQgR,KAAOvL,KAAKzF,QAAQgR,MAAQ,IAEzCvL,KAAKzF,QAAQK,MAASoF,KAAKzF,QAAQK,OAAwC,kBAAvBoF,KAAKzF,QAAQK,OAAsBoF,KAAKzF,QAAQK,MAAMyB,QAAQ,UAAW2D,KAAKnC,OAAWmC,KAAKzF,QAAQK,OAASoF,KAAKnC,O,yCAUtJuB,EAAUC,GAAQ,IAAD,OAGnCA,EAAM4C,YAAcqpB,YAAoB,IAAIlmB,KAAK/F,EAAMksB,GAAG,KAAS,CAAElmB,OAAQC,IAAQtL,IAAKuL,eAAgBimB,gBAAgB,EAAMC,WAAW,IAG3IpsB,EAAMiP,KAAO,GAGb,IAAIhT,EAAM0E,KAAK0rB,yBAAyB,iBAAkBtsB,EAAU,MAAOC,EAAM/D,KAwBjF,OAvBA+D,EAAM/D,SAAciC,IAARjC,EAAoBA,EAAM+D,EAAM/D,IAG5C+D,EAAMvD,MAAQuD,EAAM/D,IAGpB,CAAC,CAAE,MAAS,SAAW,CAAE,QAAW,SAAW,CAAE,KAAQ,SAAU4H,SAAQ,SAAAyoB,GAC1E,IAAId,EAAYphB,OAAOC,KAAKiiB,GAAMvnB,WAC9B1G,EAAS+L,OAAOgP,OAAOkT,GAAMvnB,WAC7BV,EAAW,GAGfA,EAAQ,QAAc,EAAKkoB,gBAAgBxsB,EAAUyrB,EAAWxrB,EAAM/D,KAGtE,CAAC,iBAAkB,YAAY4H,SAAQ,SAAA0nB,GACtClnB,EAASknB,GAAU,EAAKc,yBAAyBd,EAAQxrB,EAAUyrB,EAAWxrB,EAAM/D,QAGrF+D,EAAM3B,GAAN,uEAA4CgG,EAAUrE,EAAM3B,OAG7D2B,EAAMvD,MAAQ9B,IAAKC,EAAEoF,EAAMvD,OACpBuD,I,0BAOJkJ,GACH,OAAOvI,KAAKuI,IAAa,O,kCASwB,IAAxCnJ,EAAuC,uDAA5B,KAAMysB,EAAsB,wDAChDzsB,EAAWA,GAAYY,KAAKT,gBAE5B,IAAMF,EAAQW,KAAKuR,OAAOnS,GAAUC,MAAMvD,MACpColB,EAAW7hB,EAAQA,EAAM/D,IAAM,KAE/BqnB,GAAWkJ,GAAgB7rB,KAAK9H,QAAQkH,IAAcY,KAAK9H,QAAQyqB,OACzE,OAAO,kBAACA,EAAD,CAAQ/oB,IAAK,UAAYoG,KAAK9G,GAAK,IAAMkG,EAAUE,OAAQU,KAAMX,MAAOA,EAAOD,SAAUA,EAAU8hB,SAAUA,EAAUjjB,OAAQ+B,KAAK2B,SAAS,QAASvC,EAAU8hB,O,mCAS3J9hB,GACZA,EAAWA,GAAYY,KAAKT,gBAE5B,IAAMF,EAAQW,KAAKuR,OAAOnS,GAAUC,MAAMvD,MACpColB,EAAW7hB,EAAQA,EAAM/D,IAAM,KAE/B6G,EAAYnC,KAAK5B,WAAWgB,GAClC,OAAQ+C,GAAa,kBAACA,EAAD,CAAW9H,MAAO2F,KAAKuR,OAAOnS,GAAUxE,OAASZ,IAAKC,EAAE+F,KAAKwd,SAAW,IAAMpe,GAAWE,OAAQU,KAAMZ,SAAUA,EAAU8hB,SAAUA,KAAiBlhB,KAAKuR,OAAOnS,GAAUxE,OAASZ,IAAKC,EAAE+F,KAAKwd,SAAW,IAAMpe,K,uCAUjL,IAAxCA,EAAuC,uDAA5B,KAAM0sB,EAAsB,uDAAN,KACzCzL,EAAIrgB,KAAKuR,OAAOnS,GAAYY,KAAKT,iBAEnCwsB,EAAc,KASlB,OAPI1L,GAAKA,EAAEhhB,OAA2B,OAAlBysB,QAA4CvuB,IAAlB8iB,EAAEhhB,MAAMvD,YAAwDyB,IAAjC8iB,EAAEhhB,MAAMvD,MAAMgwB,GAC1FC,EAAc1L,EAAEhhB,MAAMvD,MAAMgwB,GAEpBzL,GAAKA,EAAEhhB,OAA2B,OAAlBysB,QAA4CvuB,IAAlB8iB,EAAEhhB,MAAMvD,QAC1DiwB,EAAc1L,EAAEhhB,MAAMvD,OAGhBiwB,I,8BAWA3sB,GAAmD,IAAD,OAAxC8hB,EAAwC,uDAA7B,GAAI8K,EAAyB,4DAAXzuB,EAE1CmG,EAAW,GAWf,OAVAtE,EAAWA,GAAYY,KAAKT,gBAG5BmE,EAAQ,QAAc1D,KAAK4rB,gBAAgBxsB,EAAU,OAAQ8hB,GAG7D,CAAC,iBAAkB,YAAYhe,SAAQ,SAAA0nB,GACtClnB,EAASknB,GAAU,EAAKc,yBAAyBd,EAAQxrB,EAAU,OAAQ8hB,MAGrE,6EAA4Bxd,EAAUsoB,K,gCAOpCtuB,GAA+B,IAAvBwjB,EAAsB,uDAAX,UAC5B,OAAQlhB,KAAKzF,QAAQmD,KAAYsC,KAAKzF,QAAQmD,GAAQwjB,IAAalhB,KAAKzF,QAAQmD,GAAb,UAAqCsC,KAAKzF,QAAQmD,IAAW,O,+BAOxHmtB,GAAmD,IAAD,OAAvCzrB,EAAuC,uDAA5B,KAAM8hB,EAAsB,uDAAX,UAE3Cxd,EAAW,GAWf,OAVAtE,EAAWA,GAAYY,KAAKT,gBAG5BmE,EAAQ,QAAc1D,KAAK4rB,gBAAgBxsB,EAAUyrB,EAAY,QAAS3J,GAG1E,CAAC,iBAAkB,YAAYhe,SAAQ,SAAA0nB,GACtClnB,EAASknB,GAAU,EAAKc,yBAAyBd,EAAQxrB,EAAUyrB,EAAY,QAAS3J,MAGlF,6EAA4Bxd,EAAU,M,6BAOvCuoB,EAAWlX,GAEQ,oBAAdkX,IACVlX,EAAWkX,EACXA,EAAY,eAIGjsB,KAAKksB,UAAUD,GAAW3T,WAAU,SAAA6T,GAAQ,OAAIA,EAAS/nB,YAAc2Q,EAAS3Q,eAAe,GAI9GpE,KAAKyqB,GAAGwB,EAAWlX,K,4CAWmB,IAApBqX,EAAmB,wDAElCC,EAAY,GAChB,IAAK,IAAIjtB,KAAYY,KAAKuR,OACzB8a,EAAU5oB,KAAKzD,KAAK4c,mBAAmBxd,EAAUgtB,IAGlD,OAAOC,I,2CAWgD,IAAD,OAApCjtB,EAAoC,uDAAzB,KAAMgtB,EAAmB,wDAEtDhtB,EAAWA,GAAYY,KAAKT,gBAC5B,IAAI8gB,EAAIrgB,KAAKorB,iBAAiBhsB,GAC9B,MAAgB,iBAALihB,EACHiM,QAAQC,OAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAASihB,IAGnE,IAAIiM,SAAQ,SAACpF,EAASqF,QAGNhvB,IAAlB8iB,EAAEhhB,MAAMvD,OAAuB,EAAK0uB,mBAAmBnmB,QAAQjF,IAAa,GAG/E,EAAKotB,KAAK,cAAeptB,EAAUihB,EAAEhhB,MAAMvD,MAAO,GAGlDorB,EAAQ,CAAE,SAAW,EAAM,SAAY9nB,EAAU,QAAU,KAK3D,EAAK2R,OAAO0b,SAASpM,EAAEhhB,MAAMsrB,MAC3BjM,MAAK,SAAArf,GAGS,OAAVA,GACHktB,EAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAAS,SAAWihB,EAAEhhB,MAAMsrB,KAAO,gBAIrFtK,EAAEhhB,MAAMvD,MAAQ,EAAK4wB,mBAAmBttB,EAAUC,GAGlD,EAAKmtB,KAAK,cAAeptB,EAAUihB,EAAEhhB,MAAMvD,MAAO,GAG9CswB,GACH,EAAKO,qBAAqBvtB,GAAUkY,OAAM,SAAAtM,GAAG,OAAIuhB,EAAOvhB,MAIzDkc,EAAQ,CAAE,SAAW,EAAM,SAAY9nB,EAAU,QAAU,OAE3DkY,OAAM,SAAAtM,GAAG,OAAIuhB,EAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAAS4L,Y,kDAeC,IAAD,OAAlD5L,EAAkD,uDAAvC,KAAMgtB,EAAiC,wDAAd7xB,EAAc,uDAAJ,GAEvE6E,EAAWA,GAAYY,KAAKT,gBAC5B,IAAI8gB,EAAIrgB,KAAKorB,iBAAiBhsB,GAC9B,MAAgB,iBAALihB,EACHiM,QAAQC,OAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAASihB,IAGnE,IAAIiM,SAAQ,SAACpF,EAASqF,GAC5BlM,EAAEhhB,MAAMutB,aAAevM,EAAEhhB,MAAMutB,cAAgB,GAG3CryB,EAAQga,OAASha,EAAQia,KAAOja,EAAQ8c,WAAyF9Z,IAAjF8iB,EAAEhhB,MAAMutB,aAAaryB,EAAQga,MAAQ,IAAMha,EAAQia,IAAM,IAAMja,EAAQ8c,OAG1H,EAAKmV,KAAK,gBAAiBptB,EAAUihB,EAAEhhB,MAAMutB,aAAaryB,EAAQga,MAAQ,IAAMha,EAAQia,IAAM,IAAMja,EAAQ8c,MAAOgJ,EAAEhhB,MAAO,GAG5H6nB,EAAQ,CAAE,SAAW,EAAM,SAAY9nB,EAAU,QAAU,KAK3D,EAAK2R,OAAO8b,gBAAgBxM,EAAEhhB,MAAMsrB,KAAMpwB,GACxCmkB,MAAK,SAAAvK,GAGW,OAAZA,GACHoY,EAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAAS,SAAWihB,EAAEhhB,MAAMsrB,KAAO,gBAIjFpwB,EAAQga,OAASha,EAAQia,KAAOja,EAAQ8c,OAC3CgJ,EAAEhhB,MAAMutB,aAAaryB,EAAQga,MAAQ,IAAMha,EAAQia,IAAM,IAAMja,EAAQ8c,MAAQlD,GAIhFkM,EAAEhhB,MAAM8U,QAAUA,EAGlB,EAAKqY,KAAK,gBAAiBptB,EAAUihB,EAAEhhB,MAAM8U,QAASkM,EAAEhhB,MAAO,GAG3D+sB,GACH,EAAKO,qBAAqBvtB,GAAUkY,OAAM,SAAAtM,GAAG,OAAIuhB,EAAOvhB,MAIzDkc,EAAQ,CAAE,SAAW,EAAM,SAAY9nB,EAAU,QAAU,OAE3DkY,OAAM,SAAAtM,GAAG,OAAIuhB,EAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAAS4L,Y,gCASlEpK,GACTZ,KAAKzF,QAAQqG,OAASA,I,mCAOVD,GACZX,KAAKzF,QAAQK,MAAQ+F,I,uCAUkB,IAAD,OAAxBvB,EAAwB,uDAAb,KAAMtD,EAAO,uCAEtCsD,EAAWA,GAAYY,KAAKT,gBAC5B,IAAI8gB,EAAIrgB,KAAKorB,iBAAiBhsB,EAAU,UACxC,MAAgB,iBAALihB,EACHiM,QAAQC,OAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAASihB,IAGnE,IAAIiM,SAAQ,SAACpF,EAASqF,GAC5B,EAAKxb,OAAOtR,SAAS4gB,EAAEzf,OAAO+pB,KAAM7uB,GAClC4iB,MAAK,SAAAoO,IAG8C,IAA/C,EAAKtC,mBAAmBnmB,QAAQjF,IACnC,EAAKwd,mBAAmBxd,GAIzB8nB,EAAQ,CAAE,SAAW,EAAM,SAAY9nB,OAEvCkY,OAAM,SAAAtM,GAAG,OAAIuhB,EAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAAS4L,Y,6CAUpC,IAAD,OAAjB5L,EAAiB,uDAAN,KAE/BA,EAAWA,GAAYY,KAAKT,gBAC5B,IAAI8gB,EAAIrgB,KAAKorB,iBAAiBhsB,GAC9B,MAAgB,iBAALihB,EACHiM,QAAQC,OAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAASihB,KAIvB,IAA/CrgB,KAAKwqB,mBAAmBnmB,QAAQjF,IACnCY,KAAKwqB,mBAAmB/mB,KAAKrE,GAGtB,IAAIktB,SAAQ,SAAApF,GAClB,EAAKnW,OAAOgc,eAAe1M,EAAEhhB,MAAMsrB,MAAM,SAACzxB,EAAImG,EAAOrB,GAEhDqB,GAASA,EAAM/D,MAAQ,EAAKqE,eAAeP,EAAU,SAGxDihB,EAAEhhB,MAAMvD,MAAQ,EAAK4wB,mBAAmBttB,EAAUC,GAGlD,EAAKmtB,KAAK,cAAeptB,EAAUihB,EAAEhhB,MAAMvD,MAAO,GAGlD,EAAK7D,SAASiL,SAAQ,SAAA8pB,GAAK,OAAIA,EAAMR,KAAK,cAAeptB,EAAUihB,EAAEhhB,MAAMvD,MAAO,UAIpForB,EAAQ,CAAE,SAAW,EAAM,SAAY9nB,QAIjCktB,QAAQC,OAAO,CAAE,SAAW,EAAO,SAAYntB,EAAU,MAAS,gC,+BAQlE6sB,EAAWlX,GAEM,oBAAdkX,IACVlX,EAAWkX,EACXA,EAAY,eAGbjsB,KAAKitB,IAAIhB,EAAWlX,O,GAloBc4U,G,QCzBrB,GACduD,cAAetf,EAAQ,KAAyCC,QAChE0b,KAAM3b,EAAQ,KAAuBC,S,gHCmBhCvX,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACtC22B,OAAQ,CACPC,SAAU,EACVpR,UAAW,OACXpd,UAAW,QAEZ6M,QAAS,CACRhU,gBAAiBjB,EAAMO,QAAQ8K,QAAQuE,MAExCinB,WAAY,CACX9zB,YAAa/C,EAAMI,QAAQ,IAE5ByD,MAAO,CACN+yB,SAAU,GAEX3xB,KAAK,2BACDjF,EAAM4H,WAAW3C,MADjB,IAEH3E,MAAO,OACPyH,aAAc,MACd5E,MAAO,MACP0Q,OAAQ,MACRhR,QAAS,eACT6W,SAAU,SACVod,WAAY,8CACZC,WAAY,EACZC,WAAY,SAEbC,aAAc,CACb32B,MAAO,YAKM,SAAS42B,EAAO51B,GAC9B,IAAMQ,EAAUhC,IAER2B,EAA6EH,EAA7EG,SAAUoC,EAAmEvC,EAAnEuC,MAAOszB,EAA4D71B,EAA5D61B,iBAAgCjE,GAA4B5xB,EAA1C81B,aAA0C91B,EAA5B4xB,UAHpB,GAGgD5xB,EAAlB+1B,cAC3CxzB,EAAMgK,QAAQ,MAAQ,EAAIhK,EAAMiK,MAAM,KAAO,CAAE,KAAMjK,IAJxC,mBAI7BoB,EAJ6B,KAIvBb,EAJuB,KAM/BkzB,GAA4C,IAArBH,EAA4B,cAAsC,YAArBA,EAAiC,cAAgB,iBACrHI,GAA+C,IAArBJ,EAA4B3zB,IAAKC,EAAE,yBAAiD,YAArB0zB,EAAiC3zB,IAAKC,EAAE,6CAA+CD,IAAKC,EAAE,iDAE7L,OAED,kBAAC+zB,EAAA,EAAD,CAAQ90B,GAAG,SAASxC,SAAS,SAASoC,UAAWR,EAAQ60B,QAExD,kBAACtmB,EAAA,EAAD,CAAS/N,UAAWR,EAAQmT,SAE3B,kBAAC3E,EAAA,EAAD,CAAY/N,QAAQ,KAAKD,UAAWR,EAAQ+B,OAC1CoB,GAAQ,0BAAM3C,UAAWN,YAAKF,EAAQmD,KAAM,WAAaA,KAC/C,SAAVb,GAAoBA,GAGtB,kBAACqzB,EAAA,EAAD,CAAQC,QAAM,IACS,IAArBP,GAA6B,kBAAC3mB,EAAA,EAAD,CAAY1O,QAAS,CAAEM,KAAMN,EAAQm1B,cAAgB32B,MAAM,UAAUmC,QAAS,kBAAMywB,EAAS,UAC1H,kBAAC3iB,EAAA,EAAD,CAAS1M,MAAOL,IAAKC,EAAE8zB,IACtB,0BAAMj1B,UAAW,WAAag1B,MAGhC,kBAAC9mB,EAAA,EAAD,CAAYlQ,MAAM,UAAUmC,QAAS,kBAAMywB,EAAS,YACnD,kBAAC,IAAD,OAED,kBAAC1iB,EAAA,EAAD,CAAYlQ,MAAM,UAAUmC,QAAS,kBAAMywB,EAAS,mBACnD,kBAAC,IAAD,SAcFzxB,GC7FF,SAASk2B,IAAuB,IAAD,EACsBC,OACnD,MAAO,CACLz0B,MAH2B,EACrB00B,WAGNhkB,OAJ2B,EACFikB,a,+BCQvBh4B,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACtCiF,KAAK,2BACDjF,EAAM4H,WAAW3C,MADjB,IAEH3E,MAAO,OACPy3B,cAAe,MACf50B,MAAO,MACP0Q,OAAQ,MACRhR,QAAS,eACT6W,SAAU,SACVod,WAAY,8CACZC,WAAY,EACZC,WAAY,SAEbgB,KAAM,CACL/2B,gBAAiBjB,EAAMO,QAAQ8K,QAAQuE,KACvCF,YAAa1P,EAAMI,UACnBE,MAAO,OACP6C,MAAO,eAAiBnD,EAAMI,UAAY,MAC1CglB,OAAQ,IACR6S,aAAc,kBAEfC,MAAO,CACNh4B,SAAU,QACVG,IAAK,GAEN83B,UAAW,CACVl3B,gBAAiB,QAElBm3B,WAAY,CACXt1B,YAAa9C,EAAMI,UACnB4H,UAAW,QAEZqwB,KAAM,CACLN,cAAe,YAKF,SAASO,EAAOh3B,GAAQ,IAChC02B,EAAmC12B,EAAnC02B,KAAMO,EAA6Bj3B,EAA7Bi3B,YAAaC,EAAgBl3B,EAAhBk3B,YACnB12B,EAAUhC,IACZ24B,EAAcxU,iBAAO,IAHY,EAMf5e,mBAASkzB,GANM,mBAM9BG,EAN8B,KAMzBC,EANyB,OAaXtzB,oBAAS,GAbE,mBAa9B6yB,EAb8B,KAavBU,EAbuB,KAc/BC,EAAe7S,uBAAY,WAChC,IAAM8S,EAAaL,EAAY9uB,QAAQtJ,IAAMo4B,EAAY9uB,QAAQkK,OAAS,GACpEqkB,EAAQN,OAAOmB,SAAWD,EAEhCF,GAAS,SAAAI,GACR,OAAIA,IAAcd,GACjB1J,SAASE,eAAe,QAAQrrB,MAAM4qB,WAAaiK,EAASY,EAAU,EAAE,EAAK,KAAO,EAC7EZ,GAGDc,OAGN,CAACP,IAEJ/yB,qBAAU,WACTizB,EAAOJ,KACL,CAACA,IAEJ7yB,qBAAU,WAOT,OANA+yB,EAAY9uB,QAAU,CACrBtJ,IAAKmuB,SAASE,eAAe,UAAUuK,UACvCplB,OAAQ2a,SAASE,eAAe,UAAUwK,cAG3CtB,OAAOuB,iBAAiB,SAAUN,GAC3B,kBAAMjB,OAAOwB,oBAAoB,SAAUP,EAAc,MAE9D,CAACA,IAGJ,IAAMQ,EAAerB,EAAK1xB,KAAI,SAACoyB,EAAKtrB,GAAO,IAAD,EACjBsrB,EAAI7qB,QAAQ,MAAQ,EAAI6qB,EAAI5qB,MAAM,KAAO,CAAE,KAAM4qB,GADhC,mBACjCzzB,EADiC,KAC3Bb,EAD2B,KAEzC,OAAO,kBAACk1B,EAAA,EAAD,CAAKl2B,IAAK,MAAQgK,EAAGnI,KAAM,0BAAM3C,UAAWN,YAAKF,EAAQmD,KAAM,WAAaA,KAAgBb,MAAQ8zB,IAAmD,IAA1CxT,IAASC,WAAW,mBAAwC,SAAVvgB,EAA2B,KAARA,QAG1L,OAED,kBAACm1B,EAAA,EAAD,CACC72B,GAAG,SACH4C,MAAOozB,EACPx0B,SAhDqB,SAAC8N,EAAO0mB,GAC5BF,EAAYE,GACZC,EAAOD,IA+CRn2B,QAAQ,aACRT,QAAS,CACRM,KAAMJ,YAAKF,EAAQk2B,KAAME,GAASp2B,EAAQo2B,OAC1CC,UAAWr2B,EAAQq2B,YAGnBkB,IAOK,SAASG,EAASl4B,GAAQ,IACxBG,EAAmDH,EAAnDG,SAAU82B,EAAyCj3B,EAAzCi3B,YAAakB,EAA4Bn4B,EAA5Bm4B,YAAarB,EAAe92B,EAAf82B,WACtCt2B,EAAUhC,IAIR+T,EDlHM,WAAgC,IAAD,EACIxO,mBAASsyB,KADb,mBACrC+B,EADqC,KACnBC,EADmB,KAY5C,OATAj0B,qBAAU,WACR,SAASk0B,IACPD,EAAoBhC,KAItB,OADAC,OAAOuB,iBAAiB,SAAUS,GAC3B,kBAAMhC,OAAOwB,oBAAoB,SAAUQ,MACjD,IAEIF,ECsGWG,GAAXhmB,OANuB,EAOGxO,mBAASwO,GAPZ,mBAOxBimB,EAPwB,KAObC,EAPa,KAQ3BC,EAAe/V,iBAAO,IAE1Bve,qBAAU,WACTs0B,EAAarwB,QAAU6kB,SAASE,eAAe,UAAUwK,aACzDa,EAAalmB,EAAOmmB,EAAarwB,QAAQ,KAEvC,CAACkK,IAd2B,MAsBHxO,mBAAS,MAtBN,mBAsBxBqd,EAtBwB,KAsBhBuX,EAtBgB,KA4B/B,OALAv0B,qBAAU,WACTyb,YAAW,kBAAM8Y,EAAU1B,IAAgBkB,KAAc,MAEvD,CAAClB,EAAakB,IAIlB,kBAACS,EAAA,EAAD,CACC9mB,KAAK,WACLsP,OAAQA,EACRhgB,GAAI,YAAc+2B,EAClBn3B,UAAWN,YAAKo2B,EAAat2B,EAAQs2B,WAAat2B,EAAQu2B,MAC1Dh1B,MAAO,CAAEwQ,OAAQimB,EAAY,OAG5Br4B,G,sBCxII04B,G,kDAEL,WAAY74B,GAAQ,IAAD,8BAClB,cAAMA,IAEDuH,MAAQ,GAHK,E,qDAOT,IAAD,SAC2BW,KAAKlI,MAAhCQ,EADA,EACAA,QADA,EACSu1B,cAEjB,OAEF,kBAAC+C,GAAA,EAAD,CACCC,OAAO,QACPl4B,KAAMqH,KAAKlI,MAAMa,KACjBX,QAAS,kBAAM,EAAKF,MAAM81B,aAAa,sBAAsB,IAC7Dt1B,QAAS,CACRC,MAAOD,EAAQw4B,c,GAnBWjxB,IAAMsC,WA6BnBpD,iBApCA,SAAAvI,GAAK,MAAK,CACxBs6B,OAAQ,CACPn3B,MAAO,QAkCMoF,CAAmB4xB,I,UC3C5Br6B,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACtCu6B,cAAc,aACb7qB,YAAa1P,EAAMI,QAAQ,IAC1BJ,EAAM+L,YAAYC,KAAK,MAAQ,CAC/B0D,YAAa1P,EAAMI,QAAQ,UAMf,SAASo6B,GAAcl5B,GAOrC,IAP6C,IAAD,EAClBA,EAAlBm5B,gBADoC,MACzB,GADyB,EAGtC34B,EAAUhC,KACVwS,EAAUW,OAAOC,KAAKunB,GAAU1sB,OAElCsqB,EAAO,GACF9kB,EAAS,EAAGA,GAAUjB,EAASiB,IAElCknB,EAASlnB,GAKd8kB,EAAKprB,KACJ,kBAACytB,GAAA,EAAD,CAAMt3B,IAAKmQ,EAAQhQ,MAAI,EACtBqW,GAAI,GACJ+gB,GAAI,EACJC,GAAI,EACJC,GAAIpxB,KAAK6f,MAAM,GAAGhX,GAClBwoB,GAAIrxB,KAAK6f,MAAM,GAAGhX,IAGjBmoB,EAASlnB,KAbXvE,IAAI+R,EAAE,gBAAiB,0BAA4BxN,EAAS,IAAK,QAkBnE,OAED,kBAACmnB,GAAA,EAAD,CAAMp3B,WAAS,EAAClD,QAAS,EAAGkC,UAAWR,EAAQy4B,eAC7ClC,I,6FCfIx3B,GAAc0H,cAdL,SAAAvI,GAAK,MAAK,CACxBoC,KAAM,CACLhB,OAAQ,EACRT,QAASX,EAAMI,QAAQ,IAExBH,YAAa,CACZC,SAAU,WACVC,MAAOH,EAAMI,QAAQ,GACrBC,IAAKL,EAAMI,QAAQ,GACnBE,MAAON,EAAMO,QAAQC,KAAK,SAKR+H,EAAmB,SAAAjH,GAAU,IACxCG,EAAyCH,EAAzCG,SAAUK,EAA+BR,EAA/BQ,QAASN,EAAsBF,EAAtBE,QAAYu5B,EADQ,aACEz5B,EADF,kCAE/C,OAED,kBAAC,KAAD,eAAgBe,mBAAiB,EAACC,UAAWR,EAAQM,MAAU24B,GAC9D,kBAACzqB,EAAA,EAAD,CAAY/N,QAAQ,MAAMd,GACzBD,EACD,kBAACgP,EAAA,EAAD,CAAYhO,aAAW,QAAQF,UAAWR,EAAQ7B,YAAawC,QAASjB,GACvE,kBAAC,KAAD,OAEG,UAMCR,GAAgBuH,cAAW,SAAAvI,GAAK,MAAK,CAC1CoC,KAAK,aACJzB,QAASX,EAAMI,QAAQ,IACtBJ,EAAM+L,YAAYC,KAAK,MAAQ,CAC/B0D,YAAa1P,EAAMI,QAAQ,QAJRmI,CAOlByyB,MAEE75B,GAAgBoH,cAAW,SAAAvI,GAAK,MAAK,CAC1CoC,KAAM,CACLhB,OAAQ,EACRT,QAASX,EAAMI,QAAQ,OAHHmI,CAKlB0yB,MAGiBC,G,kDAEpB,WAAY55B,GAAQ,IAAD,8BAClB,cAAMA,IAEDuH,MAAQ,CACZpH,SAAU,IAJO,E,+DAQAwf,EAAWtF,GAAY,IAAD,OAEpC7S,EAASU,KAAKlI,MAAMm5B,UAAYjxB,KAAKlI,MAAMm5B,SAAS3xB,OACxD,GAAIA,EAAOpG,IAAM8G,KAAKlI,MAAMm5B,SAAS9Y,KAAOV,EAAUwZ,SAAS9Y,GAG9D,GAAI7Y,EAAOrH,SAASsM,OACnBiB,IAAI+R,EAAE,QAAS,CAAE,OAAS9N,OAAOC,KAAKpK,EAAOrH,UAAUsM,OAAS,sBAAwBjF,EAAOzB,KAAO,eAAgByB,EAAOrH,WAC7H+H,KAAKP,SAAS,CAAE,SAAYH,EAAOrH,WAAY,kBAAM,EAAK05B,qBAItD,CAEJ,IAAItF,EAAY,GACZp0B,EAAW,GAEf,IAAK,IAAImH,KAAYE,EAAOiS,OAE3B,UAAsChU,IAAlC+B,EAAOiS,OAAOnS,GAAUC,OAAuBC,EAAO/E,QAAQ4wB,aAAa9mB,QAAQjF,IAAa,GAApG,CAIA,IAAI4tB,EAAQ,IAAI7C,EAAO,CACrB,OAAU7qB,EACV,GAAMA,EAAOpG,GAAK,IAAMkG,EACxB,KAAQE,EAAOzB,KACf,SAAYyB,EAAOke,SAEnB,OAAUle,EAAOiS,OACjB,QAAU,2BACNjS,EAAO/E,SADX,IAEC,QAAW6E,EACX,UAAa,KACb,QAA+B,IAApBnH,EAASsM,OACpB,SAAY,KACZ,SAAY,QAIdyM,IAAWC,cACXmd,OAAOxJ,UAIRtlB,EAAOrH,SAASwL,KAAKupB,GAGrBX,EAAU5oB,KAAKupB,EAAMpQ,mBAAmB,MAAM,IAC9C3kB,EAASwL,KAAKupB,GAGfV,QAAQsF,WAAWvF,GAAW3N,MAAK,WAClClZ,IAAI+R,EAAE,QAAS,CAAE,aAAe9N,OAAOC,KAAKzR,GAAUsM,OAAS,sBAAwBjF,EAAOzB,KAAO,IAAK5F,IAC1G,EAAKwH,SAAS,CAAE,SAAYxH,IAAY,kBAAM,EAAK05B,yBAI5CryB,EAAOpG,IAAM8G,KAAKlI,MAAMm5B,SAAS9Y,KAAOV,EAAUwZ,SAAS9Y,IACpEnY,KAAKP,SAAS,CAAE,SAAY,KAAM,kBAAM,EAAKkyB,mB,4CAIzBE,EAAWC,GAChC,OAAQ9xB,KAAKlI,MAAMm5B,UAAYjxB,KAAKlI,MAAMm5B,SAAS9Y,KAAO0Z,EAAUZ,SAAS9Y,K,+BAGpE,IAAD,EACgCnY,KAAKlI,MAArCa,EADA,EACAA,KAAMo5B,EADN,EACMA,YACNzyB,EAFA,EACmB2xB,SACnB3xB,OAER,OAEF,kBAACrI,GAAA,EAAD,CAAQe,QAAS+5B,EAAap5B,KAAMA,IAAQ,EAAOD,SAAU,KAAMD,WAAW,GAC7E,kBAAC,GAAD,CAAaT,QAAS+5B,GACpBzyB,EAAOzB,MAET,kBAAC,GAAD,CAAe1E,UAAQ,EAACU,MAAO,CAAE1C,QAAS,IAEzC,kBAAC,KAAQoM,UAAT,CAAmB9C,WAAY,KAAM+C,QAASxD,KAAKX,MAAMpH,SAAU0I,WAAW,EAAMC,QAAQ,KAG7F,kBAAC,GAAD,KACC,kBAAC0C,GAAA,EAAD,CAAQlI,WAAS,EAACnC,QAAS84B,EAAaj7B,MAAM,WAA9C,e,GA7FiC+I,IAAMsC,W,wCCtDnC7L,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACtCw7B,KAAK,aACJp6B,OAAQpB,EAAMI,QAAQ,EAAG,EAAG,EAAG,IAC9BJ,EAAM+L,YAAYC,KAAK,MAAQ,CAC/B5K,OAAQpB,EAAMI,QAAQ,GAAK,GAAK,EAAG,KAGrCq7B,qBAAsB,CACrB96B,QAASX,EAAMI,WAEhBs7B,WAAY,SAAAp6B,GAAK,oBAChBL,gBAAiBjB,EAAMO,QAAQ8K,QAAQuE,KACvCtP,MAAO,OACPoZ,SAAU,QACPpY,IAEJq6B,YAAY,aACXh7B,QAASX,EAAMI,QAAQ,EAAG,IACzBJ,EAAM+L,YAAYC,KAAK,MAAQ,CAC/BrL,QAASX,EAAMI,QAAQ,SAMX,SAASw7B,GAAOt6B,GAAQ,IAC9BuC,EAA2BvC,EAA3BuC,MAAOoB,EAAoB3D,EAApB2D,KAAM42B,EAAcv6B,EAAdu6B,UACf/5B,EAAUhC,GAAU+7B,GAE1B,OAED,kBAACC,GAAA,EAAD,CAAMx5B,UAAWR,EAAQ05B,MACxB,kBAACO,GAAA,EAAD,CACCxV,OAAiB,OAATthB,GACP,kBAAC+2B,GAAA,EAAD,CAAQz5B,QAAQ,UAAUT,QAAS,CAAEM,KAAMN,EAAQ45B,aACjDryB,IAAMma,cAAc,OAAQ,CAAE,UAAa,YAAcve,GAAQyf,IAASC,WAAW,mBAAqB,WAG7G9gB,MAAOA,GACN,kBAACyM,EAAA,EAAD,CAAY/N,QAAQ,KAAK4H,UAAU,MACjCtG,KAIJ,kBAACo4B,GAAA,EAAD,CAAa35B,UAAWR,EAAQ65B,aAC9Br6B,EAAMG,WCpCT,IAAMy6B,GAAW,SAACjK,EAAS6B,GAAuB,IAAhBxyB,EAAe,uDAAP,GAGzC,IAAKwyB,IAAuE,IAA9DvW,KAAeuW,EAAM5mB,SAAS/C,WAAWqT,iBAEtD,OADAxO,IAAI+R,EAAE,SAAU,SAAWkR,EAAU,uDAAwD,SACtF,KAIR,IAAMkK,EAAMC,KAAQtI,EAAM5mB,SAAS/C,WAAa,aAGhD,YAAYpD,IAARo1B,GACHntB,IAAI+R,EAAE,SAAU,wBAA0B+S,EAAM5mB,SAAS/C,UAAY,UAAW,SACzE,MAGD,kBAACgyB,EAAD,CAAK/4B,IAAK,MAAQ6uB,EAASjlB,QAAS8mB,EAAM9mB,SAAW,GAAI/C,WAAY3I,EAAM8I,OAAS9I,EAAM8I,OAAS,KAAM8C,SAAQ,2BAAO4mB,EAAM5mB,UAAa5L,MAO7I+6B,GAAkB,SAAC5B,EAAUzI,GAKlC,IAL0D,IAAhB1wB,EAAe,uDAAP,GAE9Cg7B,EAAe,GACbhqB,EAAUW,OAAOC,KAAKunB,GAAU1sB,OAE7BwF,EAAS,EAAGA,GAAUjB,EAASiB,IAAU,CACjD,IAAIgpB,EAAiB9B,EAASlnB,GAI9B,GAHA+oB,EAAa/oB,GAAU+oB,EAAa/oB,IAAW,GAG1CgpB,GAAmBtpB,OAAOC,KAAKqpB,GAAgBxuB,OAMnD,IAAK,IAAIkkB,KAAWsK,EAAgB,CAEnC,IAAIzI,EAAQ9B,EAAOC,IAAY,GAC/B6B,EAAM9mB,QAAU8mB,EAAM9mB,SAAW,GACjC8mB,EAAM5mB,SAAWqvB,EAAetK,IAAY,GAC5C,IAAIuK,EAAiBjf,KAAeuW,EAAM5mB,SAAS/C,YAAc,GAE7DsJ,EAAUyoB,GAASjK,EAAS6B,EAAOxyB,IAClCwyB,EAAM9mB,QAAQe,OAAS,GAAKyuB,EAAehf,mBAAqB/J,GACpE6oB,EAAa/oB,GAAQtG,KACpB,kBAAC2uB,GAAD,CACCx4B,IAAK,OAAS6uB,EACdpuB,MAAgC,OAAzBiwB,EAAM5mB,SAASrJ,MAAiB,KAAQiwB,EAAM5mB,SAASrJ,OAASiwB,EAAMzsB,MAAQm1B,EAAe34B,MACpGoB,KAA8B,OAAxB6uB,EAAM5mB,SAASjI,KAAgB,KAAQ6uB,EAAM5mB,SAASjI,MAAQu3B,EAAev3B,KACnF42B,UAAW/H,EAAM5mB,SAAS2uB,WAGzBpoB,SAtBL6oB,EAAa/oB,GAAQtG,KAAK,MA8B5B,OAAOqvB,GAIaG,G,kDAEjB,WAAYn7B,GAAQ,IAAD,8BACrB,cAAMA,IAEDuH,MAAQ,CACZ0vB,YAAa,EACbmE,SAAU,GAEV9mB,KAAM,OAEN+mB,oBAAoB,EACpBtF,cAAe,GACfuF,oBAAqB,EAErBC,QAAQ,EACRC,eAAgB,CACf,GAAM,EACN,OAAU,KAKZ,EAAKvB,YAAc,EAAKA,YAAYtwB,KAAjB,gBACnB,EAAKhB,WAAa,EAAKA,WAAWgB,KAAhB,gBAClB,EAAKutB,YAAc,EAAKA,YAAYvtB,KAAjB,gBACnB,EAAKmsB,aAAe,EAAKA,aAAansB,KAAlB,gBACpB,EAAKioB,SAAW,EAAKA,SAASjoB,KAAd,gBAGhB,EAAKsP,OAASC,IAAWC,cAGzB,EAAK6hB,aAAe,GACpB,EAAKtvB,QAAU6kB,IAAQkL,aACvB,EAAKC,OAAStY,IAASC,WAAW,UAClC,EAAKqT,KAAO/kB,OAAOC,KAAK,EAAK8pB,QAC7B,EAAKC,YAAc3uB,OAAOC,MAAMJ,SAAS,EAAK6pB,KAAK,KACnD,EAAKnvB,MAAM6zB,SAAW,EAAK1E,KAAK,EAAKnvB,MAAM0vB,aAGtC,EAAK0E,cACT,EAAKD,OAAS,CAAE,KAAQ,EAAKA,QAC7B,EAAKhF,KAAK/qB,KAAK,MAIhB,EAAKiwB,YAAc,GA7CE,E,gEAgDD,IAAD,OAGsB,IAArCjqB,OAAOC,KAAK1J,KAAKwD,SAASe,QAAkD,KAAlC2W,IAASC,WAAW,WACjEnb,KAAK0pB,SAAS,iBAIf1pB,KAAK+Q,OAAO0b,SAAS,0BAA0B/N,MAAK,SAAAmP,GACnDA,EAAiBA,GAAiBA,EAAcvyB,KAAO4O,KAAKoI,MAAMub,EAAcvyB,MAAS,GAEzF,EAAKmE,SAAS,CACb2zB,oBAAqBvF,EAAc8F,QAAO,SAAAC,GAAY,OAAKA,EAAaC,SAAkC,IAAxBD,EAAaC,UAAkBtvB,OACjHspB,cAAeA,OAIjB7tB,KAAK+Q,OAAOgc,eAAe1D,IAASyK,oBAAoB,SAAAjG,GAAa,OAAIroB,IAAI+R,EAAE,SAAUsW,Q,qCAIzF,IAAMrF,EAASH,IAAQ0L,YAEnBjqB,EAAW,EACXkqB,EAAY,GAEhB,IAAK,IAAIC,KAAYj0B,KAAKwzB,OAAQ,CACjC,IAAMvC,EAAWjxB,KAAKwzB,OAAOS,GAGvBxL,EAAUhf,OAAOC,KAAKunB,GAAU,GAChCrC,EAAa9pB,OAAOC,MAAMJ,SAAS8jB,KAEpCzoB,KAAK8yB,aAAamB,IAAarF,EACnC5uB,KAAK8yB,aAAamB,GAAYvB,GAASzB,EAAD,YAAC,eAAezI,EAAOC,IAAvB,IAAiC/kB,SAAUutB,EAASxI,IAAY,KAAhE,aAAwE7nB,OAAQZ,KAAKS,YAAeT,KAAK0zB,cAItI1zB,KAAK8yB,aAAamB,KAC3Bj0B,KAAK8yB,aAAamB,GAAY,kBAACjD,GAAD,CAAeC,SAAU4B,GAAgB5B,EAAUzI,EAAX,aAAqB5nB,OAAQZ,KAAKS,YAAeT,KAAK0zB,iBAG7H,IAAMQ,EACL,kBAAClE,EAAD,CAAUp2B,IAAK,YAAckQ,EAAUmmB,YAAanmB,EAAUilB,YAAa/uB,KAAKX,MAAM0vB,YAAaH,WAAYA,GAC7G5uB,KAAK8yB,aAAamB,IAIrBD,EAAUvwB,KAAKywB,GACfpqB,IAGD,OAAOkqB,I,oCAIPh0B,KAAKP,SAAS,CAAE,QAAU,EAAO,eAAkB,CAAE,GAAM2F,KAAK+uB,MAAO,OAAU,Q,iCAGvE70B,GACVU,KAAKP,SAAS,CAAE,QAAU,EAAM,eAAkB,CAAE,GAAM2F,KAAK+uB,MAAO,OAAU70B,O,kCAGrE4vB,GACXlvB,KAAKP,SAAS,CAAEsvB,YAAaG,EAAKgE,SAAUlzB,KAAKwuB,KAAKU,O,mCAG1C4B,EAAQn4B,GACpBqH,KAAKP,SAAL,eAAiBqxB,EAASn4B,M,+BAGlByT,GACRpM,KAAKP,SAAS,CAAE2M,W,+BAIhB,IAAIgoB,EAAOC,EAAMr0B,KAAKX,MAAM+M,OAAS,KAE/B4nB,EAAYh0B,KAAKs0B,eACjB,OAER,kBAAC,IAAMlzB,SAAP,KACC,kBAACssB,EAAD,CACCrzB,MAAO6gB,IAASqZ,aAAgBv0B,KAAKyzB,aAAezzB,KAAKX,MAAM6zB,UAAahY,IAASC,WAAW,cAAgB,+BAChHwS,iBAAkB3tB,KAAKlI,MAAM61B,iBAC7BC,aAAc5tB,KAAK4tB,aACnBlE,SAAU1pB,KAAK0pB,SACfmE,cAAe7tB,KAAKX,MAAM+zB,qBAGzBpzB,KAAKyzB,aAAe,kBAAC3E,EAAD,CAAQN,KAAMxuB,KAAKwuB,KAAMO,YAAa/uB,KAAKX,MAAM0vB,YAAaC,YAAahvB,KAAKgvB,eAKtG,kBAAC,GAAD,CACCr2B,KAAMqH,KAAKX,MAAM8zB,mBACjBvF,aAAc5tB,KAAK4tB,aACnBC,cAAe7tB,KAAKX,MAAMwuB,gBAK1BuG,GAAQ,kBAACA,EAAD,CACRhoB,KAAMpM,KAAKX,MAAM+M,KACjBsd,SAAU1pB,KAAK0pB,SACflmB,QAASxD,KAAKwD,UAKf,kBAAC,GAAD,CACC7K,KAAMqH,KAAKX,MAAMg0B,OACjBpC,SAAUjxB,KAAKX,MAAMi0B,eACrBvB,YAAa/xB,KAAK+xB,cAiBlBiC,O,GArLkCn0B,IAAMsC,W,gJCxEpC7L,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACtCg+B,QAAS,CACR/8B,gBAAiBg9B,KAAM,MAExBz4B,MAAO,CACNvE,gBAAiBjB,EAAMO,QAAQiF,MAAMwK,MAEtC/M,KAAM,CACLhC,gBAAiBjB,EAAMO,QAAQ8K,QAAQuE,MAExCsuB,QAAS,CACRj9B,gBAAiBk9B,KAAM,MAExBl5B,KAAM,CACLyU,SAAU,IAEX0kB,YAAa,CACZC,QAAS,GACTt7B,YAAa/C,EAAMI,QAAQ,IAE5B8O,QAAS,CACRrM,QAAS,OACT+gB,WAAY,cAKR0a,GAAc,CACnBN,QAASO,KACTL,QAASM,KACTh5B,MAAOi5B,KACPx7B,KAAMy7B,MAIQ,SAASC,GAAer9B,GACtC,IAAMQ,EAAUhC,KACVwC,EAAwFhB,EAAxFgB,UAAWH,EAA6Eb,EAA7Ea,KAAMy8B,EAAuEt9B,EAAvEs9B,iBAAkB1vB,EAAqD5N,EAArD4N,QAASjP,EAA4CqB,EAA5CrB,YAAauB,EAA+BF,EAA/BE,QAASe,EAAsBjB,EAAtBiB,QAAYw4B,EAFvC,aAEiDz5B,EAFjD,qFAGvCu9B,EAAOP,GAAY/7B,GAIzB,OAFAJ,EAAOA,IAAQ,EACfy8B,EAAmBA,GAAoB,KAGxC,kBAACE,GAAA,EAAD,CACCC,aAAc,CACbC,SAAU,SACV90B,WAAY,UAEb/H,KAAMA,EACNy8B,iBAAkBA,EAClBp9B,QAASA,GAET,kBAACy9B,GAAA,EAAD,eACC38B,UAAWN,YAAKF,EAAQS,GAAUD,GAClC4M,QACC,0BAAMxM,GAAG,kBAAkBJ,UAAWR,EAAQoN,SAC7C,kBAAC2vB,EAAD,CAAMv8B,UAAWN,YAAKF,EAAQmD,KAAMnD,EAAQs8B,eAC3ClvB,GAGH9E,OAAQnK,GAAe,CACtB,kBAACuQ,EAAA,EAAD,CAAYpN,IAAI,QAAQZ,aAAW,QAAQlC,MAAM,UAAUmC,QAASjB,GACnE,kBAAC,KAAD,CAAWc,UAAWR,EAAQmD,UAG5B81B,K,cC5CAmE,G,kDAEF,WAAY59B,GAAQ,IAAD,8BACrB,cAAMA,IAEDuH,MAAQ,CACZs2B,OAAQ,GACR/iB,WAAW,EACX5W,OAAO,EACPb,aAAc,GAEd3E,MAAO,MATa,E,gEAcD,IAAD,OAGbo/B,EAAe,SAAA5qB,GAEpB,EAAKvL,SAAS,CACbmT,WAAW,EACX5W,OAAO,EACPb,aAAcnB,IAAKC,EAAiB,kBAAR+Q,EAAmBA,EAAMA,EAAItF,SAAW,sBAchE2X,EAA+B,SAAzB+Q,OAAOnf,SAAS4mB,KAAkBjL,EAC7CwD,OAAOnf,SAAS6mB,SAAW,KAAO1H,OAAOnf,SAAS8mB,UAAY3H,OAAOnf,SAAS4mB,KAAO,IAAMzH,OAAOnf,SAAS4mB,KAAO,IAE7G3J,EAAY,CACjB,CAAE,MAAS,UAAW,SAAY,kBAAM,EAAKzsB,SAAS,CAAEmT,WAAW,EAAM5W,OAAO,EAAOb,aAAc,OACrG,CAAE,MAAS,YAAa,SAAY,kBAAM,EAAKsE,SAAS,CAAEmT,UAAW,UAAW5W,OAAO,EAAOb,aAAc,OAC5G,CAAE,MAAS,aAAc,SAAYy6B,GACrC,CAAE,MAAS,QAAS,SAAYA,IAGjCpwB,IAAI+R,EAAE,MAAOvd,IAAKC,EAAE,cAAgB,IAAMojB,EAAM,OAChDrd,KAAK+Q,OAASC,IAAWglB,QAAQ3Y,EAAK6O,GAGtClsB,KAAK0D,SAAW,GAChB1D,KAAK+Q,OAAO0b,SAASpD,IAAS4M,eAC5BvX,MAAK,SAAArf,GAEL,IACKA,IACH,EAAKqE,SAAL,2BAAqB,EAAKA,UAAawG,KAAKoI,MAAMjT,EAAM/D,KAAO,KAC/D4f,IAASgb,YAAY,EAAKxyB,UAC1BwX,IAASib,sBAIE54B,IADAkM,OAAOC,KAAK,EAAKhG,SAAS8vB,QAAQ,GAE7C,EAAK/zB,UAAS,SAAA0S,GAAS,MAAK,CAC3BwjB,OAAO,GAAD,mBAAOxjB,EAAUwjB,QAAjB,CAAyB,aAC/B35B,OAAO,EACPb,aAAcnB,IAAKC,EAAE,2DAItB,EAAKwF,UAAS,SAAA0S,GAAS,MAAK,CAAEwjB,OAAO,GAAD,mBAAOxjB,EAAUwjB,QAAjB,CAAyB,iBAG/D,MAAM3qB,GACLxF,IAAI+R,EAAE,MAAO,iBAAmBvM,EAAItF,QAAS,SAC7C,EAAKjG,UAAS,SAAA0S,GAAS,MAAK,CAC3BwjB,OAAO,GAAD,mBAAOxjB,EAAUwjB,QAAjB,CAAyB,aAC/B35B,OAAO,EACPb,aAAcnB,IAAKC,EAAE,0BAA4B,YAInDqd,OAAM,SAAAtM,GACNxF,IAAI+R,EAAE,MAAO,iBAAmBvM,EAAItF,QAAS,SAC7C,EAAKjG,UAAS,SAAA0S,GAAS,MAAK,CAC3BwjB,OAAO,GAAD,mBAAOxjB,EAAUwjB,QAAjB,CAAyB,aAC/B35B,OAAO,EACPb,aAA6B,kBAAR6P,EAAmBhR,IAAKC,EAAE+Q,GAAOhR,IAAKC,EAAE+Q,EAAItF,gBAKpE1F,KAAK0D,SAAS0yB,SAAW,GACzBp2B,KAAK+Q,OAAOslB,UAAU,iBAAiB,SAACrrB,EAAK0L,GACxCA,GAAQA,EAAK3E,SAChB,EAAKrO,SAAS0yB,SAAW1f,EAAK3E,OAC9BmJ,IAASgb,YAAY,CAAEE,SAAU,EAAK1yB,SAAS0yB,eAKjD,8BAAkB1X,MAAK,SAAAloB,GAAK,OAAI,EAAKiJ,SAAS,CAAEjJ,MAAOA,EAAMqX,aAG7D7N,KAAK+Q,OAAO0b,SAASpD,IAASiN,cAC5B5X,MAAK,SAAArf,GACL,IAAIipB,EAAa,KAEjB,IACCA,EAAape,KAAKoI,MAAMjT,EAAM/D,KAAO,IACrC,EAAKi7B,eAAejO,GAAY5J,MAAK,SAAAoO,GACpCzE,IAAQmO,IAAIlO,GAAYmO,WAAW3J,EAAItpB,SAASkzB,UAAU5J,EAAItE,QAC9D,EAAK/oB,UAAS,SAAA0S,GAAS,MAAK,CAAEwjB,OAAO,GAAD,mBAAOxjB,EAAUwjB,QAAjB,CAAyB,kBAG/D,MAAM3qB,GACLxF,IAAI+R,EAAE,MAAO,gBAAkBvM,EAAItF,QAAS,SAC5C,EAAKjG,UAAS,SAAA0S,GAAS,MAAK,CAC3BwjB,OAAO,GAAD,mBAAOxjB,EAAUwjB,QAAjB,CAAyB,WAC/B35B,OAAO,EACPb,aAAcnB,IAAKC,EAAE,yBAA2B,YAIlDqd,OAAM,SAAAtM,GACNxF,IAAI+R,EAAE,MAAO,gBAAkBvM,EAAItF,QAAS,SAC5C,EAAKjG,UAAS,SAAA0S,GAAS,MAAK,CAC3BwjB,OAAO,GAAD,mBAAOxjB,EAAUwjB,QAAjB,CAAyB,WAC/B35B,OAAO,EACPb,aAAcnB,IAAKC,EAAE,uCAAyC,a,kCAUtDuuB,EAAQlpB,GAenB,OAZcA,EAAOuB,IAAI,WACjBypB,MAAMpnB,SAAQ,SAAAonB,GAErB,IAAI7B,EAAU6B,EAAMluB,cAAcC,QAAQ,KAAM,IAC3CmsB,EAAOC,GAIXD,EAAOC,GAASjlB,QAAQC,KAAKnE,GAH7BkpB,EAAOC,GAAW,CAAE,GAAMA,EAAS,KAAQ6B,EAAO,QAAW,CAAChrB,OAOzDkpB,I,oCAOM4B,GAEb,IAAIuM,EAAW,GACXr3B,EAAS,KACb,IACCA,EAAS,IAAI6qB,EAAOC,EAAkBpqB,KAAK+Q,QAG3C4lB,EAASlzB,KAAKnE,EAAOsd,mBAAmB,MAAM,IAG1Ctd,EAAOE,mBACVm3B,EAASlzB,KAAKnE,EAAOsd,mBAAmBtd,EAAOE,mBAAmB,IAIpE,MAAMwL,GACLxF,IAAI+R,EAAE,MAAOvM,EAAItF,QAAS,QAG3B,OAAO,IAAI4mB,SAAQ,SAAApF,GAClBoF,QAAQsF,WAAW+E,GAAUjY,MAAK,SAAAkY,GAEjCA,EAAQ1zB,SAAQ,SAAA2zB,GACO,aAAlBA,EAAO1zB,QACVqC,IAAI+R,EAAE,MAAOsf,EAAQ,YAIvB3P,EAAQ5nB,W,qCASIw3B,GAAa,IAAD,OAGtBH,EAAW,GACXnzB,EAAU,GACVglB,EAAS,GAETuO,EAAmB,EAAGC,EAAiB,EAPjB,WAQjBzO,GACRwO,IAEAD,EAAWvO,GAAUhuB,QAArB,2BAAoCu8B,EAAWvO,GAAUhuB,SAAYu8B,EAAWvO,GAAU0O,eACnFH,EAAWvO,GAAU0O,OAE5B,IAAI7M,EAAgB,2BAAQ0M,EAAWvO,IAAnB,IAA8B,GAAMA,IACxDoO,EAASlzB,KAAK,IAAI6oB,SAAQ,SAACpF,EAASqF,GAEnC,EAAK2K,cAAc9M,GAAkB1L,MAAK,SAAApf,GAE1B,OAAXA,IACH03B,IACAxO,EAAS,EAAK2O,YAAY3O,EAAQlpB,GAClCkE,EAAQlE,EAAOpG,IAAMoG,EACrB4nB,EAAQqB,IAGTgE,EAAOhE,UA1BgB,eA+BhBnpB,GAER,IAAIC,EAAQ+qB,EAAiB7Y,OAAOnS,GAChCC,QAA0B9B,IAAjB8B,EAAM43B,QAElBN,EAASlzB,KAAK,IAAI6oB,SAAQ,SAACpF,EAASqF,GAEnC,EAAK2K,cAAL,2BAAwB9M,GAAxB,IAA0C,GAAM7B,EAAW,IAAMnpB,EAAU,OAAS,eAAIA,EAAWC,GAAS,QAAWA,EAAM43B,UAAUvY,MAAK,SAAApf,GAE5H,OAAXA,IACH03B,IACAxO,EAAS,EAAK2O,YAAY3O,EAAQlpB,GAClCkE,EAAQlE,EAAOpG,IAAMoG,EACrB4nB,EAAQqB,IAGTgE,EAAOhE,WAhBX,IAAK,IAAInpB,KAAYgrB,EAAiB7Y,OAAS,EAAtCnS,IAvBV,IAAK,IAAImpB,KAAYuO,EAAa,EAAzBvO,GA+CT,OAAO,IAAI+D,SAAQ,SAAApF,GAAO,OAAIoF,QAAQsF,WAAW+E,GAAUjY,MAAK,SAAAoO,GAG/D,IAAK,IAAIrE,KAAWD,EACnBA,EAAOC,GAASjlB,QAAQ+H,MAAK,SAACyG,EAAOC,GACpC,OAAID,EAAMzX,QAAQgR,KAAO0G,EAAM1X,QAAQgR,KAAa,EAC3C0G,EAAM1X,QAAQgR,KAAOyG,EAAMzX,QAAQgR,MAAc,EAC9C,KAKd/F,IAAI+R,EAAE,MAAO,CAAE,aAAewf,EAAmB,mBAAqBC,EAAiB,eAAiBvtB,OAAOC,KAAK8e,GAAQjkB,OAAS,WAAYuoB,EAAKtE,IACtJtB,EAAQ,CAAE1jB,QAASA,EAASglB,OAAQA,Y,kCAI1BxsB,GAIX,OAHAA,EAAQA,GAASgE,KAAKX,MAAMlE,aAC5BqK,IAAI+R,EAAE,MAAO,iBAAmBvb,EAAO,SAIzC,kBAACm5B,GAAD,CACCv7B,IAAK,iBACLb,QAAQ,QACRtC,aAAa,EACbiP,QAAS1J,EAAMoI,e,8CAMU,IAChB9L,EAAY0H,KAAKlI,MAAjBQ,QACR,OAEF,kBAAC44B,GAAA,EAAD,CACCt3B,IAAI,iBACJE,WAAS,EACTlD,QAAS,EACT0R,UAAU,SACV6W,QAAQ,SACR/E,WAAW,SACXvgB,MAAO,CAAE2qB,UAAW,UAGpB,kBAAC4S,GAAA,EAAD,MACA,kBAACtwB,EAAA,EAAD,CAAYhO,UAAWR,EAAQka,SAAUxY,IAAKC,EAAE,uBAAhD,W,4CAOsBnC,GAOrB,IAP6B,IACrBQ,EAAY0H,KAAKlI,MAAjBQ,QACA++B,EAAgCv/B,EAAhCu/B,OAAQC,EAAwBx/B,EAAxBw/B,OAAQC,EAAgBz/B,EAAhBy/B,YAElBC,EAAiB,SAAC1/B,GAAD,OAAW,kBAAC2/B,GAAA,EAAD,CAAUC,UAAU,OAAO3+B,QAAQ,OAAOD,UAAWR,EAAQq/B,SAAUttB,OAAQvS,EAAMuS,UAEnHyoB,EAAe,GACV/oB,EAAS,EAAGA,GAAUwtB,EAAaxtB,IAAU,CACrD+oB,EAAa/oB,GAAU+oB,EAAa/oB,IAAW,GAG/C,IADA,IAAI6tB,EAAU,EAAA33B,KAAK43B,SAAqB,EAC/BC,EAAS,EAAGA,GAAUF,EAASE,IACvChF,EAAa/oB,GAAQtG,KAAK,kBAAC+zB,EAAD,CAAgB59B,IAAKmQ,EAAS,IAAM+tB,EAAQztB,OAAS,IAAApK,KAAK43B,SAAyB,OAI/G,OAEF,kBAAC,IAAMz2B,SAAP,KACEi2B,GAAU,kBAACI,GAAA,EAAD,CAAUC,UAAU,OAAO3+B,QAAQ,OAAOsR,OAAQ,KAC5DitB,GAAU,kBAACG,GAAA,EAAD,CAAUC,UAAU,OAAO3+B,QAAQ,OAAOsR,OAAQ,KAC7D,kBAAC2mB,GAAD,CAAep3B,IAAI,kBAAkBq3B,SAAU6B,Q,+BAS9C,IAAM92B,EAAQgE,KAAKX,MAAMrD,MAAQgE,KAAK+3B,cAAgB,KAGtD,GAAK/7B,IAAoD,IAA3CgE,KAAKX,MAAMs2B,OAAOtxB,QAAQ,YAGnC,IAAKrI,IAAkD,IAAzCgE,KAAKX,MAAMs2B,OAAOtxB,QAAQ,UAQ5C,OADAmB,IAAI+R,EAAE,MAAO,CAAE,aAAcvX,KAAKX,MAAMuT,YAG3C,kBAAColB,GAAA,EAAD,CAAexhC,MAAOwJ,KAAKX,MAAM7I,OAC/BwF,EAC6B,IAA7BgE,KAAKX,MAAMs2B,OAAOpxB,QAAgB,kBAAC,GAAD,CAAQ3K,IAAI,SAAS+zB,iBAAkB3tB,KAAKX,MAAMuT,aAXnF,IAAMsc,EAAMzlB,OAAOC,KAAK1J,KAAK0D,SAAS8vB,QAAQ,GAC9C,YAAej2B,IAAR2xB,EAAoB,KAAOlvB,KAAKi4B,sBAAsB,CAAEZ,QAAQ,EAAMC,OAAgB,IAARpI,EAAWqI,YAAsB,IAARrI,EAAYzlB,OAAOC,KAAK1J,KAAK0D,SAAS8vB,OAAOtE,IAAM3qB,OAAS2qB,EAAI3qB,SAJ9K,OAAOvE,KAAKk4B,4B,GAzVGr4B,IAAMsC,WA+WTpD,iBAjYA,SAAAvI,GAAK,MAAK,CACxBgc,QAAS,CACR5a,OAAQ,aACRd,MAAO,QAER6gC,SAAS,aACR//B,OAAQpB,EAAMI,QAAQ,EAAG,EAAG,EAAG,IAC9BJ,EAAM+L,YAAYC,KAAK,MAAQ,CAC/BjJ,YAAa/C,EAAMI,QAAQ,GAAK,GAAK,EAAG,QAyX5BmI,CAAmB22B,IC9YdyC,QACW,cAA7B/J,OAAOnf,SAAS8mB,UAEe,UAA7B3H,OAAOnf,SAAS8mB,UAEhB3H,OAAOnf,SAAS8mB,SAASqC,MACvB,2DCXNC,IAASC,OAAO,kBAAC,GAAD,MAAStT,SAASE,eAAe,SD4H3C,kBAAmBc,WACrBA,UAAUuS,cAAcC,MAAM9Z,MAAK,SAAA+Z,GACjCA,EAAaC,iB,8MEpIJ,GACdp1B,OAAQsK,EAAQ,KAAmBC,QACnC8qB,KAAM/qB,EAAQ,KAAkBC,QAChC+qB,MAAOhrB,EAAQ,KAAkB2B,WACjCspB,WAAYjrB,EAAQ,KAAkB6B,gBACtCM,SAAUnC,EAAQ,KAAqBC,QACvCmC,aAAcpC,EAAQ,KAAqBoC,aAC3CK,KAAMzC,EAAQ,KAAqByC,KACnCvL,OAAQ8I,EAAQ,KAAmBC,QACnCirB,OAAQlrB,EAAQ,KAAmBC,QACnCuY,OAAQxY,EAAQ,KAAmBC,QACnCyY,aAAc1Y,EAAQ,KAAmB6Y,kBACzCnsB,KAAMsT,EAAQ,KAAiBC,S,kGCZjB,GACd,QAAW,CACV,KAAQ,CACP,GAAM,GACN,GAAM,uGAEP,KAAQ,SACR,UAAa,CACZ,CACC,GAAI,CACH,GAAM,aACN,GAAM,qBAGR,CACC,OAAU,CACT,GAAM,4BACN,GAAM,6CAGR,CACC,MAAS,CACR,GAAM,2BACN,GAAM,gDAKV,MAAS,CACR,KAAQ,CACP,GAAM,GACN,GAAM,6FAGR,aAAgB,CACf,KAAQ,CACP,GAAM,GACN,GAAM,gFAGR,cAAiB,CAChB,KAAQ,CACP,GAAM,GACN,GAAM,iFAGR,aAAgB,CACf,KAAQ,CACP,GAAM,GACN,GAAM,6DASR,gBAAmB,CAClB,KAAQ,CACP,GAAM,GACN,GAAM,2FAGR,kBAAqB,CACpB,KAAQ,CACP,GAAM,GACN,GAAM,6FAGR,KAAQ,CACP,KAAQ,CACP,GAAM,GACN,GAAM,mFAEP,KAAQ,WAIGkrB,EAAgB,CAC5B,MAAS,CACR,KAAQ,CACP,GAAM,GACN,GAAM,oDAGR,WAAc,CACb,KAAQ,CACP,GAAM,GACN,GAAM,iDAEP,MAAQ,GAET,QAAW,CACV,KAAQ,CACP,GAAM,GACN,GAAM,4DAEP,MAAQ,GAET,MAAS,CACR,KAAQ,CACP,GAAM,GACN,GAAM,UAGR,KAAQ,CACP,KAAQ,CACP,GAAM,GACN,GAAM,IAEP,KAAQ,UAET,OAAU,CACT,KAAQ,CACP,GAAM,GACN,GAAM,gDAGR,KAAQ,CACP,KAAQ,CACP,GAAM,GACN,GAAM,YAGR,KAAQ,CACP,KAAQ,CACP,GAAM,GACN,GAAM,iDAEP,KAAQ,oCAET,UAAa,CACZ,KAAQ,CACP,GAAM,GACN,GAAM,oCAEP,MAAQ,I,gJCpFJC,E,kDAEL,WAAYlhC,GAAQ,IAAD,8BAClB,cAAMA,IAyBPmhC,MAAQ,WACP,IAAIC,EAAW,eAAQ,EAAK75B,MAAMC,QAElC,IAAK,IAAM1F,KAAO,EAAKu/B,YAAa,CACnC,IAAM79B,EAAM,EAAK69B,YAAYv/B,GADM,EAEIA,EAAI0K,MAAM,KAFd,mBAE3BzJ,EAF2B,KAErBu+B,EAFqB,KAEfC,EAFe,KAKtB,WAATx+B,EACoC,kBAA5Bq+B,EAAYr+B,GAAMu+B,GAC5BF,EAAYr+B,GAAMu+B,GAAMC,GAAkB/9B,EAG1C49B,EAAYr+B,GAAMu+B,GAAlB,aACC/5B,MAAO65B,EAAYr+B,GAAMu+B,IACxBC,EAAiB/9B,GAMH,YAATT,GAA+B,eAATA,EAC9Bq+B,EAAYr+B,GAAMu+B,GAAQ99B,EAK1B49B,EAAYE,GAAQ99B,EAKtB49B,EAAY3+B,QAAQ+vB,MAAMxtB,KAAI,SAAAwtB,GAAK,OAAIjC,IAAQM,WAAW2B,EAAMluB,cAAcC,QAAQ,IAAK,IAAKiuB,MAGhG4O,EAAYI,SAAWl0B,KAAK+uB,MAC5B,EAAKr8B,MAAMyhC,QAAU,EAAKzhC,MAAMyhC,OAAOL,IA9DrB,EAoEnBM,cAAgB,kBAAM,EAAK1hC,MAAMuX,UAAY,EAAKvX,MAAMuX,SAAS,EAAKkZ,WApEnD,EAyEnBkR,UAAY,SAAC3hC,EAAOwD,GAGnB,GAAIxD,EAAM6C,WAAciC,MAAMC,QAAQvB,IAAuB,IAAfA,EAAIiJ,QAAiC,kBAARjJ,IAAqBA,GAQ/F,OAPA,EAAKmE,UAAS,SAAAiZ,GAAU,MAAK,CAC5BvD,OAAO,2BACHuD,EAAWvD,QADT,kBAEJrd,EAAMoB,GAAKc,IAAKC,EAAE,yBAId,EAIR,GAAInC,EAAM6D,YAAc7D,EAAM6D,WAAW+9B,KAExC,IACCp+B,EAAMA,EAAM4O,KAAKoI,MAAMhX,GAAO,GAE/B,MAAM0P,GAQL,OAPA,EAAKvL,UAAS,SAAAiZ,GAAU,MAAK,CAC5BvD,OAAO,2BACHuD,EAAWvD,QADT,kBAEJrd,EAAMoB,GAAKc,IAAKC,EAAE,4BAId,EAKL,EAAKoF,MAAM8V,OAAOrd,EAAMoB,KAC3B,EAAKuG,UAAS,SAAAiZ,GACb,IAAIihB,EAAU,eAAQjhB,EAAWvD,QAAU,IAE3C,cADOwkB,EAAW7hC,EAAMoB,IACjB,CAAEic,OAAQwkB,MAKnB,EAAKR,YAAYrhC,EAAMoB,IAAMoC,GAnHX,EAyHnBs+B,UAAY,WAGX,GAAK,EAAKC,YAUL,GAAIpwB,OAAOC,KAAK,EAAKrK,MAAMC,OAAOiS,QAAQlN,QAAQ,EAAKw1B,cAAgB,EAC3E,EAAKp6B,UAAS,SAAAiZ,GAAU,MAAK,CAC5BvD,OAAO,2BACHuD,EAAWvD,QADT,IAEL0kB,YAAa7/B,IAAKC,EAAE,oCAMlB,CACJ,IAAIL,EAAM,EAAKigC,YAAYx9B,QAAQ,KAAM,IAGzC,EAAKoD,UAAS,SAAAiZ,GACb,IAAIihB,EAAU,eAAQjhB,EAAWvD,QAGjC,cAFOwkB,EAAU,YAEV,CACNxkB,OAAQwkB,EACRr6B,OAAO,2BACHoZ,EAAWpZ,QADT,IAELiS,OAAO,2BACL3X,EAAM,IACJ8e,EAAWpZ,OAAOiS,QAAU,eAjCnC,EAAK9R,UAAS,SAAAiZ,GAAU,MAAK,CAC5BvD,OAAO,2BACHuD,EAAWvD,QADT,IAEL0kB,YAAa7/B,IAAKC,EAAE,2CAhIL,EAyKnB6/B,WAAa,SAACl5B,EAAQhH,GACrB,IAAI0N,EAAK,eAAQ,EAAKjI,MAAMC,OAAOiS,QAC/BwoB,GAAS,EACTC,EAAcvwB,OAAOC,KAAKpC,GAAOiE,MAAK,SAACd,EAAGC,GAE7C,OAAKqvB,IAAuB,OAAXn5B,GAAmB8J,IAAM9Q,GAAoB,SAAXgH,GAAqB6J,IAAM7Q,IAC7EmgC,GAAS,EACF,GAGD,KAGJE,EAAe,GACnBD,EAAYl9B,KAAI,SAAAlD,GAAG,OAAIqgC,EAAargC,GAAO0N,EAAM1N,MAEjD,EAAK6F,UAAS,SAAA0S,GAAS,MAAK,CAC3B7S,OAAO,2BACH6S,EAAU7S,QADR,IAELiS,OAAQ0oB,SA5LQ,EAoMnBC,aAAe,SAAAtgC,GAEd,EAAK6F,UAAS,SAAAiZ,GACb,IAAIyhB,EAAU,eAAQzhB,EAAWpZ,QAGjC,cAFO66B,EAAW5oB,OAAO3X,GAElB,CACN0F,OAAQ66B,OAxMV,EAAK96B,MAAQ,CACZC,OAAQ,EAAKxH,MAAMwH,OACnB6V,OAAQ,IAIJ,EAAK9V,MAAMC,OAAOzB,OACtB,EAAKwB,MAAM8V,OAAO,eAAiBnb,IAAKC,EAAE,qBAEtC,EAAKoF,MAAMC,OAAO/E,UAAY,EAAK8E,MAAMC,OAAO/E,QAAQ+vB,OAAU,EAAKjrB,MAAMC,OAAO/E,QAAQ+vB,OAAoD,IAA3C,EAAKjrB,MAAMC,OAAO/E,QAAQ+vB,MAAM/lB,UACzI,EAAKlF,MAAM8V,OAAO,iBAAmBnb,IAAKC,EAAE,uBAI7C,EAAKS,SAAW,EAAK5C,MAAM4C,SAC3B,EAAK6tB,SAAW,EAAKzwB,MAAMwH,OAAOpG,GAClC,EAAKigC,YAAc,GACnB,EAAKU,YAAc,GApBD,E,8DAmNDx6B,GAAQ,IAAD,OAChB/G,EAAY0H,KAAKlI,MAAjBQ,QAEFiZ,EAAS9H,OAAOC,KAAKqvB,GAAej8B,KAAI,SAAAlD,GAC7C,IC/Q6BwgC,ED+QvB/Z,EAAI0Y,EAAcn/B,GACxB,OACC,kBAACygC,EAAOrqB,aAAR,CAAqBlH,QAAS,EAAGlP,IAAK,UAAYyF,EAAMzF,IAAM,IAAMA,GACnE,kBAACygC,EAAO//B,KAAR,CACCqB,WAAY0kB,EACZnnB,GAAI,UAAYmG,EAAMzF,IAAM,IAAMA,EAClCmB,QAAQ,EACRH,MAAOylB,EAAEzlB,QCtRiBw/B,EDsRAxgC,ECrR1BwgC,EAIEA,EAAItU,OAAO,GAAGC,cAAgBqU,EAAIptB,MAAM,GAHvC,IDqRH1R,IAAM+D,EAAMzF,IAA8B,kBAAfyF,EAAMzF,GAA0CyF,EAAMzF,GAAK+wB,MAAQzgB,KAAKC,UAAU9K,EAAMzF,IAA7DyF,EAAMzF,IAAQ,GACpEc,SAAU,EAAK++B,UACfz9B,WAAgEuB,IAAzD,EAAK8B,MAAM8V,OAAO,UAAY9V,EAAMzF,IAAM,IAAMA,UAO3D,OACC,kBAAC0H,EAAA,EAAD,CAAU1H,IAAK,uBAAyByF,EAAMzF,IAAKzB,OAAK,EAACkJ,SAAO,GAC9DhC,EAAMzF,KACP,kBAAC8H,EAAA,EAAD,CAAcpJ,QAAS,CAAEM,KAAMN,EAAQgiC,gBACtC,kBAACtzB,EAAA,EAAD,CAAY/L,KAAK,QAAQhC,QAAS,kBAAM,EAAK6gC,WAAW,KAAMz6B,EAAMzF,OACnE,kBAAC,IAAD,OAED,kBAACoN,EAAA,EAAD,CAAY/L,KAAK,QAAQhC,QAAS,kBAAM,EAAK6gC,WAAW,OAAQz6B,EAAMzF,OACrE,kBAAC,IAAD,OAED,kBAACoN,EAAA,EAAD,CAAY/L,KAAK,QAAQhC,QAAS,kBAAM,EAAKihC,aAAa76B,EAAMzF,MAAMC,MAAO,CAAE2E,UAAW,KACzF,kBAAC,IAAD,QAIF,kBAACoB,EAAA,EAAD,CAAc/G,mBAAiB,GAC9B,yBAAKgB,MAAO,CAAE00B,cAAe,IAAK,gCAASlvB,EAAMzF,MACjD,kBAACygC,EAAOtqB,SAAR,CAAiBD,WAAS,GACxByB,O,yCAUaA,GAAS,IAAD,OAClBjZ,EAAY0H,KAAKlI,MAAjBQ,QAEFiiC,EAAiB9wB,OAAOC,KAAK6H,GAAU,IAAIzU,KAAI,SAAAsC,GACpD,IAAIC,EAAQkS,EAAOnS,GAEnB,OADAC,EAAyB,kBAAVA,EAAqB,CAAE,MAASA,GAAUA,EAClD,EAAKm7B,kBAAL,2BAA4Bn7B,GAA5B,IAAmCzF,IAAKwF,QAGhD,OACC,oCACC,kBAACuE,EAAA,EAAD,CAAMrL,QAAS,CAAEM,KAAMN,EAAQG,WAAaN,OAAK,GAChD,kBAACmJ,EAAA,EAAD,CAAU1H,IAAK,0BAA2BzB,OAAK,EAACkJ,SAAO,GACtD,kBAACK,EAAA,EAAD,KACC,kBAACsF,EAAA,EAAD,CAAY/L,KAAK,QAAQD,UAAQ,GAChC,kBAAC,IAAD,QAIF,kBAAC4E,EAAA,EAAD,CAAc/G,mBAAiB,GAC9B,kBAACwhC,EAAO//B,KAAR,CAAapB,GAAI,aAAcwB,SAAU,SAAC5C,EAAOuhB,GAAR,OAAkB,EAAKwgB,YAAcxgB,GAAOte,QAAQ,EAAMH,MAAM,UAAUU,IAAK0E,KAAK65B,cAC7H,kBAACQ,EAAO/2B,OAAR,CACC1I,MAAOZ,IAAKC,EAAE,iBACdhB,QAAS+G,KAAK45B,YAGd55B,KAAKX,MAAM8V,OAAX,aAAoC,KAItColB,M,yCAUc3P,EAAQ9uB,GAEtBc,MAAMC,QAAQf,GACjBA,EAAQA,EAAMkB,KAAK,KAEM,kBAAVlB,IACfA,EAAQoO,KAAKC,UAAUrO,IAGxB,IAAM62B,EAAM0H,EAAOzP,EAAO/vB,MAAQ,QAClC,OACC,kBAACyG,EAAA,EAAD,CAAU1H,IAAK,uBAAyBgxB,EAAO6P,UAAWp5B,SAAO,GAChE,kBAACzB,EAAA,EAAD,CACCiC,QAAS+oB,EAAO6P,UAChB14B,UAAW/H,IAAKC,EAAE2wB,EAAOhwB,OAAS,MAGnC,kBAACmF,EAAA,EAAD,KACC,kBAAC4yB,EAAD,eACC/4B,IAAK,WAAagxB,EAAO6P,UACzBvhC,GAAI,WAAa0xB,EAAO6P,UAExBn/B,IAAKQ,EACLpB,SAAUsF,KAAKy5B,WACX7O,S,0CAWWrwB,GAAU,IAAD,OACpBjC,EAAY0H,KAAKlI,MAAjBQ,QACFoiC,EAAkBjxB,OAAOC,KAAKixB,GAAepvB,OAAOzO,KAAI,SAAA8tB,GAE7D,MAAe,UAAXA,EACI,KAGD,EAAKgQ,mBAAL,2BAA6BD,EAAc/P,IAA3C,IAAoD6P,UAAW7P,IAAUrwB,EAAQqwB,IAAW,OAGpG,OACC,kBAACjnB,EAAA,EAAD,CAAMrL,QAAS,CAAEM,KAAMN,EAAQG,WAAaN,OAAK,GAC/CuiC,K,+BAQM,IAAD,OACApiC,EAAY0H,KAAKlI,MAAjBQ,QAER,GAA0B,OAAtB0H,KAAKX,MAAMC,OACd,OAAO,KAGR,IAAMiS,EAASvR,KAAK66B,mBAAmB76B,KAAKX,MAAMC,OAAOiS,QACnDhX,EAAUyF,KAAK86B,oBAAoB96B,KAAKX,MAAMC,OAAO/E,SAE3D,OACC,kBAACtD,EAAA,EAAD,CACCc,OAAQiC,IAAKC,EAAE,wBACf/B,QAAS,CACR,kBAACg5B,EAAA,EAAD,CAAMt3B,IAAI,UAAUE,WAAS,GAC5B,kBAACo3B,EAAA,EAAD,CAAMn3B,MAAI,EAACqW,GAAI,GACd,kBAAC9M,EAAA,EAAD,CAAQ1J,IAAI,gBAAgBX,QAAS,kBAAM,EAAKugC,iBAAiB1iC,MAAM,YAAYywB,UAAW,kBAAC,IAAD,OAC5FvtB,IAAKC,EAAE,mBAGV,kBAACi3B,EAAA,EAAD,CAAMn3B,MAAI,EAACqW,GAAI,EAAGtX,UAAWR,EAAQyiC,YACpC,kBAACz3B,EAAA,EAAD,CAAQ1J,IAAI,gBAAgBX,QAAS,kBAAM,EAAKnB,MAAME,WAAWlB,MAAM,aACrEkD,IAAKC,EAAE,WAET,kBAACqJ,EAAA,EAAD,CAAQ1J,IAAI,cAAcX,QAAS,kBAAM,EAAKggC,SAASniC,MAAM,UAAUkE,SAAUyO,OAAOC,KAAK1J,KAAKX,MAAM8V,QAAQ5Q,OAAS,GACvHvK,IAAKC,EAAE,aAMZ9B,OAAK,EACLO,SAAS,KACTD,WAAW,EAEXE,KAA4B,OAAtBqH,KAAKX,MAAMC,OACjBtH,QAAS,kBAAM,EAAKF,MAAME,YAG1B,kBAACqiC,EAAOtqB,SAAR,CAAiBnV,MAAOZ,IAAKC,EAAE,YAC9B,kBAACogC,EAAOrqB,aAAR,CAAqBlH,QAAS,GAC7B,kBAACuxB,EAAO//B,KAAR,CACCV,IAAI,cACJV,GAAG,cACHkC,WAAS,EACTT,UAAQ,EACRqB,WAA4CuB,IAArCyC,KAAKX,MAAM8V,OAAO,eAEzBva,MAAOZ,IAAKC,EAAE,UACdqB,IAAK0E,KAAKX,MAAMC,OAAOzB,KACvBnD,SAAUsF,KAAKy5B,aAIjB,kBAACY,EAAOrqB,aAAR,CAAqBlH,QAAS,GAC7B,kBAACuxB,EAAO//B,KAAR,CACCV,IAAI,uBACJV,GAAG,uBAEH0B,MAAOZ,IAAKC,EAAE,kBACdqB,IAAM0E,KAAKX,MAAMC,OAAO/E,SAAWyF,KAAKX,MAAMC,OAAO/E,QAAQK,OAAU,GACvEF,SAAUsF,KAAKy5B,aAIjB,kBAACY,EAAOrqB,aAAR,CAAqBlH,QAAS,GAC7B,kBAACuxB,EAAOvB,OAAR,CACCl/B,IAAI,kBACJV,GAAG,kBAEH0B,MAAOZ,IAAKC,EAAE,YACdqB,IAAK0E,KAAKX,MAAMC,OAAOke,SACvB2L,UAAW1f,OAAOC,KAAKsxB,KAAWzvB,OAAOzO,KAAI,SAAAm+B,GAAI,MAAa,aAATA,EAAA,eAA0BA,EAAOjhC,IAAKC,EAAEghC,IAAY,CAAE,MAASjhC,IAAKC,EAAE,aAC3HS,SAAUsF,KAAKy5B,aAIjB,kBAACY,EAAOrqB,aAAR,KACC,kBAACqqB,EAAOxB,WAAR,CACCl/B,MAAM,OACNT,GAAG,gBACHyB,UAAQ,EACRqB,WAA8CuB,IAAvCyC,KAAKX,MAAM8V,OAAO,iBAEzBja,YAAalB,IAAKC,EAAE,UACpBqB,IAAM0E,KAAKX,MAAMC,OAAO/E,SAAWyF,KAAKX,MAAMC,OAAO/E,QAAQ+vB,OAAStqB,KAAKX,MAAMC,OAAO/E,QAAQ+vB,MAAMxtB,KAAI,SAAAwtB,GAAK,MAAK,CAAEpxB,GAAIoxB,EAAMluB,cAAeyB,KAAMysB,OAAc,GAEnK/vB,QAAS8tB,IAAQ6S,eACjBxrB,UAAU,OAEVhV,SAAU,SAAC5C,EAAOuhB,GAAR,OAAkB,EAAKogB,UAAU3hC,EAAOuhB,EAAMvc,KAAI,SAAAY,GAAM,OAAIA,EAAOG,cAOhF,kBAACw8B,EAAOtqB,SAAR,CAAiBnV,MAAOZ,IAAKC,EAAE,WAC7BsX,GAGF,kBAAC8oB,EAAOtqB,SAAR,CAAiBnV,MAAOZ,IAAKC,EAAE,YAC7BM,Q,GA5cqBsF,IAAMsC,WAodlBpD,gBAveA,SAAAvI,GAAK,MAAK,CACxBiC,UAAW,CACVkB,MAAO,QAER2gC,cAAe,CACd53B,cAAe,SACf0X,WAAY,UAEb2gB,WAAY,CACX1hC,QAAS,OACTghB,eAAgB,WAEhB,yBAA0B,CACzB/gB,WAAY,OA0dAyF,CAAmBi6B,GE3d5BA,G,kDAEL,WAAYlhC,GAAQ,IAAD,8BAClB,cAAMA,IAaPqjC,aAAe,SAAA33B,GACd,EAAKA,QAAUA,EACf,EAAK1L,MAAM4C,UAAY,EAAK5C,MAAM4C,SAAS8I,IAhBzB,EAsBnB43B,YAAc,SAAA97B,GACb,EAAK67B,aAAL,2BAAuB,EAAK33B,SAA5B,kBAAsClE,EAAOpG,GAAKoG,KAElD,EAAKG,SAAS,CAAE47B,eAAgB,KAAMlmB,OAAQ,KAAM,kBAAM6P,SAASE,eAAe,iBAAiBoW,UAAatW,SAASE,eAAe,UAAY5lB,EAAOpG,KAAO8rB,SAASE,eAAe,UAAY5lB,EAAOpG,IAAIu2B,WAAc,MAzB7M,EA+BnB+J,cAAgB,SAAAjR,GACf,IAAIgT,EAAW,eAAQ,EAAK/3B,gBACrB+3B,EAAYhT,GACnB,EAAK4S,aAAaI,GAElB,EAAK97B,SAAS,CAAE47B,eAAgB,KAAMlmB,OAAQ,MAjC9C,EAAK9V,MAAQ,CACZg8B,eAAgB,KAChBlmB,OAAQ,IAGT,EAAK3R,QAAU6kB,IAAQkL,WAAW,CAAEzK,KAAK,EAAMC,MAAM,IARnC,E,0DA0CLjxB,GAAQ,IAAD,OACZiR,EAAejR,EAAfiR,WAER,OACC,kBAACyD,EAAA,EAAD,KAECzD,EAAWjM,KAAI,SAACwC,EAAQ8J,GACxB,IAAI7O,EAAUkP,OAAOC,KAAKpK,EAAO/E,SAAW,IAAIo5B,QAAO,SAAAjkB,GAAS,OAAsQ,KAAnP,UAAdA,GAAuD,KAA9BpQ,EAAO/E,QAAQmV,IAAsB9S,MAAMC,QAAQyC,EAAO/E,QAAQmV,KAAoD,IAArCpQ,EAAO/E,QAAQmV,GAAWnL,QAAuD,kBAA9BjF,EAAO/E,QAAQmV,IAA6E,IAAlDjG,OAAOC,KAAKpK,EAAO/E,QAAQmV,IAAYnL,WAA0BgH,OAAOvO,KAAK,MACrVrB,EAAa8N,OAAOC,KAAKpK,EAAO3D,YAAc,IAAI4P,OAAOvO,KAAK,MAC9DstB,EAAShrB,EAAO/E,SAAW+E,EAAO/E,QAAQ+vB,OAAShrB,EAAO/E,QAAQ+vB,MAAMttB,KAAK,OAAU,GAE3F,OACA,kBAAC0K,EAAA,EAAD,CAAU9N,IAAK,YAAcwP,EAAOlQ,GAAI,UAAYoG,EAAOpG,GAAIyQ,OAAK,EAACG,UAAW,GAC/E,kBAACnC,EAAA,EAAD,CAAWxQ,QAAQ,WAAW6S,MAAM,MAAM/B,MAAM,UAC/C,kBAACjB,EAAA,EAAD,CAAY/N,QAAS,kBAAM,EAAKwG,SAAS,CAAE47B,eAAgB/7B,EAAOpG,OACjE,kBAAC,IAAD,QAGF,kBAACyO,EAAA,EAAD,KAAarI,EAAO/E,SAAW+E,EAAO/E,QAAQK,OAAU0E,EAAOzB,MAC/D,kBAAC8J,EAAA,EAAD,KAAYrI,EAAOke,UACnB,kBAAC7V,EAAA,EAAD,KAAY2iB,GACZ,kBAAC3iB,EAAA,EAAD,KAAY8B,OAAOC,KAAKpK,EAAOiS,QAAU,IAAIvU,KAAK,OAClD,kBAAC2K,EAAA,EAAD,KAAYpN,EAAQgK,OAAS,GAAKhK,EAAQyK,OAAO,EAAE,IAAM,MAAQzK,GACjE,kBAACoN,EAAA,EAAD,KAAYhM,EAAW4I,OAAS,GAAK5I,EAAWqJ,OAAO,EAAE,IAAM,MAAQrJ,U,+BAajE,IAAD,OACR,OAEF,kBAAC,IAAMyF,SAAP,KACC,kBAACyH,EAAA,EAAD,CACCxO,MAAOL,IAAKC,EAAE,gBACdiN,UAAW,CACV,CAAEhO,GAAI,OAAQS,MAAO,KAAMuO,gBAAgB,EAAMtN,MAAO,IACxD,CAAE1B,GAAI,OAAQS,MAAO,MAAOiB,MAAOZ,IAAKC,EAAE,SAC1C,CAAEf,GAAI,WAAYS,MAAO,KAAMiB,MAAOZ,IAAKC,EAAE,aAC7C,CAAEf,GAAI,QAASqO,QAAS,gBAAiB5N,MAAO,KAAMiB,MAAOZ,IAAKC,EAAE,UACpE,CAAEf,GAAI,SAAUS,MAAO,MAAOuO,gBAAgB,EAAOtN,MAAOZ,IAAKC,EAAE,WACnE,CAAEf,GAAI,UAAWS,MAAO,MAAOuO,gBAAgB,EAAOtN,MAAOZ,IAAKC,EAAE,YACpE,CAAEf,GAAI,aAAcS,MAAO,MAAOuO,gBAAgB,EAAOtN,MAAOZ,IAAKC,EAAE,gBAExEsC,KAAMkN,OAAOgP,OAAOzY,KAAKwD,SAEzBoI,eAAe,OACfxE,YAAY,EACZC,UAAU,EACVwF,cAAY,EAEZrB,gBAAiB,SAAA1T,GAAK,OAAI,EAAK0jC,cAAc1jC,IAC7CkU,yBACC,kBAACquB,EAAO/2B,OAAR,CACCrK,QAAS,kBAAM,EAAKwG,SAAS,CAAE47B,eAAgB,UAC/C9T,UAAW,kBAAC,IAAD,MACXvsB,SAAwC,OAA9BgF,KAAKX,MAAMg8B,eACrBzgC,MAAOZ,IAAKC,EAAE,sBAKhB+F,KAAKX,MAAMg8B,gBAAkB,kBAACI,GAAD,CACtBn8B,OAAsC,SAA9BU,KAAKX,MAAMg8B,eAA4B,CAAEniC,GAAIwiC,cAAQnqB,OAAQ,GAAIhX,QAAS,IAAOyF,KAAKwD,QAAQxD,KAAKX,MAAMg8B,gBACjH9B,OAAQv5B,KAAKo7B,YACb/rB,SAAUrP,KAAKw5B,cACfxhC,QAAS,kBAAM,EAAKyH,SAAS,CAAE47B,eAAgB,gB,GArH7Bx7B,IAAMsC,WA8HlBpD,gBAnJA,SAAAvI,GAAK,MAAK,CACxBmlC,aAAc,CACbn9B,UAAW,QAEZo9B,GAAI,CACHhkC,OAAQ,YAETikC,gBAAiB,CAChBliC,MAAO,KAERrC,kBAAmB,CAClBH,QAAS,EACToC,YAAa,QAEdoO,UAAW,CACVm0B,cAAe,MACf3kC,QAAS,YAmII4H,CAAmBi6B,I,kBC3KnB,IACd,eAAkB,CACjBp+B,MAAO,CACN,GAAM,wCACN,GAAM,qCAEPnB,KAAM,CACL,GAAM,kDACN,GAAM,+CAEPoB,KAAM,SACNS,KAAK,GAEN,QAAW,CACVV,MAAO,CACN,GAAM,WACN,GAAM,YAEPC,KAAM,QAEP,SAAY,CACXD,MAAO,CACN,GAAM,YACN,GAAM,aAEPC,KAAM,QAEP,cAAiB,CAChBD,MAAO,CACN,GAAM,mBACN,GAAM,kBAEPnB,KAAM,CACL,GAAM,4GACN,GAAM,mGAEPoB,KAAM,SACNS,KAAK,GAEN,UAAa,CACZV,MAAO,CACN,GAAM,iBACN,GAAM,qBAEPC,KAAM,OACNS,IAAK,IAEN,UAAa,CACZV,MAAO,CACN,GAAM,SACN,GAAM,SAEPC,KAAM,OACNS,IAAK,IAEN,YAAe,CACdV,MAAO,CACN,GAAM,+BACN,GAAM,0BAEPC,KAAM,OACNS,IAAK,YACLf,QAASkP,OAAOC,KAAKqyB,OAEtB,WAAc,CACbnhC,MAAO,CACN,GAAM,uBACN,GAAM,2BAEPC,KAAM,OACNS,IAAK,IAEN,UAAa,CACZV,MAAO,CACN,GAAM,sBACN,GAAM,0BAEPC,KAAM,OACNS,IAAK,QAEN,eAAkB,CACjBV,MAAO,CACN,GAAM,4BACN,GAAM,gCAEPC,KAAM,OACNS,IAAK,iF,0CCjBD0gC,G,kDAEL,WAAYlkC,GAAQ,IAAD,8BAClB,cAAMA,IAqBP2hC,UAAY,SAAC3hC,EAAOwD,GAEnB,GAAIxD,EAAM6C,WAAaW,EAQtB,OAPA,EAAKmE,UAAS,SAAAiZ,GAAU,MAAK,CAC5BvD,OAAO,2BACHuD,EAAWvD,QADT,kBAEJrd,EAAMoB,GAAKc,IAAKC,EAAE,yBAId,EAGJ,EAAKoF,MAAM8V,OAAOrd,EAAMoB,KAC3B,EAAKuG,UAAS,SAAAiZ,GACb,IAAIihB,EAAU,eAAQjhB,EAAWvD,QAAU,IAE3C,cADOwkB,EAAW7hC,EAAMoB,IACjB,CAAEic,OAAQwkB,MAInB,EAAKR,YAAYrhC,EAAMoB,IAAMoC,GA3CX,EAiDnB2gC,WAAa,SAACC,EAAQC,GAErB,EAAK18B,UAAS,SAAA0S,GAAS,MAAK,CAC3BqhB,OAAO,2BACHrhB,EAAUqhB,QADR,kBAEJ0I,EAFI,2BAGD/pB,EAAUqhB,OAAO0I,IAHhB,kBAIHC,EAAY,WAGZ,kBAAM,EAAKrkC,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,cA3D1C,EAiEnB04B,QAAU,WACT,IAAMC,EAAc5yB,OAAOC,KAAK,EAAKrK,MAAMm0B,QAAQjvB,OAAO,EAC1D,EAAK9E,UAAS,SAAA0S,GAAS,MAAK,CAC3BqhB,OAAO,2BACHrhB,EAAUqhB,QADR,kBAEJ,QAAUx5B,IAAKC,EAAE,WAAa,IAAMoiC,EAAc,CAClDC,EAAG,UAGF,kBAAM,EAAKxkC,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,aAE5DiU,YAAW,kBAAMyW,OAAOnf,SAAW,QAAUotB,IAAa,MA5ExC,EAkFnBE,WAAa,SAAAL,GAAM,OAAI,WAAS1V,GAAe,IAArBttB,EAAoB,EAApBA,GAGzB,GAAW,YAAPA,GAA2B,aAAPA,EAAmB,OAGpBgjC,EAAO53B,MAAM,KAHO,mBAGpC7I,EAHoC,KAG9Bb,EAH8B,KAI/B,YAAP1B,EACHuC,EAAO+qB,EAEQ,aAAPttB,IACR0B,EAAQ4rB,GAGT,IAAIgN,EAAS,GACb/pB,OAAOC,KAAK,EAAKrK,MAAMm0B,QAAQtwB,SAAQ,SAAAs5B,GACtChJ,EAAOgJ,IAASN,EAASzgC,EAAO,IAAMb,EAAQ4hC,GAAQ,EAAKn9B,MAAMm0B,OAAOgJ,MAGzE,EAAK/8B,SAAS,CAAE+zB,OAAQA,IAAU,kBAAM,EAAK17B,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,kBAItF,GAAW,kBAAPxK,EAAwB,CAChC,IAAIujC,EAAO,eAAQ,EAAKp9B,MAAMm0B,OAAO0I,KAEnB,IAAd1V,EACH,EAAK/mB,UAAS,SAAA0S,GAAS,MAAK,CAC3BqhB,OAAO,2BACHrhB,EAAUqhB,QADR,kBAEJ0I,EAASO,EAAQ,SAGhB,kBAAM,EAAK3kC,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,aAG5D,EAAKjE,UAAS,SAAA0S,GAAS,MAAK,CAC3BqhB,OAAO,2BACHrhB,EAAUqhB,QADR,kBAEJ0I,EAAS,CACTI,EAAGG,SAIF,kBAAM,EAAK3kC,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,gBA9H5C,EAsInBg5B,YAAc,SAAA97B,GAEb,GAAe,WAAXA,EAEH,OADA,EAAKnB,SAAS,CAAEk9B,OAAO,KAChB,EAEH,GAAe,SAAX/7B,EAAmB,CAE3B,IAAIs7B,EAAS,EAAK78B,MAAM0vB,YACpB6N,EAAY,EAAKv9B,MAAMw9B,eACvBC,EAAW,EAAKz9B,MAAM09B,cAAcnjC,IAIpCub,EAAS,GAMb,GAJA,UAHuB,CAAC,CAAEslB,UAAW,MAAO9/B,UAAU,GAAQ,CAAE8/B,UAAW,YAAa9/B,UAAU,IAGlG,aAAyBqiC,KAAqB,EAAK39B,MAAM09B,cAAcnjC,MAAQ,KAAMsJ,SAAQ,SAAA+5B,GAC5F9nB,EAAO,eAAiB8nB,EAAMxC,YAAgC,IAAnBwC,EAAMtiC,WAAsB,EAAKw+B,YAAY,eAAiB8D,EAAMxC,cAG5GhxB,OAAOgP,OAAOtD,GAAQ9Q,SAAQ,IAAS,EAG1C,OAFA,EAAK5E,UAAS,SAAA0S,GAAS,MAAK,CAAEgD,OAAO,2BAAMhD,EAAUgD,QAAWA,OAChEnP,QAAQhK,MAAMmZ,EAAQ,EAAKgkB,cACpB,EAGR,IAAI7O,EAAQ,GAKZ,GAJA7gB,OAAOC,KAAK,EAAKyvB,aAAaj2B,SAAQ,SAAAtJ,GAAG,OAAI0wB,EAAM1wB,EAAIyC,QAAQ,eAAgB,KAAO,EAAK88B,YAAYv/B,MACvG0wB,EAAM1wB,IAAM0wB,EAAM1wB,IAAIwC,cAAcC,QAAQ,KAAM,IAG9CygC,EAAU,CAGb,IADA,IAAII,EAAY,GACPC,EAAM,EAAGA,EAAM1zB,OAAOC,KAAK,EAAKrK,MAAMm0B,OAAO0I,IAAS33B,OAAQ44B,IACtED,EAAUC,GAAO,EAAK99B,MAAMm0B,OAAO0I,GAAQiB,GAAOP,EAAYO,EAAI,EAAIA,GAGvE,IAAIC,EAAkB,GACtB3zB,OAAOC,KAAK,EAAKrK,MAAMm0B,OAAO0I,GAAQU,IAAY15B,SAAQ,SAAAm6B,GAErDA,IAAiBP,EACpBM,EAAgB9S,EAAM1wB,KAAtB,2BAAkC,EAAKyF,MAAMm0B,OAAO0I,GAAQU,GAAWS,IAAkB/S,GAGzF8S,EAAgBC,GAAgB,EAAKh+B,MAAMm0B,OAAO0I,GAAQU,GAAWS,aAIhED,EAAgB9S,EAAM1wB,KAAKA,IAClC,EAAK6F,UAAS,SAAA0S,GAAS,MAAK,CAC3BwqB,OAAO,EACPnJ,OAAO,2BACHrhB,EAAUqhB,QADR,kBAEJ0I,EAFI,2BAGD/pB,EAAUqhB,OAAO0I,IAHhB,kBAIHU,EAAYQ,UAIZ,kBAAM,EAAKtlC,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,kBAM5D,EAAKjE,UAAS,SAAA0S,GAAS,MAAK,CAC3BwqB,OAAO,EACPnJ,OAAO,2BACHrhB,EAAUqhB,QADR,kBAEJ0I,EAFI,2BAGD/pB,EAAUqhB,OAAO0I,IAHhB,kBAIHU,EAJG,2BAKAzqB,EAAUqhB,OAAO0I,GAAQU,IALzB,kBAMFtS,EAAM1wB,IAAM0wB,YAIb,kBAAM,EAAKxyB,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,eApN5C,EA4NnB45B,cAAgB,SAACpB,EAAQU,GAGxB,IADA,IAAIM,EAAY,GACPC,EAAM,EAAGA,EAAM1zB,OAAOC,KAAK,EAAKrK,MAAMm0B,OAAO0I,IAAS33B,OAAQ44B,IACtED,EAAUC,GAAO,EAAK99B,MAAMm0B,OAAO0I,GAAQiB,GAAOP,EAAYO,EAAI,EAAIA,GAGvE,EAAK19B,UAAS,SAAA0S,GAAS,MAAK,CAC3BqhB,OAAO,2BACHrhB,EAAUqhB,QADR,kBAEJ0I,EAASgB,SAtOM,EA8OnBK,aAAe,SAACrB,EAAQU,EAAWE,GAElC,IAAItJ,EAAM,eAAQ,EAAKn0B,MAAMm0B,OAAO0I,GAAQU,WACrCpJ,EAAOsJ,GAEd,EAAKr9B,UAAS,SAAA0S,GAAS,MAAK,CAC3BwqB,OAAO,EACPnJ,OAAO,2BACHrhB,EAAUqhB,QADR,kBAEJ0I,EAFI,2BAGD/pB,EAAUqhB,OAAO0I,IAHhB,kBAIHU,EAAYpJ,UAGZ,kBAAM,EAAK17B,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,cA5P1C,EAkQnB85B,WAAa,SAAAtB,GAEZ,IAAI1I,EAAM,eAAQ,EAAKn0B,MAAMm0B,eACtBA,EAAO0I,GAEd,EAAKz8B,SAAS,CAAE+zB,OAAQA,IAAU,kBAAM,EAAK17B,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,cAvQxE,EA6QnB+5B,WAAa,SAAC78B,EAAQs7B,EAAQU,EAAWS,GAA5B,OAA6C,SAAA70B,GACzDA,EAAMk1B,kBAEN,IAAIp2B,EAAK,eAAQ,EAAKjI,MAAMm0B,OAAO0I,GAAQU,IACvC7C,GAAS,EACTC,EAAcvwB,OAAOC,KAAKpC,GAAOiE,MAAK,SAACd,EAAGC,GAE7C,OAAKqvB,IAAuB,OAAXn5B,GAAmB8J,IAAM2yB,GAA6B,SAAXz8B,GAAqB6J,IAAM4yB,IACtFtD,GAAS,EACF,GAGD,KAGJE,EAAe,GACnBD,EAAYl9B,KAAI,SAAAlD,GAAG,OAAIqgC,EAAargC,GAAO0N,EAAM1N,MAEjD,EAAK6F,UAAS,SAAA0S,GAAS,MAAK,CAC3BqhB,OAAO,2BACHrhB,EAAUqhB,QADR,kBAEJ0I,EAFI,2BAGD/pB,EAAUqhB,OAAO0I,IAHhB,kBAIHU,EAAY3C,UAGZ,kBAAM,EAAKniC,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,eAvS1C,EA6SnBi6B,SAAW,SAAC/8B,EAAQs7B,GAAT,OAAoB,SAAA1zB,GAC9BA,EAAMk1B,kBAEN,IAAIp2B,EAAK,eAAQ,EAAKjI,MAAMm0B,QACxBuG,GAAS,EACTC,EAAcvwB,OAAOC,KAAKpC,GAAOiE,MAAK,SAACd,EAAGC,GAE7C,OAAKqvB,IAAuB,OAAXn5B,GAAmB8J,IAAMwxB,GAAuB,SAAXt7B,GAAqB6J,IAAMyxB,IAChFnC,GAAS,EACF,GAGD,KAGJE,EAAe,GACnBD,EAAYl9B,KAAI,SAAAlD,GAAG,OAAIqgC,EAAargC,GAAO0N,EAAM1N,MACjD,EAAK6F,UAAS,SAAA0S,GAAS,MAAK,CAAEqhB,OAAQyG,MAAiB,kBAAM,EAAKniC,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAAQ,EAAKn0B,MAAMqE,eA9T7F,EAoUnBk6B,WAAa,SAAC1B,EAAQU,EAAWtS,GAEhC,IAAI/Y,EAAS,GACb9H,OAAOC,KAAK4gB,GAAS,IAAIxtB,KAAI,SAAAlD,GAAG,OAAI2X,EAAO,eAAiB3X,GAAO0wB,EAAM1wB,IAAQ,MACjF,EAAKu/B,YAAc5nB,EAEnB,EAAK9R,SAAL,2BACI8R,GADJ,IAECorB,OAAO,EACPxnB,OAAQ,GAER4Z,YAAamN,EACbW,eAAgBD,EAChBG,cAAezS,GAAS,OA9UzB,EAAKjrB,MAAQ,CACZs9B,OAAO,EAEP5N,YAAa,KACb8N,eAAgB,KAChBE,cAAe,GAEfvJ,OAAQ,EAAK17B,MAAM07B,OACnB9vB,SAAU,EAAK5L,MAAM4L,SACrByR,OAAQ,IAGT,EAAK0oB,SAAWxV,IAAQ6S,eACxB,EAAK/B,YAAc,GAhBD,E,iEAwVEjK,EAAKnlB,EAAQugB,GAAQ,IAAD,OAChChyB,EAAY0H,KAAKlI,MAAjBQ,QAER,OAEF,kBAACgJ,EAAA,EAAD,CACC1H,IAAK,OAASs1B,EAAIt1B,IAAM,WAAamQ,EAAOnQ,IAAM,cAAgB0wB,EAAM1wB,IACxEX,QAAS,kBAAM,EAAK2kC,WAAW1O,EAAIt1B,IAAKmQ,EAAOnQ,IAAK0wB,IACpD9oB,QAAM,EACNH,SAAO,GAGN6tB,EAAIN,WACL,kBAACltB,EAAA,EAAD,CAAcpJ,QAAS,CAAEM,KAAMN,EAAQgiC,gBACtC,kBAAC,KAAD,OAGD,kBAAC54B,EAAA,EAAD,CAAcpJ,QAAS,CAAEM,KAAMN,EAAQgiC,gBACtC,kBAAC,IAAMl5B,SAAP,KACC,kBAAC4F,EAAA,EAAD,CAAY/L,KAAK,QAAQhC,QAAS+G,KAAKy9B,WAAW,KAAMvO,EAAIt1B,IAAKmQ,EAAOnQ,IAAK0wB,EAAM1wB,MAClF,kBAAC,IAAD,OAED,kBAACoN,EAAA,EAAD,CAAY/L,KAAK,QAAQhC,QAAS+G,KAAKy9B,WAAW,OAAQvO,EAAIt1B,IAAKmQ,EAAOnQ,IAAK0wB,EAAM1wB,MACpF,kBAAC,IAAD,SAKH,kBAACgG,EAAA,EAAD,CAAciC,QACb,kBAAC,IAAMT,SAAP,KACC,kBAAC0F,EAAA,EAAD,CAAYzN,QAAQ,SAASixB,EAAM1wB,KACnC,kBAACkN,EAAA,EAAD,CAAY/N,QAAQ,aAApB,IAAkCuxB,EAAMzsB,KAAxC,W,uCAYeqxB,EAAKnlB,GAAS,IAAD,OACrBzR,EAAY0H,KAAKlI,MAAjBQ,QAGJwlC,EAA2B,GAE/B,IAAK,IAAIT,KAAgBtzB,EAAOg0B,QAAS,CACxC,IAAIp9B,EAAS,2BAAQoJ,EAAOg0B,QAAQV,IAAvB,IAAsCzjC,IAAKyjC,EAAcx/B,KAAOkM,EAAOg0B,QAAQV,IAAiBtzB,EAAOg0B,QAAQV,GAAc18B,WAAc0oB,IAAS2U,SACjKF,EAAyBr6B,KAAKzD,KAAKi+B,qBAAqB/O,EAAKnlB,EAAQpJ,IAGtE,OAEF,kBAACuwB,EAAA,EAAD,CAAMp4B,UAAWR,EAAQyR,OAAQnQ,IAAK,OAASs1B,EAAIt1B,IAAM,WAAamQ,EAAOnQ,IAAKG,MAAI,GACrF,kBAAC4J,EAAA,EAAD,KACC,kBAACrC,EAAA,EAAD,CAAUrI,QAAS,kBAAM,EAAKqkC,cAAcpO,EAAIt1B,IAAKmQ,EAAOnQ,MAAM4H,QAAM,EAACH,SAAO,EAAClJ,OAAK,GACrF,kBAACuJ,EAAA,EAAD,CAAcpJ,QAAS,CAAEM,KAAMN,EAAQgiC,gBACtC,kBAACtzB,EAAA,EAAD,CAAY/L,KAAK,SAChB,kBAAC,IAAD,QAGF,kBAAC2E,EAAA,EAAD,CAAciC,QAAS7H,IAAKC,EAAE,sBAE5Bi1B,EAAIN,YAAeM,EAAIN,YAAc7kB,EAAOg0B,QAAQx5B,OAAS,IAAM,kBAACjD,EAAA,EAAD,CAAUrI,QAAS,kBAAM,EAAK2kC,WAAW1O,EAAIt1B,IAAKmQ,EAAOnQ,IAAK,OAAO4H,QAAM,EAACH,SAAO,EAAClJ,OAAK,GAC9J,kBAACuJ,EAAA,EAAD,CAAcpJ,QAAS,CAAEM,KAAMN,EAAQgiC,gBACtC,kBAACtzB,EAAA,EAAD,CAAY/L,KAAK,SAChB,kBAAC,IAAD,QAGF,kBAAC2E,EAAA,EAAD,CAAciC,QAAS7H,IAAKC,EAAE,oBAG9B6jC,O,gCAWQ5O,GAAM,IAAD,OACN52B,EAAY0H,KAAKlI,MAAjBQ,QADM,EAEgB42B,EAAIt1B,IAAI0K,MAAM,KAF9B,mBAEN45B,EAFM,KAEGjK,EAFH,KAGd/E,EAAIN,WAAa9pB,OAAOC,MAAMJ,SAAS8E,OAAOC,KAAKwlB,EAAI6O,SAAS,KAOhE,IAJA,IAAIj1B,EAAUW,OAAOC,KAAKwlB,EAAI6O,SAASx5B,OACnC45B,EAAuBjP,EAAI6O,SAAW7O,EAAI6O,QAAQ,IAAMt0B,OAAOC,KAAKwlB,EAAI6O,QAAQ,IAAIx5B,QAAW,EAC/F65B,EAAkB,GAEbxB,EAAY,EAAGA,EAAY9zB,EAAQ,EAAG8zB,IAAa,CAC3D,IAAI7yB,EAAS,CAAEg0B,aAAqCxgC,IAA3B2xB,EAAI6O,QAAQnB,GAA2B1N,EAAI6O,QAAQnB,GAAa1N,EAAI6O,QAAUnkC,IAAKgjC,GAC5GwB,EAAgB36B,KAAKzD,KAAKq+B,iBAAiBnP,EAAKnlB,IAGjD,OAEF,kBAACzI,EAAA,EAAD,CACCpI,GAAI,OAASg2B,EAAI9lB,MACjB/H,SAAyB,IAAhB6tB,EAAIoP,QAAkB1kC,IAAK,OAASs1B,EAAIt1B,IACjDtB,QAAS,CAAEM,KAAMN,EAAQ42B,MAGzB,kBAACxtB,EAAA,EAAD,CAAc9H,IAAK,OAASs1B,EAAIt1B,IAAM,gBAAiBtB,QAAS,CAAEM,KAAMN,EAAQgiC,gBAC/E,kBAAC,IAAMl5B,SAAP,KACC,kBAAC4F,EAAA,EAAD,CAAY/L,KAAK,QAAQhC,QAAS+G,KAAK29B,SAAS,KAAMzO,EAAIt1B,MACzD,kBAAC,IAAD,OAED,kBAACoN,EAAA,EAAD,CAAY/L,KAAK,QAAQhC,QAAS+G,KAAK29B,SAAS,OAAQzO,EAAIt1B,MAC3D,kBAAC,IAAD,OAED,kBAACoN,EAAA,EAAD,CAAY/L,KAAK,QAAQhC,QAAS,kBAAM,EAAKukC,WAAWtO,EAAIt1B,MAAMtB,QAAS,CAAEM,KAAMN,EAAQqjC,eAC1F,kBAAC,IAAD,SAIH,kBAAC/7B,EAAA,EAAD,CACC/G,mBAAmB,EACnBgJ,QAAS,CACR,kBAACw4B,EAAO//B,KAAR,eACCV,IAAI,gBACJV,GAAG,WACCqlC,GAAcL,QAHnB,CAICxjC,SAAUsF,KAAKu8B,WAAWrN,EAAIt1B,KAC9B0B,IAAK4iC,GAAW,GAChBziC,KAAMyiC,GAAW,MAGlB,kBAAC7D,EAAO//B,KAAR,eACCV,IAAI,iBACJV,GAAG,YACCqlC,GAActK,SAHnB,CAICv5B,SAAUsF,KAAKu8B,WAAWrN,EAAIt1B,KAC9B0B,IAAK24B,GAAY,MAGlB,kBAACoG,EAAO/2B,OAAR,CACC1J,IAAI,uBACJV,GAAG,uBACH0B,MAAM,iBACNI,SAAUk0B,EAAIN,WACd31B,QAAS,kBAAM,EAAKgjC,WAAW/M,EAAIt1B,IAAKkP,EAAQ,MAGjD,kBAACuxB,EAAOjU,OAAR,eACCxsB,IAAI,sBACJV,GAAG,iBACCqlC,GAAcC,cAHnB,CAICxjC,SAAW8N,EAAU,GAAKq1B,EAAsB,EAChDzjC,SAAUsF,KAAKu8B,WAAWrN,EAAIt1B,KAC9B0B,IAAK4zB,EAAIN,cAGV,kBAACsC,EAAA,EAAD,CACCt3B,IAAK,OAASs1B,EAAIt1B,IAAM,mBACxBtB,QAAS,CAAEM,KAAMN,EAAQmmC,iBACzB3kC,WAAS,GAGRskC,U,iCAaO5P,GACV,IAAIU,EAAM,EACNwP,EAAY,GAEVC,EAAYl1B,OAAOC,KAAK8kB,GAAMjqB,OACpC,IAAK,IAAI23B,KAAU1N,EAClBU,IACAwP,EAAUj7B,KAAKzD,KAAK4+B,UAAU,CAAEb,QAASvP,EAAK0N,GAAStiC,IAAKsiC,EAAQ9yB,MAAO8lB,EAAKoP,QAASpP,IAAQyP,KAGlG,OAAOD,I,+BAME,IAAD,OACApmC,EAAY0H,KAAKlI,MAAjBQ,QAEFk2B,EAAOxuB,KAAK6+B,WAAW7+B,KAAKX,MAAMm0B,QACpC5I,EAASoS,KAAqBh9B,KAAKX,MAAM09B,cAAcp8B,WAAa0oB,IAAS2U,QAAQlhC,KAAI,SAAA8tB,GAC5F,IAAMntB,EAAQ48B,EAAOzP,EAAO/vB,MAAQ,QACpC,OACC,kBAACw/B,EAAOrqB,aAAR,CAAqBlH,QAAS,EAAGlP,IAAK,gBAAkBgxB,EAAO6P,WAC9D,kBAACh9B,EAAD,eACC7D,IAAK,eAAiBgxB,EAAO6P,UAC7BvhC,GAAI,eAAiB0xB,EAAO6P,UAC5B7/B,MAAOZ,IAAKC,EAAE2wB,EAAOhwB,OAASgwB,EAAO6P,WACrChhC,KAAMmxB,EAAO7c,aACT6c,EALL,CAMClwB,SAAU,EAAK++B,UACfn+B,IAAK,EAAK+D,MAAM09B,cAAcnS,EAAO6P,YAAc7P,EAAOtvB,YAOxDwjC,EAAW9+B,KAAK69B,SAASlK,QAAO,SAAArJ,GAAK,OAAIA,EAAMpxB,KAAO,EAAKmG,MAAM09B,cAAcnjC,OAC/EmlC,EAAYD,GAAYA,EAAS,IAAMA,EAAS,GAAGjhC,KAEzD,OAEF,kBAAC,IAAMuD,SAAP,KACC,kBAAC49B,EAAA,EAAD,KACC,kBAACr7B,EAAA,EAAD,CAAM7K,UAAWR,EAAQk2B,MACxB,kBAACltB,EAAA,EAAD,CAAUD,SAAO,EAAC/I,QAAS,CAAEM,KAAMN,EAAQ42B,MAC1C,kBAACxtB,EAAA,EAAD,CAAcpJ,QAAS,CAAEM,KAAMN,EAAQgiC,gBACtC,kBAAC,KAAD,OAED,kBAAC16B,EAAA,EAAD,CACC/G,mBAAmB,EACnBgJ,QAAS,CACR,kBAACw4B,EAAO/2B,OAAR,CAAe1J,IAAI,gBAAgBV,GAAG,gBAAgB0B,MAAM,cAAc3B,QAAS,kBAAM,EAAKmjC,aAC9F,kBAAC/B,EAAOjU,OAAR,eACCxsB,IAAI,uBACJV,GAAG,kBACCqlC,GAAcU,eAHnB,CAICvkC,SAAU,SAACxB,EAAIstB,GAAL,OAAmB,EAAK1uB,MAAM4C,SAAS,EAAK2E,MAAMm0B,OAA/B,eAA0Ct6B,EAAKstB,KAC5ElrB,IAAK0E,KAAKX,MAAMqE,SAAX,sBAOR8qB,IAKH,kBAACv3B,EAAA,EAAD,CACCc,OAAQiC,IAAKC,EAAE,uBACf3B,QAAS,CAAET,oBAAqBS,EAAQX,eACxCO,QACC,kBAACg5B,EAAA,EAAD,CAAMp3B,WAAS,GACd,kBAACo3B,EAAA,EAAD,CAAMn3B,MAAI,EAACqW,GAAI,GACbpQ,KAAKX,MAAM09B,cAAcnjC,KAC1B,kBAAC0J,EAAA,EAAD,CAAQ1J,IAAI,gBAAgBX,QAAS,kBAAM,EAAKskC,aAAa,EAAKl+B,MAAM0vB,YAAa,EAAK1vB,MAAMw9B,eAAgB,EAAKx9B,MAAM09B,cAAcnjC,MAAM9C,MAAM,YAAYywB,UAAW,kBAAC,IAAD,OAC1KvtB,IAAKC,EAAE,kBAGV,kBAACi3B,EAAA,EAAD,CAAMn3B,MAAI,EAACqW,GAAI,EAAGtX,UAAWR,EAAQyiC,YACpC,kBAACz3B,EAAA,EAAD,CAAQ1J,IAAI,gBAAgBX,QAAS,kBAAM,EAAKyjC,YAAY,WAAW5lC,MAAM,aAC3EkD,IAAKC,EAAE,WAET,kBAACqJ,EAAA,EAAD,CAAQ1J,IAAI,cAAcX,QAAS,kBAAM,EAAKyjC,YAAY,SAAS5lC,MAAM,UAAUiC,QAAQ,YAAYiC,SAAUyO,OAAOC,KAAK1J,KAAKX,MAAM8V,QAAQ5Q,OAAS,GACvJvK,IAAKC,EAAE,SAMZ9B,OAAK,EACLO,SAAU,KACVC,KAAMqH,KAAKX,MAAMs9B,MACjB3kC,QAAS,kBAAM,EAAK0kC,YAAY,YAGhC,kBAACrC,EAAOtqB,SAAR,CAAiBnV,MAAOZ,IAAKC,EAAE,gBAC8D,IAA3F8Z,KAAe/T,KAAKX,MAAM09B,cAAcp8B,WAAa0oB,IAAS2U,QAAQhqB,kBAA6B,kBAACqmB,EAAOrqB,aAAR,KACnG,kBAACqqB,EAAO//B,KAAR,eACCV,IAAI,kBACJV,GAAG,mBACCqlC,GAAcQ,UAHnB,CAKCG,cAAY,EACZC,eAAa,EAEb7jC,IAAK0E,KAAKX,MAAM09B,cAAcnjC,IAAO,CAAEV,GAAI8G,KAAKX,MAAM09B,cAAcnjC,IAAKiE,KAAMkhC,GAAa/+B,KAAKX,MAAM09B,cAAcnjC,KAAS,KAC9Hc,SAAU,SAAC5C,EAAOwyB,GAAR,OAAkB,EAAKmP,UAAU3hC,EAAQwyB,GAASA,EAAMpxB,IAAO,KACzEqB,QAASyF,KAAK69B,SACdhuB,eAAgB,SAAAnS,GAAM,OAAIA,EAAM,MAGhC/C,UAAQ,EACRqB,WAAgDuB,IAAzCyC,KAAKX,MAAM8V,OAAO,uBAI3B,kBAACklB,EAAOrqB,aAAR,CAAqBlH,QAAS,GAC7B,kBAACuxB,EAAO//B,KAAR,eAAaV,IAAI,oBAAoBV,GAAG,qBAAwBqlC,GAAca,WAA9E,CAA0F1kC,SAAUsF,KAAKy5B,UAAWn+B,IAAK0E,KAAKX,MAAM09B,cAAc1iC,OAAS,OAE5J,kBAACggC,EAAOrqB,aAAR,CAAqBlH,QAAS,GAC7B,kBAACuxB,EAAO//B,KAAR,eAAaV,IAAI,mBAAmBV,GAAG,oBAAuBqlC,GAAcc,UAA5E,CAAuF3kC,SAAUsF,KAAKy5B,UAAWn+B,IAAK0E,KAAKX,MAAM09B,cAActhC,MAAQ,OAExJ,kBAAC4+B,EAAOrqB,aAAR,CAAqBlH,QAAS,GAC7B,kBAACuxB,EAAO//B,KAAR,eAAaV,IAAI,wBAAwBV,GAAG,yBAA4BqlC,GAAce,eAAtF,CAAsG5kC,SAAUsF,KAAKy5B,UAAWn+B,IAAK0E,KAAKX,MAAM09B,cAAc1K,WAAa,QAI7K,kBAACgI,EAAOtqB,SAAR,CAAiBnV,MAAOZ,IAAKC,EAAE,WAC9B,kBAACogC,EAAOrqB,aAAR,KACC,kBAACqqB,EAAO//B,KAAR,eACCV,IAAI,wBACJV,GAAG,yBACCqlC,GAAcgB,YAHnB,CAKCL,cAAY,EACZC,eAAa,EAEb7jC,IAAK0E,KAAKX,MAAM09B,cAAcp8B,WAAa0oB,IAAS2U,OACpDtjC,SAAU,SAAC5C,EAAOwD,GACjB,EAAKm+B,UAAU3hC,EAAOwD,GACtB,EAAKmE,UAAS,SAAA0S,GAAS,MAAK,CAC3B4qB,cAAc,2BACV5qB,EAAU4qB,eADD,IAEZp8B,UAAWrF,SAKdX,UAAQ,EACRqB,WAAsDuB,IAA/CyC,KAAKX,MAAM8V,OAAO,6BAI1ByV,S,GAzqBsB/qB,IAAMsC,WAmrBjBpD,gBAxtBA,SAAAvI,GAAK,MAAK,CACxBmlC,aAAc,CACbn9B,UAAW,QAEZgwB,KAAM,CACLlU,aAAc,QAEf4U,IAAK,CACJ/3B,QAASX,EAAMI,QAAQ,EAAG,IAE3B0jC,cAAe,CACd53B,cAAe,SACf0X,WAAY,UAEbqkB,gBAAiB,CAChBjgC,UAAWhI,EAAMI,QAAQ,IAE1BmT,OAAQ,CACPpQ,MAAO,IACP/B,OAAQpB,EAAMI,QAAQ,EAAG,GACzB4oC,YAAa,gCACbC,WAAY,iCAEb9nC,cAAe,CACd0iB,eAAgB,WAEjB0gB,WAAY,CACX1hC,QAAS,OACTghB,eAAgB,WAEhB,yBAA0B,CACzB/gB,WAAY,OAyrBAyF,CAAmBi9B,ICzvBnB,IACd,aAAgB,CACf,MAAS,gBACT,SAAY,CACX,SAAY,CACX,MAAS,CACR,GAAM,+BACN,GAAM,gCAEP,KAAQ,SACR,UAAa,CACZ,CAAE,GAAM,WACR,CAAE,GAAM,aAGV,YAAe,CACd,MAAS,CACR,GAAM,qBACN,GAAM,mBAEP,KAAQ,CACP,GAAM,yBACN,GAAM,6BAEP,KAAQ,QAET,UAAa,CACZ,MAAS,CACR,GAAM,mBACN,GAAM,iBAEP,KAAQ,OACR,YAAe,0CAIlB,cAAiB,CAChB,MAAS,iBACT,SAAY,CACX,kBAAqB,CACpB,MAAS,CACR,GAAM,8BACN,GAAM,uBAEP,KAAQ,CACP,GAAM,sJAEP,KAAQ,6DACR,KAAQ,OACR,YAAe,YAEhB,oBAAuB,CACtB,MAAS,CACR,GAAM,gCACN,GAAM,yBAEP,KAAQ,CACP,GAAM,kJAEP,KAAQ,6DACR,KAAQ,OACR,YAAe,QAEhB,eAAkB,CACjB,MAAS,CACR,GAAM,2BACN,GAAM,2BAEP,KAAQ,OACR,YAAe,W,mDCvCbhD,G,kDAEL,WAAYlhC,GAAQ,IAAD,8BAClB,cAAMA,IAcP4nC,sBAAwB,SAAC9lC,EAAK0B,GAC7B4f,IAASykB,WAAW/lC,EAAK0B,GAErB,EAAKZ,UACR,EAAKA,SAASwgB,IAAS0kB,gBAnBN,EA0BnBC,mBAAqB,SAAAC,GAAK,OAAI,SAACt3B,EAAOu3B,GAAR,OAAuB,EAAKtgC,SAAS,CAAEqgC,QAAOC,GAAaD,aAvBjF5kB,IAASxX,SAAS0yB,SACzB,EAAK/2B,MAAQ,CACZygC,OAAO,GAGR,EAAKplC,SAAW,EAAK5C,MAAM4C,SAC3B,EAAKgJ,SAAWwX,IAAS0kB,cATP,E,wDA+BPhmC,EAAKkmC,GAAQ,IAAD,OACfxnC,EAAY0H,KAAKlI,MAAjBQ,QAEFoL,EAAW+F,OAAOC,KAAKo2B,EAAMp8B,UAAU5G,KAAI,SAAAkjC,GAChD,IAAMC,EAAgBH,EAAMp8B,SAASs8B,GAC/BrN,EAAM0H,EAAO4F,EAAcplC,MAAQ,QAEzC,OAAO,kBAAC83B,EAAD,eACJ/4B,IAAK,SAAWA,EAAM,IAAMomC,EAC5B9mC,GAAI8mC,EACJtlC,SAAU,EAAKglC,sBACfpkC,IAAK,EAAKxD,MAAM4L,SAASs8B,IAAa,EAAKt8B,SAASs8B,IAChDC,OAIR,OAEF,kBAACC,GAAA,EAAD,CACCtmC,IAAK,aAAeA,EACpBumC,SAAUngC,KAAKX,MAAMygC,QAAUlmC,EAC/Bc,SAAUsF,KAAK6/B,mBAAmBjmC,IAGlC,kBAACwmC,GAAA,EAAD,CACCC,WAAY,kBAAC,KAAD,MACZnnC,GAAI,gBAAkBU,GAGtB,kBAACkN,EAAA,EAAD,CAAYhO,UAAWR,EAAQgoC,SAAUR,EAAMllC,OAC9CklC,EAAM/xB,aAAe,kBAACjH,EAAA,EAAD,CAAYhO,UAAWR,EAAQioC,kBAAmBT,EAAM/xB,cAG/E,kBAACyyB,GAAA,EAAD,KACE98B,M,+BAUQ,IAAD,OACR,OAAO+F,OAAOC,KAAK+2B,IAAgB3jC,KAAI,SAAAgjC,GAAK,OAAI,EAAKY,YAAYZ,EAAOW,GAAeX,W,GA9E9DjgC,IAAMsC,WAkFlBpD,gBA/FA,SAAAvI,GAAK,MAAK,CACxB8pC,QAAS,CACRpwB,SAAU1Z,EAAMmqC,WAAWC,QAAQ,IACnCC,UAAW,SACXtT,WAAY,GAEbgT,iBAAkB,CACjBrwB,SAAU1Z,EAAMmqC,WAAWC,QAAQ,IACnC9pC,MAAON,EAAMO,QAAQwP,KAAKxE,cAuFbhD,CAAmBi6B,IC/D5B8H,G,kDAEL,WAAYhpC,GAAQ,IAAD,uBAClB,cAAMA,IA0CPipC,iBAAmB,SAAAv9B,GAAO,OAAI,EAAK/D,SAAS,CAAE+D,QAASA,KA3CpC,EA4CnBw9B,kBAAoB,SAAAt9B,GAAQ,OAAI,EAAKjE,SAAS,CAAEiE,SAAUA,KA5CvC,EA6CnBu9B,iBAAmB,SAACzN,EAAQ9vB,GAAT,OAAsB,EAAKjE,UAAS,SAAA0S,GAAS,MAAK,CAAEzO,SAAS,2BAAMyO,EAAUzO,UAAaA,GAAY,IAAM8vB,OAAQA,OA7CpH,EAkDnB0N,YAAc,SAACppC,EAAOwD,GAErB,IACC,IAAIwxB,EAAM5iB,KAAKoI,MAAMhX,GAErB,EAAKmE,UAAS,SAAAiZ,GACb,IAAIihB,EAAU,eAAQjhB,EAAWvD,QAGjC,cAFOwkB,EAAW7hC,EAAMoB,IAEjB,aACNic,OAAQwkB,GACP7hC,EAAM+C,KAAOiyB,MAIjB,MAAM9hB,GACL,EAAKvL,UAAS,SAAAiZ,GAAU,MAAK,CAC5BvD,OAAO,2BACHuD,EAAWvD,QADT,kBAEJrd,EAAMoB,GAAKc,IAAKC,EAAE,+BArEJ,EA8EnBknC,iBAAmB,SAAC34B,EAAO0mB,GAAR,OAAgB,EAAKzvB,SAAS,CAAEyvB,SA9EhC,EAmFnBkS,QAAU,kBAAM,EAAKtpC,MAAM4xB,SAAS,SAnFjB,EAwFnBuP,MAAQ,WACP,IAAIpC,EAAS,CACZ,EAAK9lB,OAAOtR,SAAS4pB,IAAS4M,cAAe/rB,KAAKC,UAAL,2BAAoB,EAAK9K,MAAMqE,UAA/B,IAAyC8vB,OAAQ,EAAKn0B,MAAMm0B,WACzG,EAAKziB,OAAOtR,SAAS4pB,IAASiN,aAAcpsB,KAAKC,UAAU,EAAK9K,MAAMmE,WAGvE8oB,QAAQ+U,IAAIxK,GACVnY,MAAK,kBAAM0P,OAAOnf,SAASqyB,YAC3BhqB,OAAM,SAAAtM,GAAG,OAAIhF,QAAQhK,MAAMgP,OA7F7B,IAAItH,EAAQ,eAAQwX,IAAS0kB,eACzBpM,EAAS9vB,EAAS8vB,OAJJ,cAKX9vB,EAAS8vB,cACT9vB,EAAS0yB,SAEhB,EAAK/2B,MAAQ,CACZkiC,YAAY,EACZrS,IAAK,UACL/Z,OAAQ,GAERzR,SAAUA,GAAY,GACtB8vB,OAAQA,GAAU,GAClBhwB,QAAS6kB,IAAQkL,WAAW,CAAEzK,KAAK,EAAMC,MAAM,KAGhD,EAAKhY,OAASC,IAAWC,cAEzB,EAAK8vB,iBAAiBt/B,KAAtB,gBACA,EAAKu/B,kBAAkBv/B,KAAvB,gBACA,EAAKw/B,iBAAiBx/B,KAAtB,gBAtBkB,E,+DA6BAgW,EAAWtF,GAE7B,GAAInS,KAAKX,MAAMkiC,WAAY,CAC1B,IAAIC,EAAYxc,SAASE,eAAellB,KAAKX,MAAM6vB,KAE/CsS,EAAUC,eAAiBtvB,EAAUuvB,iBACxC1hC,KAAKP,SAAS,CAAEiiC,gBAAiBF,EAAUC,kB,+BAmEpC,IAAD,OACAnpC,EAAY0H,KAAKlI,MAAjBQ,QAER,OAEF,kBAACrB,EAAA,EAAD,CACCqB,QAAS,CAAElB,aAAckB,EAAQmxB,UACjChxB,WAAW,EACXC,UAAU,EAEVC,KAA2B,kBAApBqH,KAAKlI,MAAMsU,KAClBpU,QAASgI,KAAKohC,QAEdrpC,OAAQ,CACP,kBAAC+O,EAAA,EAAD,CAAYlN,IAAI,SAASb,QAAQ,MAC/BiB,IAAKC,EAAE,iBACR,kBAACogC,EAAO/T,aAAR,CACC1sB,IAAI,mBACJV,GAAG,aACH+B,KAAK,QACLL,MAAOZ,IAAKC,EAAE,eACdS,SAAU,SAACd,EAAK0B,GAAN,OAAc,EAAKmE,UAAS,SAAA0S,GAAS,MAAK,CAAEovB,WAAYjmC,EAAK4zB,IAAK/c,EAAUovB,WAAapvB,EAAU+c,IAAIlqB,OAAO,EAAGmN,EAAU+c,IAAI3qB,OAAO,GAAK4N,EAAU+c,IAAM,WACrK5zB,IAAK0E,KAAKX,MAAMkiC,cAIlB,kBAACxR,EAAA,EAAD,CACCn2B,IAAI,OACJkC,MAAOkE,KAAKX,MAAM6vB,IAClByS,eAAe,UACfC,UAAU,UACVlnC,SAAUsF,KAAKmhC,mBAGY,IAA1BnhC,KAAKX,MAAMkiC,YAAuB,kBAACzR,EAAA,EAAD,CAAKh0B,MAAM,aAAalB,MAAOZ,IAAKC,EAAE,cAC9C,IAA1B+F,KAAKX,MAAMkiC,YAAuB,kBAACzR,EAAA,EAAD,CAAKh0B,MAAM,YAAYlB,MAAOZ,IAAKC,EAAE,aAC7C,IAA1B+F,KAAKX,MAAMkiC,YAAuB,kBAACzR,EAAA,EAAD,CAAKh0B,MAAM,cAAclB,MAAOZ,IAAKC,EAAE,eAC/C,IAA1B+F,KAAKX,MAAMkiC,YAAuB,kBAACzR,EAAA,EAAD,CAAKh0B,MAAM,UAAUlB,MAAOZ,IAAKC,EAAE,cAC3C,IAA1B+F,KAAKX,MAAMkiC,YAAuB,kBAACzR,EAAA,EAAD,CAAKh0B,MAAM,SAASlB,MAAOZ,IAAKC,EAAE,aAC1C,IAA1B+F,KAAKX,MAAMkiC,YAAuB,kBAACzR,EAAA,EAAD,CAAKh0B,MAAM,WAAWlB,MAAOZ,IAAKC,EAAE,gBAGzE/B,QAAS,CACR,kBAACoL,EAAA,EAAD,CAAQ1J,IAAI,gBAAgBwB,WAAS,EAACnC,QAAS+G,KAAKohC,QAAStqC,MAAM,aACjEkD,IAAKC,EAAE,WAET,kBAACqJ,EAAA,EAAD,CAAQ1J,IAAI,cAAcX,QAAS+G,KAAKi5B,MAAOniC,MAAM,UAAUiC,QAAQ,YAAYiC,SAAUyO,OAAOC,KAAK1J,KAAKX,MAAM8V,QAAQ5Q,OAAS,GACnIvK,IAAKC,EAAE,WAKV,yBAAKif,OAA2B,YAAnBlZ,KAAKX,MAAM6vB,KACvB,kBAAC8P,EAAA,EAAD,CAAOlmC,UAAWR,EAAQC,OACL,YAAnByH,KAAKX,MAAM6vB,KAAqB,kBAAC2S,GAAD,CAAiBnnC,SAAUsF,KAAK+gC,sBAGxC,IAA1B/gC,KAAKX,MAAMkiC,YACZ,yBAAKroB,OAA2B,eAAnBlZ,KAAKX,MAAM6vB,KACvB,kBAAC8P,EAAA,EAAD,CAAOlmC,UAAWR,EAAQC,OACzB,kBAACuO,EAAA,EAAD,CAAYhO,UAAWR,EAAQ+B,MAAOtB,QAAQ,MAC5CiB,IAAKC,EAAE,cAAgB,IAAMD,IAAKC,EAAE,YAEtC,kBAACogC,EAAO//B,KAAR,CACCpB,GAAG,aACH0B,MAAO,CAAC,mBAAoD2C,IAApCyC,KAAKX,MAAM8V,OAAX,WAAgD,KAAOnV,KAAKX,MAAM8V,OAAX,WAAkC,IAAM,IACvHzZ,WAAY,CAAEF,kBAAkB,EAAM1C,UAAWR,EAAQkpC,WACzDz5B,WAAY,CAAElO,MAAO,CAAEwQ,OAAQrK,KAAKX,MAAMqiC,kBAC1CrmC,WAAS,EACT1B,MAAM,MACNqC,WAA2CuB,IAApCyC,KAAKX,MAAM8V,OAAX,WACPza,SAAU,SAAC5C,EAAOwD,GAAR,OAAgB,EAAK4lC,YAAL,2BAAsBppC,GAAtB,IAA6B+C,KAAM,YAAaS,IAC1EA,IAAK4O,KAAKC,UAAUnK,KAAKX,MAAMmE,QAAS,KAAM,OAKjD,yBAAK0V,OAA2B,aAAnBlZ,KAAKX,MAAM6vB,IAAoBr1B,MAAO,CAAEF,MAAO,SAC3D,kBAACqlC,EAAA,EAAD,CAAOlmC,UAAWR,EAAQ+B,OACzB,kBAACyM,EAAA,EAAD,CAAY/N,QAAQ,MAClBiB,IAAKC,EAAE,cAGU,aAAnB+F,KAAKX,MAAM6vB,KAAsB,kBAAC,GAAD,CAAcxrB,SAAU1D,KAAKX,MAAMqE,SAAUhJ,SAAUsF,KAAKghC,sBAGpE,IAA1BhhC,KAAKX,MAAMkiC,YACZ,yBAAKroB,OAA2B,gBAAnBlZ,KAAKX,MAAM6vB,IAAuBr1B,MAAO,CAAEF,MAAO,SAC9D,kBAACqlC,EAAA,EAAD,CAAOlmC,UAAWR,EAAQC,OACzB,kBAACuO,EAAA,EAAD,CAAYhO,UAAWR,EAAQ+B,MAAOtB,QAAQ,MAC5CiB,IAAKC,EAAE,cAAgB,IAAMD,IAAKC,EAAE,aAEtC,kBAACogC,EAAO//B,KAAR,CACCpB,GAAG,cACH0B,MAAO,CAAC,mBAAqD2C,IAArCyC,KAAKX,MAAM8V,OAAX,YAAiD,KAAOnV,KAAKX,MAAM8V,OAAX,YAAmC,IAAM,IACzHzZ,WAAY,CAAEF,kBAAkB,EAAM1C,UAAWR,EAAQkpC,WACzDz5B,WAAY,CAAElO,MAAO,CAAEwQ,OAAQrK,KAAKX,MAAMqiC,kBAC1CrmC,WAAS,EACT1B,MAAM,MACNqC,WAA4CuB,IAArCyC,KAAKX,MAAM8V,OAAX,YACPza,SAAU,SAAC5C,EAAOwD,GAAR,OAAgB,EAAK4lC,YAAL,2BAAsBppC,GAAtB,IAA6B+C,KAAM,aAAcS,IAC3EA,IAAK4O,KAAKC,UAAUnK,KAAKX,MAAMqE,SAAU,KAAM,OAKlD,yBAAKwV,OAA2B,WAAnBlZ,KAAKX,MAAM6vB,KACvB,kBAAC8P,EAAA,EAAD,KACC,kBAACl4B,EAAA,EAAD,CAAYhO,UAAWR,EAAQ+B,MAAOtB,QAAQ,MAC5CiB,IAAKC,EAAE,YAGU,WAAnB+F,KAAKX,MAAM6vB,KAAoB,kBAAC,GAAD,CAAaxrB,SAAU1D,KAAKX,MAAMqE,SAAU8vB,OAAQxzB,KAAKX,MAAMm0B,OAAQ94B,SAAUsF,KAAKihC,qBAG5F,IAA1BjhC,KAAKX,MAAMkiC,YACZ,yBAAKroB,OAA2B,cAAnBlZ,KAAKX,MAAM6vB,IAAqBr1B,MAAO,CAAEF,MAAO,SAC5D,kBAACqlC,EAAA,EAAD,CAAOlmC,UAAWR,EAAQC,OACzB,kBAACuO,EAAA,EAAD,CAAYhO,UAAWR,EAAQ+B,MAAOtB,QAAQ,MAC5CiB,IAAKC,EAAE,cAAgB,IAAMD,IAAKC,EAAE,WAEtC,kBAACogC,EAAO//B,KAAR,CACCpB,GAAG,YACH0B,MAAO,CAAC,mBAAmD2C,IAAnCyC,KAAKX,MAAM8V,OAAX,UAA+C,KAAOnV,KAAKX,MAAM8V,OAAX,UAAiC,IAAM,IACrHzZ,WAAY,CAAEF,kBAAkB,EAAM1C,UAAWR,EAAQkpC,WACzDz5B,WAAY,CAAElO,MAAO,CAAEwQ,OAAQrK,KAAKX,MAAMqiC,kBAC1CrmC,WAAS,EACT1B,MAAM,MACNqC,WAA0CuB,IAAnCyC,KAAKX,MAAM8V,OAAX,UACPza,SAAU,SAAC5C,EAAOwD,GAAR,OAAgB,EAAK4lC,YAAL,2BAAsBppC,GAAtB,IAA6B+C,KAAM,WAAYS,IACzEA,IAAK4O,KAAKC,UAAUnK,KAAKX,MAAMm0B,QAAU,GAAI,KAAM,Y,GA1OvB3zB,IAAMsC,WAsPvBpD,uBA9QA,SAAAvI,GAAK,MAAK,CACxB+B,MAAO,CACN+hB,aAAc,QAEfmP,SAAU,CACT/yB,SAAU,WACVG,IAAK,EACL6kB,KAAM,GAEPrhB,MAAO,CACN6L,YAAa1P,EAAMI,QAAQ,GAC3B2H,aAAc/H,EAAMI,QAAQ,GAC5B0jB,aAAc9jB,EAAMI,QAAQ,GAC5B4tB,UAAW,OACXnrB,QAAS,OACT3C,SAAU,WACV0jB,WAAY,UAEbonB,UAAW,CACVM,WAAY,4DA2PC/iC,CAAmB+hC,K,iJCvRbiB,E,kDAEpB,aAAuC,IAAD,EAA1B1kB,EAA0B,uDAApB,KAAM9iB,EAAc,uDAAJ,GAAI,4BACrC,gBAGKwW,OAASixB,IAAG3kB,EAAD,YAAC,aAAO4kB,QAAS,KAAU1nC,GAA3B,IAAoC2nC,MAAO,aAC3D,EAAKC,iBAAmB,GAQxB,EAAKpxB,OAAO0Z,GAAG,WAAW,kBAAM,EAAK+B,KAAK,cAG1C,EAAKzb,OAAO0Z,GAAG,aAAa,SAAA2X,GAAQ,OAAI,EAAK5V,KAAK,YAAa4V,MAG/D,EAAKrxB,OAAO0Z,GAAG,mBAAmB,SAAAzuB,GAAK,OAAI,EAAKwwB,KAAK,QAAS,CAAE,KAAQ,YAAa,MAAS,kBAAmB,QAAYxwB,GAASA,EAAM0J,SAAY,0BAGxJ,EAAKqL,OAAO0Z,GAAG,oBAAoB,kBAAM,EAAK+B,KAAK,QAAS,CAAE,KAAQ,YAAa,MAAS,mBAAoB,QAAW,2BAG3H,EAAKzb,OAAO0Z,GAAG,cAAc,SAAA4X,GAAM,OAAI,EAAK7V,KAAK,aAAc6V,MAG/D,EAAKtxB,OAAO0Z,GAAG,SAAS,SAAAzuB,GAAK,OAAI,EAAKwwB,KAAK,QAAS,CAAE,KAAQ,QAAS,MAAS,QAAS,QAAYxwB,GAASA,EAAM0J,SAAY,qBAGhI,EAAKqL,OAAO0Z,GAAG,kBAAkB,SAAAzuB,GAAK,OAAI,EAAKwwB,KAAK,QAAS,CAAE,KAAQ,UAAW,MAAS,gBAAiB,QAAYxwB,GAASA,EAAM0J,SAAY,wBAGnJ,EAAKqL,OAAO0Z,GAAG,iBAAiB,SAAAzuB,GAAK,OAAI,EAAKwwB,KAAK,QAAS,CAAE,KAAQ,UAAW,MAAS,gBAAiB,QAAYxwB,GAASA,EAAM0J,SAAY,wBAGlJ,EAAKqL,OAAO0Z,GAAG,mBAAmB,kBAAM,EAAK+B,KAAK,QAAS,CAAE,KAAQ,UAAW,MAAS,kBAAmB,QAAW,gCAMvH,EAAKzb,OAAO0Z,GAAG,eAAe,SAACvxB,EAAImG,GAAL,OAAesY,YAAW,kBAAM,EAAKxY,YAAYjG,EAAImG,KAAQ,MA3CtD,E,8DAkDpBnG,GACjB,IAAIopC,EAAUppC,EACZmD,QAAQ,MAAO,OACfA,QAAQ,MAAO,MACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OAMjB,OAJ8B,IAA1BimC,EAAQj+B,QAAQ,OACnBi+B,GAAW,KAGLA,I,sCAOQC,EAAKC,GAAK,IAAD,QACxBD,EAAM3lC,MAAMC,QAAQ0lC,GAAOA,EAAM,CAACA,IAC9Br/B,SAAQ,SAAAhK,GAAE,OAAI,EAAK6zB,eAAe7zB,EAAIspC,Q,qCAO5BtpC,EAAIspC,GAElB,GAAKxiC,KAAKmiC,iBAAiBjpC,IASqB,IAA/C8G,KAAKmiC,iBAAiBjpC,GAAIupC,IAAIp+B,QAAQm+B,IAAcxiC,KAAKmiC,iBAAiBjpC,GAAIupC,IAAIh/B,KAAK++B,OATxD,CAC/B,IAAIE,EAAM1iC,KAAK2iC,kBAAkBzpC,GACjC8G,KAAKmiC,iBAAiBjpC,GAAM,CAAEwpC,IAAK,IAAI9c,OAAO8c,GAAMD,IAAK,CAACD,IAEtDxiC,KAAK+Q,OAAO6B,WACf5S,KAAK+Q,OAAOyb,KAAK,YAAatzB,M,kCAYrBA,EAAImG,GAGf,IAAK,IAAMujC,KADX1pC,EAAKA,EAAKA,EAAGmD,QAAQ,UAAW,KAAO,GACpB2D,KAAKmiC,iBACnBniC,KAAKmiC,iBAAiBU,eAAeD,IAAS5iC,KAAKmiC,iBAAiBS,GAAMF,IAAII,KAAK5pC,IACtF8G,KAAKmiC,iBAAiBS,GAAMH,IAAIv/B,SAAQ,SAAAs/B,GAAE,OAAIA,EAAGtpC,EAAImG,Q,0CASpCoT,EAAS+vB,GAO5B,MALuB,oBAAZ/vB,IACV+vB,EAAK/vB,EACLA,EAAU,MAGJzS,KAAK+iC,cAAc,SAAU,WAAY,CAAE,SAAY,mBAAqBtwB,EAAUA,EAAU,IAAM,IAAK,OAAU,mBAAqBA,EAAUA,EAAU,OAAS,QAAU+vB,K,gCAO/KtpC,EAAIspC,GAAK,IAAD,OAEjB,IAAKA,EACJ,OAAO,IAAIlW,SAAQ,SAACpF,EAASqF,GAAV,OAAqB,EAAK8J,UAAUn9B,GAAI,SAAC8R,EAAKgf,GAAN,OAAchf,EAAMuhB,EAAOvhB,GAAOkc,EAAQ8C,SAErGhqB,KAAK+Q,OAAOyb,KAAK,YAAatzB,EAAIspC,K,oCAQtBQ,EAAQC,EAAQjlC,EAAQwkC,GAAK,IAAD,OAEzC,IAAKA,EACJ,OAAO,IAAIlW,SAAQ,SAACpF,EAASqF,GAAV,OAAqB,EAAKwW,cAAcC,EAAQC,EAAQjlC,GAAQ,SAAAgN,GAAG,OAAIA,EAAMuhB,EAAOvhB,GAAOkc,UAE9GlnB,KAAK+Q,OAAOyb,KAAK,gBAAiBwW,EAAQC,EAAQjlC,EAAQwkC,K,wCAQ1CnlB,EAAKmlB,GAAK,IAAD,OAE1B,IAAKA,EACJ,OAAO,IAAIlW,SAAQ,SAACpF,EAASqF,GAAV,OAAqB,EAAK9N,kBAAkBpB,GAAK,SAACrS,EAAK3L,GAAN,OAAgB2L,EAAMuhB,EAAOvhB,GAAOkc,EAAQ7nB,SAEhHW,KAAK+Q,OAAOyb,KAAK,UAAWnP,EAAKmlB,K,+BAQ1BtpC,EAAIspC,GAAK,IAAD,OAEhB,IAAKA,EACJ,OAAO,IAAIlW,SAAQ,SAACpF,EAASqF,GAAV,OAAqB,EAAKE,SAASvzB,GAAI,SAAC8R,EAAK3L,GAAN,OAAgB2L,EAAMuhB,EAAOvhB,GAAOkc,EAAQ7nB,SAEtGW,KAAK+Q,OAAOyb,KAAK,WAAYtzB,EAAIspC,K,gCAQzBF,EAASE,GAAK,IAAD,OAEtB,IAAKA,EACJ,OAAO,IAAIlW,SAAQ,SAACpF,EAASqF,GAAV,OAAqB,EAAKjb,UAAUgxB,GAAS,SAACt3B,EAAK3L,GAAN,OAAgB2L,EAAMuhB,EAAOvhB,GAAOkc,EAAQ7nB,SAE5GW,KAAK+Q,OAAOyb,KAAK,YAAa8V,EAASE,K,sCAQzBtpC,EAAIqB,EAASioC,GAAK,IAAD,OAOhC,GALuB,oBAAZjoC,IACVioC,EAAKjoC,EACLA,EAAU,KAGNioC,EACJ,OAAO,IAAIlW,SAAQ,SAACpF,EAASqF,GAAV,OAAqB,EAAKM,gBAAgB3zB,EAAIqB,GAAS,SAACyQ,EAAK3L,GAAN,OAAgB2L,EAAMuhB,EAAOvhB,GAAOkc,EAAQ7nB,SAEtHW,KAAK+Q,OAAOyb,KAAK,aAActzB,EAAIqB,EAASioC,K,+BAQrCtpC,EAAIoC,EAAKknC,GAAK,IAAD,OAErB,IAAKA,EACJ,OAAO,IAAIlW,SAAQ,SAACpF,EAASqF,GAAV,OAAqB,EAAK9sB,SAASvG,EAAIoC,GAAK,SAAA0P,GAAG,OAAIA,EAAMuhB,EAAOvhB,GAAOkc,UAE1FlnB,KAAK+Q,OAAOyb,KAAK,WAAYtzB,EAAIoC,EAAKknC,K,wCAQtBD,GAAM,IAAD,QACtBA,EAAM3lC,MAAMC,QAAQ0lC,GAAOA,EAAM,CAACA,IAC9Br/B,SAAQ,SAAAhK,GAAE,OAAI,EAAKgqC,iBAAiBhqC,Q,uCAOxBA,GAEZ8G,KAAKmiC,iBAAiBjpC,IAAO8G,KAAK+Q,OAAO6B,YAC5C5S,KAAK+Q,OAAOyb,KAAK,cAAetzB,UACzB8G,KAAKmiC,iBAAiBjpC,Q,GA7OIgxB,KCVflZ,E,uGAmB0B,IAA/BqM,EAA8B,uDAAxB,KAAM6O,EAAkB,uDAAN,KAgBtC,OAbI7O,IACHrM,EAAWmyB,OAAS9lB,GAIrBrM,EAAW6B,WAAa,IAAIkvB,EAAO/wB,EAAWqM,KAG1C6O,IACHlb,EAAWoyB,aAAelX,GAIpBlb,EAAW6B,a,oCAUlB,OAAO7B,EAAW6B,YAAc,O,6BAUhC,OAAO7B,EAAWqM,M,gCAUlB,OAAOrM,EAAWglB,U,gCAWI7J,GACtBnb,EAAW6B,WAAW4X,GAAG0B,EAAS3jB,MAAO2jB,EAASpX,Y,mCASV,IAAjBmX,EAAgB,uDAAJ,GAEnC,SAAKA,IAActvB,MAAMC,QAAQqvB,MAIjCA,EAAUhpB,SAAQ,SAAAipB,GAAQ,OAAInb,EAAWqyB,YAAclX,MAChD,K,2BASU9O,GACjBrM,EAAWqM,IAAMA,M,KAvGErM,EAKbqM,IAAM+Q,OAAOnf,SAAS8mB,SALT/kB,EAUb6B,WAAa,M,gCChBrB,oEAAO,IAAMkB,EAAiB,CAC7BtD,cAAe7C,EAAQ,KAAmBmG,gBAAkB,GAC5DE,MAAOrG,EAAQ,KAAWmG,gBAAkB,GAC5CwG,SAAU3M,EAAQ,KAAcmG,gBAAkB,GAClDoI,IAAKvO,EAAQ,KAASmG,gBAAkB,GACxC6O,WAAYhV,EAAQ,KAAgBmG,gBAAkB,GACtDxQ,UAAWqK,EAAQ,KAAemG,gBAAkB,GACpDsK,oBAAqBzQ,EAAQ,KAAyBmG,gBAAkB,GACxEwK,QAAS3Q,EAAQ,KAAamG,gBAAkB,IAGpCipB,EAAuB,CACnCvsB,cAAe7C,EAAQ,KAAmB3J,cAAgB,GAC1DgQ,MAAOrG,EAAQ,KAAW3J,cAAgB,GAC1CsW,SAAU3M,EAAQ,KAAc3J,cAAgB,GAChDkY,IAAKvO,EAAQ,KAAS3J,cAAgB,GACtC2e,WAAYhV,EAAQ,KAAgB3J,cAAgB,GACpDV,UAAWqK,EAAQ,KAAe3J,cAAgB,GAClDoa,oBAAqBzQ,EAAQ,KAAyB3J,cAAgB,GACtEsa,QAAS3Q,EAAQ,KAAa3J,cAAgB,IAGhC,KACdwM,cAAe7C,EAAQ,KAAmBC,QAC1CoG,MAAOrG,EAAQ,KAAWC,QAC1B0M,SAAU3M,EAAQ,KAAcC,QAChCsO,IAAKvO,EAAQ,KAASC,QACtB+U,WAAYhV,EAAQ,KAAgBC,QACpCtK,UAAWqK,EAAQ,KAAeC,QAClCwQ,oBAAqBzQ,EAAQ,KAAyBC,QACtD0Q,QAAS3Q,EAAQ,KAAaC,U,gCC9BhB,KACdc,SAAUf,EAAQ,IAAcC,QAEhCy1B,MAAO11B,EAAQ,KAAYC,QAC3Boa,KAAMra,EAAQ,KAAWC,QACzB01B,QAAS31B,EAAQ,KAAcC,QAC/B21B,SAAU51B,EAAQ,KAAYC,QAC9BvH,MAAOsH,EAAQ,KAAYC,QAC3BoB,SAAUrB,EAAQ,KAAeC,QACjC41B,KAAM71B,EAAQ,KAAWC,QACzBugB,OAAQxgB,EAAQ,KAAaC,W","file":"static/js/main.91c26d32.chunk.js","sourcesContent":["import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n\tDialog: {\r\n\t},\r\n\tDialogDense: {\r\n\t\tpadding: theme.spacing(2, 0)\r\n\t},\r\n\tCustomDialog: {\r\n\t},\r\n\tDialogTitle: {\r\n\t},\r\n\tCustomDialogTitle: {\r\n\t},\r\n\tDialogTitleTypography: {\r\n\t\t//padding: theme.spacing(2)\r\n\t},\r\n\tDialogContent: {\r\n\t\tbackgroundColor: '#fafafa'\r\n\t},\r\n\tCustomDialogContent: {\r\n\t},\r\n\tDialogActions: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n\tCustomDialogActions: {\r\n\t}\r\n}));\r\n\r\n\r\nexport default function CustomDialog(props) {\r\n\tconst { header, onClose, children, actions, dense, disableBackdropClick, disableEscapeKeyDown } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\treturn (\r\n\r\n<Dialog\r\n\tclasses={{ paper: clsx(classes.Dialog, classes.CustomDialog) }}\r\n\tfullWidth={props.fullWidth}\r\n\tmaxWidth={props.maxWidth}\r\n\t\r\n\tdisableBackdropClick={disableBackdropClick ? disableBackdropClick : true}\r\n\tdisableEscapeKeyDown={disableEscapeKeyDown ? disableEscapeKeyDown : true}\r\n\t\r\n\topen={props.open}\r\n\tonClose={props.onClose}\r\n\t>\r\n\t\r\n\t<DialogTitle\r\n\t\tclasses={{ root: clsx(classes.DialogTitle, classes.CustomDialogTitle) }}\r\n\t\tdisableTypography\r\n\t\t>\r\n\t\t\r\n\t\t{typeof header !== 'string' ? header : <Typography className={classes.DialogTitleTypography} variant=\"h6\">\r\n\t\t\t{header}\r\n\t\t</Typography>}\r\n\t\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t\t<CloseIcon />\r\n\t\t</IconButton>\r\n\t</DialogTitle>\r\n\t\r\n\t<DialogContent id='DialogContent' className={clsx(classes.DialogContent, classes.CustomDialogContent, dense && classes.DialogDense)} dividers>\r\n\t\t{children}\r\n\t</DialogContent>\r\n\t\r\n\t<DialogActions classes={{ root: clsx(classes.DialogActions, classes.CustomDialogActions) }}>\r\n\t\t{actions}\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport i18n from '../../i18n'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport InfoIcon from '@material-ui/icons/Info'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles((theme) => ({\r\n\tField: {\r\n\t\tdisplay: 'inline-flex',\r\n\t\tmarginLeft: theme.spacing(1),\r\n\t\tmarginRight: theme.spacing(1),\r\n\t\tpadding: '0 !important',\r\n\t},\r\n\tCustomField: {\r\n\t},\r\n}));\r\n\r\n\r\n/*\r\n *\r\n */\r\nexport default function Field(props) {\r\n\tconst { children, id, info, link, width } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\treturn (\r\n\t\t<Grid\r\n\t\t\tkey={'grid-' + id}\r\n\t\t\tclassName={clsx(classes.Field, classes.CustomField)}\r\n\t\t\tstyle={{ width: width || 250 }}\r\n\t\t\tcontainer\r\n\t\t\titem\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{i18n.t(info) && <Grid item style={{ width: 30 }}>\r\n\t\t\t\t<a target=\"_blank\" rel=\"noopener noreferrer\" href={link}>\r\n\t\t\t\t\t<Tooltip title={i18n.t(info)}>\r\n\t\t\t\t\t\t<InfoIcon color=\"primary\" />\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</a>\r\n\t\t\t</Grid>}\r\n\t\t\t<Grid item style={{ width: info ? 250-30 : '100%' }}>\r\n\t\t\t\t{children}\r\n\t\t\t</Grid>\r\n\t\t</Grid>\r\n\r\n\t);\r\n}","import React, { useState, useEffect } from 'react'\r\nimport i18n from '../../i18n'\r\n\r\nimport Autocomplete, { createFilterOptions } from '@material-ui/lab/Autocomplete'\r\nimport InputAdornment from '@material-ui/core/InputAdornment'\r\nimport TextField from '@material-ui/core/TextField'\r\n\r\nimport Field from './Field'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles((theme) => ({\r\n}));\r\n\r\n\r\n/*\r\n *\r\n */\r\nexport default function Text(props) {\r\n\treturn props.options ? TextAutoComplete(props) : TextInput(props);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport function TextInput(props) {\r\n\tconst { onChange, id, required, label, type, children, select, shrink, disabled, size, placeholder, errorMessage, autoFocus, multiline, val, onEnter, disableUnderline, icon, InputProps, attributes, ...otherProps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [value,setValue] = useState(val || '');\r\n\tconst [error,setError] = useState(props.error ? props.error : (required && !val));\r\n\tuseEffect(() => setError(props.error), [props.error]);\r\n\t\r\n\tconst inputId = id || 'input-' + label.toLowerCase().replace(/ /g, '');\r\n\t\r\n\treturn (\r\n\t\t<Field {...props} {...attributes}>\r\n\t\t\t<TextField\r\n\t\t\t\tclasses={{ root: classes.TextField }}\r\n\t\t\t\t\r\n\t\t\t\tid={inputId}\r\n\t\t\t\ttype={type || 'text'}\r\n\t\t\t\trequired={required}\r\n\t\t\t\tselect={select}\r\n\t\t\t\t\r\n\t\t\t\tmultiline={multiline}\r\n\t\t\t\trows={4}\r\n\t\t\t\tsize={size}\r\n\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\r\n\t\t\t\tfullWidth={true}\r\n\t\t\t\tplaceholder={placeholder || ''}\r\n\t\t\t\tautoFocus={autoFocus ? autoFocus : false}\r\n\t\t\t\t\r\n\t\t\t\tonKeyPress={e => {\r\n\t\t\t\t\tif (e.key === 'Enter' && !multiline) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tonEnter && onEnter();\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t\t\r\n\t\t\t\terror={error}\r\n\t\t\t\thelperText={errorMessage ? i18n.t(errorMessage) : (required && error && i18n.t('No input given'))}\r\n\t\t\t\t\r\n\t\t\t\tlabel={Array.isArray(label) ? label.map(lbl => i18n.t(lbl)).join('') : i18n.t(label)}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tonChange={e => {\r\n\t\t\t\t\tsetError(required && !e.target.value);\r\n\t\t\t\t\tsetValue(e.target.value);\r\n\t\t\t\t\tonChange && onChange(props, e.target.value);\r\n\t\t\t\t}}\r\n\t\t\t\t\r\n\t\t\t\tInputProps={{\r\n\t\t\t\t\tdisableUnderline: disableUnderline,\r\n\t\t\t\t\tstartAdornment: icon && (\r\n\t\t\t\t\t\t<InputAdornment position=\"start\">\r\n\t\t\t\t\t\t\t<span className={'mdi mdi-' + icon}></span>\r\n\t\t\t\t\t\t</InputAdornment>\r\n\t\t\t\t\t),\r\n\t\t\t\t\t...InputProps || {}\r\n\t\t\t\t}}\r\n\t\t\t\t\r\n\t\t\t\tInputLabelProps={{\r\n\t\t\t\t\tshrink: shrink ? shrink : true\r\n\t\t\t\t}}\r\n\t\t\t\t\r\n\t\t\t\t{...otherProps}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{children ? children : null}\r\n\t\t\t</TextField>\r\n\t\t</Field>\r\n\r\n\t)\r\n}\r\n\r\n\r\n/*\r\n *\r\n */\r\nexport function TextAutoComplete(props) {\r\n\tconst classes = useStyles();\r\n\tconst { error, required, autoFocus, placeholder, label,\r\n\t\t\t\tshowMaxResults, onChange, val, attributes, ...otherProps } = props;\r\n\t\r\n\tconst [value,setValue] = useState(val || []);\r\n\t//const [inputValue,setInputValue] = useState('');\r\n\tconst filterOptions = showMaxResults && showMaxResults > 0 ? createFilterOptions({ limit: showMaxResults }) : undefined;\r\n\tconst objectify = props.options && props.options[0] && props.options[0].id; // discover whether plain array of array of objects is used\r\n\t\r\n\treturn (\r\n\t\t<Field {...props} {...attributes}>\r\n\t\t\t<Autocomplete\r\n\t\t\t\tclasses={{ root: classes.Input, option: classes.AutoCompleteOption }}\r\n\t\t\t\tpopupIcon={null}\r\n\t\t\t\t\r\n\t\t\t\tvalue={value}\r\n\t\t\t\t//defaultValue={val}\r\n\t\t\t\t//inputValue={inputValue}\r\n\t\t\t\t//onInputChange={(e, text) => setInputValue(text)}\r\n\t\t\t\t\r\n\t\t\t\tonChange={(e, option) => {\r\n\t\t\t\t\toption = option.map(val => typeof val === 'string' && objectify ? { id: val.toLowerCase().replace(/ /g, ''), name: val } : val);\r\n\t\t\t\t\tsetValue(option);\r\n\t\t\t\t\tonChange && onChange(props, option);\r\n\t\t\t\t}}\r\n\t\t\t\t\r\n\t\t\t\tgetOptionSelected={(option, value) => option && value ? (objectify ? option.id === value.id : option === value) : false}\r\n\t\t\t\tfilterOptions={filterOptions}\r\n\t\t\t\t\r\n\t\t\t\trenderInput={params => <TextField\r\n\t\t\t\t\t\t\t\t\t\t{...params}\r\n\t\t\t\t\t\t\t\t\t\terror={error}\r\n\t\t\t\t\t\t\t\t\t\trequired={required}\r\n\t\t\t\t\t\t\t\t\t\tautoFocus={autoFocus ? autoFocus : false}\r\n\t\t\t\t\t\t\t\t\t\tlabel={i18n.t(label) || i18n.t(placeholder)}\r\n\t\t\t\t\t\t\t\t\t\t/>}\r\n\t\t\t\t\r\n\t\t\t\t{...otherProps}\r\n\t\t\t\t/>\r\n\t\t</Field>\r\n\t\r\n\t);\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListDivider: {\r\n\t\tmargin: '0 0 5px 0'\r\n\t},\r\n\tdefaultListIcon: props => ({\r\n\t\t...theme.components.icon,\r\n\t\t...props.styles\r\n\t}),\r\n\thorizontalListItem: {\r\n\t\tdisplay: 'inline-block',\r\n\t\ttextAlign: 'center',\r\n\t\tpaddingRight: '16px',\r\n\t\twidth: '140px',\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\thorizontalListItemIcon: {\r\n\t\tminWidth: 'auto'\r\n\t},\r\n\thorizontalListItemAction: {\r\n\t\ttextAlign: 'center',\r\n\t\ttop: 0,\r\n\t\tright: 0,\r\n\t\tposition: 'static',\r\n\t\ttransform: 'none',\r\n\t},\r\n\tverticalListItemAction: {\r\n\t\ttextAlign: 'right'\r\n\t},\r\n});\r\n\r\n\r\nconst ListItemIconElement = withStyles(styles)(props => {\r\n\tconst { customClassNames, children, classes } = props;\r\n\t\r\n\tlet classNames = Array.isArray(customClassNames) ? customClassNames : [customClassNames];\r\n\tclassNames = classNames.map(className => (classes[className] ? classes[className] : className));\r\n\t\r\n\treturn <span className={clsx(classNames)}>{children}</span>\r\n});\r\n\r\n\r\nclass StateListItem extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tListItemTextWidth: '100%'\r\n\t\t}\r\n\t\t\r\n\t\tthis.state[this.props.device.primaryStateKey] = this.props.device.getDeviceState() || {}\r\n\t\t\r\n\t\tif (this.props.device.secondaryStateKey) {\r\n\t\t\tthis.state[this.props.device.secondaryStateKey] = this.props.device.getDeviceState(this.props.device.secondaryStateKey) || {}\r\n\t\t}\r\n\t\t\r\n\t\tthis.ListItemText = React.createRef();\r\n\t\tthis.ListItemSecondaryAction = React.createRef();\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\tthis.ListItemTextWidth = Math.floor(this.ListItemText.current.offsetWidth);\r\n\t\tthis.resizeComponent();\r\n\t\t\r\n\t\t// get state changes\r\n\t\tthis.props.device.listen(this.stateChange);\r\n\t}\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tthis.props.device.unlisten(this.stateChange);\r\n\t}\r\n\t\r\n\tcomponentDidUpdate() {\r\n\t\tthis.resizeComponent();\r\n\t}\r\n\t\r\n\tstateChange = (stateKey, state) => {\r\n\t\tif (stateKey === this.props.device.primaryStateKey || stateKey === this.props.device.secondaryStateKey) {\r\n\t\t\tthis.setState({ [stateKey]: state });\r\n\t\t}\r\n\t}\r\n\t\r\n\tresizeComponent() {\r\n\t\tconst ListItemSecondaryActionWidth = Math.floor(this.ListItemSecondaryAction.current.offsetWidth*1.08);\r\n\t\t\r\n\t\tif (this.state.ListItemSecondaryActionWidth !== ListItemSecondaryActionWidth) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tListItemSecondaryActionWidth: ListItemSecondaryActionWidth,\r\n\t\t\t\tListItemTextWidth: this.ListItemTextWidth-ListItemSecondaryActionWidth + 'px'\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, device, component, action } = this.props;\r\n\t\t\r\n\t\tconst state = this.state[device.primaryStateKey];\r\n\t\tconst options = device.get('options');\r\n\t\t\r\n\t\tconst icon = device.getIcon(device.primaryStateKey, state.val) || device.getIcon(device.primaryStateKey, state.value);\r\n\t\tconst primaryComponent = component && device.getComponent();\r\n\t\tconst primaryAction = device.getAction(device.primaryStateKey, device.options.primaryAction === false);\r\n\t\tconst secondaryAction = action && this.state[device.secondaryStateKey] ? device.getAction(device.secondaryStateKey) : null;\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{options.divider && options.divider !== 'after' && <ListItem divider className={classes.defaultListDivider} />}\r\n\t\r\n\t<ListItem\r\n\t\tclassName={clsx(this.props.openDialog && classes.finger, horizontal && classes.horizontalListItem)}\r\n\t\tbutton={this.props.openDialog !== null}\r\n\t\tonClick={this.props.openDialog && this.openDialog.bind(this)}\r\n\t\t>\r\n\t\t\r\n\t\t<ListItemIcon className={clsx(horizontal && classes.horizontalListItemIcon)}>\r\n\t\t{icon === null ? <React.Fragment /> :\r\n\t\t\t<ListItemIconElement customClassNames={['defaultListIcon','mdi mdi-' + icon]} styles={device.getStyle('icon', device.primaryStateKey, state.val)} />\r\n\t\t}\r\n\t\t</ListItemIcon>\r\n\t\t\r\n\t\t<ListItemText\r\n\t\t\tref={this.ListItemText}\r\n\t\t\tdisableTypography={primaryComponent !== false}\r\n\t\t\tprimary={primaryComponent || device.getOption('label')}\r\n\t\t\tsecondary={(options.subtitle !== null ? (options.subtitle || (state && state.timeChanged) || null) : null)}\r\n\t\t\tstyle={{ flex: 'initial', width: this.state.ListItemTextWidth }}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction\r\n\t\t\tref={this.ListItemSecondaryAction}\r\n\t\t\tclassName={ horizontal ? classes.horizontalListItemAction : classes.verticalListItemAction }\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{!secondaryAction ? primaryAction : [ primaryAction, <br key={'br_' + device.id} />, secondaryAction ]}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t\r\n\t{options.divider && options.divider === 'after' && <ListItem divider style={{margin: '5px 0'}} />}\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateListItem);\r\n","import React from 'react'\r\nimport i18n from '../i18n'\r\n\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport StateListItem from './StateListItem'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListSectionDivider: {\r\n\t\tmargin: '5px 0 0 0'\r\n\t},\r\n\tdefaultListSectionDividerItem: {\r\n\t\tmargin: '6px 0 7px 0',\r\n\t\tpadding: '0 16px !important'\r\n\t},\r\n\tdefaultListSectionText: {\r\n\t\tmargin: 0,\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: '0 0 0 10px',\r\n\t\t}\r\n\t},\r\n\thorizontalList: {\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'row',\r\n\t\tflexWrap: 'wrap'\r\n\t}\r\n});\r\n\r\n\r\nconst ListDivider = withStyles(styles)(props => {\r\n\tconst { classes, getDevicesBySubgroup, subgroup, title, subgroupActions } = props;\r\n\t\r\n\tconst handleChangeOn = () => handleChange(true);\r\n\tconst handleChangeOff = () => handleChange(false);\r\n\tconst handleChange = targetStatus => {\r\n\t\t\r\n\t\tconst devices = getDevicesBySubgroup(subgroup);\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\tlet status = targetStatus;\r\n\t\t\tif (device.primaryStateKey === 'level') {\r\n\t\t\t\tstatus = status ? (device.getOption('defaultValue') || 100) : 0;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdevice.setDeviceState(null, status);\r\n\t\t});\r\n\t}\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t<ListItem divider className={classes.defaultListSectionDivider} />\r\n\t<ListItem className={classes.defaultListSectionDividerItem}>\r\n\t\t<ListItemText\r\n\t\t\tclassName={classes.defaultListSectionText}\r\n\t\t\tprimary={title}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction>\r\n\t\t{subgroupActions === null || subgroupActions === false ? null :\r\n\t\t\t<ButtonGroup color=\"primary\" size=\"small\">\r\n\t\t\t\t<Button onClick={handleChangeOn}>{i18n.t('on')}</Button>\r\n\t\t\t\t<Button onClick={handleChangeOff}>{i18n.t('off')}</Button>\r\n\t\t\t</ButtonGroup>\r\n\t\t}\r\n\t\t\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n</React.Fragment>\r\n\t\r\n\t);\r\n});\r\n\r\nclass StateList extends React.Component {\r\n\t\r\n\tgetDevicesBySubgroup(subgroup) {\r\n\t\t\r\n\t\tlet devices = [];\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\r\n\t\t\tif (subgroup === device.getOption('subgroup')) {\r\n\t\t\t\tdevices.push(device);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn devices;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, devices, settings, component, action, ...props } = this.props;\r\n\t\tlet subgroup;\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense={true} className={horizontal && classes.horizontalList}>\r\n\t{devices.map((device, i) => {\r\n\t\t\r\n\t\tconst listSection = subgroup !== null && device.options.subgroup !== null && device.options.subgroup !== subgroup && <ListDivider\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={'ListDivider-' + device.get('id')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgetDevicesBySubgroup={this.getDevicesBySubgroup.bind(this)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroup={device.getOption('subgroup')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={device.options.subgroup}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsubgroupActions={settings.subgroupActions || device.options.subgroupActions}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tconst listItem = <StateListItem\r\n\t\t\t\t\t\t\t{...props}\r\n\t\t\t\t\t\t\tkey={'StateListItem-' + device.get('id')}\r\n\t\t\t\t\t\t\thorizontal={horizontal}\r\n\t\t\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t\t\tcomponent={component || false}\r\n\t\t\t\t\t\t\taction={action || true}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tsubgroup = device.getOption('subgroup');\r\n\t\treturn [ listSection, listItem ];\r\n\t})}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateList);\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt eine Liste von States an.\";\r\nexport const ModuleScreenshots = ['StateList1.png', 'StateList2.png', 'StateList3.png', 'StateList4.png'];\r\n\r\nexport const ModuleConfig = [\r\n\t{\r\n\t\t'parameter': 'subgroupActions',\r\n\t\t'label': {\r\n\t\t\t'en': 'Show on/off actions for sugroups',\r\n\t\t\t'de': 'Buttons an/aus für Untergruppen einblenden'\r\n\t\t},\r\n\t\t'type': 'Switch',\r\n\t\t'val': true\r\n\t}\r\n]\r\n","import { format } from 'date-fns'\r\nimport i18n, { locales } from '../i18n'\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToSeconds(time) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\ttime = time.toString();\r\n\t\tlet format = time.split(':').length-1;\r\n\t\tlet [ hours, minutes, seconds ] = format > 1 ? time.split(':') : ('0:' + time).split(':');\r\n\t\ttime = parseInt(hours) * 3600 + parseInt(minutes) * 60 + parseInt(seconds);\r\n\t}\r\n\t\r\n\treturn parseInt(time);\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction timeToHoursMinutesSeconds(time, withHours = false) {\r\n\t\r\n\tif (time.toString().indexOf(':') > -1) {\r\n\t\treturn time;\r\n\t}\r\n\t\r\n\ttime = parseInt(time);\r\n\twithHours = withHours || (time > 3600);\r\n\t\r\n\tif (Number.isNaN(time)) {\r\n\t\treturn withHours ? '00:00:00' : '00:00';\r\n\t}\r\n\t\r\n\tlet hours = '0' + Math.floor(time/3600);\r\n\tlet minutes = '0' + Math.floor(time/60);\r\n\tlet seconds = '0' + (time % 60);\r\n\t\r\n\treturn withHours ? [ hours.substr(-2), minutes.substr(-2), seconds.substr(-2) ].join(':') : [ minutes.substr(-2), seconds.substr(-2) ].join(':');\r\n}\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction secondsToDateTime(seconds, dateTimeFormat = 'dd. MMM yyyy, HH:mm') {\r\n\treturn format(new Date(seconds*1000), dateTimeFormat, { locale: locales[i18n.getLanguage()] });\r\n}\r\n\r\n\r\nexport default {\r\n\ttimeToSeconds,\r\n\ttimeToHoursMinutesSeconds,\r\n\tsecondsToDateTime\r\n}","/**\r\n * Settings\r\n *\r\n *\r\n */\r\nexport default class Log {\r\n\r\n\t/*\r\n\t * holds the log\r\n\t */\r\n\tstatic log = [];\r\n\r\n\t/**\r\n\t * Add a message to the log\r\n\t *\r\n\t * @param\t{String}\t\tmodule\t\t\t\t\t\tModule (origin) of log message\r\n\t * @param\t{String|Array}\tmessage\t\t\t\t\t\tLog message\r\n\t * @param\t{String}\t\t[criticality=info]\t\t\tCriticality, one of 'debug', 'info', 'warn' or 'error'\r\n\t * @param\t{Boolean}\t\t[printToConsole=false]\t\tPrint log message to console\r\n\t * @param\t{Object}\t\t[stack={}]\t\t\t\t\tStack trace of error message\r\n\t * @return\t{Log}\r\n\t */\r\n\tstatic _(module, message, criticality = 'info', printToConsole = true, stack = {}) {\r\n\t\tmessage = Array.isArray(message) ? message : [message];\r\n\t\tmessage.forEach(entry => {\r\n\t\t\tLog.log.push({\r\n\t\t\t\ttime: new Date(),\r\n\t\t\t\tmodule: module,\r\n\t\t\t\tcriticality: criticality,\r\n\t\t\t\tmessage: entry,\r\n\t\t\t\tstack: stack\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\tif (printToConsole) {\r\n\t\t\tmessage[0] = module + ' # ' + message[0];\r\n\t\t\tconsole[criticality](...message); // https://nodejs.org/docs/latest/api/console.html\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the log\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Array}\r\n\t */\r\n\tstatic getLog() {\r\n\t\treturn Log.log;\r\n\t}\r\n}\r\n","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport clsx from 'clsx'\r\n\r\nimport { lighten, makeStyles } from '@material-ui/core/styles'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\n\r\nconst useToolbarStyles = makeStyles(theme => ({\r\n  root: {\r\n    paddingLeft: theme.spacing(2),\r\n    paddingRight: theme.spacing(1),\r\n  },\r\n  highlight:\r\n    theme.palette.type === 'light'\r\n      ? {\r\n          color: theme.palette.secondary.main,\r\n          backgroundColor: lighten(theme.palette.secondary.light, 0.85),\r\n        }\r\n      : {\r\n          color: theme.palette.text.primary,\r\n          backgroundColor: theme.palette.secondary.dark,\r\n        },\r\n  title: {\r\n    flex: '1 1 100%',\r\n  },\r\n}));\r\n\r\nexport default function EnhancedTableToolbar(props) {\r\n  const classes = useToolbarStyles();\r\n  const { title, rowCount, numSelected, rightActionButton } = props;\r\n\r\n  return (\r\n    <Toolbar\r\n      className={clsx(classes.root, {\r\n        [classes.highlight]: numSelected > 0,\r\n      })}\r\n    >\r\n      {numSelected > 0 ? (\r\n        <Typography className={classes.title} color=\"inherit\" variant=\"subtitle1\">\r\n          {numSelected} selected\r\n        </Typography>\r\n      ) : (\r\n        <Typography className={classes.title} variant=\"h6\" id=\"tableTitle\">\r\n\t\t\t{title !== undefined && (title + ' (' + rowCount + ')')}\r\n        </Typography>\r\n      )}\r\n\r\n      {numSelected > 0 ? (\r\n        <Tooltip title=\"Delete\">\r\n          <IconButton aria-label=\"delete\">\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        </Tooltip>\r\n      )\r\n\t  : rightActionButton}\r\n    </Toolbar>\r\n  );\r\n};\r\n\r\nEnhancedTableToolbar.propTypes = {\r\n  numSelected: PropTypes.number.isRequired,\r\n};","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\nimport TableHead from '@material-ui/core/TableHead'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableSortLabel from '@material-ui/core/TableSortLabel'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\n\r\n\r\nexport default function EnhancedTableHead(props) {\r\n  const { headCells, onSelectAllClick, selectable, sortable, order, orderBy, numSelected, rowCount, onRequestSort } = props;\r\n  const createSortHandler = property => event => {\r\n    onRequestSort(event, property);\r\n  };\r\n\r\n  return (\r\n    <TableHead>\r\n      <TableRow>\r\n\t\t{selectable !== false &&\r\n\t\t\t<TableCell padding=\"checkbox\">\r\n\t\t\t  <Checkbox\r\n\t\t\t\tindeterminate={numSelected > 0 && numSelected < rowCount}\r\n\t\t\t\tchecked={rowCount > 0 && numSelected === rowCount}\r\n\t\t\t\tonChange={onSelectAllClick}\r\n\t\t\t\tinputProps={{ 'aria-label': 'select all' }}\r\n\t\t\t  />\r\n\t\t\t</TableCell>\r\n\t\t}\r\n\t\t\r\n        {headCells.map(headCell => (\r\n          <TableCell\r\n            key={headCell.id}\r\n            align={headCell.align || 'left'}\r\n            padding={headCell.disablePadding ? 'none' : 'default'}\r\n            sortDirection={sortable && (orderBy === headCell.id ? order : false)}\r\n\t\t\tstyle={{ width: headCell.width || 'auto' }}\r\n          >\r\n\t\t  {sortable ?\r\n            <TableSortLabel\r\n              active={orderBy === headCell.id}\r\n              direction={orderBy === headCell.id ? order : 'asc'}\r\n              onClick={createSortHandler(headCell.orderBy || headCell.id)}\r\n            >\r\n              <strong>{headCell.label}</strong>\r\n            </TableSortLabel>\r\n\t\t\t:\r\n\t\t\t <strong>{headCell.label}</strong>\r\n\t\t\t}\r\n          </TableCell>\r\n        ))}\r\n      </TableRow>\r\n    </TableHead>\r\n  );\r\n}\r\n\r\nEnhancedTableHead.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n  numSelected: PropTypes.number.isRequired,\r\n  onRequestSort: PropTypes.func.isRequired,\r\n  onSelectAllClick: PropTypes.func.isRequired,\r\n  order: PropTypes.oneOf(['asc', 'desc']).isRequired,\r\n  orderBy: PropTypes.string.isRequired,\r\n  rowCount: PropTypes.number.isRequired,\r\n};","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React from 'react'\r\nimport clsx from 'clsx'\r\nimport { format } from 'date-fns'\r\n\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableCell from '@material-ui/core/TableCell'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport Checkbox from '@material-ui/core/Checkbox'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tnoWrap: {\r\n\t\twhiteSpace: 'nowrap'\r\n\t}\r\n}));\r\n\r\n\r\n// https://stackoverflow.com/questions/9382167/serializing-object-that-contains-cyclic-object-value\r\nfunction nestedObjects(key, val, seen) {\r\n\t\r\n\tif (val !== null && typeof val === 'object') {\r\n\t\tif (seen.indexOf(val) >= 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tseen.push(val);\r\n\t}\r\n\t\r\n\treturn val;\r\n}\r\n\r\nfunction showTableContent(content, type = '') {\r\n\t\r\n\tif (content === undefined || content === null) {\r\n\t\treturn '';\r\n\t}\r\n\t\r\n\tlet seen = [];\r\n\tswitch(type.toLowerCase()) {\r\n\t\tcase 'date':\r\n\t\t\tcontent = format(content, 'yyyy-MM-dd HH:mm:ss');\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault:\r\n\t\t\tcontent = Array.isArray(content) || typeof content === 'object' ? JSON.stringify(content, (key, val) => nestedObjects(key, val, seen)) : content;\r\n\t\t\tcontent = typeof content === 'boolean' ? content.toString() : content;\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn content;\r\n}\r\n\r\nexport default function EnhancedTable(props) {\r\n\tconst { columns, sortedRows, emptyRows, rowStyles, selectable, selected, onClick } = props;\r\n\tconst classes = useStyles();\r\n\tconst isSelected = id => selected.indexOf(id) !== -1;\r\n\r\n\treturn (\r\n\r\n<TableBody>\r\n\t{sortedRows.map((row, index) => {\r\n\t\tconst isItemSelected = isSelected(row.id);\r\n\t\tconst labelId = `enhanced-table-checkbox-${index}`;\r\n\t\t\r\n\t\tlet styles = {};\r\n\t\tfor (let columnId in rowStyles) {\r\n\t\t\tlet rowStyle = rowStyles[columnId];\r\n\t\t\t\r\n\t\t\tif (row[columnId] && Object.keys(rowStyle).indexOf(row[columnId]) > -1) {\r\n\t\t\t\tstyles = { ...styles, ...rowStyle[row[columnId]] };\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n\t<TableRow\r\n\t\tkey={'TableRow-' + index}\r\n\t\thover\r\n\t\tonClick={onClick ? (event => onClick(event, row.id)) : undefined}\r\n\t\trole=\"checkbox\"\r\n\t\taria-checked={isItemSelected}\r\n\t\ttabIndex={-1}\r\n\t\tselected={isItemSelected}\r\n\t\t>\r\n\t\t\r\n\t\t{selectable !== false &&\r\n\t\t<TableCell\r\n\t\t\tkey={'TableCell-' + index + '-Checkbox'}\r\n\t\t\tstyle={styles}\r\n\t\t\tpadding=\"checkbox\"\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<Checkbox\r\n\t\t\t\tchecked={isItemSelected}\r\n\t\t\t\tinputProps={{ 'aria-labelledby': labelId }}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</TableCell>\r\n\t\t}\r\n\t\t\r\n\t\t{columns.map(column => (\r\n\t\t<TableCell\r\n\t\t\tkey={'TableCell-' + index + '-' + column.id}\r\n\t\t\tclasses={{ root: clsx(column.noWrap && classes.noWrap) }}\r\n\t\t\tstyle={styles}\r\n\t\t\tscope=\"row\"\r\n\t\t\tpadding={column.disablePadding ? 'none' : 'default'}\r\n\t\t\t>\r\n\r\n\t\t\t{showTableContent(row[column.id], column.type)}\r\n\t\t</TableCell>\r\n\r\n\t\t))}\r\n\r\n\t</TableRow>\r\n\t\t\r\n\t\t);\r\n\t})}\r\n\t\r\n\t{emptyRows > 0 && (\r\n\t<TableRow style={{ height: 53 * emptyRows }}>\r\n\t\t<TableCell colSpan={6} />\r\n\t</TableRow>\r\n\t)}\r\n\t\r\n</TableBody>\r\n\r\n\t);\r\n}","/*\r\n * Code by MATERIAL-UI\r\n * @see https://material-ui.com/components/tables/#sorting-amp-selecting\r\n *\r\n */\r\nimport React, { useEffect } from 'react'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport Table from '@material-ui/core/Table'\r\nimport TableContainer from '@material-ui/core/TableContainer'\r\nimport TablePagination from '@material-ui/core/TablePagination'\r\n\r\nimport EnhancedTableToolbar from '../components/EnhancedTableToolbar'\r\nimport EnhancedTableHead from '../components/EnhancedTableHead'\r\nimport EnhancedTableBody from '../components/EnhancedTableBody'\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  table: {\r\n    minWidth: 750,\r\n  }\r\n}));\r\n\r\n\r\nfunction descendingComparator(a, b, orderBy, orderByCase) {\r\n\t\r\n\tlet orderA, orderB;\r\n\tif (orderBy.indexOf('.') === -1) {\r\n\t\torderA = a[orderBy] || '';\r\n\t\torderB = b[orderBy] || '';\r\n\t}\r\n\telse {\r\n\t\tlet tmpA = { ...a };\r\n\t\tlet tmpB = { ...b };\r\n\t\tlet key = orderBy;\r\n\t\tlet index;\r\n\t\t\r\n\t\twhile (key.indexOf('.') > -1) {\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tindex = key.substr(0, key.indexOf('.'));\r\n\t\t\t\tkey = key.substr(key.indexOf('.')+1);\r\n\t\t\t\ttmpA = tmpA[index];\r\n\t\t\t\ttmpB = tmpB[index];\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tconsole.error(err.message);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\torderA = tmpA[key] || '';\r\n\t\torderB = tmpB[key] || '';\r\n\t}\r\n\t\r\n\tif (orderByCase !== true) {\r\n\t\torderA = typeof orderA === 'object' ? JSON.stringify(orderA) : orderA.toLowerCase();\r\n\t\torderB = typeof orderB === 'object' ? JSON.stringify(orderB) : orderB.toLowerCase();\r\n\t}\r\n\t\r\n\t\r\n  if (orderB < orderA) {\r\n    return -1;\r\n  }\r\n  if (orderB > orderA) {\r\n    return 1;\r\n  }\r\n  return 0;\r\n}\r\n\r\nfunction getComparator(order, orderBy, orderByCase) {\r\n  return order === 'desc'\r\n    ? (a, b) => descendingComparator(a, b, orderBy, orderByCase)\r\n    : (a, b) => -descendingComparator(a, b, orderBy, orderByCase);\r\n}\r\n\r\nfunction stableSort(array, comparator) {\r\n  const stabilizedThis = array.map((el, index) => [el, index]);\r\n  stabilizedThis.sort((a, b) => {\r\n    const order = comparator(a[0], b[0]);\r\n    if (order !== 0) return order;\r\n    return a[1] - b[1];\r\n  });\r\n  return stabilizedThis.map(el => el[0]);\r\n}\r\n\r\nexport default function EnhancedTable(props) {\r\n  const classes = useStyles();\r\n  \r\n  const { title, headCells, size, CustomTableBody, rows, toolbar, selectable, pagination, defaultOrder, defaultOrderBy, orderByCase, defaultSelected, defaultPage, defaultRowsPerPage, toolbarRightActionButton } = props;\r\n  \r\n  const [order, setOrder] = React.useState(defaultOrder || 'asc');\r\n  const [orderBy, setOrderBy] = React.useState(defaultOrderBy || headCells[0].orderBy || headCells[0].id);\r\n  const [selected, setSelected] = React.useState(defaultSelected || []);\r\n  const [page, setPage] = React.useState(defaultPage || 0);\r\n  const [rowsPerPage, setRowsPerPage] = React.useState(pagination ? (defaultRowsPerPage || 5) : rows.length);\r\n\r\nuseEffect(() => setRowsPerPage(pagination ? (defaultRowsPerPage || 5) : rows.length), [rows.length, pagination, defaultRowsPerPage]);\r\n\r\n\r\n  const handleRequestSort = (event, property) => {\r\n    const isAsc = orderBy === property && order === 'asc';\r\n    setOrder(isAsc ? 'desc' : 'asc');\r\n    setOrderBy(property);\r\n  };\r\n\r\n  const handleSelectAllClick = event => {\r\n    if (event.target.checked) {\r\n      const newSelecteds = rows.map(n => n.id);\r\n      setSelected(newSelecteds);\r\n      return;\r\n    }\r\n    setSelected([]);\r\n  };\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = event => {\r\n    setRowsPerPage(parseInt(event.target.value, 10));\r\n    setPage(0);\r\n  };\r\n\r\n  const selectRow = (event, id) => {\r\n    const selectedIndex = selected.indexOf(id);\r\n    let newSelected = [];\r\n\r\n    if (selectedIndex === -1) {\r\n      newSelected = newSelected.concat(selected, id);\r\n    } else if (selectedIndex === 0) {\r\n      newSelected = newSelected.concat(selected.slice(1));\r\n    } else if (selectedIndex === selected.length - 1) {\r\n      newSelected = newSelected.concat(selected.slice(0, -1));\r\n    } else if (selectedIndex > 0) {\r\n      newSelected = newSelected.concat(\r\n        selected.slice(0, selectedIndex),\r\n        selected.slice(selectedIndex + 1),\r\n      );\r\n    }\r\n\r\n    setSelected(newSelected);\r\n  };\r\n\r\n  const TableBody = CustomTableBody || EnhancedTableBody;\r\n  return (\r\n\t<React.Fragment>\r\n\t\t{toolbar !== false &&\r\n        <EnhancedTableToolbar\r\n\t\t  title={title}\r\n          rowCount={rows.length}\r\n\t\t  numSelected={selected.length || 0}\r\n\t\t  rightActionButton={toolbarRightActionButton}\r\n\t\t  />}\r\n\t\t\r\n        <TableContainer>\r\n          <Table\r\n            className={classes.table}\r\n            aria-labelledby=\"tableTitle\"\r\n            aria-label=\"enhanced table\"\r\n\t\t\tsize={size}\r\n\t\t\tstickyHeader={true}\r\n          >\r\n            <EnhancedTableHead\r\n              classes={classes}\r\n              numSelected={selected.length}\r\n              order={order}\r\n              orderBy={orderBy}\r\n              onSelectAllClick={handleSelectAllClick}\r\n              onRequestSort={handleRequestSort}\r\n              rowCount={rows.length}\r\n\t\t\t  {...props}\r\n            />\r\n\t\t\t\r\n\t\t\t<TableBody\r\n\t\t\t\tcolumns={headCells}\r\n\t\t\t\tsortedRows={stableSort(rows, getComparator(order, orderBy, orderByCase)).slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)}\r\n\t\t\t\temptyRows={rowsPerPage - Math.min(rowsPerPage, rows.length - page * rowsPerPage)}\r\n\t\t\t\tonClick={selectable !== false && selectRow}\r\n\t\t\t\tselected={selected}\r\n\t\t\t\t{...props}\r\n\t\t\t\t/>\r\n\t\t\t\r\n          </Table>\r\n        </TableContainer>\r\n\t\t{pagination && <TablePagination\r\n          rowsPerPageOptions={[5, 10, 25]}\r\n          component=\"div\"\r\n          count={rows.length}\r\n          rowsPerPage={rowsPerPage}\r\n          page={page}\r\n          onChangePage={handleChangePage}\r\n          onChangeRowsPerPage={handleChangeRowsPerPage}\r\n        />}\r\n\t</React.Fragment>\r\n\t\r\n  );\r\n}","import i18n from '../../i18n'\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./door.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'Doors',\r\n\t\t'de': 'Türen',\r\n\t},\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\ttrue: 'door-open',\r\n\t\t\t\tfalse: 'door-closed'\r\n\t\t\t},\r\n\t\t\tdisplay: {\r\n\t\t\t\ttrue: i18n.t('door#open#true'),\r\n\t\t\t\tfalse: i18n.t('door#open#false')\r\n\t\t\t},\r\n\t\t},\r\n\t\tlock: {\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport i18n from '../../i18n'\r\nimport defaults from '../defaults'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./heating.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction HeatingSetTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={0} max={35} {...props} />\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'Heating',\r\n\t\t'de': 'Heizung',\r\n\t},\r\n\tconfigurations: {\r\n\t\ttemperature: {\r\n\t\t\tvalue: val => val.toFixed(1),\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'radiator',\r\n\t\t},\r\n\t\tsetTemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer-chevron-up'\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tboost: {\r\n\t\t\ticon: 'radiator'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tsetTemperature: HeatingSetTemperatureComponent\r\n\t},\r\n\tactions: {\r\n\t\tboost: defaults.actions.PowerAction\r\n\t}\r\n}","import i18n from '../../i18n'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./location.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'locations',\r\n\t\t'de': 'Orte',\r\n\t},\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tpresence: {\r\n\t\t\ticon: {\r\n\t\t\t\ttrue: 'map-marker-radius',\r\n\t\t\t\tfalse: 'map-marker-remove-outline'\r\n\t\t\t},\r\n\t\t\tdisplay: {\r\n\t\t\t\ttrue: i18n.t('location#presence#true'),\r\n\t\t\t\tfalse: i18n.t('location#presence#false'),\r\n\t\t\t},\r\n\t\t},\r\n\t\tusers: {\r\n\t\t\ticon: {\r\n\t\t\t\t'': 'account-group-outline',\r\n\t\t\t\t'default': 'account-group'\r\n\t\t\t},\r\n\t\t\tdisplay: {\r\n\t\t\t\t'': i18n.t('location#users#empty')\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t}\r\n}","import i18n from '../../i18n'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./user.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'users',\r\n\t\t'de': 'Benutzer',\r\n\t},\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tlocation: {\r\n\t\t\ticon: 'account'\r\n\t\t},\r\n\t\tbattery: {\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t}\r\n}","import i18n from '../../i18n'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./window.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'windows',\r\n\t\t'de': 'Fenster',\r\n\t},\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\ttrue: 'window-open-variant',\r\n\t\t\t\tfalse: 'window-closed-variant'\r\n\t\t\t},\r\n\t\t\tdisplay: {\r\n\t\t\t\ttrue: i18n.t('window#open#true'),\r\n\t\t\t\tfalse: i18n.t('window#open#false')\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport Chip from '@material-ui/core/Chip'\r\nimport { TextAutoComplete } from './Text'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles((theme) => ({\r\n\tchip: {\r\n\t\tmargin: theme.spacing(0.5),\r\n\t},\r\n}));\r\n\r\n\r\n/*\r\n *\r\n */\r\nexport default function InputChip(props) {\r\n\tconst { icon, color, label, onDelete, deleteIcon } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\tconst handleDelete = () => onDelete && onDelete();\r\n\treturn (\r\n\t\t<Chip\r\n\t\t\tclassName={classes.chip}\r\n\t\t\ticon={icon}\r\n\t\t\tcolor={color}\r\n\t\t\tlabel={label}\r\n\t\t\tonDelete={handleDelete}\r\n\t\t\tdeleteIcon={deleteIcon}\r\n\t\t\t/>\r\n\t)\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport function InputChips(props) {\r\n\tconst { list, ...otherProps } = props;\r\n\t\r\n\tconst chips = Array.isArray(list) ? list : list.split(',');\r\n\treturn chips.map(chip => typeof chip === 'string' ? InputChip({ label: chip, ...otherProps }) : InputChip({ ...chip, ...otherProps }));\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport function InputChipsField(props) {\r\n\tconst { optionKey, ...otherProps } = props;\r\n\t\r\n\treturn (\r\n\t\t<TextAutoComplete\r\n\t\t\tmultiple\r\n\t\t\tfreeSolo\r\n\t\t\tgetOptionLabel={option => optionKey ? option[optionKey] : option}\r\n\t\t\t{...otherProps}\r\n\t\t\t/>\r\n\t);\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\nimport i18n from '../../i18n'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles((theme) => ({\r\n\tnoPadding: {\r\n\t\tpadding: '0 !important'\r\n\t},\r\n\tFieldset: {\r\n\t\tpadding: theme.spacing(0.5, 3, 2, 3)\r\n\t},\r\n\tFieldsetItem: {\r\n\t\tpadding: theme.spacing(2, 0, 1, 0)\r\n\t},\r\n\tLegend: {\r\n\t\tfontSize: '1.2rem',\r\n\t\tcolor: theme.palette.primary.dark,\r\n\t\tpadding: theme.spacing(1, 3),\r\n\t},\r\n}));\r\n\r\n/*\r\n *\r\n */\r\nexport default function Fieldset(props) {\r\n\tconst { children, noPadding, ...otherProps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<FieldsetLegend {...otherProps} />\r\n\t\t\t<Grid container className={clsx(classes.Fieldset, noPadding && classes.noPadding)} {...otherProps}>\r\n\t\t\t\t{children}\r\n\t\t\t</Grid>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport function FieldsetItem(props) {\r\n\tconst { container, children, columns } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<Grid\r\n\t\t\tcontainer={container || false}\r\n\t\t\titem\r\n\t\t\tclassName={classes.FieldsetItem}\r\n\t\t\txs={columns || 12}\r\n\t\t\t{...props}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{children}\r\n\t\t</Grid>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport function FieldsetLegend(props) {\r\n\tconst classes = useStyles();\r\n\treturn !props.label ? null : (\r\n\t\t<>\r\n\t\t\t<Typography className={classes.Legend} variant=\"h3\">{props.label}</Typography>\r\n\t\t\t<Divider />\r\n\t\t</>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport function Form(props) {\r\n\tconst { children } = props;\r\n\t\r\n\treturn (\r\n\t\t<MuiPickersUtilsProvider utils={i18n.getLocaleDateAdapter()} locale={i18n.getLocale()}>\r\n\t\t\t{children}\r\n\t\t</MuiPickersUtilsProvider>\r\n\t);\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { format } from 'date-fns'\r\n\r\nimport Connection from '../Connection'\r\nimport i18n, { locales } from '../i18n'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport List from '@material-ui/core/List'\r\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport StarIcon from '@material-ui/icons/Star';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tnoUpdates: {\r\n\t\tfontStyle: 'italic',\r\n\t\ttextAlign: 'right',\r\n\t\tcolor: 'rgba(0, 0, 0, 0.54)'\r\n\t},\r\n\tUpdateAvailable: {\r\n\t\tcolor: '#CCAA00',\r\n\t},\r\n\tUpdatesListItem: {\r\n\t\tbackgroundColor: '#ffd700',\r\n\t\tcolor: '#fff',\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t\tpaddingLeft: theme.spacing(2)\r\n\t},\r\n\tUpdatesIndicator: {\r\n\t\tright: theme.spacing(3.75),\r\n\t\tbackgroundColor: '#CCAA00',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t\tcolor: '#fff',\r\n\t\ttextAlign: 'center',\r\n\t\tfontSize: '1rem !important'\r\n\t},\r\n\tStatusIndicator: {\r\n\t\tfontSize: '1.4rem'\r\n\t},\r\n\tloading: {\r\n\t\ttextAlign: 'center',\r\n\t\tmarginTop: '5px'\r\n\t},\r\n\tsmall: {\r\n\t\twidth: theme.spacing(3),\r\n\t\theight: theme.spacing(3),\r\n\t},\r\n\talive: {\r\n\t\tcolor: '#86d686'\r\n\t},\r\n\tnotAlive: {\r\n\t\tcolor: '#f7e43b'\r\n\t},\r\n\tdisabled: {\r\n\t\tcolor: '#bababa'\r\n\t}\r\n});\r\n\r\n\r\nclass AdapterStatus extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tadapterInformation: [],\r\n\t\t\tadapterAliveStatus: {},\r\n\t\t\tnewUpdates: false,\r\n\t\t\tupdatesJson: '',\r\n\t\t\tlastUpdateCheck: ''\r\n\t\t}\r\n\t\t\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\tthis.list = this.props.settings.list ? (Array.isArray(this.props.settings.list) ? this.props.settings.list : this.props.settings.list.split(',')) : null;\r\n\t\tthis.blacklist = this.props.settings.blacklist ? (Array.isArray(this.props.settings.blacklist) ? this.props.settings.blacklist : this.props.settings.blacklist.split(',')) : null;\r\n\t\t\r\n\t\tthis.updateStates = ['admin.0.info.newUpdates', 'admin.0.info.lastUpdateCheck', 'admin.0.info.updatesJson'];\r\n\t\tthis.adapterStates = [];\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// retrieve updates\r\n\t\tif (this.props.settings.updates !== false) {\r\n\t\t\t\r\n\t\t\tthis.socket.getStates(this.updateStates, (err, states) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tnewUpdates: states['admin.0.info.newUpdates'].val,\r\n\t\t\t\t\tlastUpdateCheck: states['admin.0.info.lastUpdateCheck'].val,\r\n\t\t\t\t\tupdatesJson: states['admin.0.info.updatesJson'].val\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// get state updates\r\n\t\t\t\tthis.socket.subscribeStates(this.updateStates, (id, update) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tid = id.substr(id.lastIndexOf('.')+1);\r\n\t\t\t\t\tif (this.state[id] !== update.val) {\r\n\t\t\t\t\t\tthis.setState({ [id]: update.val });\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get adapter instances\r\n\t\tthis.socket.getAdapterInstances((err, instances) => {\r\n\t\t\t\r\n\t\t\tif (instances && instances.rows) {\r\n\t\t\t\tlet adapters = [];\r\n\t\t\t\t\r\n\t\t\t\t// states per instance to retrieve\r\n\t\t\t\tinstances.rows.forEach((instance, i) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get alive / connected states\r\n\t\t\t\t\tif ((!this.list || (this.list && this.list.indexOf(instance.value.common.name) > -1)) && (!this.blacklist || (this.blacklist && this.blacklist.indexOf(instance.value.common.name) === -1))) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tadapters.push(instance);\r\n\t\t\t\t\t\tthis.adapterStates = this.adapterStates.concat([\r\n\t\t\t\t\t\t\tinstance.id + '.alive',\r\n\t\t\t\t\t\t\tinstance.id + '.connected',\r\n\t\t\t\t\t\t\tinstance.id.replace('system.adapter.', '') + '.info.connection'\r\n\t\t\t\t\t\t]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// sort instances\r\n\t\t\t\tthis.setState({ adapterInformation: adapters.sort((item1, item2) => {\r\n\t\t\t\t\t\tif (item1.id > item2.id) return 1;\r\n\t\t\t\t\t\telse if (item2.id > item1.id) return -1;\r\n\t\t\t\t\t\telse return 0;\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t// retrieve intial states\r\n\t\t\t\tthis.socket.getStates(this.adapterStates, (err, adapterAliveStatus) => {\r\n\t\t\t\t\tthis.setState({ adapterAliveStatus });\r\n\t\t\t\t\t\r\n\t\t\t\t\t// get state updates\r\n\t\t\t\t\tthis.socket.subscribeStates(this.adapterStates, (id, aliveStatus) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (aliveStatus && (!this.state.adapterAliveStatus[id] || (aliveStatus.val !== this.state.adapterAliveStatus[id].val))) {\r\n\t\t\t\t\t\t\tthis.setState(prevState => ({ adapterAliveStatus: { ...prevState.adapterAliveStatus, [id]: aliveStatus } }));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tthis.socket.unsubscribeStates([ ...this.updateStates, ...this.adapterStates ]);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\t// adapter updates\r\n\t\tconst updateList = (this.state.updatesJson && JSON.parse(this.state.updatesJson)) || {};\r\n\t\tconst updates = Object.keys(updateList).length\r\n\t\t\r\n\t\t// adapter instances\r\n\t\tlet adapterList = <ListItem key='loading' className={classes.loading}><CircularProgress size={20} /></ListItem>\r\n\t\t\r\n\t\tif (this.state.adapterInformation.length > 0) {\r\n\t\t\t\r\n\t\t\tadapterList = this.state.adapterInformation.map(adapter => {\r\n\t\t\t\tadapter.update = updateList[adapter.value.common.name] || false;\r\n\t\t\t\t\r\n\t\t\t\tconst enabled = adapter.value.common.enabled;\r\n\t\t\t\tconst alive = (this.state.adapterAliveStatus[adapter.id + '.alive'] && this.state.adapterAliveStatus[adapter.id + '.alive'].val) || false;\r\n\t\t\t\tconst connected = (this.state.adapterAliveStatus[adapter.id + '.connected'] && this.state.adapterAliveStatus[adapter.id + '.connected'].val) || false;\r\n\t\t\t\tconst connection = this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'] ? this.state.adapterAliveStatus[adapter.id.replace('system.adapter.', '') + '.info.connection'].val : true;\r\n\t\t\t\t\r\n\t\t\t\tconst tooltip = i18n.t('Adapter') + ' ' + (enabled ? (alive && connected && connection ? i18n.t('alive') : i18n.t('not alive')) : i18n.t('disabled'));\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t\r\n\t\t\t\t\t<ListItem key={'adapter-' + adapter.id}>\r\n\t\t\t\t\t\t<ListItemAvatar>\r\n\t\t\t\t\t\t\t<Avatar alt={adapter.value.common.name} src={adapter.value.common.extIcon} className={classes.small} />\r\n\t\t\t\t\t\t</ListItemAvatar>\r\n\t\t\t\t\t\t<ListItemText\r\n\t\t\t\t\t\t\tprimary={adapter.value.common.title}\r\n\t\t\t\t\t\t\tsecondary={[\r\n\t\t\t\t\t\t\t\t'v' + adapter.value.common.version,\r\n\t\t\t\t\t\t\t\t(adapter.update && adapter.value.common.version !== adapter.update.availableVersion && (<span key={'updates-' + adapter.id}>, <span className={classes.UpdateAvailable}>{i18n.t('Update available') + ' v' + adapter.update.availableVersion}</span></span>)),\r\n\t\t\t\t\t\t\t\t(adapter.value.common.runAsCompactMode && ', ' + i18n.t('Compact Mode') + ' ' + i18n.t('on') + ' (' + i18n.t('Group') + ' ' + adapter.value.common.compactGroup + ')')\r\n\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, enabled ? (alive && connected && connection ? classes.alive : classes.notAlive) : classes.disabled)}>\r\n\t\t\t\t\t\t\t<Tooltip title={tooltip}>\r\n\t\t\t\t\t\t\t\t<span className={enabled ? (alive && connected && connection ? 'mdi mdi-check-circle' : 'mdi mdi-alert') : 'mdi mdi-close'}></span>\r\n\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t\t\t</ListItem>\r\n\t\t\t\t\r\n\t\t\t\t)\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<List dense>\r\n\t{this.state.newUpdates === false ? (this.state.lastUpdateCheck && \r\n\t<ListItem key=\"updates\" classes={{ root: classes.noUpdates }}>\r\n\t\t<ListItemText\r\n\t\t\tprimary={i18n.t('last update') + ': ' + format(new Date(this.state.lastUpdateCheck), 'dd.MM.yyyy HH:mm:ss', { locale: locales[i18n.getLanguage()] })}\r\n\t\t\t/>\r\n\t\t\r\n\t</ListItem>)\r\n\t:\r\n\t<ListItem key=\"updates\" classes={{ container: classes.UpdatesListItem }}>\r\n\t\t<ListItemAvatar>\r\n\t\t\t<StarIcon />\r\n\t\t</ListItemAvatar>\r\n\t\t<ListItemText\r\n\t\t\tprimary={i18n.t('Updates available') + '!'}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={clsx(classes.StatusIndicator, classes.UpdatesIndicator)}>\r\n\t\t\t{updates}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t}\r\n\t\r\n\t{adapterList}\r\n</List>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nexport default withStyles(styles)(AdapterStatus);\r\n\r\nexport const ModuleSettings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Adapter Status'),\r\n\ticon: 'traffic-light'\r\n}\r\n\r\nexport const ModuleDescription = \"Zeigt alle installierten Adapter mit ihren Instanzen und dem jeweiligen Status (active & alive, active & not connected, inactive) an.\";\r\nexport const ModuleScreenshots = ['AdapterStatus1.png'];\r\n\r\nexport const ModuleConfig = [\r\n\t{\r\n\t\t'parameter': 'updates',\r\n\t\t'label': 'Adapter Updates',\r\n\t\t'description': {\r\n\t\t\t'en': 'Enable to show adapters updates',\r\n\t\t\t'de': 'Aktivieren, um Adapter Updates anzuzeigen'\r\n\t\t},\r\n\t\t'type': 'Switch',\r\n\t\t'val': true\r\n\t},\r\n\t{\r\n\t\t'parameter': 'list',\r\n\t\t'label': {\r\n\t\t\t'en': 'List of Adapter\\'s',\r\n\t\t\t'de': 'Liste angezeigter Adapter'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'List of adapters to show (empty shows all adapters)',\r\n\t\t\t'de': 'Liste der Adapter, die angezeigt werden (leere Liste zeigt alle Adapter)'\r\n\t\t},\r\n\t\t'values': {\r\n\t\t\t'en': 'Adapter names separated by comma',\r\n\t\t\t'de': 'Namen der Adapter mit Komma separiert'\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t'parameter': 'blacklist',\r\n\t\t'label': {\r\n\t\t\t'en': 'List of Adapter\\'s to hide',\r\n\t\t\t'de': 'Liste nicht angezeigter Adapter'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'Shows all adapters except the ones listed here',\r\n\t\t\t'de': 'Zeigt alle Adapter, außer die hier angegebenen'\r\n\t\t},\r\n\t\t'values': {\r\n\t\t\t'en': 'Adapter names separated by comma',\r\n\t\t\t'de': 'Namen der Adapter mit Komma separiert'\r\n\t\t}\r\n\t}\r\n]\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { Line } from 'react-chartjs-2'\r\n// eslint-disable-next-line\r\nimport chartjs_colorschemes from 'chartjs-plugin-colorschemes'\r\n// eslint-disable-next-line\r\nimport chartjs_zoom from 'chartjs-plugin-zoom'\r\n\r\nimport DateFnsUtils from '@date-io/date-fns'\r\n\r\nimport Log from '../Log'\r\nimport i18n, { locales } from '../i18n'\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport Alert from '@material-ui/lab/Alert'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport { MuiPickersUtilsProvider, DateTimePicker } from '@material-ui/pickers'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport Select from '@material-ui/core/Select'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CalendarIcon from '@material-ui/icons/Event'\r\nimport CalendarTodayIcon from '@material-ui/icons/EventAvailable'\r\nimport HistoryIcon from '@material-ui/icons/History'\r\nimport FastRewindIcon from '@material-ui/icons/FastRewind'\r\n//import DisablePan from '@material-ui/icons/SelectAll'\r\n//import DisableZoom from '@material-ui/icons/LocationDisabled'\r\nimport ResetZoom from '@material-ui/icons/ZoomOutMap'\r\nimport LiveUpdates from '@material-ui/icons/Update'\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tloading: {\r\n\t\tposition: 'absolute',\r\n\t\tbackgroundColor: 'rgba(0, 0, 0, 0.3)',\r\n\t\twidth: '100%',\r\n\t\theight: '100%',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'center',\r\n\t},\r\n\terrorMessage: {\r\n\t\tmarginBottom: 5,\r\n\t\tmarginRight: 15,\r\n\t\twidth: '100%'\r\n\t},\r\n\ttoolbar: {\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\ttoolbarButtons: {\r\n\t\tdisplay: 'initial',\r\n\t\twhiteSpace: 'nowrap'\r\n\t},\r\n\toptions: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t},\r\n\tdatePicker: {\r\n\t\tpadding: '2px 4px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tmargin: 2\r\n\t},\r\n\tinput: {\r\n\t\tmarginLeft: theme.spacing(1),\r\n\t\tflex: 1,\r\n\t},\r\n\tselect: {\r\n\t\twidth: 100\r\n\t},\r\n\ticon: {\r\n\t\tmargin: 10,\r\n\t},\r\n\ticonButton: {\r\n\t\tpadding: 10,\r\n\t},\r\n\tdivider: {\r\n\t\tmargin: '15px 0',\r\n\t},\r\n\tdividerVertical: {\r\n\t\theight: 28,\r\n\t\tmargin: 4,\r\n\t},\r\n\tbutton: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff !important',\r\n\t\tmargin: '4px'\r\n\t},\r\n\tbuttonDisabled: {\r\n\t\tbackgroundColor: '#eee',\r\n\t\tmargin: '4px'\r\n\t}\r\n});\r\n\r\n\r\nclass Chart extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\t// chart settings\r\n\t\tthis.chartFilter = this.props.settings.chartFilter || {};\r\n\t\tthis.chartConfig = this.props.settings.chartConfig || {};\r\n\t\t\r\n\t\tthis.chartConfig.yAxes = this.chartConfig.yAxes || [];\r\n\t\tthis.chartConfig.yAxes.unshift({\r\n\t\t\tid: 'left',\r\n\t\t\ttype: 'linear',\r\n\t\t\tposition: 'left',\r\n\t\t\tticks: {\r\n\t\t\t\tcallback: value => (this.chartConfig.yLeftAxisUnitBefore || '') + Number.parseFloat(value).toFixed(1) + (this.chartConfig.yLeftAxisUnitAfter || '')\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// states\r\n\t\tthis.state = {\r\n\t\t\tloading: true,\r\n\t\t\terrors: [],\r\n\t\t\t\r\n\t\t\tdatePicker: false,\r\n\t\t\tselectedTimeRangeValue: (this.chartFilter && this.chartFilter.selectedTimeRangeValue) || 1,\r\n\t\t\tselectedTimeRangeUnit: (this.chartFilter && this.chartFilter.selectedTimeRangeUnit) || 'days',\r\n\t\t\tselectedDateTime: (this.chartFilter && this.chartFilter.selectedDateTime && new Date(this.chartFilter.selectedDateTime)) || new Date(),\r\n\t\t\tdateNow: this.chartFilter && this.chartFilter.selectedDateTime ? false : true,\r\n\t\t\t\r\n\t\t\tchartLabels: [],\r\n\t\t\tchartData: {\r\n\t\t\t\tlabels: [],\r\n\t\t\t\tdatasets: []\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\tchartPan: true,\r\n\t\t\tchartZoom: true\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tthis.timer = null;\r\n\t\tthis.timeRangeRef = React.createRef();\r\n\t\t\r\n\t\t// chart instance options\r\n\t\tthis.chartRef = React.createRef();\r\n\t\tthis.chartUpdates = {};\r\n\t\tthis.chartOptions = {\r\n\t\t\tmaintainAspectRatio: false,\r\n\t\t\tspanGaps: true,\r\n\t\t\tlegend: {\r\n\t\t\t\tonClick: this.legendClickHandler.bind(this)\r\n\t\t\t},\r\n\t\t\ttooltips: {\r\n\t\t\t\tcallbacks: {\r\n\t\t\t\t\tlabel: (item, data) => data.datasets[item.datasetIndex].label + ': ' + item.value + data.datasets[item.datasetIndex].unit\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tscales: {\r\n\t\t\t\tyAxes: this.chartConfig.yAxes\r\n\t\t\t},\r\n\r\n\t\t\tplugins: {\r\n\t\t\t\tcolorschemes: {\r\n\t\t\t\t\tscheme: 'brewer.SetOne9'\r\n\t\t\t\t},\r\n\t\t\t\tzoom: {\r\n\t\t\t\t\t// Container for pan options\r\n\t\t\t\t\tpan: {\r\n\t\t\t\t\t\t// Boolean to enable panning\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Panning directions\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Container for zoom options\r\n\t\t\t\t\tzoom: {\r\n\t\t\t\t\t\t// Boolean to enable zooming\r\n\t\t\t\t\t\tenabled: true,\r\n\r\n\t\t\t\t\t\t// Zooming directions.\r\n\t\t\t\t\t\tmode: 'xy'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// request initial history data\r\n\t\tlet options = { ...this.getTimeRange(), axis: this.getAxis() };\r\n\t\t\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\tdevice.label = device.name + ' (' + i18n.t(device.primaryStateKey) + ')';\r\n\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => Log._('Modules (Chart)', err.message, 'error', true, err.stack));\r\n\t\t\t\r\n\t\t\t// add listeners for newly requested data\r\n\t\t\tdevice.listen('historyChange', (options) => this.historyChange);\r\n\t\t\t\r\n\t\t\t// add listeners for data updates\r\n\t\t\tif (this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow) {\r\n\t\t\t\tdevice.listen((options) => this.stateChange);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tthis.props.devices.forEach(device => {\r\n\t\t\tdevice.unlisten(this.stateChange);\r\n\t\t});\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tif (this.state.selectedTimeRangeValue &&\r\n\t\t\t\t(prevState.selectedDateTime !== this.state.selectedDateTime || prevState.selectedTimeRangeValue !== this.state.selectedTimeRangeValue || prevState.selectedTimeRangeUnit !== this.state.selectedTimeRangeUnit)\r\n\t\t\t) {\r\n\t\t\t\r\n\t\t\t// request updated history data\r\n\t\t\tthis.setState({ loading: true, errors: [] });\r\n\t\t\t\r\n\t\t\tclearTimeout(this.timer);\r\n\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\r\n\t\t\t\tconst options = this.getTimeRange();\r\n\t\t\t\tthis.props.devices.forEach(device => {\r\n\t\t\t\t\tdevice.requestDeviceStateHistory(device.options.history || null, true, { 'start': options.start, 'end': options.end, 'step': options.step, 'aggregate': 'average', 'ignoreNull': true }).catch(err => Log._('Modules (Chart)', err.message, 'error', true, err.stack));\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t}\r\n\t\r\n\thistoryChange = options => (stateKey, history, state, device) => {\r\n\t\tthis.addChartGraph(device, history, { ...options, axis: this.getAxis(options.start, options.end) } );\r\n\t\tthis.setState({ loading: false });\r\n\t}\r\n\t\r\n\tstateChange = options => (stateKey, val, state, device) => this.updateChartGraph(device, val, { ...options, axis: this.getAxis(options.end, new Date()) } )\r\n\t\r\n\tgetTimeRange() {\r\n\t\t\r\n\t\tconst end = this.state.selectedDateTime.getTime();\r\n\t\tlet timeRange = this.state.selectedTimeRangeValue;\r\n\t\tlet step = 1;\r\n\t\tlet axisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\r\n\t\tswitch(this.state.selectedTimeRangeUnit) {\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\tcase 'seconds':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'minutes':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm:ss';\r\n\t\t\t\ttimeRange = timeRange*60;\r\n\t\t\t\t//step = step;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'hours':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60;\r\n\t\t\t\tstep = step*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'days':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy, HH:mm';\r\n\t\t\t\ttimeRange = timeRange*60*60*24;\r\n\t\t\t\tstep = step*60*60;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'months':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*31;\r\n\t\t\t\tstep = step*60*60*24;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'years':\r\n\t\t\t\taxisTimeFormat = 'dd. MMM yyyy';\r\n\t\t\t\ttimeRange = timeRange*60*60*24*365;\r\n\t\t\t\tstep = step*60*60*24*31;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\t'axisTimeFormat': axisTimeFormat,\r\n\t\t\t'start': end-timeRange*1000,\r\n\t\t\t'end': end,\r\n\t\t\t'timeRange': timeRange*1000,\r\n\t\t\t'step': step*1000\r\n\t\t};\r\n\t}\r\n\t\r\n\tgetAxis(start, end) {\r\n\t\t\r\n\t\tconst { step, axisTimeFormat } = this.getTimeRange();\r\n\t\tlet axis = {};\r\n\t\t\r\n\t\tfor (let time = start; time <= end; time += step) {\r\n\t\t\taxis[time] = helpers.secondsToDateTime(time/1000, axisTimeFormat);\r\n\t\t}\r\n\t\t\r\n\t\treturn axis;\r\n\t}\r\n\t\r\n\tgroupChartData(chartData, axis) {\r\n\t\t\r\n\t\tlet prevMarker;\r\n\t\tlet data = [];\r\n\t\t\r\n\t\tlet markers = Object.keys(axis);\r\n\t\tmarkers.forEach((marker, i) => {\r\n\t\t\tprevMarker = markers[(i-1 > 0 ? i-1 : 0)];\r\n\t\t\t\r\n\t\t\tfor (let index in chartData) {\r\n\t\t\t\tlet entry = chartData[index];\r\n\t\t\t\tentry.val = parseFloat(entry.val);\r\n\t\t\t\t\r\n\t\t\t\t// \r\n\t\t\t\tif (!entry.ts || entry.val === null) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// before range, continue\r\n\t\t\t\tif (prevMarker > entry.ts) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// in range\r\n\t\t\t\telse if (prevMarker < entry.ts && entry.ts <= marker) {\r\n\t\t\t\t\tdata[i] = !data[i] ? [ entry.val ] : [ ...data[i], entry.val ]; // parseFloat((data[i] ? ((data[i]+entry.val)/2) : entry.val).toFixed(2));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// beyond range, so next marker\r\n\t\t\t\telse if (entry.ts > marker) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//\r\n\t\t\tif (!data[i]) {\r\n\t\t\t\t// \r\n\t\t\t}\r\n\t\t\telse if (data[i].length === 1) {\r\n\t\t\t\tdata[i] = data[i][0];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdata[i] = data[i].reduce((a,b) => a + b, 0) / data[i].length;\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn data;\r\n\t}\r\n\t\r\n\tupdateChartGraph(device, value, options) {\r\n\t\t\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex === -1) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tthis.chartUpdates[chartIndex] = this.chartUpdates[chartIndex] || [];\r\n\t\tthis.chartUpdates[chartIndex].push({\r\n\t\t\t'ts': value.ts,\r\n\t\t\t'val': value.val\r\n\t\t});\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(this.chartUpdates[chartIndex], options.axis);\r\n\t\t\r\n\t\t//console.log(value);\r\n\t\t//console.log(options, options.axis, data);\r\n\t\t\r\n\t\t// update chart\r\n\t\tthis.chartRef.current.chartInstance.data.labels = [ ...this.state.chartData.labels, ...Object.values(options.axis) ];\r\n\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = [ ...this.state.chartData.datasets[chartIndex].data, ...data ];\r\n\t\tthis.chartRef.current.chartInstance.update();\r\n\t}\r\n\t\r\n\taddChartGraph(device, history, options) {\r\n\t\t\r\n\t\t// only add chart if data is given\r\n\t\tif (!history || !history.length) {\r\n\t\t\tlet error = i18n.t('No history data given for %s').replace('%s', device.label) + '!';\r\n\t\t\tthis.setState(prevStates => ({ errors: [ ...prevStates.errors, error ] }));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// process data\r\n\t\tconst data = this.groupChartData(history, options.axis);\r\n\t\t\r\n\t\t// update chart\r\n\t\tconst chartIndex = this.state.chartLabels.findIndex(entry => entry === device.label);\r\n\t\tif (chartIndex > -1) {\r\n\t\t\tthis.chartRef.current.chartInstance.data.labels = Object.values(options.axis);\r\n\t\t\tthis.chartRef.current.chartInstance.data.datasets[chartIndex].data = data;\r\n\t\t\tthis.chartRef.current.chartInstance.update();\r\n\t\t}\r\n\t\t\r\n\t\t// index chart\r\n\t\telse {\r\n\t\t\tthis.setState(prevStates => ({ chartLabels: [ ...prevStates.chartLabels, device.label ] }));\r\n\t\t\t\r\n\t\t\t// chart dataset\r\n\t\t\tlet dataSet = {\r\n\t\t\t\tlabel: device.label,\r\n\t\t\t\tunit: device.states[device.primaryStateKey].state.value.unit || '',\r\n\t\t\t\tfill: false,\r\n\t\t\t\t...device.options.graphConfig || {},\r\n\t\t\t\tdata: data\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t// add data to chart\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\taxisTimeFormat: options.axisTimeFormat,\r\n\t\t\t\tchartData: {\r\n\t\t\t\t\tlabels: Object.values(options.axis),\r\n\t\t\t\t\tdatasets: [ ...prevStates.chartData.datasets, dataSet ],\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\t\r\n\tlegendClickHandler(e, legendItem) {\r\n\t\t\r\n\t\tlet index = legendItem.datasetIndex;\r\n\t\tlet ci = this.chartRef.current.chartInstance;\r\n\t\tlet meta = ci.getDatasetMeta(index);\r\n\r\n\t\tmeta.hidden = meta.hidden === null ? !ci.data.datasets[index].hidden : null;\r\n\t\tci.update();\r\n\t\tci.resetZoom();\r\n\t}\r\n\t\r\n\tdisablePan() {\r\n\t\tlet pan = this.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.pan.enabled = (pan === false);\r\n\t\tthis.setState({ chartPan: (pan === false) });\r\n\t}\r\n\t\r\n\tdisableZoom() {\r\n\t\tlet zoom = this.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled;\r\n\t\tthis.chartRef.current.chartInstance.options.plugins.zoom.zoom.enabled = (zoom === false);\r\n\t\tthis.setState({ chartZoom: (zoom === false) });\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, settings } = this.props;\r\n\t\treturn (\r\n\r\n<div>\r\n\t<div className={classes.options}>\r\n\t\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('Period shown in Chart')}>\r\n\t\t\t\t<HistoryIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<InputBase\r\n\t\t\t\tinputRef={this.timeRangeRef}\r\n\t\t\t\tclassName={classes.input}\r\n\t\t\t\tvalue={this.state.selectedTimeRangeValue}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeValue: event.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<Select\r\n\t\t\t\tvalue={this.state.selectedTimeRangeUnit}\r\n\t\t\t\tonChange={event => this.setState({ selectedTimeRangeUnit: event.target.value })}\r\n\t\t\t\tdisplayEmpty\r\n\t\t\t\tdisableUnderline\r\n\t\t\t\tclassName={classes.select}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<MenuItem value=\"seconds\">{i18n.t('Seconds')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"minutes\">{i18n.t('Minutes')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"hours\">{i18n.t('Hours')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"days\">{i18n.t('Days')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"months\">{i18n.t('Months')}</MenuItem>\r\n\t\t\t\t<MenuItem value=\"years\">{i18n.t('Years')}</MenuItem>\r\n\t\t\t</Select>\r\n\t\t\t\r\n\t\t\t{/*\r\n\t\t\t<IconButton className={classes.iconButton} onClick={() => this.timeRangeRef.current.focus()}>\r\n\t\t\t\t<CalendarIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t*/}\r\n\t\t</Paper>\r\n\r\n\t\t<Paper className={classes.datePicker}>\r\n\t\t\t<Tooltip title={i18n.t('End date')}>\r\n\t\t\t\t<FastRewindIcon className={classes.icon} />\r\n\t\t\t</Tooltip>\r\n\t\t\t\r\n\t\t\t<MuiPickersUtilsProvider locale={locales[i18n.getLanguage()]} utils={DateFnsUtils}>\r\n\t\t\t\t<DateTimePicker\r\n\t\t\t\t\tclassName={classes.input}\r\n\t\t\t\t\tvalue={this.state.selectedDateTime}\r\n\t\t\t\t\tonChange={selectedDateTime => this.setState({ selectedDateTime: selectedDateTime, dateNow: false })}\r\n\t\t\t\t\t\r\n\t\t\t\t\topen={this.state.datePicker}\r\n\t\t\t\t\tonOpen={() => this.setState({ datePicker: true })}\r\n\t\t\t\t\tonClose={() => this.setState({ datePicker: false })}\r\n\t\t\t\t\t\r\n\t\t\t\t\tvariant=\"inline\"\r\n\t\t\t\t\tampm={false}\r\n\t\t\t\t\tformat='dd.MM.yyyy HH:mm'\r\n\t\t\t\t\tInputProps={{\r\n\t\t\t\t\t\tdisableUnderline: true,\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</MuiPickersUtilsProvider>\r\n\t\t\t\r\n\t\t\t<Tooltip title={i18n.t('Select end date')}>\r\n\t\t\t\t<IconButton color=\"primary\" className={classes.iconButton} onClick={() => this.setState({ datePicker: true })}>\r\n\t\t\t\t\t<CalendarIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t\t<Divider className={classes.dividerVertical} orientation=\"vertical\" />\r\n\t\t\t<Tooltip title={i18n.t('Select today as end date')}>\r\n\t\t\t\t<IconButton className={classes.iconButton} onClick={() => this.setState({ selectedDateTime: new Date(), dateNow: true })}>\r\n\t\t\t\t\t<CalendarTodayIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</Tooltip>\r\n\t\t</Paper>\r\n\t\t\r\n\t\t<Tooltip title={i18n.t('Live updates are ' + (this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow ? 'on' : 'off'))} placement=\"top\" style={{ display: 'flex' }}>\r\n\t\t\t<span>\r\n\t\t\t\t<Button disabled={true} className={clsx(classes.datePicker, this.props.settings.liveUpdates !== null && this.props.settings.liveUpdates !== false && this.state.dateNow ? classes.button : classes.buttonDisabled)}>\r\n\t\t\t\t\t<LiveUpdates />\r\n\t\t\t\t</Button>\r\n\t\t\t</span>\r\n\t\t</Tooltip>\r\n\t\t\r\n\t</div>\r\n\t<Divider className={classes.divider} />\r\n\t\r\n\t<div className={classes.toolbar}>\r\n\t\t<div className={classes.errorMessage}>\r\n\t\t\t{this.state.errors.length > 0 && <Alert severity=\"error\">{this.state.errors.map((error, i) => [ error, React.createElement('br', { key: 'br-error-' + i }) ])}</Alert>}\r\n\t\t</div>\r\n\t\t\r\n\t\t<ButtonGroup className={classes.toolbarButtons} color=\"primary\">\r\n\t\t{/*\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartPan ? 'contained' : 'outlined'} onClick={this.disablePan.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartPan ? 'Disable panning' : 'Enable panning')}>\r\n\t\t\t\t\t<DisablePan />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t\t<Button disableElevation={true} variant={this.state.chartZoom ? 'contained' : 'outlined'} onClick={this.disableZoom.bind(this)}>\r\n\t\t\t\t<Tooltip title={i18n.t(this.state.chartZoom ? 'Disable Zoom' : 'Enable Zoom')}>\r\n\t\t\t\t\t<DisableZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t*/}\r\n\t\t\t<Button disableElevation={true} variant=\"contained\" onClick={() => this.chartRef.current.chartInstance.resetZoom()}>\r\n\t\t\t\t<Tooltip title={i18n.t('Reset Zoom')}>\r\n\t\t\t\t\t<ResetZoom />\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</Button>\r\n\t\t</ButtonGroup>\r\n\t</div>\r\n\t\r\n\t<div className={'chart-container'} style={{ position: 'relative', height: settings.chartHeight || '500px' }}>\r\n\t\t{this.state.loading && <div className={classes.loading}>\r\n\t\t\t<CircularProgress />\r\n\t\t</div>}\r\n\t\t\r\n\t\t<Line\r\n\t\t\tref={this.chartRef}\r\n\t\t\tdata={this.state.chartData}\r\n\t\t\toptions={this.chartOptions}\r\n\t\t\t/>\r\n\t\t\t\r\n\t</div>\r\n</div>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Chart);\r\n\r\nexport const ModuleSettings = {\r\n\t//noDevicesAllowed: true,\r\n\ttitle: i18n.t('Adapter Status'),\r\n\ticon: 'traffic-light'\r\n}\r\n\r\nexport const ModuleDescription = \"Stellt historische Werte (z.B. aus ioBroker.history) grafisch als Chart mittels Chart.js dar.\";\r\nexport const ModuleScreenshots = ['Chart1.png'];\r\n\r\nexport const ModuleConfig = [\r\n]\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport { format } from 'date-fns'\r\nimport { getSunrise, getSunset } from 'sunrise-sunset-js'\r\n\r\nimport Settings from '../Settings'\r\nimport i18n, { locales } from '../i18n'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\n\r\n\r\nexport default function DateTime(props) {\r\n\tconst { settings } = props;\r\n\t\r\n\tconst refTimer = useRef();\r\n\tconst [DateTime, setDateTime] = useState(format(new Date(), settings.format, { locale: locales[i18n.getLanguage()] }));\r\n\tconst [city, setCity] = useState('');\r\n\tconst [sunrise, setSunrise] = useState('');\r\n\tconst [sunset, setSunset] = useState('');\r\n\t\r\n\t// https://date-fns.org/v2.9.0/docs/format\r\n\tsettings.style = { fontSize: '1.5rem', textAlign: 'center', ...settings.style };\r\n\tsettings.format = settings.format || 'dd.MM.yyyy HH:mm:ss';\r\n\tsettings.refresh = settings.format.indexOf('s') > -1 ? 1000 : (settings.format.indexOf('i') > -1 ? 60*1000 : 60*60*1000);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tclearTimeout(refTimer.current);\r\n\t\trefTimer.current = setTimeout(() => setDateTime(format(new Date(), settings.format, { locale: locales[i18n.getLanguage()] })), settings.refresh);\r\n\t\t\r\n\t\t//\r\n\t\tif (Settings.getSetting('iobroker').latitude && Settings.getSetting('iobroker').longitude) {\r\n\t\t\tsetSunrise(getSunrise(Settings.getSetting('iobroker').latitude, Settings.getSetting('iobroker').longitude));\r\n\t\t\tsetSunset(getSunset(Settings.getSetting('iobroker').latitude, Settings.getSetting('iobroker').longitude));\r\n\t\t}\r\n\t\t\r\n\t\tif (Settings.getSetting('iobroker').city) {\r\n\t\t\tsetCity(Settings.getSetting('iobroker').city);\r\n\t\t}\r\n\t\t\r\n\t}, [settings]);\r\n\t\r\n\treturn (\r\n\r\n<div style={settings.style}>\r\n\t{i18n.t('%DateTime').replace(/%DateTime/, DateTime)}\r\n\t\r\n\t{settings.sun !== false && <div style={{ margin: '5px 0', fontSize: '1.2rem' }}>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-city-variant-outline\"></span> {city ? city : <CircularProgress size=\"1.2rem\" />}\r\n\t\t<span style={{ margin: '0 10px' }}></span>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-weather-sunset-up\"></span> {sunrise ? format(sunrise, 'HH:mm') : <CircularProgress size=\"1.2rem\" />}\r\n\t\t<span style={{ margin: '0 10px' }}></span>\r\n\t\t\r\n\t\t<span className=\"mdi mdi-weather-sunset-down\"></span> {sunset ? format(sunset, 'HH:mm') : <CircularProgress size=\"1.2rem\" />}\r\n\t</div>\r\n\t}\r\n\t\r\n</div>\r\n\r\n\t);\r\n}\r\n\r\nexport const ModuleSettings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Time'),\r\n\ticon: 'clock-outline'\r\n}\r\n\r\nexport const ModuleDescription = \"Das Modul dient der Anzeige des aktuellen Datums und Zeit.\";\r\nexport const ModuleScreenshots = ['DateTime1.png'];\r\n\r\nexport const ModuleConfig = [\r\n\t{\r\n\t\t'parameter': 'style',\r\n\t\t'label': {\r\n\t\t\t'en': 'Style of the text',\r\n\t\t\t'de': 'Style des Textes'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'CSS statements in javascript notation',\r\n\t\t\t'de': 'CSS-Anweisungen in Javascript Syntax'\r\n\t\t},\r\n\t\t'val': '{ fontSize: \"1.5rem\", textAlign: \"center\" }'\r\n\t},\r\n\t{\r\n\t\t'parameter': 'format',\r\n\t\t'label': {\r\n\t\t\t'en': 'Date/Time format',\r\n\t\t\t'de': 'Format des Datums / Uhrzeit'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'For possible format values, see date-fns documentation',\r\n\t\t\t'de': 'Für mögliche Werte, siehe date-fns Dokumentation'\r\n\t\t},\r\n\t\t'link': 'https://date-fns.org/v2.9.0/docs/format',\r\n\t\t'val': 'dd.MM.yyyy HH:mm:ss'\r\n\t},\r\n\t{\r\n\t\t'parameter': 'sun',\r\n\t\t'label': {\r\n\t\t\t'en': 'Show times of sunrise and -set',\r\n\t\t\t'de': 'Zeigt Zeiten für Sonnenauf- und -untergang'\r\n\t\t},\r\n\t\t'type': 'Switch',\r\n\t\t'val': true\r\n\t}\r\n]\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport L from 'leaflet'\r\nimport { Map as LeafletMap, TileLayer, Marker as LeafletMarker, Tooltip as LeafletTooltip } from 'react-leaflet'\r\n\r\nimport Log from '../Log'\r\nimport Settings from '../Settings'\r\nimport i18n from '../i18n'\r\n\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tmap: {\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapOverview: {\r\n\t\tcolor: '#666',\r\n\t\tposition: 'absolute',\r\n\t\tleft: 0,\r\n\t\tbottom: 0,\r\n\t\twidth: '100%',\r\n\t\theight: '60px',\r\n\t\tzIndex: 999,\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\t\r\n\t\t'& > *': {\r\n\t\t\tmargin: theme.spacing(1),\r\n\t\t\tcursor: 'pointer',\r\n\t\t},\r\n\t},\r\n\tmapIconContainer: {\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tboxShadow: '0 0 0 8px rgba(255, 255, 255, 0.3)',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '2rem',\r\n\t\tcolor: theme.palette.primary.main,\r\n\t\ttransform: 'translate3d(4px, -4px,0)', /* for fontSize: '2.3rem' -> 'translate3d(2px, -8px,0)', */\r\n\t\tdisplay: 'block',\r\n\t\t\r\n\t\t'&:after': {\r\n\t\t\tcontent: '\"\"',\r\n\t\t\tdisplay: 'block',\r\n\t\t\tpadding: '50% 0%'\r\n\t\t}\r\n\t},\r\n\tmapTooltip: {\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Map(props) {\r\n\tconst { settings, devices } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [zoom,] = useState(settings.defaultZoom);\r\n\tconst [position,] = useState(settings.defaultPosition ? (Array.isArray(settings.defaultPosition) ? settings.defaultPosition : settings.defaultPosition.split(',')) : [ Settings.getSetting('iobroker').latitude, Settings.getSetting('iobroker').longitude ]);\r\n\tconst [markers, setMarkers] = useState({});\r\n\t\r\n\t// map instance\r\n\tconst map = useRef();\r\n\tconst memoizedMapInitialised = useCallback(function() {map.current = this}, [],);\r\n\t\r\n\t// Marker click in overview\r\n\tconst memoizedHandleClick = useCallback(flyTo => map.current.flyTo(flyTo.split(',')), [],);\r\n\t\r\n\t// state change\r\n\tconst stateChange = (stateKey, state, device) => {\r\n\t\t\r\n\t\tif (stateKey === 'position') {\r\n\t\t\t\r\n\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\tif (!prevMarkers[device.id] || prevMarkers[device.id].position !== state.val) {\r\n\t\t\t\t\tdevice.options.position = state.val;\r\n\t\t\t\t\treturn { ...prevMarkers, [device.id]: device };\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn prevMarkers;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t// get gps position coordinates\r\n\tuseEffect(() => {\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('position').catch(err => {\r\n\t\t\t\tLog._('Modules (Map)', err.message, 'error', true, err.stack)\r\n\t\t\t\t\r\n\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\tif (!prevMarkers[device.id]) {\r\n\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: null };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.listen(stateChange);\r\n\t\t});\r\n\t\t\r\n\t\t// componentWillUnmount\r\n\t\treturn () => devices.forEach(device => device.unlisten(stateChange));\r\n\t\t\r\n\t}, [devices]);\r\n\t\r\n\t// add markers\r\n\tlet mapMarkers = [], mapOverview = [];\r\n\tif (devices.length > 0 && devices.length === Object.keys(markers).length) {\r\n\t\t\r\n\t\tfor (let key in markers) {\r\n\t\t\tlet device = markers[key];\r\n\t\t\tif (device !== null) {\r\n\t\t\t\tlet marker = <Marker key={'marker-' + device.id} position={device.options.position || ''} device={device} settings={settings.component} />\r\n\t\t\t\tmapMarkers.push(marker);\r\n\t\t\t\t\r\n\t\t\t\tlet item = null;\r\n\t\t\t\tif (device.attributes.avatar) {\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} src={device.attributes.avatar} onClick={() => memoizedHandleClick(device.options.position)} />\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlet state = device.getDeviceState();\r\n\t\t\t\t\tconst icon = device.getIcon(null, state && state.val !== undefined ? state.val : null);\r\n\t\t\t\t\tconst styles = device.getStyle('icon', null, state && state.val !== undefined ? state.val : null);\r\n\t\t\t\t\t\r\n\t\t\t\t\tconsole.log(state && state.val !== undefined ? state.val : null);\r\n\t\t\t\t\tconsole.log(styles);\r\n\t\t\t\t\t\r\n\t\t\t\t\titem = <Avatar style={styles} key={'overview-' + device.id} alt={device.name} onClick={() => memoizedHandleClick(device.options.position)}><span className={clsx('mdi mdi-' + icon)}></span></Avatar>\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tmapOverview.push(<Tooltip key={'tooltip-' + device.id} title={device.name} aria-label={device.name} arrow>{item}</Tooltip>);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Box className={classes.mapOverview}>\r\n\t\t<Typography>{i18n.t('Jump to')}:</Typography>\r\n\t\t{mapOverview}\r\n\t</Box>\r\n\t<LeafletMap useFlyTo={true} center={position} zoom={zoom} className={classes.map} whenReady={memoizedMapInitialised}>\r\n\t\t<TileLayer\r\n\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n\t\t\turl='https://{s}.tile.osm.org/{z}/{x}/{y}.png'\r\n\t\t\t/>\r\n\t\t\r\n\t\t{mapMarkers}\r\n\t</LeafletMap>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nfunction Marker(props) {\r\n\tconst { position, device, settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tlet markerIcon = null, offset = 40;\r\n\tLog._('Modules (Map)', 'Marker for ' + device.function + ' ' + device.name + ' added to map.');\r\n\t\r\n\t// Marker with avatar / picture\r\n\tif (device.attributes && device.attributes.avatar && device.attributes.avatar.substr(0, 11) === 'data:image/') {\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<img src=\"' + device.attributes.avatar + '\" class=\"' + classes.mapIconParent + '\" />',\r\n\t\t\ticonSize: [ 64, 64 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker with Icon\r\n\telse {\r\n\t\toffset = 30;\r\n\t\tlet state = device.getDeviceState();\r\n\t\tconst icon = device.getIcon(null, state && state.val !== undefined ? state.val : null);\r\n\t\tconst styles = device.getStyle('icon', null, state && state.val !== undefined ? state.val : null);\r\n\t\t\r\n\t\tconsole.log(styles); \r\n\t\tconst useStyles = makeStyles({root: styles}, {name:'testi'});\r\n\t\tconsole.log(useStyles.root); \r\n\t\t\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<div class=\"' + clsx(classes.mapIconParent) + '\"><span class=\"' + clsx(classes.mapIcon, 'mdi mdi-' + icon) + '\"></span></div>',\r\n\t\t\ticonSize: [ 40, 40 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker MouseOver / MouseOut (bring tooltip to front if markers overlay)\r\n\tconst memoizedHandleMouseEvent = useCallback(function() {this.closeTooltip().openTooltip()}, [],);\r\n\r\n\treturn (\r\n\r\n<LeafletMarker riseOnHover={true} position={Array.isArray(position) ? position : position.split(',')} icon={markerIcon} onMouseOver={memoizedHandleMouseEvent}>\r\n\t<LeafletTooltip className={classes.mapTooltip} direction={settings.tooltipDirection || 'bottom'} permanent={settings.tooltipPermanent || true} offset={[0,offset]}>\r\n\t\t{device.name}\r\n\t</LeafletTooltip>\r\n</LeafletMarker>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt eine Karte von OpenStreetMap.\";\r\nexport const ModuleScreenshots = [];\r\n\r\nexport const ModuleConfig = [\r\n\t{\r\n\t\t'parameter': 'defaultZoom',\r\n\t\t'label': {\r\n\t\t\t'en': 'initial map zoom',\r\n\t\t\t'de': 'initialer Zoom der Karte'\r\n\t\t},\r\n\t\t'type': 'Number',\r\n\t\t'val': 10\r\n\t},\r\n\t{\r\n\t\t'parameter': 'defaultPosition',\r\n\t\t'label': {\r\n\t\t\t'en': 'initial map position',\r\n\t\t\t'de': 'initiale Position auf der Karte'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'Separate latitude and longitude via comma (e.g. 53.550383, 9.992376)',\r\n\t\t\t'de': 'Latitude und Longitude mit Komma separiert (z. B. 53.550383, 9.992376)'\r\n\t\t},\r\n\t\t'val': ''\r\n\t},\r\n\t{\r\n\t\t'parameter': 'tooltipDirection',\r\n\t\t'label': {\r\n\t\t\t'en': 'Direction tooltip will open',\r\n\t\t\t'de': 'Richtung in die der Tooltip öffnet'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'possible directions to open: auto, center, top, left, right or bottom',\r\n\t\t\t'de': 'mögliche Werte: auto, center, top, left, right or bottom'\r\n\t\t},\r\n\t\t'val': ''\r\n\t},\r\n\t{\r\n\t\t'parameter': 'tooltipPermanent',\r\n\t\t'label': {\r\n\t\t\t'en': 'permanent tooltip',\r\n\t\t\t'de': 'Permanenter Tooltip'\r\n\t\t},\r\n\t\t'description': {\r\n\t\t\t'en': 'Option to keep tooltip permanently open (true) or only open on mouse-over (false)',\r\n\t\t\t'de': 'Angabe ob der Tooltip permanent ist (true) oder nur beim rüberfahren mit der Maus gezeigt wird (false)'\r\n\t\t},\r\n\t\t'type': 'Switch',\r\n\t\t'val': true\r\n\t}\r\n]\r\n","import React from 'react'\r\n\r\nimport StateList, { ModuleConfig as StateListConfig } from './StateList'\r\n\r\n\r\nexport default function StateListHorizontal(props) {\r\n\treturn <StateList horizontal={true} {...props} />\r\n}\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt eine Liste von States horizontal an\";\r\nexport const ModuleScreenshots = ['StateListHorizontal1.png'];\r\n\r\nexport const ModuleConfig = StateListConfig","import React, { useState, useEffect } from 'react'\r\n\r\nimport Log from '../Log'\r\nimport Connection from '../Connection'\r\nimport i18n from '../i18n'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tpaper: {\r\n\t\twidth: 100,\r\n\t\theight: 160,\r\n\t\tpadding: 5,\r\n\t\ttextAlign: 'center',\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Weather(props) {\r\n\tconst { settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [data,setData] = useState(null);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tConnection.getConnection.getRemoteResource(settings.url).then(\r\n\t\t\tresponse => {\r\n\t\t\t\t\r\n\t\t\t\tif (response.statusCode === 200) {\r\n\t\t\t\t\tsetData(JSON.parse(response.body));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\terr => Log._('Modules (Weather)', err.message, 'error', true, err.stack)\r\n\t\t);\r\n\t\t\r\n\t}, [settings.url]);\r\n\t\r\n\tlet weatherForecast = [];\r\n\t//console.log(data);\r\n\t\r\n\tif (!data) {\r\n\t\treturn null;\r\n\t}\r\n\telse {\r\n\t\tfor (let day in data.day) {\r\n\t\t\tlet forecast = data.day[day];\r\n\t\t\tforecast.title = day === 1 ? i18n.t('today') : (day === 2 ? i18n.t('tomorrow') : forecast.name);\r\n\t\t\t\r\n\t\t\tconst dailyForecast = (\r\n\r\n<Grid key={'day-' + day} item>\r\n\t<Paper className={classes.paper}>\r\n\t\t<Typography variant=\"body1\">\r\n\t\t\t{forecast.title}\r\n\t\t</Typography>\r\n\t\t<Typography variant=\"caption\">\r\n\t\t\t{forecast.date}\r\n\t\t</Typography>\r\n\r\n\r\n\t</Paper>\r\n</Grid>\r\n\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tweatherForecast.push(dailyForecast);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container justify=\"space-between\" spacing={1}>\r\n\t{weatherForecast}\r\n\t\r\n</Grid>\r\n\r\n\t);\r\n}\r\n\r\nexport const ModuleSettings = {\r\n\tnoDevicesAllowed: true,\r\n\ttitle: i18n.t('Weather'),\r\n\ticon: 'weather-partly-cloudy'\r\n}\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt die Wetter-Vorschau an.\";\r\nexport const ModuleScreenshots = [];\r\n\r\nexport const ModuleConfig = [\r\n]\r\n","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\nimport color from 'color'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport ButtonGroup from '@material-ui/core/ButtonGroup'\r\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport StopIcon from '@material-ui/icons/Stop'\r\n\r\nimport Log from '../../Log'\r\nimport i18n from '../../i18n'\r\nimport defaults from '../defaults'\r\nimport getActivityType from './blind-manufacturers'\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tvalue: props => ({\r\n\t\tfloat: 'left',\r\n\t\tlineHeight: '32px',\r\n\t\tmarginRight: '10px'\r\n\t}),\r\n\tborderLeftTransparent: {\r\n\t\tborderLeftColor: 'transparent !important'\r\n\t},\r\n\tborderLeftColor: {\r\n\t\tborderLeftColor: color(theme.palette.primary.main).alpha(0.5).rgb().toString() +  '!important'\r\n\t},\r\n\tborderRightTransparent: {\r\n\t\tborderRightColor: 'transparent !important'\r\n\t},\r\n\tborderRightColor: {\r\n\t\tborderRightColor: color(theme.palette.primary.main).alpha(0.5).rgb().toString() +  '!important'\r\n\t},\r\n\tborderRightColorSecondary: {\r\n\t\tborderRightColor: color(theme.palette.secondary.main).alpha(0.5).rgb().toString() +  '!important'\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./blind.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction BlindLevelAction(props) {\r\n\tconst { device, state, stateKey } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onGoUp = () => {\r\n\t\tsetLevel(100);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 100).catch(err => Log._('Function (blind)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst onGoDown = () => {\r\n\t\tsetLevel(0);\r\n\t\tsetActivity(true);\r\n\t\tdevice.setDeviceState(stateKey, 0).catch(err => Log._('Function (blind)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst onStop = () => {\r\n\t\tsetActivity(false);\r\n\t\tdevice.setDeviceState('activity', true).catch(err => Log._('Function (blind)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\t// level\r\n\tconst [level, setLevel] = useState(state.value);\r\n\tuseEffect(() => setLevel(state.value), [state]);\r\n\t\r\n\t// state change\r\n\tconst stateChange = (sKey, s, d) => {\r\n\t\t\r\n\t\tif (sKey === 'activity') {\r\n\t\t\tsetActivity(s.val);\r\n\t\t}\r\n\t}\r\n\t\r\n\t// activity\r\n\tconst [activity, setActivity] = useState(false);\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (device.states.activity && device.states.activity.state) {\r\n\t\t\tdevice.states.activity.state = typeof device.states.activity.state === 'string' ? { 'node': device.states.activity.state } : device.states.activity.state;\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('activity', true).catch(err => Log._('Function (blind)', err.message, 'error', true, err.stack));\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.listen(stateChange)\r\n\t\t}\r\n\t\t\r\n\t\t// componentWillUnmount\r\n\t\treturn () => device.unlisten(stateChange);\r\n\t\t\r\n\t}, [device, state]);\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t<div className={classes.value}>\r\n\t\t{level + state.unit}\r\n\t</div>\r\n\t\r\n\t<ButtonGroup size=\"small\">\r\n\t\t<Button color=\"primary\" className={clsx(activity !== null && (!activity ? classes.borderRightColor : classes.borderRightTransparent))} onClick={onGoUp}><ExpandLessIcon /></Button>\r\n\t\t{activity !== null && <Button color=\"secondary\" className={clsx(!activity ? [ classes.borderLeftTransparent, classes.borderRightTransparent ] : classes.borderRightColorSecondary)} onClick={onStop} disabled={!activity}><StopIcon /></Button>}\r\n\t\t<Button color=\"primary\" className={clsx(activity !== null && (!activity ? classes.borderLeftColor : classes.borderLeftTransparent))} onClick={onGoDown}><ExpandMoreIcon /></Button>\r\n\t</ButtonGroup>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'Shutters and Blinds',\r\n\t\t'de': 'Rollos oder Jalousien',\r\n\t},\r\n\tconfigurations: {\r\n\t\tlevel: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t},\r\n\t\tlevel2: {\r\n\t\t\tvalue: val => Math.round(val),\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t},\r\n\t\tactivity: {\r\n\t\t\tval: (val, stateKey, device) => getActivityType(device.options.manufacturer, val),\r\n\t\t\ticon: {\r\n\t\t\t\ttrue: 'pan-vertical',\r\n\t\t\t\tfalse: 'dots-vertical',\r\n\t\t\t},\r\n\t\t\tdisplay: {\r\n\t\t\t\ttrue: i18n.t('blind#activity#true'),\r\n\t\t\t\tfalse: i18n.t('blind#activity#false'),\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel2: defaults.components.LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tlevel: BlindLevelAction\r\n\t}\r\n}","export default function getActivityType(manufacturer, val) {\r\n\t\r\n\t// HomeMatic\r\n\tif (manufacturer === 'HomeMatic') {\r\n\t\t\r\n\t\tswitch(val) {\r\n\t\t\tcase 1: // UP\r\n\t\t\tcase 2: // DOWN\r\n\t\t\t\tval = true;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 3: // STABLE\r\n\t\t\t\tval = false;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tdefault: // UNKNOWN\r\n\t\t\t\tval = null;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Shelly\r\n\telse if (manufacturer === 'Shelly') {\r\n\t\t\r\n\t\tswitch(val) {\r\n\t\t\tcase 'open': // MOVING\r\n\t\t\tcase 'close': // MOVING\r\n\t\t\t\tval = true;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tcase 'stop': // MOVING\r\n\t\t\t\tval = false;\r\n\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\tdefault: // UNKNOWN\r\n\t\t\t\tval = null;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn val;\r\n}","/**\r\n *\r\n *\r\n */\r\nfunction HsvToRgb(h, s = 1, v = 1) {\r\n\tif (Array.isArray(h)) {\r\n\t\tv = h[2];\r\n\t\ts = h[1];\r\n\t\th = h[0];\r\n\t}\r\n\telse if (typeof h === 'string' && h.indexOf(',')) {\r\n\t\t[h, s, v] = h.split(',');\r\n\t}\r\n\t\r\n\tif (h > 1) {\r\n\t\th = h/360;\r\n\t}\r\n\t\r\n\tlet r, g, b, i, f, p, q, t;\r\n\t\r\n\ti = Math.floor(h * 6);\r\n\tf = h * 6 - i;\r\n\tp = v * (1 - s);\r\n\tq = v * (1 - f * s);\r\n\tt = v * (1 - (1 - f) * s);\r\n\t\r\n\tswitch (i % 6) {\r\n\t\tcase 0:\r\n\t\t\tr = v;\r\n\t\t\tg = t;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\t\r\n\t\tcase 1:\r\n\t\t\tr = q;\r\n\t\t\tg = v;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 2:\r\n\t\t\tr = p;\r\n\t\t\tg = v;\r\n\t\t\tb = t;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 3:\r\n\t\t\tr = p;\r\n\t\t\tg = q;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 4:\r\n\t\t\tr = t;\r\n\t\t\tg = p;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 5:\r\n\t\t\tr = v;\r\n\t\t\tg = p;\r\n\t\t\tb = q;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault: // for webpack\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn [\r\n\t\tMath.round(r * 255),\r\n\t\tMath.round(g * 255),\r\n\t\tMath.round(b * 255)\r\n\t];\r\n}\r\n\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction RgbToHex(r, g, b) {\r\n\tif (Array.isArray(r)) {\r\n\t\tb = r[2];\r\n\t\tg = r[1];\r\n\t\tr = r[0];\r\n\t}\r\n\telse if (typeof r === 'string' && r.indexOf(',')) {\r\n\t\t[r, g, b] = r.split(',');\r\n\t}\r\n\t\r\n\tr = parseInt(r).toString(16);\r\n\tg = parseInt(g).toString(16);\r\n\tb = parseInt(b).toString(16);\r\n\t\r\n\tif (r.length === 1) r = '0' + r;\r\n\tif (g.length === 1) g = '0' + g;\r\n\tif (b.length === 1) b = '0' + b;\r\n\t\r\n\treturn \"#\" + r + g + b;\r\n}\r\n\r\n\r\nexport default {\r\n\tHsvToRgb,\r\n\tRgbToHex\r\n}","import React, { useState, useEffect } from 'react'\r\nimport { HuePicker, SketchPicker as ColorPicker } from 'react-color'\r\n\r\nimport Log from '../../Log'\r\nimport i18n from '../../i18n'\r\nimport helpers from '../../helpers/colorConverter'\r\nimport defaults from '../defaults'\r\n\r\n\r\n/*\r\n * i18n\r\n */\r\nlet translations = require('./light.' + i18n.getLanguage()).default\r\ni18n.setTranslation(i18n.getLanguage(), translations);\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction LightLevelAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked ? ((device.getOption('defaultValue')) || 100) : 0).catch(err => Log._('Function (light)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal > 0);\r\n\tuseEffect(() => setChecked(stateVal > 0), [stateVal]);\r\n\t\r\n\t// only show percentage if device has a switch itself\r\n\tif (device.parent && device.parent.states.power) {\r\n\t\treturn <defaults.actions.Action {...props} stateVal={checked} onChange={onChange} />;\r\n\t}\r\n\t\r\n\treturn <defaults.actions.PowerAction {...props} stateVal={checked} onChange={onChange} />\r\n}\r\n\r\nfunction LightColorAction(props) {\r\n\tconst { stateKey, stateVal } = props;\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(stateVal);\r\n\tuseEffect(() => setColorSpace(stateVal), [stateVal]);\r\n\t\r\n\tlet colors, labels = {};\r\n\tif (stateKey === 'rgb' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Red: colors[0], Green: colors[1], Blue: colors[2] };\r\n\t\t\r\n\t}\r\n\telse if (stateKey === 'hsv' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Hue: colors[0], Saturation: colors[1], Brightness: colors[2] };\r\n\t}\r\n\t\r\n\tconst Label = defaults.components.Label;\r\n\tlet label = [];\r\n\tfor (let key in labels) {\r\n\t\tlabel.push(<Label key={key} label={key + ' ' + labels[key]} br={true} />);\r\n\t}\r\n\t\r\n\treturn label;\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction LightColorTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={2000} max={6500} step={10} {...props} />\r\n\t);\r\n}\r\n\r\nfunction LightHueComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tsetHue(Math.round(color.hsl.h));\r\n\t\tdevice.setDeviceState(stateKey, Math.round(color.hsl.h)).catch(err => Log._('Function (light)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst [hue, setHue] = useState(stateVal);\r\n\tuseEffect(() => setHue(stateVal), [stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\tconst color = helpers.RgbToHex(helpers.HsvToRgb(hue));\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<HuePicker\r\n\t\tcolor={color}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\nfunction LightColorComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tcolor = color[stateKey];\r\n\t\t\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tcolor = [color.r, color.g, color.b].join(',');\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tcolor = [color.h, color.s, color.v].join(',');\r\n\t\t}\r\n\t\t\r\n\t\tdevice.setDeviceState(stateKey, color).catch(err => Log._('Function (light)', err.message, 'error', true, err.stack));\r\n\t};\r\n\t\r\n\tlet initialColor = stateVal || '#ffffff';\r\n\t\r\n\t// RGB\r\n\tif (stateKey === 'rgb') {\r\n\t\tinitialColor = helpers.RgbToHex(initialColor);\r\n\t}\r\n\t// HSV\r\n\telse if (stateKey === 'hsv') {\r\n\t\tinitialColor = helpers.RgbToHex(helpers.HsvToRgb(initialColor));\r\n\t}\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(initialColor);\r\n\tuseEffect(() => {\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(stateVal));\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(helpers.HsvToRgb(stateVal)));\r\n\t\t}\r\n\t\t// HEX\r\n\t\telse if (stateKey === 'hex') {\r\n\t\t\tsetColorSpace(stateVal);\r\n\t\t}\r\n\t}, [stateKey, stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<ColorPicker\r\n\t\tcolor={colorSpace}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\nconst color = {\r\n\ticon: {\r\n\t\t'default': 'palette',\r\n\t},\r\n\tunit: ' °'\r\n}\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'lights',\r\n\t\t'de': 'Lichter',\r\n\t},\r\n\tconfigurations: {\r\n\t\tpower: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'lightbulb-on',\r\n\t\t\t\t'false': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tvalue: val => val > 0 && val <= 1 ? val * 100 : val,\r\n\t\t\tunit: val => val > 0 ? ' %' : null,\r\n\t\t\tstateStyle: {\r\n\t\t\t\t'0': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'lightbulb-on',\r\n\t\t\t\t'0': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t\tdisplay: {\r\n\t\t\t\t'0': i18n.t('light#level#off')\r\n\t\t\t},\r\n\t\t},\r\n\t\tcolorTemperature: {\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'thermometer',\r\n\t\t\t},\r\n\t\t\tunit: ' °K'\r\n\t\t},\r\n\t\thue: color,\r\n\t\trgb: color,\r\n\t\thsv: color,\r\n\t\thex: color\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel: defaults.components.LevelComponent,\r\n\t\tcolorTemperature: LightColorTemperatureComponent,\r\n\t\trgb: LightColorComponent,\r\n\t\thsv: LightColorComponent,\r\n\t\thex: LightColorComponent,\r\n\t\thue: LightHueComponent\r\n\t},\r\n\tactions: {\r\n\t\tpower: defaults.actions.PowerAction,\r\n\t\tlevel: LightLevelAction,\r\n\t\trgb: LightColorAction,\r\n\t\thsv: LightColorAction,\r\n\t\thex: LightColorAction\r\n\t}\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Log from '../Log'\r\n\r\nimport helpers from '../helpers/timeConverter'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\n//import IconButton from '@material-ui/core/IconButton'\r\nimport Fab from '@material-ui/core/Fab'\r\nimport PlayIcon from '@material-ui/icons/PlayArrow'\r\nimport PauseIcon from '@material-ui/icons/Pause'\r\nimport StopIcon from '@material-ui/icons/Stop'\r\nimport SkipPreviousIcon from '@material-ui/icons/SkipPrevious'\r\nimport SkipNextIcon from '@material-ui/icons/SkipNext'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdivider: {\r\n\t\tmargin: '15px -16px'\r\n\t},\r\n\tcontainer: {\r\n\t\tmargin: theme.spacing(0, -2),\r\n\t},\r\n\tnoHeader: {\r\n\t\tmarginTop: theme.spacing(-4),\r\n\t},\r\n\timage: {\r\n\t\theight: '200px',\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'flex-end',\r\n\t\tbackgroundPosition: 'center',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tnoImage: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tdisplay: 'flex',\r\n\t\tcursor: 'pointer'\r\n\t},\r\n\tinformation: {\r\n\t\tbackgroundColor: theme.palette.primary.main + '66',\r\n\t\tcolor: '#fff',\r\n\t\tpadding: '10px',\r\n\t\tmargin: 0,\r\n\t\twidth: '100%',\r\n\t\tminHeight: '45px'\r\n\t},\r\n\tinformationLeft: {\r\n\t\twidth: '80%',\r\n\t\tfloat: 'left',\r\n\t\tmargin: 0\r\n\t},\r\n\tinformationRight: {\r\n\t\twidth: '19%',\r\n\t\tfloat: 'right',\r\n\t\tmargin: 0,\r\n\t\ttextAlign: 'right'\r\n\t},\r\n\tlength: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\twidth: '100%',\r\n\t\theight: '7px',\r\n\t},\r\n\tlengthBar: {\r\n\t\tbackgroundColor: theme.palette.secondary.main,\r\n\t\theight: '100%',\r\n\t},\r\n\tcontrols: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'stretch'\r\n\t},\r\n\tcontrolsBox: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'center',\r\n\t\talignItems: 'center',\r\n\t\tpaddingTop: '30px'\r\n\t},\r\n\tcontrolsBoxLeft: {\r\n\t\tflex: 1,\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'baseline'\r\n\t},\r\n\tcontrolsBoxCenter: {\r\n\t\tflex: 3\r\n\t},\r\n\tcontrolsBoxRight: {\r\n\t\tflex: 1,\r\n\t\tjustifyContent: 'end'\r\n\t},\r\n\tcontrolButton: {\r\n\t\tmargin: '0 5px'\r\n\t},\r\n\tcontrolButtonSmall: {\r\n\t\tmargin: '0 10px',\r\n\t\tfontSize: '1.2rem',\r\n\t\theight: '32px',\r\n\t\twidth: '32px'\r\n\t}\r\n});\r\n\r\n\r\nclass Multimedia extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// get initial states\r\n\t\tfor (let stateKey in this.props.device.states) {\r\n\t\t\tthis.props.device.requestDeviceState(stateKey, true).catch(err => Log._('Modules (MultimediaItem)', err.message, 'error', true, err.stack));\r\n\t\t}\r\n\t\t\r\n\t\t// receive updates\r\n\t\tthis.props.device.listen(this.stateChange);\r\n\t}\r\n\t\r\n\tcomponentWillUnmount() {\r\n\t\tthis.props.device.unlisten(this.stateChange);\r\n\t}\r\n\t\r\n\tstateChange = (stateKey, state) => {\r\n\t\t\r\n\t\t// duration\r\n\t\tif (stateKey === 'duration' && state && state.val.indexOf(':') === -1) {\r\n\t\t\tstate.val = helpers.timeToHoursMinutesSeconds(state.val);\r\n\t\t}\r\n\t\t\r\n\t\t// isRunning\r\n\t\tif (stateKey === 'isRunning' && state && typeof state.val === 'string') {\r\n\t\t\tstate.val = state.val.indexOf('play') > -1;\r\n\t\t}\r\n\t\t\r\n\t\tthis.setState({ [stateKey]: state }, () => {\r\n\t\t\tthis.progress();\r\n\t\t});\r\n\t}\r\n\t\r\n\tprogress() {\r\n\t\tclearTimeout(this.progressTimeout);\r\n\t\t\r\n\t\tif (this.state.isRunning && this.state.isRunning.val === true && this.state.progress && this.state.progress.val && this.state.duration && this.state.duration.val) {\r\n\t\t\tthis.progressTimeout = setTimeout(() => {\r\n\t\t\t\tthis.setState(prevState => ({ progress: { ...prevState.progress, val: helpers.timeToSeconds(prevState.progress.val) + 1 }}), () => this.progress());\r\n\t\t\t}, 1000);\r\n\t\t}\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\tsetDeviceState(stateKey, value) {\r\n\t\tthis.props.device.setDeviceState(stateKey, value).catch(err => Log._('Modules (MultimediaItem)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, noHeader, index, device } = this.props;\r\n\t\tlet styleImage = {}, styleLength = {}, styleLengthBar = {};\r\n\t\t\r\n\t\t// background\r\n\t\tif (this.state.background && this.state.background.val !== '') {\r\n\t\t\tstyleImage.backgroundImage = 'url(' + ((device.options.backgroundUrlPrepend || '') + this.state.background.val) + ')';\r\n\t\t}\r\n\t\t\r\n\t\t// duration\r\n\t\tif (this.state.duration && this.state.duration.val) {\r\n\t\t\tstyleLengthBar.width = ((this.state.progress && this.state.progress.val) || 0) + 'px';\r\n\t\t}\r\n\t\t\r\n\t\tconst playIconElements = this.state.isRunning && this.state.isRunning.val ? [<PauseIcon onClick={this.setDeviceState.bind(this, 'pause', true)} />, <StopIcon />] : [<PlayIcon onClick={this.setDeviceState.bind(this, 'play', true)} />];\r\n\t\t//const repeatIcon = 'repeat'; // repeat, repeat-off, repeat-once\r\n\t\t//const shuffleIcon = 'shuffle-variant'; // shuffle-variant, shuffle-disabled\r\n\t\t//const volumeIcon = 'volume-high'; // volume-variant-off\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{index > 0 && <Divider className={classes.divider} />}\r\n\t<div className={clsx(classes.container, noHeader && classes.noHeader)}>\r\n\t\t\r\n\t\t<div className={clsx(this.state.background && this.state.background.val !== '' ? classes.image : classes.noImage)} style={ styleImage } onClick={this.openDialog.bind(this)}>\r\n\t\t\t\r\n\t\t\t<div className={classes.information}>\r\n\t\t\t\t<p className={classes.informationLeft}>\r\n\t\t\t\t\t{this.state.grandParent && this.state.grandParent.val && [this.state.grandParent.val, <br key={'br-' + device.id} />]}\r\n\t\t\t\t\t{this.state.parent && this.state.parent.val && this.state.parent.val + ' - '}{this.state.title && this.state.title.val}\r\n\t\t\t\t</p>\r\n\t\t\t\t<p className={classes.informationRight}>\r\n\t\t\t\t\t{this.state.progress && helpers.timeToHoursMinutesSeconds(this.state.progress.val)} / {this.state.duration && this.state.duration.val}\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t</div>\r\n\t\t<div className={classes.length} style={ styleLength }>\r\n\t\t\t<div className={classes.lengthBar} style={ styleLengthBar }></div>\r\n\t\t</div>\r\n\t\t\r\n\t\t<div className={classes.controls}>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxLeft)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + repeatIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + shuffleIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxCenter)}>\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipPreviousIcon onClick={this.setDeviceState.bind(this, 'previous', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t\t{playIconElements.map((icon, i) => \r\n\t\t\t\t<Fab key={'icon-' + i} className={classes.controlButton} size=\"large\" color=\"primary\">\r\n\t\t\t\t\t{icon}\r\n\t\t\t\t</Fab>\r\n\t\t\t\t)}\r\n\t\t\t\t\r\n\t\t\t\t<Fab className={classes.controlButton} size=\"small\" color=\"secondary\">\r\n\t\t\t\t\t<SkipNextIcon onClick={this.setDeviceState.bind(this, 'next', true)} />\r\n\t\t\t\t</Fab>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className={clsx(classes.controlsBox, classes.controlsBoxRight)}>\r\n\t\t\t\t{/*\r\n\t\t\t\t<IconButton size=\"small\" className={classes.controlButtonSmall}>\r\n\t\t\t\t\t<span className={'mdi mdi-' + volumeIcon}></span>\r\n\t\t\t\t</IconButton>\r\n\t\t\t\t*/}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t</div>\r\n\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Multimedia);\r\n","import React from 'react'\r\n\r\nimport MultimediaItem from './MultimediaItem'\r\n\r\n\r\nexport default function StateList(props) {\r\n\tconst { devices, settings } = props;\r\n\treturn devices.map((device, i) => <MultimediaItem key={'MultimediaItem-' + device.id} {...props} index={i} noHeader={i === 0 && settings.icon === null && settings.title === null} device={device} />)\r\n}\r\n\r\n\r\nexport const ModuleDescription = \"Zeigt ein Multimedia-Player an (z. B. Spotify)\";\r\nexport const ModuleScreenshots = [];\r\n\r\nexport const ModuleConfig = [\r\n]\r\n","import Log from './Log'\r\nimport i18n from './i18n'\r\n\r\n\r\n/**\r\n * Settings\r\n *\r\n *\r\n */\r\nexport default class Settings {\r\n\r\n\t/*\r\n\t * holds the settings\r\n\t */\r\n\tstatic settings = {};\r\n\t\r\n\t/**\r\n\t * Apply settings.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic applySettings() {\r\n\t\t\r\n\t\t// language\r\n\t\tif (Settings.settings.language) {\r\n\t\t\ti18n.setLanguage(Settings.settings.language);\r\n\t\t\ti18n.loadTranslation(Settings.settings.language);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ti18n.loadTranslation();\r\n\t\t}\r\n\t\t\r\n\t\t// page title\r\n\t\tif (Settings.settings.pageTitle) {\r\n\t\t\tdocument.title = Settings.settings.pageTitle;\r\n\t\t}\r\n\t\t\r\n\t\t// favicon\r\n\t\tif (Settings.settings.pageFavicon && Settings.settings.pageFavicon.substr(0, 5) === 'data:') {\r\n\t\t\tdocument.getElementById('favicon').href = Settings.settings.pageFavicon;\r\n\t\t}\r\n\t\t\r\n\t\t// translations\r\n\t\tif (Settings.settings.translations) {\r\n\t\t\t\r\n\t\t\tlet translations = Settings.settings.translations;\r\n\t\t\tfor (let language in translations) {\r\n\t\t\t\ti18n.setTranslation(language, translations[language]);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a setting.\r\n\t *\r\n\t * @param\t{String}\tsettings\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic getSetting(setting) {\r\n\t\treturn Settings.settings[setting] || '';\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets all settings.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Object}\r\n\t */\r\n\tstatic getSettings() {\r\n\t\treturn Settings.settings || {};\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a setting.\r\n\t *\r\n\t * @param\t{String}\tsetting\r\n\t * @param\t{String}\tvalue\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setSetting(setting, val) {\r\n\t\t\r\n\t\tif (setting && val !== undefined) {\r\n\t\t\tSettings.settings[setting] = val;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * Set settings.\r\n\t *\r\n\t * @param\t{Object}\tsettings\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setSettings(settings) {\r\n\t\tif (settings) {\r\n\t\t\tSettings.settings = { ...Settings.settings, ...settings || {} };\r\n\t\t\tLog._('Settings', [ 'Set settings', Settings.settings ]);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n}\r\n","export { default } from './blind'\r\n","export default {\r\n\t// States\r\n\t\"blind#activity\": \"Aktivität\",\r\n\t\"blind#level\": \"Behanghöhe\",\r\n\t\"blind#level2\": \"Lamellenposition\",\r\n\t\r\n\t// State values\r\n\t\"blind#activity#true\": \"in Bewegung\",\r\n\t\"blind#activity#false\": \"keine\",\r\n}","export default {\r\n\t// States\r\n\t\"blind#activity\": \"Activity\",\r\n\t\"blind#level\": \"Level\",\r\n\t\"blind#level2\": \"Lamella\",\r\n\t\r\n\t// State values\r\n\t\"blind#activity#true\": \"moving\",\r\n\t\"blind#activity#false\": \"none\",\r\n}","export default {\r\n\t// States\r\n\t\"door#bell\": \"Klingel\",\r\n\t\"door#lock\": \"Schloß\",\r\n\t\"door#open\": \"Tür\",\r\n\t\r\n\t// State values\r\n\t\"door#open#true\": \"offen\",\r\n\t\"door#open#false\": \"geschlossen\",\r\n}","export default {\r\n\t// States\r\n\t\"door#bell\": \"Bell\",\r\n\t\"door#lock\": \"Lock\",\r\n\t\"door#open\": \"Door\",\r\n\t\r\n\t// State values\r\n\t\"door#open#true\": \"open\",\r\n\t\"door#open#false\": \"closed\",\r\n}","export default {\r\n\t\"heating#boost\": \"Boost\",\r\n\t\"heating#humidity\": \"Luftfeuchtigkeit\",\r\n\t\"heating#setTemperature\": \"eingestellte Temperatur\",\r\n\t\"heating#temperature\": \"Temperatur\",\r\n}","export default {\r\n\t\"heating#boost\": \"Boost\",\r\n\t\"heating#humidity\": \"Humidity\",\r\n\t\"heating#setTemperature\": \"Set Temperature\",\r\n\t\"heating#temperature\": \"Temperature\",\r\n}","import Log from './Log'\r\nimport { de } from 'date-fns/locale'\r\nexport const locales = { de }\r\n\r\n\r\n/**\r\n * Internationalization\r\n * Based on https://raw.githubusercontent.com/ioBroker/adapter-react/master/src/i18n.js.\r\n * Copyright 2018-2019 bluefox <dogafox@gmaiLog.com>\r\n *\r\n * MIT License\r\n *\r\n *\r\n */\r\nexport default class i18n {\r\n\r\n\t/*\r\n\t * holds the translations\r\n\t */\r\n\tstatic translations = {};\r\n\r\n\t/*\r\n\t * default language\r\n\t */\r\n\tstatic language = (navigator.language || navigator.userLanguage || 'en-EN');\r\n\r\n\t/**\r\n\t * Override default language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setLanguage(language) {\r\n\t\tif (language) {\r\n\t\t\ti18n.language = language;\r\n\t\t\tLog._('i18n', 'Set language to ' + language + '.', 'debug');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads multiple translations.\r\n\t *\r\n\t * @param\t{String|Array}\tlanguages\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslations(languages) {\r\n\t\t\r\n\t\tif (languages) {\r\n\t\t\tlanguages = Array.isArray(languages) ? languages : [languages];\r\n\t\t\tlanguages.forEach(language => i18n.loadTranslation(language));\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads a translation.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslation(language = i18n.getLanguage()) {\r\n\t\t\r\n\t\tif (language) {\r\n\t\t\tlet translation;\r\n\t\t\ttry {\r\n\t\t\t\ttranslation = require('./i18n/' + language + '.js').default;\r\n\t\t\t\ti18n.setTranslation(language, translation);\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tLog._('i18n', err.message, 'error', false, err.stack);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a translation for language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @param\t{Object}\ttranslation\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setTranslation(language, translation) {\r\n\t\tif (language && translation) {\r\n\t\t\ti18n.translations[language] = { ...i18n.translations[language] || {}, ...translation };\r\n\t\t\tLog._('i18n', 'Set translations for language ' + language + '.', 'debug');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic getLanguage(isoLong = false) {\r\n\t\treturn i18n.language.substr(0, isoLong ? 5 : 2);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\t{String|Object}\t\tword\r\n\t * @param\t{Object}\t\t\t[options={}]\r\n\t * @param\t{Boolean}\t\t\t[options.ucFirst=false]\r\n\t * @param\t{Object}\t\t\t[placeholders={}]\r\n\t * @param\t{String}\t\t\t[language=i18n.language]\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic t(word = '', options = {}, placeholders = {}, language = i18n.getLanguage()) {\r\n\t\t\r\n\t\t// if object is provided, it might be translated already\r\n\t\tif (typeof word === 'object' && word[language] !== undefined) {\r\n\t\t\tword = word[language];\r\n\t\t}\r\n\t\t\r\n\t\telse if (word) {\r\n\t\t\tword = word.toString();\r\n\t\t\tif (i18n.translations[language]) {\r\n\t\t\t\t\r\n\t\t\t\t// check if word is concatenated\r\n\t\t\t\tif (word.indexOf('#') > -1) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet parts = word.split('#');\r\n\t\t\t\t\twhile (parts.length > 0 && !i18n.translations[language][parts.join('#')]) {\r\n\t\t\t\t\t\tparts.shift();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tword = parts.join('#');\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (i18n.translations[language][word]) {\r\n\t\t\t\t\tword = i18n.translations[language][word];\r\n\t\t\t\t}\r\n\t\t\t\telse if (i18n.translations[language][word.toLowerCase()]) {\r\n\t\t\t\t\tword = i18n.translations[language][word.toLowerCase()];\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tLog._('i18n', 'Word \"' + word + '\" not found in language ' + language + '!', 'debug', false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tLog._('i18n', 'Language ' + language + ' not loaded for word ' + word + '!', 'error');\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// replace placeholders\r\n\t\tfor (let key in placeholders) {\r\n\t\t\tword = word.replace(RegExp('%' + key + '%', 'g'), placeholders[key]);\r\n\t\t}\r\n\t\t\r\n\t\t// options\r\n\t\tif (options.ucFirst) {\r\n\t\t\tword = word.charAt(0).toUpperCase() + word.slice(1);\r\n\t\t}\r\n\t\t\r\n\t\treturn word;\r\n\t}\r\n}\r\n","export default {\r\n\t// States\r\n\t\"light#colorTemperature\": \"Farbtemperatur\",\r\n\t\"light#hex\": \"Farbe (Hex)\",\r\n\t\"light#hsv\": \"Farbraum Hue-Saturation-Value (HSV)\",\r\n\t\"light#hue\": \"Farbe (Hue)\",\r\n\t\"light#level\": \"Helligkeit\",\r\n\t\"light#power\": \"Licht\",\r\n\t\"light#rgb\": \"Farbraum Rot-Grün-Blau (RGB)\",\r\n\t\r\n\t// State values\r\n\t\"light#level#off\": \"ausgeschaltet\",\r\n}","export default {\r\n\t// States\r\n\t\"light#colorTemperature\": \"Color Temperature\",\r\n\t\"light#hex\": \"Color (Hex)\",\r\n\t\"light#hsv\": \"Colorspace Hue-Saturation-Value (HSV)\",\r\n\t\"light#hue\": \"Color (Hue)\",\r\n\t\"light#level\": \"Brightness\",\r\n\t\"light#power\": \"Power\",\r\n\t\"light#rgb\": \"Colorspace Red-Green-Blue (RGB)\",\r\n\t\r\n\t// State values\r\n\t\"light#level#off\": \"off\",\r\n}","export default {\r\n\t// States\r\n\t\"location#position\": \"Position\",\r\n\t\"location#presence\": \"Anwesenheit\",\r\n\t\"location#users\": \"Benutzer\",\r\n\t\r\n\t// State values\r\n\t\"location#presence#true\": \"anwesend\",\r\n\t\"location#presence#false\": \"abwesend\",\r\n\t\"location#users#empty\": \"niemand anwesend\",\r\n}","export default {\r\n\t// States\r\n\t\"location#position\": \"Position\",\r\n\t\"location#presence\": \"Presence\",\r\n\t\"location#users\": \"Users\",\r\n\t\r\n\t// State values\r\n\t\"location#presence#true\": \"present\",\r\n\t\"location#presence#false\": \"absent\",\r\n\t\"location#users#empty\": \"nobody present\",\r\n}","export default {\r\n\t\"user#location\": \"Standort\",\r\n\t\"user#position\": \"Position\",\r\n}","export default {\r\n\t\"user#location\": \"Location\",\r\n\t\"user#position\": \"Position\",\r\n}","export default {\r\n\t// States\r\n\t\"window#open\": \"Fenster\",\r\n\t\r\n\t// State values\r\n\t\"window#open#true\": \"offen\",\r\n\t\"window#open#false\": \"geschlossen\",\r\n}","export default {\r\n\t// States\r\n\t\"window#open\": \"Window\",\r\n\t\r\n\t// State values\r\n\t\"window#open#true\": \"open\",\r\n\t\"window#open#false\": \"closed\",\r\n}","import React, { useState } from 'react'\r\nimport i18n from '../../i18n'\r\n\r\nimport FormControl from '@material-ui/core/FormControl'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport InputLabel from '@material-ui/core/InputLabel'\r\nimport Switch from '@material-ui/core/Switch'\r\n\r\nimport Field from './Field'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles((theme) => ({\r\n\tFormControl: {\r\n\t\twidth: '100%'\r\n\t},\r\n\tInputLabel: {\r\n\t\twidth: '133%'\r\n\t},\r\n\tSwitch: {\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\tSwitchSmall: {\r\n\t\tmarginTop: '2px'\r\n\t},\r\n\tSwitchInline: {\r\n\t\tmarginLeft: '5px'\r\n\t},\r\n}));\r\n\r\n\r\n/*\r\n *\r\n */\r\nexport default function InputSwitch(props) {\r\n\tconst { id, label, val, size, disabled, onChange } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\tconst [checked, setChecked] = useState(val || false);\r\n\tconst handleSwitchChange = event => {\r\n\t\tlet userInput = (event && event.target && event.target.checked) || false;\r\n\t\t\r\n\t\tsetChecked(userInput);\r\n\t\tonChange && onChange(props, userInput);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<Field {...props}>\r\n\t\t\t<FormControl\r\n\t\t\t\tkey={'FormControl-' + id}\r\n\t\t\t\tclasses={{ root: classes.FormControl }}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<InputLabel classes={{ root: classes.InputLabel }} shrink={true}>{i18n.t(label)}</InputLabel>\r\n\t\t\t\t<Switch\r\n\t\t\t\t\tclasses={{ root: size === 'small' ? classes.SwitchSmall : classes.Switch }}\r\n\t\t\t\t\tchecked={checked}\r\n\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\tonChange={handleSwitchChange}\r\n\t\t\t\t\tsize={size}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t</FormControl>\r\n\t\t</Field>\r\n\r\n\t)\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport function InputSwitchInline(props) {\r\n\tconst { label, val, size, disabled, onChange } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\tconst [checked, setChecked] = useState(val || false);\r\n\tconst handleSwitchChange = event => {\r\n\t\tlet userInput = (event && event.target && event.target.checked) || false;\r\n\t\t\r\n\t\tsetChecked(userInput);\r\n\t\tonChange && onChange(props, userInput);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<Field {...props}>\r\n\t\t\t<FormControlLabel\r\n\t\t\t\tclasses={{ root: classes.SwitchInline }}\r\n\t\t\t\tlabel={i18n.t(label)}\r\n\t\t\t\tcontrol={<Switch\r\n\t\t\t\t\tclasses={{ root: size === 'small' ? classes.SwitchSmall : classes.Switch }}\r\n\t\t\t\t\tchecked={checked}\r\n\t\t\t\t\tdisabled={disabled}\r\n\t\t\t\t\tonChange={handleSwitchChange}\r\n\t\t\t\t\tsize={size} />}\r\n\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t</Field>\r\n\r\n\t)\r\n}","var map = {\n\t\"./de.js\": 405,\n\t\"./en.js\": 406\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 404;","export default {\r\n\t\"Weather\": \"Wetter\",\r\n\t\r\n\t/*\r\n\t * LOADING SCREEN\r\n\t */\r\n\t\"Retrieving settings\": \"Einstellungen werden geladen\",\r\n\t\r\n\t/*\r\n\t * GENERAL\r\n\t */\r\n\t\"last update\": \"letzte Aktualisierung\",\r\n\t\"Updates available\": \"Aktualisierung verfügbar\",\r\n\t\r\n\t/*\r\n\t * STATES\r\n\t */\r\n\t\"on\": \"an\",\r\n\t\"off\": \"aus\",\r\n\t\r\n\t\"user\": \"User\",\r\n\t\"users\": \"Users\",\r\n\t\r\n\t\"door\": \"Tür\",\r\n\t\"window\": \"Fenster\",\r\n\t\r\n\t\"open\": \"offen\",\r\n\t\"closed\": \"geschlossen\",\r\n\t\r\n\t\"turn on\": \"anschalten\",\r\n\t\"power\": \"Geräte Status\",\r\n\t\"trigger\": \"Geräte Status\",\r\n\t\r\n\t\"brightness\": \"Helligkeit\",\r\n\t\"wind\": \"Wind\",\r\n\t\"battery\": \"Batterie\",\r\n\t\r\n\t\"%DateTime\": \"%DateTime Uhr\",\r\n\t\r\n\t/*\r\n\t * HOUSEHOLD\r\n\t */\r\n\t\"running\": \"Gerät läuft\",\r\n\t\"consumption\": \"Verbrauch\"\r\n}","export default {\r\n}","var map = {\n\t\"./blind.de\": 292,\n\t\"./blind.de.js\": 292,\n\t\"./blind.en\": 293,\n\t\"./blind.en.js\": 293,\n\t\"./blind.js\": 249\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 450;","export { default } from './door'\r\n","var map = {\n\t\"./door.de\": 294,\n\t\"./door.de.js\": 294,\n\t\"./door.en\": 295,\n\t\"./door.en.js\": 295,\n\t\"./door.js\": 218\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 453;","export { default } from './heating'\r\n","var map = {\n\t\"./heating.de\": 296,\n\t\"./heating.de.js\": 296,\n\t\"./heating.en\": 297,\n\t\"./heating.en.js\": 297,\n\t\"./heating.js\": 219\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 455;","export { default } from './light'\r\n","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Log from '../Log'\r\nimport i18n from '../i18n'\r\n\r\nimport Slider from '@material-ui/core/Slider'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport Button from '@material-ui/core/Button'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tprimaryAction: props => ({\r\n\t\t...props.styles\r\n\t}),\r\n\tsecondaryAction: props => ({\r\n\t\tcolor: '#999',\r\n\t\tfontSize: '14px',\r\n\t\t...props.styles\r\n\t}),\r\n});\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\tcomponent: {\r\n\t\tpadding: theme.spacing(2, 0, 2, 0)\r\n\t},\r\n\tsliderMarkLabel: {\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tdisplay: 'none',\r\n\t\t\t'&:nth-child(5)': { display: 'block' },\r\n\t\t\t'&:nth-child(15)': { display: 'block' },\r\n\t\t\t'&:nth-child(25)': { display: 'block' }\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nconst Action = withStyles(styles)(props => {\r\n\tconst { classes, device, state, stateKey } = props;\r\n\treturn (\r\n\r\n<span className={clsx((stateKey === device.primaryStateKey && classes.primaryAction) || (stateKey === device.secondaryStateKey && classes.secondaryAction))}>\r\n\t{state && state.value} {state && state.unit}\r\n</span>\r\n\r\n\t);\r\n});\r\n\r\nfunction PowerAction(props) {\r\n\tconst { device, stateKey, stateVal, onChange: parentOnChange } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked).catch(err => Log._('Function (defaults)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal);\r\n\tuseEffect(() => setChecked(stateVal), [stateVal]);\r\n\t\r\n\treturn (\r\n\r\n<Switch\r\n\tchecked={checked}\r\n\tonChange={parentOnChange || onChange}\r\n\tvalue={checked !== true}\r\n\tcolor=\"primary\"\r\n\t/>\r\n\r\n\t);\r\n}\r\n\r\nfunction TriggerAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onClick = () => {\r\n\t\tdevice.setDeviceState(stateKey, true).catch(err => Log._('Function (defaults)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\t//\r\n\tif (stateVal === true || stateVal > 0) {\r\n\t\treturn <Action {...props} onChange={null} />;\r\n\t}\r\n\t\r\n\tconst icon = 'power';\r\n\treturn (\r\n\r\n<Button\r\n\tvariant=\"outlined\"\r\n\tcolor=\"primary\"\r\n\tsize=\"small\"\r\n\tstartIcon={<span className={'mdi mdi-' + icon}></span>}\r\n\tonClick={onClick}\r\n\t>\r\n\t\r\n\t{i18n.t('turn on')}\r\n</Button>\r\n\r\n\t);\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction Label(props) {\r\n\tconst { label, br } = props;\r\n\tconst linebreak = br || false;\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t{label}\r\n\t{linebreak && <br />}\r\n</React.Fragment>\r\n\t\r\n\t);\r\n}\r\n\r\nfunction Component(props) {\r\n\tconst { title, children } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Label label={title} />\r\n\t<div className={classes.component}>\r\n\t\t{children}\r\n\t</div>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\nfunction LevelComponent(props) {\r\n\tlet { device, stateKey, stateVal, title, min, max, step, markSteps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onChange = (e, val) => setLevel(val)\r\n\tconst onChangeCommitted = (e, val) => {\r\n\t\tsetLevel(val);\r\n\t\tdevice.setDeviceState(stateKey, val).catch(err => Log._('Function (defaults)', err.message, 'error', true, err.stack));\r\n\t}\r\n\t\r\n\tconst [level, setLevel] = useState(stateVal);\r\n\tuseEffect(() => setLevel(stateVal), [stateVal]);\r\n\t\r\n\t// default settings\r\n\tmin = min || 0;\r\n\tmax = max || 100;\r\n\tstep = step || 1;\r\n\tmarkSteps = markSteps || 11; // 0 to 10\r\n\tlet markStep = ((max-min)/(markSteps-1)) || 10;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<Slider\r\n\t\tclasses={{ markLabel: classes.sliderMarkLabel }}\r\n\t\tonChange={onChange}\r\n\t\tonChangeCommitted={onChangeCommitted}\r\n\t\tvalue={level}\r\n\t\tvalueLabelDisplay=\"auto\"\r\n\t\tmarks={[...Array(markSteps).keys()].map(number => ({ 'value': min+number*markStep, 'label': min+number*markStep }))}\r\n\t\tmin={min}\r\n\t\tmax={max}\r\n\t\tstep={step}\r\n\t/>\r\n\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tdescription: {\r\n\t\t'en': 'Default settings for all functions',\r\n\t\t'de': 'Standard-Einstellungen für alle Gewerke',\r\n\t},\r\n\tconfigurations: {\r\n\t\t_any: {\r\n\t\t\tvalue: (val) => val.toString(),\r\n\t\t\t//stateStyle\r\n\t\t\t//unit\r\n\t\t\t//icon\r\n\t\t\t//iconStyle\r\n\t\t\t//display\r\n\t\t\tstateStyle: {\r\n\t\t\t\ttrue: {\r\n\t\t\t\t\t'color': '#090',\r\n\t\t\t\t\t'fontWeight': 'bold'\r\n\t\t\t\t},\r\n\t\t\t\tfalse: {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tbattery: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'battery-medium'\r\n\t\t},\r\n\t\tdoor: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tdisplay: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'water-percent'\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tpower: {\r\n\t\t\tdisplay: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\ttemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer'\r\n\t\t},\r\n\t\ttrigger: {\r\n\t\t\tdisplay: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\twind: {\r\n\t\t\tunit: ' km/h',\r\n\t\t\ticon: 'weather-windy'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tLabel,\r\n\t\tComponent,\r\n\t\tLevelComponent,\r\n\t\t\r\n\t\tlevel: LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tAction,\r\n\t\tPowerAction,\r\n\t\tTriggerAction,\r\n\t\t\r\n\t\tpower: PowerAction,\r\n\t\ttrigger: TriggerAction\r\n\t}\r\n}","const _copy = require('rfdc')();\r\n\r\n/**\r\n * Devices\r\n *\r\n *\r\n */\r\nexport default class Devices {\r\n\r\n\t/*\r\n\t * holds the raw data\r\n\t */\r\n\tstatic rawDevices = {};\r\n\r\n\t/*\r\n\t * holds the devices\r\n\t */\r\n\tstatic Devices = {};\r\n\r\n\t/*\r\n\t * holds the groups\r\n\t */\r\n\tstatic Groups = {};\r\n\r\n\t/*\r\n\t * holds the groups IDs with its names\r\n\t */\r\n\tstatic GroupList = [];\r\n\t\r\n\t/*\r\n\t * holds the groups IDs\r\n\t */\r\n\tstatic GroupIds = [];\r\n\t\r\n\t/**\r\n\t * Sets the raw data\r\n\t *\r\n\t * @param\t{Object}\trawDevices\r\n\t * @return\tDevices\r\n\t */\r\n\tstatic set(rawDevices) {\r\n\t\t\r\n\t\tfor (let deviceId in rawDevices) {\r\n\t\t\tDevices.rawDevices[deviceId] = { ...rawDevices[deviceId], id: deviceId };\r\n\t\t}\r\n\t\t\r\n\t\treturn Devices;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set devices\r\n\t *\r\n\t * @param\t{Object}\tdevices\r\n\t * @return\tDevices\r\n\t */\r\n\tstatic setDevices(devices) {\r\n\t\t\r\n\t\tDevices.Devices = devices;\r\n\t\treturn Devices;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set groups and group IDs\r\n\t *\r\n\t * @param\t{Object}\tgroups\r\n\t * @return\tDevices\r\n\t */\r\n\tstatic setGroups(groups) {\r\n\t\t\r\n\t\t// set groups\r\n\t\tDevices.Groups = groups;\r\n\t\t\r\n\t\t// set group Ids\r\n\t\tfor (let groupId in groups) {\r\n\t\t\tDevices.addGroupId(groupId, groups[groupId].name);\r\n\t\t}\r\n\t\t\r\n\t\treturn Devices;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Adds a group ID\r\n\t *\r\n\t * @param\t{String}\tid of group\r\n\t * @param\t{String}\tname of group\r\n\t * @return\tDevices\r\n\t */\r\n\tstatic addGroupId(id, name) {\r\n\t\t\r\n\t\tif (id && Devices.GroupIds.indexOf(id) === -1) {\r\n\t\t\tDevices.GroupList.push({ id, name });\r\n\t\t\tDevices.GroupIds.push(id);\r\n\t\t}\r\n\t\t\r\n\t\treturn Devices;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get devices\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\tObject\r\n\t */\r\n\tstatic getDevices(options = {}) {\r\n\t\t\r\n\t\tif (typeof options === 'boolean') {\r\n\t\t\toptions = { raw: options }\r\n\t\t}\r\n\t\t\r\n\t\tconst devices = options.raw ? Devices.rawDevices : Devices.Devices;\r\n\t\treturn options.copy ? _copy(devices) : devices;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get groups\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\tObject\r\n\t */\r\n\tstatic getGroups() {\r\n\t\t\r\n\t\treturn Devices.Groups;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get group IDs\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\tArray\r\n\t */\r\n\tstatic getGroupList() {\r\n\t\t\r\n\t\treturn Devices.GroupList;\r\n\t}\r\n}\r\n","var map = {\n\t\"./light.de\": 331,\n\t\"./light.de.js\": 331,\n\t\"./light.en\": 332,\n\t\"./light.en.js\": 332,\n\t\"./light.js\": 250\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 619;","export { default } from './location'\r\n","var map = {\n\t\"./location.de\": 333,\n\t\"./location.de.js\": 333,\n\t\"./location.en\": 334,\n\t\"./location.en.js\": 334,\n\t\"./location.js\": 238\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 621;","export { default } from './user'\r\n","var map = {\n\t\"./user.de\": 335,\n\t\"./user.de.js\": 335,\n\t\"./user.en\": 336,\n\t\"./user.en.js\": 336,\n\t\"./user.js\": 239\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 623;","export { default } from './window'\r\n","var map = {\n\t\"./window.de\": 337,\n\t\"./window.de.js\": 337,\n\t\"./window.en\": 338,\n\t\"./window.en.js\": 338,\n\t\"./window.js\": 240\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 625;","import React from 'react'\r\nimport i18n from '../../i18n'\r\n\r\nimport AddIcon from '@material-ui/icons/AddCircle'\r\nimport InputButton from '@material-ui/core/Button'\r\n\r\nimport Field from './Field'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles((theme) => ({\r\n\tInputButton: {\r\n\t\twidth: '100%'\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n *\r\n */\r\nexport default function Button(props) {\r\n\tconst { id, label, color, variant, disabled, startIcon, onClick } = props;\r\n\tconst classes = useStyles(props);\r\n\t\r\n\treturn (\r\n\t\t<Field {...props}>\r\n\t\t\t<InputButton\r\n\t\t\t\tkey={id}\r\n\t\t\t\tclasses={{ root: classes.InputButton }}\r\n\t\t\t\tvariant={variant || 'contained'}\r\n\t\t\t\tcolor={color || 'primary'}\r\n\t\t\t\tdisabled={disabled}\r\n\t\t\t\tstartIcon={startIcon || <AddIcon />}\r\n\t\t\t\tonClick={onClick}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{i18n.t(label)}\r\n\t\t\t</InputButton>\r\n\t\t</Field>\r\n\r\n\t)\r\n}","import TextInput from './Text'\r\n\r\n\r\n/*\r\n *\r\n */\r\nexport default function NumberInput(props) {\r\n\treturn TextInput({ ...props, type: 'number' });\r\n}","import React from 'react'\r\nimport i18n from '../../i18n'\r\n\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\n\r\nimport Text from './Text'\r\n\r\n\r\n/*\r\n *\r\n */\r\nexport default function InputSelect(props) {\r\n\tconst { id, selection, val } = props;\r\n\t\r\n\tlet value = '';\r\n\tconst menuOptions = selection.map(option => {\r\n\t\tconst key = Object.keys(option).shift();\r\n\t\t\r\n\t\tif (key === val) {\r\n\t\t\tvalue = val;\r\n\t\t}\r\n\t\t\r\n\t\treturn <MenuItem key={'MenuItem-' + id + '-' + key} value={key}>{i18n.t(option[key])}</MenuItem>\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<Text\r\n\t\t\t{...props}\r\n\t\t\tval={value}\r\n\t\t\tselect={true}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{menuOptions}\r\n\t\t</Text>\r\n\t);\r\n}","\r\nexport const DEFAULTS = {\r\n\t'MODULE': 'StateList',\r\n\t'NODE_SETTINGS': 'jarvis.0.settings',\r\n\t'NODE_DEVICES': 'jarvis.0.devices',\r\n\t'NODE_NOTIFICATIONS': 'jarvis.0.notifications',\r\n}\r\n","import React from 'react'\r\n\r\nimport Log from '../../Log'\r\nimport i18n from '../../i18n'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Paper from '@material-ui/core/Paper'\r\n\r\nimport Dialog from '../../components/Dialog'\r\nimport EnhancedTable from '../../components/EnhancedTable'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\tpinToTop: {\r\n\t\tposition: 'absolute',\r\n\t\ttop: 0,\r\n\t\tleft: 0\r\n\t}\r\n});\r\n\r\n\r\nconst headCells = [\r\n\t{ id: 'time', disablePadding: false, type: 'Date', label: i18n.t('Time'), noWrap: true },\r\n\t{ id: 'module', disablePadding: false, label: i18n.t('Module'), noWrap: true },\r\n\t{ id: 'criticality', disablePadding: false, label: i18n.t('Criticality'), noWrap: true },\r\n\t{ id: 'message', disablePadding: false, label: i18n.t('Message') },\r\n\t{ id: 'stack', disablePadding: false, type: 'Object', label: i18n.t('Stack Trace') },\r\n];\r\n\r\nconst rowStyles = { // https://material-ui.com/components/alert/#simple-alerts\r\n\t'criticality': {\r\n\t\t'debug': {\r\n\t\t\tcolor: 'rgba(0, 0, 0, 0.4)',\r\n\t\t\tbackgroundColor: 'rgba(0, 0, 0, 0.1)'\r\n\t\t},\r\n\t\t'info': {\r\n\t\t\tcolor: 'rgb(13, 60, 97)',\r\n\t\t\tbackgroundColor: 'rgb(232, 244, 253)'\r\n\t\t},\r\n\t\t'warn': {\r\n\t\t\tcolor: 'rgb(102, 60, 0)',\r\n\t\t\tbackgroundColor: 'rgb(255, 244, 229)'\r\n\t\t},\r\n\t\t'error': {\r\n\t\t\tcolor: 'rgb(97, 26, 21)',\r\n\t\t\tbackgroundColor: 'rgb(253, 236, 234)'\r\n\t\t},\r\n\t\t'success': {\r\n\t\t\tcolor: 'rgb(30, 70, 32)',\r\n\t\t\tbackgroundColor: 'rgb(237, 247, 237)'\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass LogsPage extends React.Component {\r\n\t\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tconst logs = Log.getLog();\r\n\t\treturn (\r\n\r\n<Dialog\r\n\tclasses={{ CustomDialog: classes.pinToTop }}\r\n\tfullWidth={true}\r\n\tmaxWidth={'xl'}\r\n\t\r\n\topen={(this.props.page === 'logs')}\r\n\tonClose={() => this.props.navigate('home')}\r\n\t\r\n\theader=\"Logs\"\r\n\tactions={\r\n\t\t<Button autoFocus onClick={() => this.props.navigate('home')} color=\"primary\">\r\n\t\t\t{i18n.t('Close')}\r\n\t\t</Button>\r\n\t}\r\n\t>\r\n\t\r\n\t<Paper className={classes.paper}>\r\n\t\t<EnhancedTable\r\n\t\t\theadCells={headCells}\r\n\t\t\trows={logs}\r\n\t\t\trowStyles={rowStyles}\r\n\t\t\t\r\n\t\t\tselectable={false}\r\n\t\t\tsortable={true}\r\n\t\t\ttoolbar={false}\r\n\t\t\tstickyHeader\r\n\t\t\t/>\r\n\t\t\r\n\t</Paper>\r\n\t\r\n</Dialog>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(LogsPage);\r\n","export default {\r\n\t\"iobrokerWebAdapterUrl\": \"https://192.168.178.29:8082\"\r\n}","import EventEmitter from 'events'\r\nimport functions from './functions'\r\n\r\n\r\n/**\r\n * Function\r\n *\r\n * @param\t{String}\t\tfunctionType\r\n * @return\t{Function}\r\n *\r\n */\r\nexport default class Function extends EventEmitter {\r\n\t\r\n\tconstructor(functionType) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.function = functionType;\r\n\t\t\r\n\t\tif (!this.function) {\t\r\n\t\t\tthrow new Error('No function given!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.functionId = this.function.toLowerCase();\r\n\t\t\r\n\t\t// configuration\r\n\t\tthis.defaults = functions['defaults'].configurations;\r\n\t\tthis.configurations = (functions[this.functionId] && functions[this.functionId].configurations) || {};\r\n\t\t\r\n\t\t// components and actions\r\n\t\tthis.components = { ...functions['defaults'].components, ...(functions[this.functionId] && functions[this.functionId].components) || {} };\r\n\t\tthis.actions = { ...functions['defaults'].actions, ...(functions[this.functionId] && functions[this.functionId].actions) || {} };\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Mixed}\r\n\t * @private\r\n\t */\r\n\t_applyFunction(key, val) {\r\n\t\treturn this._isFunction(key) ? key(val) : val;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{String}\r\n\t * @private\r\n\t */\r\n\t_getValueFromSettings(settings, defaults = '') {\r\n\t\t\r\n\t\tfor (let key in settings) {\r\n\t\t\tif (settings[key] !== undefined) {\r\n\t\t\t\treturn settings[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn defaults;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isFunction(key) {\r\n\t\treturn key && typeof key === 'function';\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isValue(val) {\r\n\t\treturn val !== undefined; // || val === null || val === false; // null is considered a value, so it can be used to actually null the output\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_setObjectStructure(obj, defaultValue = undefined) {\r\n\t\t\r\n\t\tif (!obj || typeof obj != 'object') {\r\n\t\t\tobj = { 'default': obj || defaultValue };\r\n\t\t}\r\n\t\telse if (typeof obj == 'object' && !obj.default) {\r\n\t\t\tobj.default = defaultValue;\r\n\t\t}\r\n\t\t\r\n\t\treturn obj;\r\n\t}\r\n}\r\n","export default {\r\n\t\"hm-rpc\": \"HomeMatic\",\r\n\t\"shelly\": \"Shelly\",\r\n\t\"sonoff\": \"Sonoff\"\r\n}","import React from 'react'\r\n\r\nimport Log from './Log'\r\nimport i18n, { locales } from './i18n'\r\nimport Function from './Function'\r\nimport Adapters from './config/adapters'\r\n\r\nimport { formatDistanceToNow } from 'date-fns'\r\n\r\n\r\n/**\r\n * Device\r\n *\r\n * @param\t{Object}\tdeviceProperties\r\n * @param\t{String}\tdeviceProperties.id\r\n * @param\t{String}\tdeviceProperties.name\r\n * @param\t{String}\t[deviceProperties.room=null]\r\n * @param\t{String}\tdeviceProperties.function\r\n * @param\t{Object}\tdeviceProperties.states\r\n * @param\t{Object}\t[deviceProperties.attributes={}]\r\n * @param\t{Object}\tdeviceProperties.options\r\n * @param\t{Object}\tsocket\r\n * @return\t{Device}\r\n * @see https://github.com/Zefau/ioBroker.jarvis/issues/21\r\n *\r\n */\r\nexport default class Device extends Function {\r\n\t\r\n\tconstructor(deviceProperties, socket) {\r\n\t\ttry {\r\n\t\t\tsuper(deviceProperties.function);\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthrow new Error('No function given for device ' + deviceProperties.name + '!');\r\n\t\t}\r\n\t\t\r\n\t\t// initialise class data\r\n\t\tthis.id = deviceProperties.id;\r\n\t\tthis.name = deviceProperties.name;\r\n\t\t\r\n\t\tthis.room = deviceProperties.room || null;\r\n\t\t\r\n\t\tthis.states = deviceProperties.states;\r\n\t\tthis.options = deviceProperties.options;\r\n\t\tthis.attributes = deviceProperties.attributes || {};\r\n\t\t\r\n\t\tthis.socket = socket;\r\n\t\t\r\n\t\t// verify data\r\n\t\tif (!this.options || typeof this.options !== 'object' || Object.keys(this.options).length === 0 || this.options.group === undefined) {\r\n\t\t\tthrow new Error('Device' + (deviceProperties.id || deviceProperties.name ? ' ' + (deviceProperties.name || deviceProperties.id) : '') + ' not defined for jarvis!');\r\n\t\t}\r\n\t\telse if (!this.states || typeof this.states !== 'object' || Object.keys(this.states).length === 0) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no states defined)!');\r\n\t\t}\r\n\t\telse if (!this.id || !this.name || !this.function) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no id, name or function defined)!');\r\n\t\t}\r\n\t\telse if (!this.socket) {\t\r\n\t\t\tthrow new Error('No socket given!');\r\n\t\t}\r\n\t\t\r\n\t\t// hierarchy\r\n\t\tthis.children = deviceProperties.children || [];\r\n\t\tthis.parent = deviceProperties.parent || null;\r\n\t\t\r\n\t\t// do some stuff\r\n\t\tthis._setProperties();\r\n\t\tthis.stateSubscriptions = [];\r\n\t\t\r\n\t\t// listen for errors of the device\r\n\t\tthis.on('error', err => Log._('Device', [ 'Device error occured!', err.message ], 'error', false, err.stack));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object|String}\r\n\t * @private\r\n\t */\r\n\t_getStateFromKey(stateKey = null, stateType = 'state') {\r\n\t\t\r\n\t\t// already a state object\r\n\t\tif (stateKey && typeof stateKey === 'object') {\r\n\t\t\treturn stateKey;\r\n\t\t}\r\n\t\t\r\n\t\t// get state object\r\n\t\tlet s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\t// state does not exist\r\n\t\tif (s === undefined) {\r\n\t\t\treturn i18n.t('State does not exist in device %device%').replace(/%device%/g, this.name) + '!';\r\n\t\t}\r\n\t\t\r\n\t\t// state not an object so far\r\n\t\telse if (typeof s === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey] = { [stateType]: { 'node': s }};\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\telse if (typeof s[stateType] === 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey][stateType] = { 'node': s[stateType] };\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\t\r\n\t\t// state not valid\r\n\t\tif (!s || !s[stateType]) {\r\n\t\t\treturn i18n.t('Incorrect or non-defined state key for device %device%').replace(/%device%/g, this.name).replace(/%stateType%/g, stateType) + '!';\r\n\t\t}\r\n\t\telse if (typeof s[stateType] == 'object' && !s[stateType].node) {\r\n\t\t\treturn i18n.t('No %stateType% specified for device %device%').replace(/%device%/g, this.name).replace(/%stateType%/g, stateType) + '!';\r\n\t\t}\r\n\t\t\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getConfigurationSetting(config, stateKey, attribute, stateVal) {\r\n\t\t//console.log(this.name, config, stateKey, attribute, stateVal, this[config], this[config][stateKey], this[config]['_any']);\r\n\t\t\r\n\t\tif (this[config][stateKey] && this[config][stateKey][attribute]) {\r\n\t\t\t\r\n\t\t\t// 1. if stateKey (e.g. level, power) is available, try to replace an attribute (e.g. icon, unit or for styles state, icon) based on current state (e.g. true, false)\r\n\t\t\tif (typeof this[config][stateKey][attribute] === 'object') {\r\n\t\t\t\t\r\n\t\t\t\tconst stateValKeys = Object.keys(this[config][stateKey][attribute]);\r\n\t\t\t\tif (stateValKeys.toString().indexOf('<') > -1 || stateValKeys.toString().indexOf('>') > -1 || stateValKeys.toString().indexOf('!=') > -1) { // !=, >, >=, <, <=\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet val = this[config][stateKey][attribute]['default'];\r\n\t\t\t\t\tstateValKeys.forEach(stateValKey => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet stateValValue = stateValKey.replace('<=', '').replace('<', '').replace('>=', '').replace('>', '').replace('!=', '');\r\n\t\t\t\t\t\tif (stateValKey.indexOf('<=') > -1 && stateVal <= stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKey.indexOf('<') > -1 && stateVal < stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKey.indexOf('>=') > -1 && stateVal >= stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKey.indexOf('>') > -1 && stateVal > stateValValue) {\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (stateValKeys.toString().indexOf('!=') > -1 && stateVal != stateValValue) {  // eslint-disable-line eqeqeq\r\n\t\t\t\t\t\t\tval = this[config][stateKey][attribute][stateValKey];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn val;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn super._isValue(this[config][stateKey][attribute][stateVal]) ? this[config][stateKey][attribute][stateVal] : this[config][stateKey][attribute]['default'];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 2. if #1 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config][stateKey][attribute])) {\r\n\t\t\t\treturn this[config][stateKey][attribute](stateVal, stateKey, this);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 3. fallback to stateKey with attribute, if defined but neither an object (thus stateless) nor a function\r\n\t\t\telse if (typeof this[config][stateKey][attribute] === 'string') {\r\n\t\t\t\treturn this[config][stateKey][attribute];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (this[config]['_any'] && this[config]['_any'][attribute]) {\r\n\t\t\t\r\n\t\t\t// 4. fallback to _any if no stateKey (e.g. level, power) is given, but consider attribute to be stateful (e.g. true, false)\r\n\t\t\tif (typeof this[config]['_any'][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config]['_any'][attribute][stateVal]) ? this[config]['_any'][attribute][stateVal] : this[config]['_any'][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 5. if #4 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config]['_any'][attribute])) {\r\n\t\t\t\treturn this[config]['_any'][attribute](stateVal, stateKey, this);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// nothing, return undefined (not null, because this would mean take an empty value)\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getUserSetting(stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tlet options = this.states;\r\n\t\tif (options[stateKey] && options[stateKey][attribute]) {\r\n\t\t\tif (typeof options[stateKey][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(options[stateKey][attribute][stateVal]) ? options[stateKey][attribute][stateVal] : options[stateKey][attribute]['default'];\r\n\t\t\t}\r\n\t\t\telse if (super._isFunction(options[stateKey][attribute])) {\r\n\t\t\t\treturn options[stateKey][attribute](stateVal, stateKey, this);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn options[stateKey][attribute];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return void\r\n\t * @private\r\n\t *\r\n\t */\r\n\t_setProperties() {\r\n\t\t\r\n\t\tlet states = Object.keys(this.states);\r\n\t\t\r\n\t\t// delete ignored states\r\n\t\tif (this.options.ignoredStates) {\r\n\t\t\tthis.options.ignoredStates = Array.isArray(this.options.ignoredStates) ? this.options.ignoredStates : [this.options.ignoredStates];\r\n\t\t\t\r\n\t\t\tthis.options.ignoredStates.forEach(ignoredState => {\r\n\t\t\t\tif (this.states[ignoredState]) {\r\n\t\t\t\t\tdelete this.states[ignoredState];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// get hidden states\r\n\t\tthis.options.hiddenStates = this.options.hiddenStates ? (Array.isArray(this.options.hiddenStates) ? this.options.hiddenStates : [this.options.hiddenStates]) : [];\r\n\t\t\r\n\t\t// properties\r\n\t\tthis.primaryStateKey = this.options.primary || states[0];\r\n\t\tthis.secondaryStateKey = this.options.secondary || null;\r\n\t\t\r\n\t\t// manufacturer\r\n\t\tthis.states[this.primaryStateKey] = this._getStateFromKey(this.primaryStateKey);\r\n\t\tthis.options.manufacturer = (this.primaryStateKey && Adapters[this.states[this.primaryStateKey].state.node.substr(0, this.states[this.primaryStateKey].state.node.indexOf('.'))]) || '';\r\n\t\t\r\n\t\t// all options\r\n\t\tthis.options.group = Array.isArray(this.options.group) ? this.options.group : [this.options.group];\r\n\t\tthis.options.sort = this.options.sort || 999;\r\n\t\t\r\n\t\tthis.options.label = (this.options.label && (typeof this.options.label === 'string' && this.options.label.replace(/%name%/g, this.name))) || this.options.label || this.name;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_updateDeviceState(stateKey, state) {\r\n\t\t\r\n\t\t// add time changed\r\n\t\tstate.timeChanged = formatDistanceToNow(new Date(state.lc-5*1000), { locale: locales[i18n.getLanguage()], includeSeconds: true, addSuffix: true })\r\n\t\t\r\n\t\t// add unit\r\n\t\tstate.unit = '';\r\n\t\t\r\n\t\t// change val\r\n\t\tlet val = this._getConfigurationSetting('configurations', stateKey, 'val', state.val);\r\n\t\tstate.val = val !== undefined ? val : state.val;\r\n\t\t\r\n\t\t// assign value\r\n\t\tstate.value = state.val;\r\n\t\t\r\n\t\t// mapping of value to state values\r\n\t\t[{ 'value': 'value' }, { 'display': 'value' }, { 'unit': 'unit' }].forEach(pair => {\r\n\t\t\tlet attribute = Object.keys(pair).toString();\r\n\t\t\tlet option = Object.values(pair).toString();\r\n\t\t\tlet settings = {};\r\n\t\t\t\r\n\t\t\t// get user setting\r\n\t\t\tsettings['options'] = this._getUserSetting(stateKey, attribute, state.val);\r\n\t\t\t\r\n\t\t\t// get function setting or fallback to defaults\r\n\t\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, state.val);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tstate[option] = super._getValueFromSettings(settings, state[option]);\r\n\t\t});\r\n\t\t\r\n\t\tstate.value = i18n.t(state.value);\r\n\t\treturn state;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tget(property) {\r\n\t\treturn this[property] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetAction(stateKey = null, forceDefault = false) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state ? state.val : null;\r\n\t\t\r\n\t\tconst Action = (!forceDefault && this.actions[stateKey]) || this.actions.Action;\r\n\t\treturn <Action key={'action-' + this.id + '-' + stateKey} device={this} state={state} stateKey={stateKey} stateVal={stateVal} styles={this.getStyle('state', stateKey, stateVal)} />\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetComponent(stateKey) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state ? state.val : null;\r\n\t\t\r\n\t\tconst Component = this.components[stateKey];\r\n\t\treturn (Component && <Component title={this.states[stateKey].label || i18n.t(this.function + '#' + stateKey)} device={this} stateKey={stateKey} stateVal={stateVal} />) || this.states[stateKey].label || i18n.t(this.function + '#' + stateKey);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateProperty=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetDeviceState(stateKey = null, stateProperty = null) {\r\n\t\tconst s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tlet deviceState = null;\r\n\t\t\r\n\t\tif (s && s.state && stateProperty !== null && s.state.value !== undefined && s.state.value[stateProperty] !== undefined) {\r\n\t\t\tdeviceState = s.state.value[stateProperty];\r\n\t\t}\r\n\t\telse if (s && s.state && stateProperty === null && s.state.value !== undefined) {\r\n\t\t\tdeviceState = s.state.value;\r\n\t\t}\r\n\t\t\r\n\t\treturn deviceState;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get an icon based on the current device state (or falls back to a default).\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateVal=default]\r\n\t * @param\t{String}\t[defaultIcon=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetIcon(stateKey, stateVal = '', defaultIcon = undefined) {\r\n\t\t\r\n\t\tlet settings = {};\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'icon', stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, 'icon', stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, defaultIcon);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetOption(option, stateVal = 'default') {\r\n\t\treturn (this.options[option] && (this.options[option][stateVal] || this.options[option]['default'])) || this.options[option] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetStyle(attribute, stateKey = null, stateVal = 'default') {\r\n\t\t\r\n\t\tlet settings = {};\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, attribute + 'Style', stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute + 'Style', stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, {});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tlisten(eventName, callback) {\r\n\t\t\r\n\t\tif (typeof eventName === 'function') {\r\n\t\t\tcallback = eventName;\r\n\t\t\teventName = 'stateChange';\r\n\t\t}\r\n\t\t\r\n\t\t// check for duplicates\r\n\t\tlet duplicate = this.listeners(eventName).findIndex(listener => listener.toString() == callback.toString()) > -1; // eslint-disable-line eqeqeq\r\n\t\t\r\n\t\t// attach callback\r\n\t\tif (!duplicate) {\r\n\t\t\tthis.on(eventName, callback);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests all state values from the backend.\r\n\t *\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Array<Promises>}\r\n\t *\r\n\t */\r\n\trequestDeviceStates(subscribe = false) {\r\n\t\t\r\n\t\tlet responses = [];\r\n\t\tfor (let stateKey in this.states) {\r\n\t\t\tresponses.push(this.requestDeviceState(stateKey, subscribe));\r\n\t\t}\r\n\t\t\r\n\t\treturn responses;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceState(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.value !== undefined && this.stateSubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('stateChange', stateKey, s.state.value, this);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getState(s.state.node)\r\n\t\t\t\t\t.then(state => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (state === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value, this);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @return\t{Promise}\r\n\t * @see https://github.com/ioBroker/ioBroker.history#access-values-from-javascript-adapter\r\n\t *\r\n\t */\r\n\trequestDeviceStateHistory(stateKey = null, subscribe = false, options = {}) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\ts.state.historyCache = s.state.historyCache || {};\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (options.start && options.end && options.step && s.state.historyCache[options.start + '#' + options.end + '#' + options.step] !== undefined) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('historyChange', stateKey, s.state.historyCache[options.start + '#' + options.end + '#' + options.step], s.state, this);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getStateHistory(s.state.node, options)\r\n\t\t\t\t\t.then(history => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (history === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// cache result\r\n\t\t\t\t\t\tif (options.start && options.end && options.step) {\r\n\t\t\t\t\t\t\ts.state.historyCache[options.start + '#' + options.end + '#' + options.step] = history;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.history = history;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('historyChange', stateKey, s.state.history, s.state, this);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetAction(action) {\r\n\t\tthis.options.action = action;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetComponent(component) {\r\n\t\tthis.options.label = component;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\tvalue\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsetDeviceState(stateKey = null, value) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey, 'action');\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.socket.setState(s.action.node, value)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\r\n\t\t\t\t\t// get state value if not subscribed\r\n\t\t\t\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\t\t\t\tthis.requestDeviceState(stateKey);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// resolve\r\n\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsubscribeDeviceState(stateKey = null) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\t// add subscription\t\r\n\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\tthis.stateSubscriptions.push(stateKey);\r\n\t\t\r\n\t\t\t// subscribe\r\n\t\t\treturn new Promise(resolve => {\r\n\t\t\t\tthis.socket.subscribeState(s.state.node, (id, state, params) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (state && state.val !== this.getDeviceState(stateKey, 'val')) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// format value\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value, this);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish to children as well\r\n\t\t\t\t\t\tthis.children.forEach(child => child.emit('stateChange', stateKey, s.state.value, this));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': 'State already subscribed!' });\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tunlisten(eventName, callback) {\r\n\t\t\r\n\t\tif (typeof eventName === 'function') {\r\n\t\t\tcallback = eventName;\r\n\t\t\teventName = 'stateChange';\r\n\t\t}\r\n\t\t\r\n\t\tthis.off(eventName, callback);\r\n\t}\r\n}\r\n","\r\nexport default {\r\n\tconfiguration: require('./ConfigurationPage/ConfigurationPage').default,\r\n\tlogs: require('./LogsPage/LogsPage').default,\r\n}","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/tooltip'\r\nimport Badge from '@material-ui/core/Badge'\r\nimport NotificationsIcon from '@material-ui/icons/Notifications'\r\nimport MenuIcon from '@material-ui/icons/Menu'\r\nimport DonateIcon from '@material-ui/icons/Favorite'\r\nimport SettingsIcon from '@material-ui/icons/Settings'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tappBar: {\r\n\t\tflexGrow: 1,\r\n\t\tboxShadow: 'none',\r\n\t\ttransform: 'none',\r\n\t},\r\n\ttoolbar: {\r\n\t\tbackgroundColor: theme.palette.primary.main\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2)\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingRight: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t},\r\n\tnotConnected: {\r\n\t\tcolor: '#f30'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TopBar(props) {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { children, title, connectionStatus, toggleDrawer, navigate, notifications } = props;\r\n\tconst [ icon, label ] = title.indexOf('|') > -1 ? title.split('|') : [ null, title ];\r\n\t\r\n\tconst connectionStatusIcon = connectionStatus === true ? 'lan-connect' : (connectionStatus === 'pending' ? 'lan-pending' : 'lan-disconnect');\r\n\tconst connectionStatusTooltip = connectionStatus === true ? i18n.t('Connected to ioBroker') : (connectionStatus === 'pending' ? i18n.t('Not connected to ioBroker! Reconnecting..') : i18n.t('Not connected to ioBroker! Connection failed!'));\r\n\t\r\n\treturn (\r\n\r\n<AppBar id=\"appBar\" position=\"static\" className={classes.appBar}>\r\n\r\n\t<Toolbar className={classes.toolbar}>\r\n\t\t\r\n\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t{icon && <span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>}\r\n\t\t\t{label !== 'null' && label}\r\n\t\t</Typography>\r\n\t\t\r\n\t\t<Hidden smDown>\r\n\t\t\t{connectionStatus !== true && <IconButton classes={{ root: classes.notConnected }} color=\"inherit\" onClick={() => navigate('logs')}>\r\n\t\t\t\t<Tooltip title={i18n.t(connectionStatusTooltip)}>\r\n\t\t\t\t\t<span className={\"mdi mdi-\" + connectionStatusIcon}></span>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t</IconButton>}\r\n\t\t\t<IconButton color=\"inherit\" onClick={() => navigate('donate')}>\r\n\t\t\t\t<DonateIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton color=\"inherit\" onClick={() => navigate('configuration')}>\r\n\t\t\t\t<SettingsIcon />\r\n\t\t\t</IconButton>\r\n\t\t</Hidden>\r\n\t\t\r\n\t\t{/*\r\n\t\t<IconButton color=\"inherit\" onClick={() => toggleDrawer('notificationDrawer', true)}>\r\n\t\t\t<Badge badgeContent={notifications} color=\"secondary\">\r\n\t\t\t\t<NotificationsIcon />\r\n\t\t\t</Badge>\r\n\t\t</IconButton>\r\n\t\t*/}\r\n\t\t\r\n\t</Toolbar>\r\n\t\r\n\t{children}\r\n</AppBar>\r\n\r\n\t);\r\n}\r\n","/*\r\n * by QoP <https://stackoverflow.com/users/4484822/qop>\r\n * @see https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\r\n */\r\nimport { useState, useEffect } from 'react';\r\n\r\nfunction getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\nexport default function useWindowDimensions() {\r\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      setWindowDimensions(getWindowDimensions());\r\n    }\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return windowDimensions;\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Settings from '../Settings'\r\nimport useWindowDimensions from '../helpers/useWindowDimensions'\r\n\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Box from '@material-ui/core/Box'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingBottom: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t},\r\n\ttabs: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tpaddingLeft: theme.spacing(),\r\n\t\tcolor: '#fff',\r\n\t\twidth: 'calc(100% - ' + theme.spacing() + 'px)',\r\n\t\tzIndex: 101,\r\n\t\tborderBottom: '5px solid #eee'\r\n\t},\r\n\tfixed: {\r\n\t\tposition: 'fixed',\r\n\t\ttop: 0\r\n\t},\r\n\tindicator: {\r\n\t\tbackgroundColor: '#fff',\r\n\t},\r\n\tfullscreen: {\r\n\t\tmarginLeft: -theme.spacing(),\r\n\t\tmarginTop: '-5px',\r\n\t},\r\n\tgrid: {\r\n\t\tpaddingBottom: '30px'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TabBar(props) {\r\n\tlet { tabs, selectedTab, onSelectTab } = props;\r\n\tconst classes = useStyles();\r\n\tlet tabBarProps = useRef({});\r\n\t\r\n\t// tab\r\n\tconst [tab, setTab] = useState(selectedTab);\r\n\tconst handleChange = (event, tab) => {\r\n\t\tonSelectTab(tab);\r\n\t\tsetTab(tab);\r\n\t}\r\n\t\r\n\t// scroll\r\n\tconst [fixed, setFixed] = useState(false);\r\n\tconst handleScroll = useCallback(() => {\r\n\t\tconst threshold = (tabBarProps.current.top + tabBarProps.current.height - 53);\r\n\t\tconst fixed = window.scrollY >= threshold;\r\n\t\t\r\n\t\tsetFixed(prevFixed => {\r\n\t\t\tif (prevFixed !== fixed) {\r\n\t\t\t\tdocument.getElementById('root').style.paddingTop = fixed ? (threshold-5-8) + 'px' : 0;\r\n\t\t\t\treturn fixed;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevFixed;\r\n\t\t});\r\n\t\t\r\n\t}, [tabBarProps]);\r\n\r\n\tuseEffect(() => {\r\n\t\tsetTab(selectedTab);\r\n\t}, [selectedTab]);\r\n\t\r\n\tuseEffect(() => {\r\n\t\ttabBarProps.current = {\r\n\t\t\ttop: document.getElementById('tabBar').offsetTop,\r\n\t\t\theight: document.getElementById('tabBar').offsetHeight\r\n\t\t}\r\n\t\t\r\n\t\twindow.addEventListener('scroll', handleScroll);\r\n\t\treturn () => window.removeEventListener('scroll', handleScroll, 0);\r\n\t\t\r\n\t}, [handleScroll]);\r\n\t\r\n\t// render tabs\r\n\tconst renderedTabs = tabs.map((tab, i) => {\r\n\t\tconst [ icon, label ] = tab.indexOf('|') > -1 ? tab.split('|') : [ null, tab ];\r\n\t\treturn <Tab key={'tab' + i} icon={<span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>} label={!fixed && Settings.getSetting('tabsHideLabels') !== true && label !== 'null' ? label : null} />\r\n\t});\r\n\t\r\n\treturn (\r\n\r\n<Tabs\r\n\tid=\"tabBar\"\r\n\tvalue={tab}\r\n\tonChange={handleChange}\r\n\tvariant=\"scrollable\"\r\n\tclasses={{\r\n\t\troot: clsx(classes.tabs, fixed && classes.fixed),\r\n\t\tindicator: classes.indicator\r\n\t}}>\r\n\t\r\n\t{renderedTabs}\r\n</Tabs>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport function TabPanel(props) {\r\n\tconst { children, selectedTab, renderedTab, fullscreen } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\t// get map height based on viewport\r\n\tconst { height } = useWindowDimensions();\r\n\tconst [mapHeight, setMapHeight] = useState(height);\r\n\tlet topBarHeight = useRef({});\r\n\t\r\n\tuseEffect(() => {\r\n\t\ttopBarHeight.current = document.getElementById('appBar').offsetHeight;\r\n\t\tsetMapHeight(height-topBarHeight.current+5);\r\n\t\t\r\n\t}, [height]);\r\n\t\r\n\t/*\r\n\t * Some components need to be visible upon loading, so proper initialise.\r\n\t * Due to the 'hidden' attribute though, they might be hidden.\r\n\t * This is a workaround to initially show everything for a short period of time and then hide according to tab settings.\r\n\t *\r\n\t */\r\n\tconst [hidden, setHidden] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tsetTimeout(() => setHidden(selectedTab !== renderedTab), 10);\r\n\t\t\r\n\t}, [selectedTab, renderedTab]);\r\n\t\r\n\treturn (\r\n\r\n<Box\r\n\trole=\"tabpanel\"\r\n\thidden={hidden}\r\n\tid={'tabpanel-' + renderedTab}\r\n\tclassName={clsx(fullscreen ? classes.fullscreen : classes.grid)}\r\n\tstyle={{ height: mapHeight + 'px' }}\r\n\t>\r\n\t\r\n\t{children}\r\n</Box>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport i18n from '../i18n'\r\n\r\nimport Drawer from '@material-ui/core/Drawer'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdrawer: {\r\n\t\twidth: 400\r\n\t}\r\n});\r\n\r\n\r\nclass Notifications extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t}\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, notifications } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Drawer\r\n\tanchor=\"right\"\r\n\topen={this.props.open}\r\n\tonClose={() => this.props.toggleDrawer('notificationDrawer', false)}\r\n\tclasses={{\r\n\t\tpaper: classes.drawer\r\n\t}}\r\n\t>\r\n\t\r\n</Drawer>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(Notifications);\r\n","import React from 'react'\r\n\r\nimport Log from '../Log'\r\nimport Grid from '@material-ui/core/Grid'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tgridContainer: {\r\n\t\tpaddingLeft: theme.spacing(1),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(0.4)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function GridContainer(props) {\r\n\tconst { contents = {} } = props;\r\n\t\r\n\tconst classes = useStyles();\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tlet grid = [];\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\t\r\n\t\tif (!contents[column]) {\r\n\t\t\tLog._('GridContainer', 'No content for column #' + column + '!', 'warn');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t\r\n\t\tgrid.push(\r\n\t\t\t<Grid key={column} item\t\t\t\t// @see https://material-ui.com/customization/breakpoints/\r\n\t\t\t\txs={12}\t\t\t\t\t\t\t//    0 -  600px\r\n\t\t\t\tsm={6}\t\t\t\t\t\t\t//  600 -  960px\r\n\t\t\t\tmd={6}\t\t\t\t\t\t\t//  960 - 1280px\r\n\t\t\t\tlg={Math.round(12/columns)}\t\t// 1280 - 1920px\r\n\t\t\t\txl={Math.round(12/columns)}\t\t// \t\t> 1920px\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{contents[column]}\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container spacing={0} className={classes.gridContainer}>\r\n\t{grid}\r\n</Grid>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\n\r\nimport Log from '../Log'\r\nimport Connection from '../Connection'\r\nimport Device from '../Device'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle'\r\nimport MuiDialogContent from '@material-ui/core/DialogContent'\r\nimport MuiDialogActions from '@material-ui/core/DialogActions'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Modules from '../modules'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n});\r\n\r\n\r\nconst DialogTitle = withStyles(styles)(props => {\r\n\tconst { children, classes, onClose, ...other } = props;\r\n\treturn (\r\n\r\n<MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n\t<Typography variant=\"h6\">{children}</Typography>\r\n\t{onClose ? (\r\n\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t<CloseIcon />\r\n\t</IconButton>\r\n\t) : null}\r\n</MuiDialogTitle>\r\n\r\n\t);\r\n});\r\n\r\nconst DialogContent = withStyles(theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(1)\r\n\t\t}\r\n\t},\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles(theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n}))(MuiDialogActions);\r\n\r\n\r\nexport default class Popup extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tchildren: []\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tlet device = this.props.contents && this.props.contents.device;\r\n\t\tif (device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\t\r\n\t\t\t// get from cache\r\n\t\t\tif (device.children.length) {\r\n\t\t\t\tLog._('Popup', [ 'Got ' + Object.keys(device.children).length + ' states for device ' + device.name + ' from cache.', device.children ]);\r\n\t\t\t\tthis.setState({ 'children': device.children }, () => this.forceUpdate());\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// retrieve new\r\n\t\t\telse {\r\n\t\t\t\t// loop through states and request status\r\n\t\t\t\tlet responses = [];\r\n\t\t\t\tlet children = [];\r\n\t\t\t\t\r\n\t\t\t\tfor (let stateKey in device.states) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (device.states[stateKey].state === undefined || device.options.hiddenStates.indexOf(stateKey) > -1) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet child = new Device({\r\n\t\t\t\t\t\t\t'parent': device,\r\n\t\t\t\t\t\t\t'id': device.id + '#' + stateKey,\r\n\t\t\t\t\t\t\t'name': device.name,\r\n\t\t\t\t\t\t\t'function': device.function,\r\n\t\t\t\t\t\t\t//'states': { [stateKey]: device.states[stateKey] },\r\n\t\t\t\t\t\t\t'states': device.states,\r\n\t\t\t\t\t\t\t'options': {\r\n\t\t\t\t\t\t\t\t...device.options,\r\n\t\t\t\t\t\t\t\t'primary': stateKey,\r\n\t\t\t\t\t\t\t\t'secondary': null,\r\n\t\t\t\t\t\t\t\t'divider': children.length !== 0,\r\n\t\t\t\t\t\t\t\t'subgroup': null,\r\n\t\t\t\t\t\t\t\t'subtitle': null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tConnection.getConnection,\r\n\t\t\t\t\t\twindow.language\r\n\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// add child to parent\r\n\t\t\t\t\tdevice.children.push(child);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// retrieve state\r\n\t\t\t\t\tresponses.push(child.requestDeviceState(null, true));\r\n\t\t\t\t\tchildren.push(child);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tPromise.allSettled(responses).then(() => {\r\n\t\t\t\t\tLog._('Popup', [ 'Retrieved ' + Object.keys(children).length + ' states for device ' + device.name + '.', children ]);\r\n\t\t\t\t\tthis.setState({ 'children': children }, () => this.forceUpdate());\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\tthis.setState({ 'children': [] }, () => this.forceUpdate());\r\n\t\t}\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(nextProps, nextState) {\r\n\t\treturn !this.props.contents || this.props.contents.ts !== nextProps.contents.ts;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { open, closeDialog, contents } = this.props;\r\n\t\tconst { device } = contents;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog onClose={closeDialog} open={open || false} maxWidth={'md'} fullWidth={true}>\r\n\t<DialogTitle onClose={closeDialog}>\r\n\t\t{device.name}\r\n\t</DialogTitle>\r\n\t<DialogContent dividers style={{ padding: 0 }}>\r\n\t\t\r\n\t\t<Modules.StateList openDialog={null} devices={this.state.children} component={true} action={true} />\t\r\n\t\t\r\n\t</DialogContent>\r\n\t<DialogActions>\r\n\t\t<Button autoFocus onClick={closeDialog} color=\"primary\">\r\n\t\t\tClose\r\n\t\t</Button>\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t\t);\r\n\t};\r\n}\r\n","import React from 'react'\r\n\r\nimport Settings from '../Settings'\r\n\r\nimport Card from '@material-ui/core/Card'\r\nimport CardHeader from '@material-ui/core/CardHeader'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n\tcard: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t},\r\n\tcardHeaderNoContents: {\r\n\t\tpadding: theme.spacing(),\r\n\t},\r\n\tcardAvatar: props => ({\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff',\r\n\t\tfontSize: '24px',\r\n\t\t...props\r\n\t}),\r\n\tcardContent: {\r\n\t\tpadding: theme.spacing(0, 2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpadding: theme.spacing(0)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Widget(props) {\r\n\tconst { title, icon, iconStyle } = props;\r\n\tconst classes = useStyles(iconStyle);\r\n\t\r\n\treturn (\r\n\r\n<Card className={classes.card}>\r\n\t<CardHeader\r\n\t\tavatar={icon !== null &&\r\n\t\t\t<Avatar variant=\"rounded\" classes={{ root: classes.cardAvatar }}>\r\n\t\t\t\t{React.createElement('span', { 'className': 'mdi mdi-' + (icon || Settings.getSetting('defaultBoxIcon') || 'home') })}\r\n\t\t\t</Avatar>\r\n\t\t}\r\n\t\ttitle={title &&\r\n\t\t\t<Typography variant=\"h5\" component=\"h2\">\r\n\t\t\t\t{title}\r\n\t\t\t</Typography>\r\n\t\t}\r\n\t/>\r\n\t<CardContent className={classes.cardContent}>\r\n\t\t{props.children}\r\n\t</CardContent>\r\n</Card>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\n\r\nimport { DEFAULTS } from './config/config'\r\nimport Log from './Log'\r\nimport Connection from './Connection'\r\nimport Settings from './Settings'\r\nimport Devices from './Devices'\r\n\r\nimport Hidden from '@material-ui/core/Hidden'\r\n//import { SwipeableViews } from '@tarragon/swipeable-tabs'\r\n\r\nimport Pages from './pages'\r\nimport TopBar from './components/TopBar'\r\nimport TabBar, { TabPanel } from './components/TabBar'\r\nimport Notifications from './components/Notifications'\r\nimport GridContainer from './components/GridContainer'\r\nimport Popup from './components/Popup'\r\nimport Widget from './components/Widget'\r\nimport Modules, { ModuleSettings } from './modules'\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst getGroup = (groupId, group, props = {}) => {\r\n\t\r\n\t// group empty\r\n\tif (!group && ModuleSettings[group.settings.component].noDevicesAllowed !== true) {\r\n\t\tLog._('Jarvis', 'Group ' + groupId + ' defined in columns but not assigned to any devices!', 'error');\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t// get module for component\r\n\tconst Tag = Modules[group.settings.component || 'StateList'];\r\n\t\r\n\t// get tag\r\n\tif (Tag === undefined) {\r\n\t\tLog._('Jarvis', 'Undefined component \"' + group.settings.component + '\" used!', 'error');\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\treturn <Tag key={'Tag' + groupId} devices={group.devices || []} openDialog={props.action ? props.action : null} settings={{ ...group.settings, ...props }} />\r\n}\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst getGridContents = (contents, groups, props = {}) => {\r\n\t\r\n\tlet gridContents = {};\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\tlet columnContents = contents[column];\r\n\t\tgridContents[column] = gridContents[column] || [];\r\n\t\t\r\n\t\t// no contents, thus add placeholder\r\n\t\tif (!columnContents || !Object.keys(columnContents).length) {\r\n\t\t\tgridContents[column].push(null);\r\n\t\t}\r\n\t\t\r\n\t\t// add contents\r\n\t\telse {\r\n\t\t\tfor (let groupId in columnContents) {\r\n\t\t\t\t\r\n\t\t\t\tlet group = groups[groupId] || {};\r\n\t\t\t\tgroup.devices = group.devices || [];\r\n\t\t\t\tgroup.settings = columnContents[groupId] || {};\r\n\t\t\t\tlet moduleSettings = ModuleSettings[group.settings.component] || {};\r\n\t\t\t\t\r\n\t\t\t\tlet content = getGroup(groupId, group, props);\r\n\t\t\t\tif ((group.devices.length > 0 || moduleSettings.noDevicesAllowed) && content) {\r\n\t\t\t\t\tgridContents[column].push(\r\n\t\t\t\t\t\t<Widget\r\n\t\t\t\t\t\t\tkey={'Box-' + groupId}\r\n\t\t\t\t\t\t\ttitle={group.settings.title === null ? null : (group.settings.title || group.name || moduleSettings.title)}\r\n\t\t\t\t\t\t\ticon={group.settings.icon === null ? null : (group.settings.icon || moduleSettings.icon)}\r\n\t\t\t\t\t\t\ticonStyle={group.settings.iconStyle}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{content}\r\n\t\t\t\t\t\t</Widget>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn gridContents;\r\n}\r\n\r\n\r\nexport default class Jarvis extends React.Component {\r\n\t\r\n    constructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tselectedTab: 0,\r\n\t\t\ttabTitle: '',\r\n\t\t\t\r\n\t\t\tpage: 'home',\r\n\t\t\t\r\n\t\t\tnotificationDrawer: false,\r\n\t\t\tnotifications: [],\r\n\t\t\tnotificationsUnread: 0,\r\n\t\t\t\r\n\t\t\tdialog: false,\r\n\t\t\tdialogContents: {\r\n\t\t\t\t'ts': 0,\r\n\t\t\t\t'device': {}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// bind methods\r\n\t\tthis.closeDialog = this.closeDialog.bind(this);\r\n\t\tthis.openDialog = this.openDialog.bind(this);\r\n\t\tthis.onSelectTab = this.onSelectTab.bind(this);\r\n\t\tthis.toggleDrawer = this.toggleDrawer.bind(this);\r\n\t\tthis.navigate = this.navigate.bind(this);\r\n\t\t\r\n\t\t// get connection\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\t\r\n\t\t// initialise\r\n\t\tthis.gridContents = {};\r\n\t\tthis.devices = Devices.getDevices();\r\n\t\tthis.layout = Settings.getSetting('layout');\r\n\t\tthis.tabs = Object.keys(this.layout);\r\n\t\tthis.tabsEnabled = Number.isNaN(parseInt(this.tabs[0]));\r\n\t\tthis.state.tabTitle = this.tabs[this.state.selectedTab];\r\n\t\t\r\n\t\t// no tabs defined, so layout wrap into default tab\r\n\t\tif (!this.tabsEnabled) {\r\n\t\t\tthis.layout = { 'Home': this.layout };\r\n\t\t\tthis.tabs.push('1');\r\n\t\t}\r\n\t\t\r\n\t\t// widget props\r\n\t\tthis.widgetProps = {}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// check if devices and settings are defined\r\n\t\tif (Object.keys(this.devices).length === 0 || Settings.getSetting('layout') === '') {\r\n\t\t\tthis.navigate('configuration');\r\n\t\t}\r\n\t\t\r\n\t\t// get notifications\r\n\t\tthis.socket.getState('jarvis.0.notifications').then(notifications => {\r\n\t\t\tnotifications = (notifications && notifications.val && JSON.parse(notifications.val)) || [];\r\n\t\t\t\r\n\t\t\tthis.setState({\r\n\t\t\t\tnotificationsUnread: notifications.filter(notification => !notification.unread || notification.unread !== false).length,\r\n\t\t\t\tnotifications: notifications\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\tthis.socket.subscribeState(DEFAULTS.NODE_NOTIFICATIONS, notifications => Log._('Jarvis', notifications));\r\n\t}\r\n\t\r\n\tgetTabPanels() {\r\n\t\tconst groups = Devices.getGroups();\r\n\t\t\r\n\t\tlet tabIndex = 0;\r\n\t\tlet tabPanels = [];\r\n\t\t\r\n\t\tfor (let tabLabel in this.layout) {\r\n\t\t\tconst contents = this.layout[tabLabel];\r\n\t\t\t\r\n\t\t\t// fullscreen in component\r\n\t\t\tconst groupId = Object.keys(contents)[0];\r\n\t\t\tconst fullscreen = Number.isNaN(parseInt(groupId));\r\n\t\t\t\r\n\t\t\tif (!this.gridContents[tabLabel] && fullscreen) {\r\n\t\t\t\tthis.gridContents[tabLabel] = getGroup(contents, { ...groups[groupId], settings: contents[groupId] || {} }, { action: this.openDialog, ...this.widgetProps });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// grid layout\r\n\t\t\telse if (!this.gridContents[tabLabel]) {\r\n\t\t\t\tthis.gridContents[tabLabel] = <GridContainer contents={getGridContents(contents, groups, { action: this.openDialog, ...this.widgetProps })} />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst tabPanel = (\r\n\t\t\t\t<TabPanel key={'tabPanel-' + tabIndex} renderedTab={tabIndex} selectedTab={this.state.selectedTab} fullscreen={fullscreen}>\r\n\t\t\t\t\t{this.gridContents[tabLabel]}\r\n\t\t\t\t</TabPanel>\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\ttabPanels.push(tabPanel);\r\n\t\t\ttabIndex++;\r\n\t\t}\r\n\t\t\r\n\t\treturn tabPanels;\r\n\t}\r\n\t\r\n\tcloseDialog() {\r\n\t\tthis.setState({ 'dialog': false, 'dialogContents': { 'ts': Date.now(), 'device': {} } });\r\n\t}\r\n\t\r\n\topenDialog(device) {\r\n\t\tthis.setState({ 'dialog': true, 'dialogContents': { 'ts': Date.now(), 'device': device } });\r\n\t}\r\n\t\r\n\tonSelectTab(tab) {\r\n\t\tthis.setState({ selectedTab: tab, tabTitle: this.tabs[tab] });\r\n\t}\r\n\t\r\n\ttoggleDrawer(drawer, open) {\r\n\t\tthis.setState({ [drawer]: open });\r\n\t}\r\n\t\r\n\tnavigate(page) {\r\n\t\tthis.setState({ page });\r\n\t}\r\n\t\r\n    render() {\r\n\t\tlet Page = Pages[this.state.page] || null;\r\n\t\t\r\n\t\tconst tabPanels = this.getTabPanels();\r\n        return (\r\n\r\n<React.Fragment>\r\n\t<TopBar\r\n\t\ttitle={Settings.topBarTitle || (this.tabsEnabled && this.state.tabTitle) || Settings.getSetting('pageTitle') || 'jarvis - Smart Home Overview'}\r\n\t\tconnectionStatus={this.props.connectionStatus}\r\n\t\ttoggleDrawer={this.toggleDrawer}\r\n\t\tnavigate={this.navigate}\r\n\t\tnotifications={this.state.notificationsUnread}\r\n\t\t>\r\n\t\t\r\n\t\t{this.tabsEnabled && <TabBar tabs={this.tabs} selectedTab={this.state.selectedTab} onSelectTab={this.onSelectTab} />}\r\n\t</TopBar>\r\n\t\r\n\t\r\n\t{/* DRAWER: NOTIFICATIONS */}\r\n\t<Notifications\r\n\t\topen={this.state.notificationDrawer}\r\n\t\ttoggleDrawer={this.toggleDrawer}\r\n\t\tnotifications={this.state.notifications}\r\n\t\t/>\r\n\t\r\n\t\r\n\t{/* PAGE */}\r\n\t{Page && <Page\r\n\t\tpage={this.state.page}\r\n\t\tnavigate={this.navigate}\r\n\t\tdevices={this.devices}\r\n\t\t/>}\r\n\t\r\n\t\r\n\t{/* POPUP */}\r\n\t<Popup\r\n\t\topen={this.state.dialog}\r\n\t\tcontents={this.state.dialogContents}\r\n\t\tcloseDialog={this.closeDialog}\r\n\t\t/>\r\n\t\r\n\t\r\n\t{/* TABS */}\r\n{/*\r\n\t<Hidden smUp>\r\n\t<SwipeableViews\r\n\t\tviews={tabPanels}\r\n\t\tselectedView={this.state.selectedTab}\r\n\t\tonSwipe={this.onSelectTab}\r\n\t\t/>\r\n\t</Hidden>\r\n\t<Hidden smDown>\r\n\t\t{tabPanels}\r\n\t</Hidden>\r\n*/}\r\n\t{tabPanels}\r\n\t\t\r\n</React.Fragment>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport WarningIcon from '@material-ui/icons/Warning';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { amber, green } from '@material-ui/core/colors';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tsuccess: {\r\n\t\tbackgroundColor: green[600],\r\n\t},\r\n\terror: {\r\n\t\tbackgroundColor: theme.palette.error.dark,\r\n\t},\r\n\tinfo: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t},\r\n\twarning: {\r\n\t\tbackgroundColor: amber[700],\r\n\t},\r\n\ticon: {\r\n\t\tfontSize: 20,\r\n\t},\r\n\ticonVariant: {\r\n\t\topacity: 0.9,\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tmessage: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t},\r\n}));\r\n\r\n\r\nconst variantIcon = {\r\n\tsuccess: CheckCircleIcon,\r\n\twarning: WarningIcon,\r\n\terror: ErrorIcon,\r\n\tinfo: InfoIcon,\r\n};\r\n\r\n\r\nexport default function StatusSnackbar(props) {\r\n\tconst classes = useStyles();\r\n\tlet { className, open, autoHideDuration, message, closeButton, onClose, variant, ...other } = props;\r\n\tconst Icon = variantIcon[variant];\r\n\t\r\n\topen = open || true;\r\n\tautoHideDuration = autoHideDuration || null;\r\n\treturn (\r\n\r\n<Snackbar\r\n\tanchorOrigin={{\r\n\t\tvertical: 'bottom',\r\n\t\thorizontal: 'center',\r\n\t}}\r\n\topen={open}\r\n\tautoHideDuration={autoHideDuration}\r\n\tonClose={onClose}\r\n\t>\r\n\t<SnackbarContent\r\n\t\tclassName={clsx(classes[variant], className)}\r\n\t\tmessage={\r\n\t\t\t<span id=\"client-snackbar\" className={classes.message}>\r\n\t\t\t\t<Icon className={clsx(classes.icon, classes.iconVariant)} />\r\n\t\t\t\t{message}\r\n\t\t\t</span>\r\n\t\t}\r\n\t\taction={closeButton && [\r\n\t\t\t<IconButton key=\"close\" aria-label=\"close\" color=\"inherit\" onClick={onClose}>\r\n\t\t\t\t<CloseIcon className={classes.icon} />\r\n\t\t\t</IconButton>,\r\n\t\t]}\r\n\t\t{...other}\r\n\t\t/>\r\n\t\t\r\n</Snackbar>\r\n\r\n\t);\r\n}","import React from 'react'\r\nimport { DEFAULTS } from './config/config'\r\nimport config from './config/config.dev.js'\r\nimport Log from './Log'\r\nimport i18n from './i18n'\r\n\r\nimport Connection from './Connection'\r\nimport Settings from './Settings'\r\nimport Devices from './Devices'\r\nimport Device from './Device'\r\nimport Jarvis from './Jarvis'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Skeleton from '@material-ui/lab/Skeleton'\r\n\r\nimport GridContainer from './components/GridContainer'\r\nimport StatusSnackbar from './components/StatusSnackbar'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { ThemeProvider, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tloading: {\r\n\t\tmargin: '10px 0 0 0',\r\n\t\tcolor: '#999'\r\n\t},\r\n\tgridItem: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmarginRight: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n/*\r\n * CONSTANTS\r\n *\r\n */\r\nclass App extends React.Component {\r\n\t\r\n    constructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tloaded: [],\r\n\t\t\tconnected: false,\r\n\t\t\terror: false,\r\n\t\t\terrorMessage: '',\r\n\t\t\t\r\n\t\t\ttheme: null\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\t// connect and get connection\r\n\t\tconst errorHandler = err => {\r\n\t\t\t//Log._('App', i18n.t('Socket disconnected') + '!', 'error') //, true, err.stack);\r\n\t\t\tthis.setState({\r\n\t\t\t\tconnected: false,\r\n\t\t\t\terror: true,\r\n\t\t\t\terrorMessage: i18n.t(typeof err === 'string' ? err : err.message) + '. Reconnecting..'\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t/*\r\n\t\t\tsetTimeout(function reconnect() {\r\n\t\t\t\t\r\n\t\t\t\tLog._('App', i18n.t('Attempting reconnect') + '..');\r\n\t\t\t\tConnection.reconnect();\r\n\t\t\t\tsetTimeout(() => reconnect, 30*1000);\r\n\t\t\t\t\r\n\t\t\t}, 10*1000);\r\n\t\t\t*/\r\n\t\t};\r\n\t\t\r\n\t\tconst url = window.location.port === '3000' ? config.iobrokerWebAdapterUrl :\r\n\t\t\twindow.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\r\n\t\t\r\n\t\tconst listeners = [\r\n\t\t\t{ 'event': 'connect', 'callback': () => this.setState({ connected: true, error: false, errorMessage: '' }) },\r\n\t\t\t{ 'event': 'reconnect', 'callback': () => this.setState({ connected: 'pending', error: false, errorMessage: '' }) },\r\n\t\t\t{ 'event': 'disconnect', 'callback': errorHandler },\r\n\t\t\t{ 'event': 'error', 'callback': errorHandler }\r\n\t\t];\r\n\t\t\r\n\t\tLog._('App', i18n.t('Connect to') + ' ' + url + '...');\r\n\t\tthis.socket = Connection.connect(url, listeners);\r\n\t\t\r\n\t\t// retrieve settings\r\n\t\tthis.settings = {};\r\n\t\tthis.socket.getState(DEFAULTS.NODE_SETTINGS)\r\n\t\t\t.then(state => {\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (state) {\r\n\t\t\t\t\t\tthis.settings = { ...this.settings, ...JSON.parse(state.val || {}) };\r\n\t\t\t\t\t\tSettings.setSettings(this.settings);\r\n\t\t\t\t\t\tSettings.applySettings();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst tab = Object.keys(this.settings.layout)[0];\r\n\t\t\t\t\tif (tab === undefined) {\r\n\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\tloaded: [ ...prevState.loaded, 'settings' ],\r\n\t\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\t\terrorMessage: i18n.t('Please create the configuration. See documentation.')\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.setState(prevState => ({ loaded: [ ...prevState.loaded, 'settings' ] }));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err) {\r\n\t\t\t\t\tLog._('App', 'GET_SETTINGS: ' + err.message, 'error');\r\n\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\tloaded: [ ...prevState.loaded, 'settings' ],\r\n\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\terrorMessage: i18n.t('Error parsing settings') + '!'\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tLog._('App', 'GET_SETTINGS: ' + err.message, 'error');\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tloaded: [ ...prevState.loaded, 'settings' ],\r\n\t\t\t\t\terror: true,\r\n\t\t\t\t\terrorMessage: typeof err === 'string' ? i18n.t(err) : i18n.t(err.message)\r\n\t\t\t\t}));\r\n\t\t\t});\r\n\t\t\r\n\t\t// retrieve ioBroker config\r\n\t\tthis.settings.iobroker = {};\r\n\t\tthis.socket.getObject('system.config', (err, data) => {\r\n\t\t\tif (data && data.common) {\r\n\t\t\t\tthis.settings.iobroker = data.common;\r\n\t\t\t\tSettings.setSettings({ iobroker: this.settings.iobroker });\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t// get theme\r\n\t\timport('./theme').then(theme => this.setState({ theme: theme.default }));\r\n\t\t\r\n\t\t// retrieve devices\r\n\t\tthis.socket.getState(DEFAULTS.NODE_DEVICES)\r\n\t\t\t.then(state => {\r\n\t\t\t\tlet rawDevices = null;\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\trawDevices = JSON.parse(state.val || {});\r\n\t\t\t\t\tthis.processDevices(rawDevices).then(res => {\r\n\t\t\t\t\t\tDevices.set(rawDevices).setDevices(res.devices).setGroups(res.groups);\r\n\t\t\t\t\t\tthis.setState(prevState => ({ loaded: [ ...prevState.loaded, 'groups' ] }));\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err) {\r\n\t\t\t\t\tLog._('App', 'GET_DEVICES: ' + err.message, 'error');\r\n\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\tloaded: [ ...prevState.loaded, 'groups' ],\r\n\t\t\t\t\t\terror: true,\r\n\t\t\t\t\t\terrorMessage: i18n.t('Error parsing devices') + '!'\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tLog._('App', 'GET_DEVICES: ' + err.message, 'error');\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tloaded: [ ...prevState.loaded, 'groups' ],\r\n\t\t\t\t\terror: true,\r\n\t\t\t\t\terrorMessage: i18n.t('Socket failed while getting devices') + '!'\r\n\t\t\t\t}));\r\n\t\t\t});\r\n\t\t\r\n    }\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgroupDevice(groups, device) {\r\n\t\t\r\n\t\t// add device to group(s)\r\n\t\tlet options = device.get('options');\r\n\t\toptions.group.forEach(group => {\r\n\t\t\t\r\n\t\t\tlet groupId = group.toLowerCase().replace(/ /g, '');\r\n\t\t\tif (!groups[groupId]) {\r\n\t\t\t\tgroups[groupId] = { 'id': groupId, 'name': group, 'devices': [device] };\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tgroups[groupId].devices.push(device);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\treturn groups;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tprocessDevice(deviceProperties) {\r\n\t\t\r\n\t\tlet promises = [];\r\n\t\tlet device = null;\r\n\t\ttry {\r\n\t\t\tdevice = new Device(deviceProperties, this.socket);\r\n\t\t\t\r\n\t\t\t// request primary state value\r\n\t\t\tpromises.push(device.requestDeviceState(null, true));\r\n\t\t\t\r\n\t\t\t// request secondary state value\r\n\t\t\tif (device.secondaryStateKey) {\r\n\t\t\t\tpromises.push(device.requestDeviceState(device.secondaryStateKey, true));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tLog._('App', err.message, 'warn');\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tPromise.allSettled(promises).then(results => {\r\n\t\t\t\t\r\n\t\t\t\tresults.forEach(result => {\r\n\t\t\t\t\tif (result.status === 'rejected') {\r\n\t\t\t\t\t\tLog._('App', result, 'error');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tresolve(device);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tprocessDevices(deviceList) {\r\n\t\t\r\n\t\t// loop through all devices of in the device list\r\n\t\tlet promises = [];\r\n\t\tlet devices = {};\r\n\t\tlet groups = {};\r\n\t\t\r\n\t\tlet processedDevices = 0, groupedDevices = 0;\r\n\t\tfor (let deviceId in deviceList) {\r\n\t\t\tprocessedDevices++;\r\n\t\t\t\r\n\t\t\tdeviceList[deviceId].options = { ...deviceList[deviceId].options, ...deviceList[deviceId].jarvis }\r\n\t\t\tdelete deviceList[deviceId].jarvis;\r\n\t\t\t\r\n\t\t\tlet deviceProperties = { ...deviceList[deviceId], 'id': deviceId };\r\n\t\t\tpromises.push(new Promise((resolve, reject) => {\r\n\t\t\t\t\r\n\t\t\t\tthis.processDevice(deviceProperties).then(device => {\r\n\t\t\t\r\n\t\t\t\t\tif (device !== null) {\r\n\t\t\t\t\t\tgroupedDevices++;\r\n\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\r\n\t\t\t\t\t\tdevices[device.id] = device;\r\n\t\t\t\t\t\tresolve(deviceId);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treject(deviceId);\r\n\t\t\t\t});\r\n\t\t\t}));\r\n\t\t\t\r\n\t\t\t// check states for own device settings\r\n\t\t\tfor (let stateKey in deviceProperties.states) {\r\n\t\t\t\t\r\n\t\t\t\tlet state = deviceProperties.states[stateKey];\r\n\t\t\t\tif (state && state.jarvis !== undefined) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tpromises.push(new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthis.processDevice({ ...deviceProperties, 'id': deviceId + '#' + stateKey, 'states': { [stateKey]: state }, 'options': state.jarvis }).then(device => {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (device !== null) {\r\n\t\t\t\t\t\t\t\tgroupedDevices++;\r\n\t\t\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\r\n\t\t\t\t\t\t\t\tdevices[device.id] = device;\r\n\t\t\t\t\t\t\t\tresolve(deviceId);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treject(deviceId);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}));\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise(resolve => Promise.allSettled(promises).then(res => {\r\n\t\t\t\r\n\t\t\t// sort groups\r\n\t\t\tfor (let groupId in groups) {\r\n\t\t\t\tgroups[groupId].devices.sort((item1, item2) => {\r\n\t\t\t\t\tif (item1.options.sort > item2.options.sort) return 1;\r\n\t\t\t\t\telse if (item2.options.sort > item1.options.sort) return -1;\r\n\t\t\t\t\telse return 0;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\r\n\t\t\t// return\r\n\t\t\tLog._('App', [ 'Processed ' + processedDevices + ' devices. Added ' + groupedDevices + ' devices in ' + Object.keys(groups).length + ' groups.', res, groups ]);\r\n\t\t\tresolve({ devices: devices, groups: groups });\r\n\t\t}));\r\n\t}\r\n\t\r\n\trenderError(error) {\r\n\t\terror = error || this.state.errorMessage;\r\n\t\tLog._('App', 'Render Error: ' + error, 'error');\r\n\t\t\r\n\t\treturn (\r\n\r\n<StatusSnackbar\r\n\tkey={'StatusSnackbar'}\r\n\tvariant=\"error\"\r\n\tcloseButton={false}\r\n\tmessage={error.toString()}\r\n\t/>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\trenderLoadingProgress() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\r\n<Grid\r\n\tkey=\"loadingProcess\"\r\n\tcontainer\r\n\tspacing={0}\r\n\tdirection=\"column\"\r\n\tjustify=\"center\"\r\n\talignItems=\"center\"\r\n\tstyle={{ minHeight: \"100vh\" }}\r\n\t>\r\n\r\n\t<CircularProgress />\r\n\t<Typography className={classes.loading}>{i18n.t('Retrieving settings')}...</Typography>\r\n\r\n</Grid>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\trenderLoadingSkeleton(props) {\r\n\t\tconst { classes } = this.props;\r\n\t\tconst { topBar, tabBar, gridColumns } = props;\r\n\t\t\r\n\t\tconst SkeletonLoader = (props) => <Skeleton animation=\"wave\" variant=\"rect\" className={classes.gridItem} height={props.height} />;\r\n\t\t\r\n\t\tlet gridContents = {}\r\n\t\tfor (let column = 1; column <= gridColumns; column++) {\r\n\t\t\tgridContents[column] = gridContents[column] || [];\r\n\t\t\t\r\n\t\t\tlet loaders = Math.random() * (5 - 2) + 2;\r\n\t\t\tfor (let loader = 1; loader <= loaders; loader++) {\r\n\t\t\t\tgridContents[column].push(<SkeletonLoader key={column + '#' + loader} height={(Math.random() * (400 - 100) + 100)} />);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t{topBar && <Skeleton animation=\"wave\" variant=\"rect\" height={64} />}\r\n\t{tabBar && <Skeleton animation=\"wave\" variant=\"rect\" height={48} />}\r\n\t<GridContainer key=\"loadingSkeleton\" contents={gridContents} />\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n    render() {\r\n\t\t\r\n\t\t// error message\r\n\t\tconst error = this.state.error ? this.renderError() : null;\r\n\t\t\r\n\t\t// loading screens\r\n\t\tif (!error && this.state.loaded.indexOf('settings') === -1) {\r\n\t\t\treturn this.renderLoadingProgress();\r\n\t\t}\r\n\t\telse if (!error && this.state.loaded.indexOf('groups') === -1) {\r\n\t\t\tconst tab = Object.keys(this.settings.layout)[0];\r\n\t\t\treturn tab === undefined ? null : this.renderLoadingSkeleton({ topBar: true, tabBar: tab !== 1, gridColumns: (tab !== 1 ? Object.keys(this.settings.layout[tab]).length : tab.length) });\r\n\t\t}\r\n\t\t\r\n\t\t// App\r\n\t\telse {\r\n\t\t\tLog._('App', [ 'Connected:', this.state.connected ]);\r\n\t\t\treturn (\r\n\r\n<ThemeProvider theme={this.state.theme}>\r\n\t{error}\r\n\t{this.state.loaded.length === 2 && <Jarvis key=\"jarvis\" connectionStatus={this.state.connected} />}\r\n</ThemeProvider>\r\n\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(App);\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' }\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport './index.css'\r\nimport App from './App'\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","\r\nexport default {\r\n\tButton: require('./inputs/Button').default,\r\n\tChip: require('./inputs/Chips').default,\r\n\tChips: require('./inputs/Chips').InputChips,\r\n\tChipsField: require('./inputs/Chips').InputChipsField,\r\n\tFieldset: require('./inputs/Fieldset').default,\r\n\tFieldsetItem: require('./inputs/Fieldset').FieldsetItem,\r\n\tForm: require('./inputs/Fieldset').Form,\r\n\tNumber: require('./inputs/Number').default,\r\n\tSelect: require('./inputs/Select').default,\r\n\tSwitch: require('./inputs/Switch').default,\r\n\tSwitchInline: require('./inputs/Switch').InputSwitchInline,\r\n\tText: require('./inputs/Text').default\r\n}","\r\nexport default {\r\n\t'divider': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Fügt einen Trennstrich vor (before) oder nach (after) dem Gerät ein (abhängig des Moduls).'\r\n\t\t},\r\n\t\t'type': 'Select',\r\n\t\t'selection': [\r\n\t\t\t{\r\n\t\t\t\t'': {\r\n\t\t\t\t\t'en': 'no divider',\r\n\t\t\t\t\t'de': 'kein Trennstrich'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'before': {\r\n\t\t\t\t\t'en': 'add Divider before Device',\r\n\t\t\t\t\t'de': 'Trennstrich vor dem Gerät einfügen'\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'after': {\r\n\t\t\t\t\t'en': 'add Divider after Device',\r\n\t\t\t\t\t'de': 'Trennstrich nach dem Gerät einfügen'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t'group': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Mit der Gruppe können mehrere Geräte zusammengefasst / gruppiert angezeigt werden.'\r\n\t\t}\r\n\t},\r\n\t'hiddenStates': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Liste mit States, die von jarvis zwar geladen, aber nicht angezeigt werden.'\r\n\t\t}\r\n\t},\r\n\t'ignoredStates': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Liste mit States, die von jarvis ignoriert (und damit nicht geladen) werden.'\r\n\t\t}\r\n\t},\r\n\t'defaultValue': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Initialer Standard-Wert, der beim Schalten gesetzt wird.'\r\n\t\t}\r\n\t},\r\n\t/*'label': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'alternativer Bezeichner des Geräts als Anzeige-Name'\r\n\t\t}\r\n\t},*/\r\n\t'primaryStateKey': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Dieses Feld dient dem Überschreiben des primären States mit einem anderen State.'\r\n\t\t}\r\n\t},\r\n\t'secondaryStateKey': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Dieses Feld dient dem Überschreiben des sekundären States mit einem anderen State.'\r\n\t\t}\r\n\t},\r\n\t'sort': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Sortierung des Geräts bezogen auf die Position innerhalb der Gruppe (group).'\r\n\t\t},\r\n\t\t'type': 'Number',\r\n\t}\r\n}\r\n\r\nexport const DevicesStates = {\r\n\t'state': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Datenpunkt dessen State als Wert angezeigt wird'\r\n\t\t}\r\n\t},\r\n\t'stateStyle': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Style des angezeigten Wertes (im JSON Format)'\r\n\t\t},\r\n\t\t'json': true\r\n\t},\r\n\t'display': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Texte die den angezeigten Wert ersetzen (im JSON Format)'\r\n\t\t},\r\n\t\t'json': true\r\n\t},\r\n\t'label': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Label'\r\n\t\t}\r\n\t},\r\n\t'type': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': ''\r\n\t\t},\r\n\t\t'type': 'Select',\r\n\t},\r\n\t'action': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Datenpunkt der zum Schalten getriggert wird'\r\n\t\t}\r\n\t},\r\n\t'unit': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Einheit'\r\n\t\t}\r\n\t},\r\n\t'icon': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Material Icon (klick zur Ansicht aller Icons)'\r\n\t\t},\r\n\t\t'link': 'https://materialdesignicons.com/'\r\n\t},\r\n\t'iconStyle': {\r\n\t\t'info': {\r\n\t\t\t'en': '',\r\n\t\t\t'de': 'Style des Icons (im JSON Format)'\r\n\t\t},\r\n\t\t'json': true\r\n\t}\r\n}\r\n","import React from 'react'\r\n//import clsx from 'clsx'\r\n//import { v4 as uuid } from 'uuid'\r\n\r\nimport DevicesConfig, { DevicesStates } from './Devices.config'\r\nimport i18n from '../../../i18n'\r\nimport Devices from '../../../Devices'\r\nimport FUNCTIONS from '../../../functions'\r\nimport ucFirst from '../../../helpers/utils'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport AddIcon from '@material-ui/icons/Add'\r\nimport ArrowUpIcon from '@material-ui/icons/KeyboardArrowUp'\r\nimport ArrowDownIcon from '@material-ui/icons/KeyboardArrowDown'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\nimport InfoIcon from '@material-ui/icons/Info'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\tfullWidth: {\r\n\t\twidth: '100%',\r\n\t},\r\n\ticonContainer: {\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'center'\r\n\t},\r\n\talignRight: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\t\r\n\t\t'& > :not(:first-child)': {\r\n\t\t\tmarginLeft: 8,\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\nclass SettingsPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tdevice: this.props.device,\r\n\t\t\terrors: {}\r\n\t\t}\r\n\t\t\r\n\t\t// required fields\r\n\t\tif (!this.state.device.name) {\r\n\t\t\tthis.state.errors['device-name'] = i18n.t('No input given');\r\n\t\t}\r\n\t\tif (!this.state.device.options || !this.state.device.options.group || (this.state.device.options.group && this.state.device.options.group.length === 0)) {\r\n\t\t\tthis.state.errors['options-group'] = i18n.t('No groups selected');\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t\tthis.onChange = this.props.onChange;\r\n\t\tthis.deviceId = this.props.device.id;\r\n\t\tthis.groupEditor = {};\r\n\t\tthis.newStateKey = '';\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\t_save = () => {\r\n\t\tlet savedDevice = { ...this.state.device }\r\n\t\t\r\n\t\tfor (const key in this.groupEditor) {\r\n\t\t\tconst val = this.groupEditor[key];\r\n\t\t\tconst [ type, base, characteristic ] = key.split('-');\r\n\t\t\t\r\n\t\t\t// states\r\n\t\t\tif (type === 'states') {\r\n\t\t\t\tif (typeof savedDevice[type][base] === 'object') {\r\n\t\t\t\t\tsavedDevice[type][base][characteristic] = val;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tsavedDevice[type][base] = {\r\n\t\t\t\t\t\tstate: savedDevice[type][base],\r\n\t\t\t\t\t\t[characteristic]: val\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// options or attributes\r\n\t\t\telse if (type === 'options' || type === 'attributes') {\r\n\t\t\t\tsavedDevice[type][base] = val;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// device\r\n\t\t\telse {\r\n\t\t\t\tsavedDevice[base] = val;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// add new groups to list\r\n\t\tsavedDevice.options.group.map(group => Devices.addGroupId(group.toLowerCase().replace(/ /, ''), group));\r\n\t\t\r\n\t\t// save\r\n\t\tsavedDevice._created = Date.now();\r\n\t\tthis.props.onSave && this.props.onSave(savedDevice);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\t_deleteDevice = () => this.props.onDelete && this.props.onDelete(this.deviceId);\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\t_onChange = (props, val) => {\r\n\t\t\r\n\t\t// data verification and error handler\r\n\t\tif (props.required && ((Array.isArray(val) && val.length === 0) || (typeof val === 'string' && !val))) {\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\terrors: {\r\n\t\t\t\t\t...prevStates.errors,\r\n\t\t\t\t\t[props.id]: i18n.t('No input given')\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t\t\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// parse JSON\r\n\t\tif (props.attributes && props.attributes.json) {\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tval = val ? JSON.parse(val) : '';\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\t\terrors: {\r\n\t\t\t\t\t\t...prevStates.errors,\r\n\t\t\t\t\t\t[props.id]: i18n.t('Wrong JSON format')\r\n\t\t\t\t\t}\r\n\t\t\t\t}));\r\n\t\t\t\t\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// remove old errors\r\n\t\tif (this.state.errors[props.id]) {\r\n\t\t\tthis.setState(prevStates => {\r\n\t\t\t\tlet nextErrors = { ...prevStates.errors || {} }\r\n\t\t\t\tdelete nextErrors[props.id];\r\n\t\t\t\treturn { errors: nextErrors };\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// set value\r\n\t\tthis.groupEditor[props.id] = val;\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\t_addState = () => {\r\n\t\t\r\n\t\t// empty state key\r\n\t\tif (!this.newStateKey) {\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\terrors: {\r\n\t\t\t\t\t...prevStates.errors,\r\n\t\t\t\t\tnewStateKey: i18n.t('Type in a state key / identifier')\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t\t\r\n\t\t// state key exists already\r\n\t\telse if (Object.keys(this.state.device.states).indexOf(this.newStateKey) > -1) {\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\terrors: {\r\n\t\t\t\t\t...prevStates.errors,\r\n\t\t\t\t\tnewStateKey: i18n.t('State key already used')\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t\t\r\n\t\t// add state key\r\n\t\telse {\r\n\t\t\tlet key = this.newStateKey.replace(/ /g, '');\r\n\t\t\t//this.newStateKey = '';\r\n\t\t\t\r\n\t\t\tthis.setState(prevStates => {\r\n\t\t\t\tlet nextErrors = { ...prevStates.errors }\r\n\t\t\t\tdelete nextErrors['newStateKey'];\r\n\t\t\t\t\r\n\t\t\t\treturn {\r\n\t\t\t\t\terrors: nextErrors,\r\n\t\t\t\t\tdevice: {\r\n\t\t\t\t\t\t...prevStates.device,\r\n\t\t\t\t\t\tstates: {\r\n\t\t\t\t\t\t\t[key]: {},\r\n\t\t\t\t\t\t\t...prevStates.device.states || {}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\t_moveState = (action, key) => {\r\n\t\tlet order = { ...this.state.device.states }\r\n\t\tlet sorted = false;\r\n\t\tlet sortedArray = Object.keys(order).sort((a, b) => {\r\n\t\t\t\r\n\t\t\tif (!sorted && ((action === 'up' && b === key) || (action === 'down' && a === key))) {\r\n\t\t\t\tsorted = true;\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t\t\r\n\t\tlet sortedObject = {}\r\n\t\tsortedArray.map(key => sortedObject[key] = order[key]);\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tdevice: {\r\n\t\t\t\t...prevState.device,\r\n\t\t\t\tstates: sortedObject\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\t_deleteState = key => {\r\n\t\t\r\n\t\tthis.setState(prevStates => {\r\n\t\t\tlet nextDevice = { ...prevStates.device }\r\n\t\t\tdelete nextDevice.states[key];\r\n\t\t\t\r\n\t\t\treturn {\r\n\t\t\t\tdevice: nextDevice\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceState(state) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tconst states = Object.keys(DevicesStates).map(key => {\r\n\t\t\tconst s = DevicesStates[key];\r\n\t\t\treturn (\r\n\t\t\t\t<Inputs.FieldsetItem columns={4} key={'states-' + state.key + '-' + key}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tattributes={s}\r\n\t\t\t\t\t\tid={'states-' + state.key + '-' + key}\r\n\t\t\t\t\t\tshrink={true}\r\n\t\t\t\t\t\tlabel={s.label || ucFirst(key)}\r\n\t\t\t\t\t\tval={!state[key] || typeof state[key] === 'string' ? (state[key] || '') : (state[key].node || JSON.stringify(state[key]))}\r\n\t\t\t\t\t\tonChange={this._onChange}\r\n\t\t\t\t\t\terror={this.state.errors['states-' + state.key + '-' + key] !== undefined}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t);\r\n\t\t});\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<ListItem key={'StatesListItemLabel-' + state.key} dense divider>\r\n\t\t\t\t{state.key &&\r\n\t\t\t\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t\t\t\t<IconButton size=\"small\" onClick={() => this._moveState('up', state.key)}>\r\n\t\t\t\t\t\t<ArrowUpIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t<IconButton size=\"small\" onClick={() => this._moveState('down', state.key)}>\r\n\t\t\t\t\t\t<ArrowDownIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t<IconButton size=\"small\" onClick={() => this._deleteState(state.key)} style={{ marginTop: 40 }}>\r\n\t\t\t\t\t\t<DeleteIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</ListItemIcon>}\r\n\t\t\t\t\r\n\t\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t\t<div style={{ paddingBottom: 8 }}><strong>{state.key}</strong></div>\r\n\t\t\t\t\t<Inputs.Fieldset noPadding>\r\n\t\t\t\t\t\t{states}\r\n\t\t\t\t\t</Inputs.Fieldset>\r\n\t\t\t\t</ListItemText>\r\n\t\t\t</ListItem>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceStates(states) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tconst renderedStates = Object.keys(states || {}).map(stateKey => {\r\n\t\t\tlet state = states[stateKey];\r\n\t\t\tstate = typeof state === 'string' ? { 'state': state } : state;\r\n\t\t\treturn this.renderDeviceState({ ...state, key: stateKey });\r\n\t\t});\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<List classes={{ root: classes.fullWidth }} dense>\r\n\t\t\t\t\t<ListItem key={'StatesListItemLabel-add'} dense divider>\r\n\t\t\t\t\t\t<ListItemIcon>\r\n\t\t\t\t\t\t\t<IconButton size=\"small\" disabled>\r\n\t\t\t\t\t\t\t\t<AddIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</ListItemIcon>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t\t\t\t<Inputs.Text id={'states-add'} onChange={(props, input) => this.newStateKey = input} shrink={true} label=\"new key\" val={this.newStateKey} />\r\n\t\t\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\t\t\tlabel={i18n.t('add new state')}\r\n\t\t\t\t\t\t\t\tonClick={this._addState}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{this.state.errors['newStateKey'] || ''}\r\n\t\t\t\t\t\t</ListItemText>\r\n\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{renderedStates}\r\n\t\t\t\t\t\r\n\t\t\t\t</List>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceOption(config, value) {\r\n\t\t\r\n\t\tif (Array.isArray(value)) {\r\n\t\t\tvalue = value.join(',');\r\n\t\t}\r\n\t\telse if (typeof value === 'object') {\r\n\t\t\tvalue = JSON.stringify(value);\r\n\t\t}\r\n\t\t\r\n\t\tconst Tag = Inputs[config.type || 'Text'];\r\n\t\treturn (\r\n\t\t\t<ListItem key={'StatesListItemLabel-' + config.parameter} divider>\r\n\t\t\t\t<ListItemText\r\n\t\t\t\t\tprimary={config.parameter}\r\n\t\t\t\t\tsecondary={i18n.t(config.label || '')}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t<ListItemSecondaryAction>\r\n\t\t\t\t\t<Tag\r\n\t\t\t\t\t\tkey={'options-' + config.parameter}\r\n\t\t\t\t\t\tid={'options-' + config.parameter}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tval={value}\r\n\t\t\t\t\t\tonChange={this._onChange}\r\n\t\t\t\t\t\t{...config}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t</ListItem>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDeviceOptions(options) {\r\n\t\tconst { classes } = this.props;\r\n\t\tconst renderedOptions = Object.keys(DevicesConfig).sort().map(config => {\r\n\t\t\t\r\n\t\t\tif (config === 'group') {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn this.renderDeviceOption({ ...DevicesConfig[config], parameter: config }, options[config] || '');\r\n\t\t});\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<List classes={{ root: classes.fullWidth }} dense>\r\n\t\t\t\t{renderedOptions}\r\n\t\t\t</List>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tif (this.state.device === null) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t\r\n\t\tconst states = this.renderDeviceStates(this.state.device.states);\r\n\t\tconst options = this.renderDeviceOptions(this.state.device.options);\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<Dialog\r\n\t\t\t\theader={i18n.t('Device Configuration')}\r\n\t\t\t\tactions={[\r\n\t\t\t\t\t<Grid key='actions' container>\r\n\t\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t\t\t<Button key='action-delete' onClick={() => this._deleteDevice()} color=\"secondary\" startIcon={<DeleteIcon />}>\r\n\t\t\t\t\t\t\t\t{i18n.t('Delete Device')}\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t<Grid item xs={6} className={classes.alignRight}>\r\n\t\t\t\t\t\t\t<Button key='action-cancel' onClick={() => this.props.onClose()} color=\"secondary\">\r\n\t\t\t\t\t\t\t\t{i18n.t('Cancel')}\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button key='action-save' onClick={() => this._save()} color=\"primary\" disabled={Object.keys(this.state.errors).length > 0}>\r\n\t\t\t\t\t\t\t\t{i18n.t('Apply')}\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t]}\r\n\t\t\t\t\r\n\t\t\t\tdense\r\n\t\t\t\tmaxWidth='md'\r\n\t\t\t\tfullWidth={true}\r\n\t\t\t\t\r\n\t\t\t\topen={this.state.device !== null}\r\n\t\t\t\tonClose={() => this.props.onClose()}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.Fieldset label={i18n.t('General')}>\r\n\t\t\t\t\t<Inputs.FieldsetItem columns={4}>\r\n\t\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\t\tkey=\"device-name\"\r\n\t\t\t\t\t\t\tid=\"device-name\"\r\n\t\t\t\t\t\t\tautoFocus\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\terror={this.state.errors['device-name'] !== undefined}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlabel={i18n.t('Device')}\r\n\t\t\t\t\t\t\tval={this.state.device.name}\r\n\t\t\t\t\t\t\tonChange={this._onChange}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t\t<Inputs.FieldsetItem columns={4}>\r\n\t\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\t\tkey=\"device-options-label\"\r\n\t\t\t\t\t\t\tid=\"device-options-label\"\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlabel={i18n.t('Displayed Name')}\r\n\t\t\t\t\t\t\tval={(this.state.device.options && this.state.device.options.label) || ''}\r\n\t\t\t\t\t\t\tonChange={this._onChange}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t\t<Inputs.FieldsetItem columns={4}>\r\n\t\t\t\t\t\t<Inputs.Select\r\n\t\t\t\t\t\t\tkey=\"device-function\"\r\n\t\t\t\t\t\t\tid=\"device-function\"\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlabel={i18n.t('Function')}\r\n\t\t\t\t\t\t\tval={this.state.device.function}\r\n\t\t\t\t\t\t\tselection={Object.keys(FUNCTIONS).sort().map(func => func !== 'defaults' ? ({ [func]: i18n.t(func) }) : ({ 'other': i18n.t('other') }))}\r\n\t\t\t\t\t\t\tonChange={this._onChange}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t\t<Inputs.FieldsetItem>\r\n\t\t\t\t\t\t<Inputs.ChipsField\r\n\t\t\t\t\t\t\twidth=\"100%\"\r\n\t\t\t\t\t\t\tid=\"options-group\"\r\n\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\terror={this.state.errors['options-group'] !== undefined}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tplaceholder={i18n.t('Groups')}\r\n\t\t\t\t\t\t\tval={(this.state.device.options && this.state.device.options.group && this.state.device.options.group.map(group => ({ id: group.toLowerCase(), name: group }))) || []}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\toptions={Devices.getGroupList()}\r\n\t\t\t\t\t\t\toptionKey=\"name\"\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tonChange={(props, input) => this._onChange(props, input.map(option => option.name))}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.Fieldset>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.Fieldset label={i18n.t('States')}>\r\n\t\t\t\t\t{states}\r\n\t\t\t\t</Inputs.Fieldset>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.Fieldset label={i18n.t('Options')}>\r\n\t\t\t\t\t{options}\r\n\t\t\t\t</Inputs.Fieldset>\r\n\t\t\t</Dialog>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(SettingsPage);\r\n","export default function ucFirst(str) {\r\n\tif (!str) {\r\n\t\treturn '';\r\n\t}\r\n\t\r\n\treturn str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\n","import React from 'react'\r\n//import clsx from 'clsx'\r\nimport { v4 as uuid } from 'uuid'\r\n\r\nimport Devices from '../../../Devices'\r\nimport i18n from '../../../i18n'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\n\r\nimport TableBody from '@material-ui/core/TableBody'\r\nimport TableRow from '@material-ui/core/TableRow'\r\nimport TableCell from '@material-ui/core/TableCell'\r\n\r\nimport AddIcon from '@material-ui/icons/AddCircle'\r\nimport EditIcon from '@material-ui/icons/Edit'\r\n\r\nimport EnhancedTable from '../../../components/EnhancedTable'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\nimport DevicesPage from './DevicesPage'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\tdeleteButton: {\r\n\t\tmarginTop: '25px'\r\n\t},\r\n\thr: {\r\n\t\tmargin: '10px 2px'\r\n\t},\r\n\tCustomTextInput: {\r\n\t\twidth: 150\r\n\t},\r\n\tCustomDialogTitle: {\r\n\t\tpadding: 0,\r\n\t\tmarginRight: '50px'\r\n\t},\r\n\tTableCell: {\r\n\t\tverticalAlign: 'top',\r\n\t\tpadding: '5px 0'\r\n\t}\r\n});\r\n\r\n\r\nclass SettingsPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tselectedDevice: null,\r\n\t\t\terrors: {}\r\n\t\t}\r\n\t\t\r\n\t\tthis.devices = Devices.getDevices({ raw: true, copy: true });\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\t_saveDevices = devices => {\r\n\t\tthis.devices = devices;\r\n\t\tthis.props.onChange && this.props.onChange(devices);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\t_saveDevice = device => {\r\n\t\tthis._saveDevices({ ...this.devices, [device.id]: device });\r\n\t\t\r\n\t\tthis.setState({ selectedDevice: null, errors: {} }, () => document.getElementById('DialogContent').scrollTop = (document.getElementById('device-' + device.id) && document.getElementById('device-' + device.id).offsetTop) || 0);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\t_deleteDevice = deviceId => {\r\n\t\tlet nextDevices = { ...this.devices }\r\n\t\tdelete nextDevices[deviceId];\r\n\t\tthis._saveDevices(nextDevices);\r\n\t\t\r\n\t\tthis.setState({ selectedDevice: null, errors: {} });\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderDevices(props) {\r\n\t\tconst { sortedRows } = props;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<TableBody>\r\n\t\t\t\r\n\t\t\t{sortedRows.map((device, index) => {\r\n\t\t\t\tlet options = Object.keys(device.options || {}).filter(optionKey => (optionKey === 'group' || device.options[optionKey] === '' || (Array.isArray(device.options[optionKey]) && device.options[optionKey].length === 0) || (typeof device.options[optionKey] === 'object' && Object.keys(device.options[optionKey]).length === 0)) === false).sort().join(', '); \r\n\t\t\t\tlet attributes = Object.keys(device.attributes || {}).sort().join(', ');\r\n\t\t\t\tlet group = (device.options && device.options.group && device.options.group.join(', ')) || '';\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t<TableRow key={'TableRow-' + index} id={'device-' + device.id} hover tabIndex={-1}>\r\n\t\t\t\t\t<TableCell padding=\"checkbox\" scope=\"row\" align=\"center\">\r\n\t\t\t\t\t\t<IconButton onClick={() => this.setState({ selectedDevice: device.id })}>\r\n\t\t\t\t\t\t\t<EditIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t<TableCell>{(device.options && device.options.label) || device.name}</TableCell>\r\n\t\t\t\t\t<TableCell>{device.function}</TableCell>\r\n\t\t\t\t\t<TableCell>{group}</TableCell>\r\n\t\t\t\t\t<TableCell>{Object.keys(device.states || {}).join(', ')}</TableCell>\r\n\t\t\t\t\t<TableCell>{options.length > 30 ? options.substr(0,27) + '...' : options}</TableCell>\r\n\t\t\t\t\t<TableCell>{attributes.length > 15 ? attributes.substr(0,12) + '...' : attributes}</TableCell>\r\n\t\t\t\t</TableRow>\r\n\t\t\t\t\r\n\t\t\t\t);\r\n\t\t\t})}\r\n\t\t\t\r\n\t\t\t</TableBody>\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trender() {\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t<EnhancedTable\r\n\t\ttitle={i18n.t('Devices List')}\r\n\t\theadCells={[\r\n\t\t\t{ id: 'edit', width: '3%', disablePadding: true, label: '' },\r\n\t\t\t{ id: 'name', width: '13%', label: i18n.t('Name') },\r\n\t\t\t{ id: 'function', width: '8%', label: i18n.t('Function') },\r\n\t\t\t{ id: 'group', orderBy: 'options.group', width: '7%', label: i18n.t('Group') },\r\n\t\t\t{ id: 'states', width: '45%', disablePadding: false, label: i18n.t('States') },\r\n\t\t\t{ id: 'options', width: '14%', disablePadding: false, label: i18n.t('Options') },\r\n\t\t\t{ id: 'attributes', width: '10%', disablePadding: false, label: i18n.t('Attributes') }\r\n\t\t]}\r\n\t\trows={Object.values(this.devices)}\r\n\t\t\r\n\t\tdefaultOrderBy=\"name\"\r\n\t\tselectable={false}\r\n\t\tsortable={true}\r\n\t\tstickyHeader\r\n\t\t\r\n\t\tCustomTableBody={props => this.renderDevices(props)}\r\n\t\ttoolbarRightActionButton={\r\n\t\t\t<Inputs.Button\r\n\t\t\t\tonClick={() => this.setState({ selectedDevice: '#new' })}\r\n\t\t\t\tstartIcon={<AddIcon />}\r\n\t\t\t\tdisabled={this.state.selectedDevice !== null}\r\n\t\t\t\tlabel={i18n.t('add new device')}\r\n\t\t\t\t/>\r\n\t\t}\r\n\t\t/>\r\n\t\r\n\t{this.state.selectedDevice && <DevicesPage\r\n\t\t\t\t\t\t\t\t\tdevice={this.state.selectedDevice === '#new' ? { id: uuid(), states: {}, options: {} } : this.devices[this.state.selectedDevice]}\r\n\t\t\t\t\t\t\t\t\tonSave={this._saveDevice}\r\n\t\t\t\t\t\t\t\t\tonDelete={this._deleteDevice}\r\n\t\t\t\t\t\t\t\t\tonClose={() => this.setState({ selectedDevice: null })}\r\n\t\t\t\t\t\t\t\t\t/>}\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(SettingsPage);\r\n","import ModuleList from '../../../modules'\r\n\r\nexport default {\r\n\t'tabsHideLabels': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Tab Labels nicht anzeigen (nur Icons)',\r\n\t\t\t'en': 'Hide tab labels (only show icons)'\r\n\t\t},\r\n\t\tinfo: {\r\n\t\t\t'de': 'Zeigt nur die Icons im Tab und nicht die Labels',\r\n\t\t\t'en': 'Show only icons within a tab, not the label'\r\n\t\t},\r\n\t\ttype: 'Switch',\r\n\t\tval: false\r\n\t},\r\n\t'tabIcon': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Tab Icon',\r\n\t\t\t'en': 'Tab Icon'\r\n\t\t},\r\n\t\ttype: 'Text',\r\n\t},\r\n\t'tabLabel': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Tab Label',\r\n\t\t\t'en': 'Tab Label'\r\n\t\t},\r\n\t\ttype: 'Text',\r\n\t},\r\n\t'tabFullscreen': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Tab als Vollbild',\r\n\t\t\t'en': 'Tab Fullscreen'\r\n\t\t},\r\n\t\tinfo: {\r\n\t\t\t'de': 'Vollbild kann nur bei einem Tab mit nur einer Spalte und nur einer eingestellten Gruppe aktiviert werden.',\r\n\t\t\t'en': 'Fullscreen can only be enabled on a tab setup with only a single column and only a single group'\r\n\t\t},\r\n\t\ttype: 'Switch',\r\n\t\tval: false\r\n\t},\r\n\t'deviceKey': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Identifikation',\r\n\t\t\t'en': 'Identifier of key'\r\n\t\t},\r\n\t\ttype: 'Text',\r\n\t\tval: ''\r\n\t},\r\n\t'groupName': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Gruppe',\r\n\t\t\t'en': 'Group'\r\n\t\t},\r\n\t\ttype: 'Text',\r\n\t\tval: ''\r\n\t},\r\n\t'groupModule': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Modul zur Anzeige der Gruppe',\r\n\t\t\t'en': 'Modul to display group'\r\n\t\t},\r\n\t\ttype: 'Text',\r\n\t\tval: 'StateList',\r\n\t\toptions: Object.keys(ModuleList)\r\n\t},\r\n\t'groupTitle': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Titel der Widget-Box',\r\n\t\t\t'en': 'Title of the widget-box'\r\n\t\t},\r\n\t\ttype: 'Text',\r\n\t\tval: ''\r\n\t},\r\n\t'groupIcon': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Icon der Widget-Box',\r\n\t\t\t'en': 'Icon of the widget-box'\r\n\t\t},\r\n\t\ttype: 'Text',\r\n\t\tval: 'home'\r\n\t},\r\n\t'groupIconStyle': {\r\n\t\tlabel: {\r\n\t\t\t'de': 'Icon style der Widget-Box',\r\n\t\t\t'en': 'Icon style of the widget-box'\r\n\t\t},\r\n\t\ttype: 'Text',\r\n\t\tval: 'backgroundColor: theme.palette.primary.main, color: \"#fff\", fontSize: \"24px\"'\r\n\t}\r\n}\r\n","import React from 'react'\r\n\r\nimport { DEFAULTS } from '../../../config/config'\r\nimport LayoutsConfig from './Layouts.config'\r\n\r\nimport i18n from '../../../i18n'\r\nimport Devices from '../../../Devices'\r\nimport { ModuleConfigurations, ModuleSettings } from '../../../modules/'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport AddIcon from '@material-ui/icons/AddCircle'\r\nimport TabIcon from '@material-ui/icons/Tab'\r\nimport ArrowUpIcon from '@material-ui/icons/KeyboardArrowUp'\r\nimport ArrowDownIcon from '@material-ui/icons/KeyboardArrowDown'\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\tdeleteButton: {\r\n\t\tmarginTop: '20px'\r\n\t},\r\n\ttabs: {\r\n\t\tmarginBottom: '10px'\r\n\t},\r\n\ttab: {\r\n\t\tpadding: theme.spacing(3, 2),\r\n\t},\r\n\ticonContainer: {\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'center'\r\n\t},\r\n\tcolumnContainer: {\r\n\t\tmarginTop: theme.spacing(2),\r\n\t},\r\n\tcolumn: {\r\n\t\twidth: 250,\r\n\t\tmargin: theme.spacing(1, 1),\r\n\t\tborderRight: '1px solid rgba(0, 0, 0, 0.12)',\r\n\t\tborderLeft: '1px solid rgba(0, 0, 0, 0.12)',\r\n\t},\r\n\tDialogActions: {\r\n\t\tjustifyContent: 'initial'\r\n\t},\r\n\talignRight: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\t\r\n\t\t'& > :not(:first-child)': {\r\n\t\t\tmarginLeft: 8,\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\nclass LayoutsPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tpopup: false,\r\n\t\t\t\r\n\t\t\tselectedTab: null,\r\n\t\t\tselectedColumn: null,\r\n\t\t\tselectedGroup: {},\r\n\t\t\t\r\n\t\t\tlayout: this.props.layout,\r\n\t\t\tsettings: this.props.settings,\r\n\t\t\terrors: {}\r\n\t\t}\r\n\t\t\r\n\t\tthis.groupIds = Devices.getGroupList();\r\n\t\tthis.groupEditor = {};\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_onChange = (props, val) => {\r\n\t\t\r\n\t\tif (props.required && !val) {\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\terrors: {\r\n\t\t\t\t\t...prevStates.errors,\r\n\t\t\t\t\t[props.id]: i18n.t('No input given')\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t\t\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tif (this.state.errors[props.id]) {\r\n\t\t\tthis.setState(prevStates => {\r\n\t\t\t\tlet nextErrors = { ...prevStates.errors || {} }\r\n\t\t\t\tdelete nextErrors[props.id];\r\n\t\t\t\treturn { errors: nextErrors };\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tthis.groupEditor[props.id] = val;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_addColumn = (tabKey, newColumn) => {\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t[newColumn]: {}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}), () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_addTab = () => {\r\n\t\tconst newTabIndex = Object.keys(this.state.layout).length+1;\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t['home|' + i18n.t('new tab') + ' ' + newTabIndex]: {\r\n\t\t\t\t\t1: {}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}), () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t\t\r\n\t\tsetTimeout(() => window.location = '#tab-' + newTabIndex, 100);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_changeTab = tabKey => ({ id }, userInput) => {\r\n\t\t\r\n\t\t// edit tab icon / label\r\n\t\tif (id === 'tabIcon' || id === 'tabLabel') {\r\n\t\t\t\r\n\t\t\t// icon or label\r\n\t\t\tlet [ icon, label ] = tabKey.split('|');\r\n\t\t\tif (id === 'tabIcon') {\r\n\t\t\t\ticon = userInput;\r\n\t\t\t}\r\n\t\t\telse if (id === 'tabLabel') {\r\n\t\t\t\tlabel = userInput;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet layout = {}\r\n\t\t\tObject.keys(this.state.layout).forEach(tKey => {\r\n\t\t\t\tlayout[tKey === tabKey ? icon + '|' + label : tKey] = this.state.layout[tKey];\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tthis.setState({ layout: layout }, () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t\t}\r\n\t\t\r\n\t\t// edit tab fullscreen option\r\n\t\telse if (id === 'tabFullscreen') {\r\n\t\t\tlet prevTab = { ...this.state.layout[tabKey] }\r\n\t\t\t\r\n\t\t\tif (userInput === true) {\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t...prevState.layout,\r\n\t\t\t\t\t\t[tabKey]: prevTab[1]\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}), () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t...prevState.layout,\r\n\t\t\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t\t\t1: prevTab\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}), () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_closePopup = action => {\r\n\t\t\r\n\t\tif (action === 'cancel') {\r\n\t\t\tthis.setState({ popup: false });\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\telse if (action === 'save') {\r\n\t\t\t\r\n\t\t\tlet tabKey = this.state.selectedTab;\r\n\t\t\tlet columnKey = this.state.selectedColumn;\r\n\t\t\tlet groupKey = this.state.selectedGroup.key;\r\n\t\t\t\r\n\t\t\t// errors\r\n\t\t\tconst requiredFields = [{ parameter: 'key', required: true }, { parameter: 'component', required: true }];\r\n\t\t\tlet errors = {};\r\n\t\t\t\r\n\t\t\t[ ...requiredFields, ...(ModuleConfigurations[this.state.selectedGroup.key] || []) ].forEach(field => {\r\n\t\t\t\terrors['input-group-' + field.parameter] = field.required === true && !this.groupEditor['input-group-' + field.parameter];\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif (Object.values(errors).indexOf(true) > -1) {\r\n\t\t\t\tthis.setState(prevState => ({ errors: { ...prevState.errors, ...errors }}));\r\n\t\t\t\tconsole.error(errors, this.groupEditor);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet group = {};\r\n\t\t\tObject.keys(this.groupEditor).forEach(key => group[key.replace('input-group-', '')] = this.groupEditor[key]);\r\n\t\t\tgroup.key = group.key.toLowerCase().replace(/ /g, '');\r\n\t\t\t\r\n\t\t\t// edit group\r\n\t\t\tif (groupKey) {\r\n\t\t\t\t\r\n\t\t\t\tlet tabLayout = {}\r\n\t\t\t\tfor (let col = 1; col < Object.keys(this.state.layout[tabKey]).length; col++) {\r\n\t\t\t\t\ttabLayout[col] = this.state.layout[tabKey][col >= columnKey ? col+1 : col];\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet tabColumnGroups = {};\r\n\t\t\t\tObject.keys(this.state.layout[tabKey][columnKey]).forEach(componentKey => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (componentKey === groupKey) {\r\n\t\t\t\t\t\ttabColumnGroups[group.key] = { ...this.state.layout[tabKey][columnKey][componentKey], ...group }\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ttabColumnGroups[componentKey] = this.state.layout[tabKey][columnKey][componentKey];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tdelete tabColumnGroups[group.key].key;\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tpopup: false,\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t...prevState.layout,\r\n\t\t\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t\t\t[columnKey]: tabColumnGroups\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}), () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// new group\r\n\t\t\telse {\r\n\t\t\t\t\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\tpopup: false,\r\n\t\t\t\t\tlayout: {\r\n\t\t\t\t\t\t...prevState.layout,\r\n\t\t\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t\t\t[columnKey]: {\r\n\t\t\t\t\t\t\t\t...prevState.layout[tabKey][columnKey],\r\n\t\t\t\t\t\t\t\t[group.key]: group\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}), () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_deleteColumn = (tabKey, columnKey) => {\r\n\t\t\r\n\t\tlet tabLayout = {}\r\n\t\tfor (let col = 1; col < Object.keys(this.state.layout[tabKey]).length; col++) {\r\n\t\t\ttabLayout[col] = this.state.layout[tabKey][col >= columnKey ? col+1 : col];\r\n\t\t}\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t[tabKey]: tabLayout\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_deleteGroup = (tabKey, columnKey, groupKey) => {\r\n\t\t\r\n\t\tlet layout = { ...this.state.layout[tabKey][columnKey] }\r\n\t\tdelete layout[groupKey];\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tpopup: false,\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t[columnKey]: layout\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}), () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_deleteTab = tabKey => {\r\n\t\t\r\n\t\tlet layout = { ...this.state.layout }\r\n\t\tdelete layout[tabKey];\r\n\t\t\r\n\t\tthis.setState({ layout: layout }, () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_moveGroup = (action, tabKey, columnKey, componentKey) => event => {\r\n\t\tevent.stopPropagation();\r\n\t\t\r\n\t\tlet order = { ...this.state.layout[tabKey][columnKey] }\r\n\t\tlet sorted = false;\r\n\t\tlet sortedArray = Object.keys(order).sort((a, b) => {\r\n\t\t\t\r\n\t\t\tif (!sorted && ((action === 'up' && b === componentKey) || (action === 'down' && a === componentKey))) {\r\n\t\t\t\tsorted = true;\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t\t\r\n\t\tlet sortedObject = {}\r\n\t\tsortedArray.map(key => sortedObject[key] = order[key]);\r\n\t\t\r\n\t\tthis.setState(prevState => ({\r\n\t\t\tlayout: {\r\n\t\t\t\t...prevState.layout,\r\n\t\t\t\t[tabKey]: {\r\n\t\t\t\t\t...prevState.layout[tabKey],\r\n\t\t\t\t\t[columnKey]: sortedObject\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}), () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_moveTab = (action, tabKey) => event => {\r\n\t\tevent.stopPropagation();\r\n\t\t\r\n\t\tlet order = { ...this.state.layout }\r\n\t\tlet sorted = false;\r\n\t\tlet sortedArray = Object.keys(order).sort((a, b) => {\r\n\t\t\t\r\n\t\t\tif (!sorted && ((action === 'up' && b === tabKey) || (action === 'down' && a === tabKey))) {\r\n\t\t\t\tsorted = true;\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t\t\r\n\t\tlet sortedObject = {}\r\n\t\tsortedArray.map(key => sortedObject[key] = order[key]);\r\n\t\tthis.setState(prevState => ({ layout: sortedObject }), () => this.props.onChange(this.state.layout, this.state.settings));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_openPopup = (tabKey, columnKey, group) => {\r\n\t\t\r\n\t\tlet states = {};\r\n\t\tObject.keys(group || {}).map(key => states['input-group-' + key] = group[key] || '');\r\n\t\tthis.groupEditor = states;\r\n\t\t\r\n\t\tthis.setState({\r\n\t\t\t...states,\r\n\t\t\tpopup: true,\r\n\t\t\terrors: {},\r\n\t\t\t\r\n\t\t\tselectedTab: tabKey,\r\n\t\t\tselectedColumn: columnKey,\r\n\t\t\tselectedGroup: group || {}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderTabColumnGroup(tab, column, group) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<ListItem\r\n\tkey={'Tab-' + tab.key + '_Column-' + column.key + '_Component-' + group.key}\r\n\tonClick={() => this._openPopup(tab.key, column.key, group)}\r\n\tbutton\r\n\tdivider\r\n\t>\r\n\t\r\n\t{tab.fullscreen ?\r\n\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t<FullscreenIcon />\r\n\t</ListItemIcon>\r\n\t\t:\r\n\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t<React.Fragment>\r\n\t\t\t<IconButton size=\"small\" onClick={this._moveGroup('up', tab.key, column.key, group.key)}>\r\n\t\t\t\t<ArrowUpIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton size=\"small\" onClick={this._moveGroup('down', tab.key, column.key, group.key)}>\r\n\t\t\t\t<ArrowDownIcon />\r\n\t\t\t</IconButton>\r\n\t\t</React.Fragment>\r\n\t</ListItemIcon>\r\n\t}\r\n\t<ListItemText primary={\r\n\t\t<React.Fragment>\r\n\t\t\t<Typography display=\"block\">{group.key}</Typography>\r\n\t\t\t<Typography variant=\"subtitle2\">({group.name})</Typography>\r\n\t\t</React.Fragment>\r\n\t} />\r\n\t\r\n</ListItem>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderTabColumns(tab, column) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\t// components per tab\r\n\t\tlet tabColumnComponentsNodes = [];\r\n\t\t\r\n\t\tfor (let componentKey in column.entries) {\r\n\t\t\tlet component = { ...column.entries[componentKey], key: componentKey, name: (column.entries[componentKey] && column.entries[componentKey].component) || DEFAULTS.MODULE };\r\n\t\t\ttabColumnComponentsNodes.push(this.renderTabColumnGroup(tab, column, component));\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<Grid className={classes.column} key={'Tab-' + tab.key + '_Column-' + column.key} item>\r\n\t<List>\r\n\t\t<ListItem onClick={() => this._deleteColumn(tab.key, column.key)} button divider dense>\r\n\t\t\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t\t\t<IconButton size=\"small\">\r\n\t\t\t\t\t<DeleteIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</ListItemIcon>\r\n\t\t\t<ListItemText primary={i18n.t('delete column')} />\r\n\t\t</ListItem>\r\n\t\t{(!tab.fullscreen || (tab.fullscreen && column.entries.length < 1))&& <ListItem onClick={() => this._openPopup(tab.key, column.key, null)} button divider dense>\r\n\t\t\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t\t\t<IconButton size=\"small\">\r\n\t\t\t\t\t<AddIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</ListItemIcon>\r\n\t\t\t<ListItemText primary={i18n.t('add new group')} />\r\n\t\t</ListItem>}\r\n\t\t\r\n\t\t{tabColumnComponentsNodes}\r\n\t\t\r\n\t</List>\r\n</Grid>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderTab(tab) {\r\n\t\tconst { classes } = this.props;\r\n\t\tconst [ tabIcon, tabLabel ] = tab.key.split('|');\r\n\t\ttab.fullscreen = Number.isNaN(parseInt(Object.keys(tab.entries)[0]));\r\n\t\t\r\n\t\t// columns per tab\r\n\t\tlet columns = Object.keys(tab.entries).length;\r\n\t\tlet groupsInFirstColumn = (tab.entries && tab.entries[1] && Object.keys(tab.entries[1]).length) || 0;\r\n\t\tlet tabColumnsNodes = [];\r\n\t\t\r\n\t\tfor (let columnKey = 1; columnKey < columns+1; columnKey++) {\r\n\t\t\tlet column = { entries: (tab.entries[columnKey] !== undefined ? tab.entries[columnKey] : tab.entries), key: columnKey }\r\n\t\t\ttabColumnsNodes.push(this.renderTabColumns(tab, column));\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<ListItem\r\n\tid={'tab-' + tab.index}\r\n\tdivider={tab.lastTab !== true} key={'Tab-' + tab.key}\r\n\tclasses={{ root: classes.tab }}\r\n\t>\r\n\t\r\n\t<ListItemIcon key={'Tab-' + tab.key + '-ListItemIcon'} classes={{ root: classes.iconContainer }}>\r\n\t\t<React.Fragment>\r\n\t\t\t<IconButton size=\"small\" onClick={this._moveTab('up', tab.key)}>\r\n\t\t\t\t<ArrowUpIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton size=\"small\" onClick={this._moveTab('down', tab.key)}>\r\n\t\t\t\t<ArrowDownIcon />\r\n\t\t\t</IconButton>\r\n\t\t\t<IconButton size=\"small\" onClick={() => this._deleteTab(tab.key)} classes={{ root: classes.deleteButton }}>\r\n\t\t\t\t<DeleteIcon />\r\n\t\t\t</IconButton>\r\n\t\t</React.Fragment>\r\n\t</ListItemIcon>\r\n\t<ListItemText\r\n\t\tdisableTypography={true}\r\n\t\tprimary={[\r\n\t\t\t<Inputs.Text\r\n\t\t\t\tkey='Input-tabIcon'\r\n\t\t\t\tid='tabIcon'\r\n\t\t\t\t{...LayoutsConfig.tabIcon}\r\n\t\t\t\tonChange={this._changeTab(tab.key)}\r\n\t\t\t\tval={tabIcon || ''}\r\n\t\t\t\ticon={tabIcon || ''}\r\n\t\t\t\t/>,\r\n\t\t\t\r\n\t\t\t<Inputs.Text\r\n\t\t\t\tkey='Input-tabLabel'\r\n\t\t\t\tid='tabLabel'\r\n\t\t\t\t{...LayoutsConfig.tabLabel}\r\n\t\t\t\tonChange={this._changeTab(tab.key)}\r\n\t\t\t\tval={tabLabel || ''}\r\n\t\t\t\t/>,\r\n\t\t\t\r\n\t\t\t<Inputs.Button\r\n\t\t\t\tkey='Input-addColumnToTab'\r\n\t\t\t\tid='Input-addColumnToTab'\r\n\t\t\t\tlabel='add new column'\r\n\t\t\t\tdisabled={tab.fullscreen}\r\n\t\t\t\tonClick={() => this._addColumn(tab.key, columns+1)}\r\n\t\t\t\t/>,\r\n\t\t\t\r\n\t\t\t<Inputs.Switch\r\n\t\t\t\tkey='Input-tabFullscreen'\r\n\t\t\t\tid='tabFullscreen'\r\n\t\t\t\t{...LayoutsConfig.tabFullscreen}\r\n\t\t\t\tdisabled={(columns > 1 || groupsInFirstColumn > 1)}\r\n\t\t\t\tonChange={this._changeTab(tab.key)}\r\n\t\t\t\tval={tab.fullscreen}\r\n\t\t\t\t/>,\r\n\t\t\t\r\n\t\t\t<Grid\r\n\t\t\t\tkey={'Tab-' + tab.key + '-ColumnContainer'}\r\n\t\t\t\tclasses={{ root: classes.columnContainer }}\r\n\t\t\t\tcontainer\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{tabColumnsNodes}\r\n\t\t\t</Grid>\r\n\t\t]}\r\n\t\t/>\r\n\t\r\n</ListItem>\r\n\r\n\t\t);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderTabs(tabs) {\r\n\t\tlet tab = 0;\r\n\t\tlet tabsNodes = [];\r\n\t\t\r\n\t\tconst tabsTotal = Object.keys(tabs).length;\r\n\t\tfor (let tabKey in tabs) {\r\n\t\t\ttab++;\r\n\t\t\ttabsNodes.push(this.renderTab({ entries: tabs[tabKey], key: tabKey, index: tab, lastTab: tab === tabsTotal }));\r\n\t\t}\r\n\t\t\r\n\t\treturn tabsNodes;\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tconst tabs = this.renderTabs(this.state.layout);\r\n\t\tlet config = ModuleConfigurations[this.state.selectedGroup.component || DEFAULTS.MODULE].map(config => {\r\n\t\t\tconst Input = Inputs[config.type || 'Text'];\r\n\t\t\treturn (\r\n\t\t\t\t<Inputs.FieldsetItem columns={4} key={'FieldsetItem-' + config.parameter}>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\tkey={'input-group-' + config.parameter}\r\n\t\t\t\t\t\tid={'input-group-' + config.parameter}\r\n\t\t\t\t\t\tlabel={i18n.t(config.label || config.parameter)}\r\n\t\t\t\t\t\tinfo={config.description}\r\n\t\t\t\t\t\t{...config}\r\n\t\t\t\t\t\tonChange={this._onChange}\r\n\t\t\t\t\t\tval={this.state.selectedGroup[config.parameter] || config.val}\r\n\t\t\t\t\t\t/>\r\n\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t);\r\n\t\t});\r\n\t\t\r\n\t\tconst filtered = this.groupIds.filter(group => group.id === this.state.selectedGroup.key);\r\n\t\tconst groupName = filtered && filtered[0] && filtered[0].name;\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t<Paper>\r\n\t\t<List className={classes.tabs}>\r\n\t\t\t<ListItem divider classes={{ root: classes.tab }}>\r\n\t\t\t\t<ListItemIcon classes={{ root: classes.iconContainer }}>\r\n\t\t\t\t\t<TabIcon />\r\n\t\t\t\t</ListItemIcon>\r\n\t\t\t\t<ListItemText\r\n\t\t\t\t\tdisableTypography={true}\r\n\t\t\t\t\tprimary={[\r\n\t\t\t\t\t\t<Inputs.Button key='Input-addTabs' id='Input-addTabs' label='add new tab' onClick={() => this._addTab()} />,\r\n\t\t\t\t\t\t<Inputs.Switch\r\n\t\t\t\t\t\t\tkey='Input-tabsHideLabels'\r\n\t\t\t\t\t\t\tid='tabsHideLabels'\r\n\t\t\t\t\t\t\t{...LayoutsConfig.tabsHideLabels}\r\n\t\t\t\t\t\t\tonChange={(id, userInput) => this.props.onChange(this.state.layout, { [id]: userInput })}\r\n\t\t\t\t\t\t\tval={this.state.settings['tabsHideLabels']}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t]}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t</ListItem>\r\n\t\t\t\r\n\t\t\t{tabs}\r\n\t\t\t\r\n\t\t</List>\r\n\t</Paper>\r\n\t\r\n\t<Dialog\r\n\t\theader={i18n.t('Group configuration')}\r\n\t\tclasses={{ CustomDialogActions: classes.DialogActions }}\r\n\t\tactions={\r\n\t\t\t<Grid container>\r\n\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t{this.state.selectedGroup.key && \r\n\t\t\t\t\t<Button key='action-delete' onClick={() => this._deleteGroup(this.state.selectedTab, this.state.selectedColumn, this.state.selectedGroup.key)} color=\"secondary\" startIcon={<DeleteIcon />}>\r\n\t\t\t\t\t\t{i18n.t('Delete Group')}\r\n\t\t\t\t\t</Button>}\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item xs={6} className={classes.alignRight}>\r\n\t\t\t\t\t<Button key='action-cancel' onClick={() => this._closePopup('cancel')} color=\"secondary\">\r\n\t\t\t\t\t\t{i18n.t('Cancel')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button key='action-save' onClick={() => this._closePopup('save')} color=\"primary\" variant=\"contained\" disabled={Object.keys(this.state.errors).length > 0}>\r\n\t\t\t\t\t\t{i18n.t('Ok')}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Grid>\r\n\t\t\t</Grid>\r\n\t\t}\r\n\t\t\r\n\t\tdense\r\n\t\tmaxWidth={'md'}\r\n\t\topen={this.state.popup}\r\n\t\tonClose={() => this._closePopup('cancel')}\r\n\t\t>\r\n\t\t\r\n\t\t<Inputs.Fieldset label={i18n.t('Widget-Box')}>\r\n\t\t\t{ModuleSettings[this.state.selectedGroup.component || DEFAULTS.MODULE].noDevicesAllowed !== true && <Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tkey='input-group-key'\r\n\t\t\t\t\tid='input-group-key'\r\n\t\t\t\t\t{...LayoutsConfig.groupName}\r\n\t\t\t\t\t\r\n\t\t\t\t\tautoComplete\r\n\t\t\t\t\tautoHighlight\r\n\t\t\t\t\t\r\n\t\t\t\t\tval={this.state.selectedGroup.key ? ({ id: this.state.selectedGroup.key, name: groupName || this.state.selectedGroup.key }) : null}\r\n\t\t\t\t\tonChange={(props, group) => this._onChange(props, (group && group.id) || '')}\r\n\t\t\t\t\toptions={this.groupIds}\r\n\t\t\t\t\tgetOptionLabel={option => option['name']}\r\n\t\t\t\t\t//getOptionSelected={}\r\n\t\t\t\t\t\r\n\t\t\t\t\trequired\r\n\t\t\t\t\terror={this.state.errors['input-group-key'] !== undefined}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t</Inputs.FieldsetItem>}\r\n\t\t\t<Inputs.FieldsetItem columns={4}>\r\n\t\t\t\t<Inputs.Text key='input-group-title' id='input-group-title' {...LayoutsConfig.groupTitle} onChange={this._onChange} val={this.state.selectedGroup.title || ''} />\r\n\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t<Inputs.FieldsetItem columns={4}>\r\n\t\t\t\t<Inputs.Text key='input-group-icon' id='input-group-icon' {...LayoutsConfig.groupIcon} onChange={this._onChange} val={this.state.selectedGroup.icon || ''} />\r\n\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t<Inputs.FieldsetItem columns={4}>\r\n\t\t\t\t<Inputs.Text key='input-group-iconStyle' id='input-group-iconStyle' {...LayoutsConfig.groupIconStyle} onChange={this._onChange} val={this.state.selectedGroup.iconStyle || ''} />\r\n\t\t\t</Inputs.FieldsetItem>\r\n\t\t</Inputs.Fieldset>\r\n\t\t\r\n\t\t<Inputs.Fieldset label={i18n.t('Module')}>\r\n\t\t\t<Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tkey='input-group-component'\r\n\t\t\t\t\tid='input-group-component'\r\n\t\t\t\t\t{...LayoutsConfig.groupModule}\r\n\t\t\t\t\t\r\n\t\t\t\t\tautoComplete\r\n\t\t\t\t\tautoHighlight\r\n\t\t\t\t\t\r\n\t\t\t\t\tval={this.state.selectedGroup.component || DEFAULTS.MODULE}\r\n\t\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\t\tthis._onChange(props, val);\r\n\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\tselectedGroup: {\r\n\t\t\t\t\t\t\t\t...prevState.selectedGroup,\r\n\t\t\t\t\t\t\t\tcomponent: val\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t\r\n\t\t\t\t\trequired\r\n\t\t\t\t\terror={this.state.errors['input-group-component'] !== undefined}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t{config}\r\n\t\t</Inputs.Fieldset>\r\n\t</Dialog>\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(LayoutsPage);\r\n","\r\nexport default {\r\n\t'pageSettings': {\r\n\t\t'label': 'Page Settings',\r\n\t\t'settings': {\r\n\t\t\t'language': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Spracheinstellung von jarvis',\r\n\t\t\t\t\t'en': 'Language settings for jarvis'\r\n\t\t\t\t},\r\n\t\t\t\t'type': 'Select',\r\n\t\t\t\t'selection': [\r\n\t\t\t\t\t{ 'de': 'Deutsch' },\r\n\t\t\t\t\t{ 'en': 'English' }\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\t'pageFavicon': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Favicon im Browser',\r\n\t\t\t\t\t'en': 'Browser favicon'\r\n\t\t\t\t},\r\n\t\t\t\t'info': {\r\n\t\t\t\t\t'de': 'base64 Wert der Grafik',\r\n\t\t\t\t\t'en': 'base64 value of the image'\r\n\t\t\t\t},\r\n\t\t\t\t'type': 'Text'\r\n\t\t\t},\r\n\t\t\t'pageTitle': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Titel im Browser',\r\n\t\t\t\t\t'en': 'Browser title'\r\n\t\t\t\t},\r\n\t\t\t\t'type': 'Text',\r\n\t\t\t\t'placeholder': 'jarvis - just another remarkable vis'\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t'themeSettings': {\r\n\t\t'label': 'Theme Settings',\r\n\t\t'settings': {\r\n\t\t\t'themeColorPrimary': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Primäre Farbe des Themes',\r\n\t\t\t\t\t'en': 'Primary theme color'\r\n\t\t\t\t},\r\n\t\t\t\t'info': {\r\n\t\t\t\t\t'de': 'Der Farbwert kann ein Wert aus der Farbpalette in der Form `HUE|SHADE` (z. B. `blue|700`) sein. Alternativ kann ein Hex oder RGB angegeben werden.'\r\n\t\t\t\t},\r\n\t\t\t\t'link': 'https://material-ui.com/customization/color/#color-palette',\r\n\t\t\t\t'type': 'Text',\r\n\t\t\t\t'placeholder': 'blue|700'\r\n\t\t\t},\r\n\t\t\t'themeColorSecondary': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Sekundäre Farbe des Themes',\r\n\t\t\t\t\t'en': 'Secondary theme color'\r\n\t\t\t\t},\r\n\t\t\t\t'info': {\r\n\t\t\t\t\t'de': 'Der Farbwert kann ein Wert aus der Farbpalette in der Form `HUE|SHADE` (z. B. `pink`) sein. Alternativ kann ein Hex oder RGB angegeben werden.'\r\n\t\t\t\t},\r\n\t\t\t\t'link': 'https://material-ui.com/customization/color/#color-palette',\r\n\t\t\t\t'type': 'Text',\r\n\t\t\t\t'placeholder': 'pink'\r\n\t\t\t},\r\n\t\t\t'defaultBoxIcon': {\r\n\t\t\t\t'label': {\r\n\t\t\t\t\t'de': 'Standard Widget-Box Icon',\r\n\t\t\t\t\t'en': 'Default widget-box icon'\r\n\t\t\t\t},\r\n\t\t\t\t'type': 'Text',\r\n\t\t\t\t'placeholder': 'home'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import React from 'react'\r\n\r\nimport SettingsConfig from './Settings.config'\r\nimport Settings from '../../../Settings'\r\n\r\nimport Accordion from '@material-ui/core/Accordion'\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails'\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\n\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\theading: {\r\n\t\tfontSize: theme.typography.pxToRem(15),\r\n\t\tflexBasis: '33.33%',\r\n\t\tflexShrink: 0,\r\n\t},\r\n\tsecondaryHeading: {\r\n\t\tfontSize: theme.typography.pxToRem(15),\r\n\t\tcolor: theme.palette.text.secondary,\r\n\t},\r\n});\r\n\r\n\r\nclass SettingsPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tdelete Settings.settings.iobroker;\r\n\t\tthis.state = {\r\n\t\t\tpanel: false\r\n\t\t}\r\n\t\t\r\n\t\tthis.onChange = this.props.onChange;\r\n\t\tthis.settings = Settings.getSettings();\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_handleSettingsChange = (key, val) => {\r\n\t\tSettings.setSetting(key, val);\r\n\t\t\r\n\t\tif (this.onChange) {\r\n\t\t\tthis.onChange(Settings.getSettings());\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_handlePanelChange = panel => (event, isExpanded) => this.setState({ panel: isExpanded ? panel : false });\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trenderPanel(key, panel) {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\tconst settings = Object.keys(panel.settings).map(inputKey => {\r\n\t\t\tconst inputSettings = panel.settings[inputKey];\r\n\t\t\tconst Tag = Inputs[inputSettings.type || 'Text'];\r\n\t\t\t\r\n\t\t\treturn <Tag\r\n\t\t\t\t\t\tkey={'Input-' + key + '-' + inputKey}\r\n\t\t\t\t\t\tid={inputKey}\r\n\t\t\t\t\t\tonChange={this._handleSettingsChange}\r\n\t\t\t\t\t\tval={this.props.settings[inputKey] || this.settings[inputKey]}\r\n\t\t\t\t\t\t{...inputSettings}\r\n\t\t\t\t\t\t/>\r\n\t\t});\r\n\t\t\r\n\t\treturn (\r\n\r\n<Accordion\r\n\tkey={'Accordion-' + key}\r\n\texpanded={this.state.panel === key}\r\n\tonChange={this._handlePanelChange(key)}\r\n\t>\r\n\t\r\n\t<AccordionSummary\r\n\t\texpandIcon={<ExpandMoreIcon />}\r\n\t\tid={'panel-header-' + key}\r\n\t\t>\r\n\t\t\r\n\t\t<Typography className={classes.heading}>{panel.label}</Typography>\r\n\t\t{panel.description && <Typography className={classes.secondaryHeading}>{panel.description}</Typography>}\r\n\t\t\r\n\t</AccordionSummary>\r\n\t<AccordionDetails>\r\n\t\t{settings}\r\n\t</AccordionDetails>\r\n</Accordion>\r\n\r\n\t\t)\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trender() {\r\n\t\treturn Object.keys(SettingsConfig).map(panel => this.renderPanel(panel, SettingsConfig[panel]))\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(SettingsPage);\r\n","import React from 'react'\r\n\r\nimport { DEFAULTS } from '../../config/config'\r\nimport Devices from '../../Devices'\r\nimport Settings from '../../Settings'\r\nimport Connection from '../../Connection'\r\nimport i18n from '../../i18n'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Dialog from '../../components/Dialog'\r\nimport Inputs from '../../components/Inputs'\r\n\r\nimport DevicesListPage from './DevicesPage/DevicesListPage'\r\nimport LayoutsPage from './LayoutsPage/LayoutsPage'\r\nimport SettingsPage from './SettingsPage/SettingsPage'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles'\r\nconst styles = theme => ({\r\n\tpaper: {\r\n\t\tmarginBottom: '10px'\r\n\t},\r\n\tpinToTop: {\r\n\t\tposition: 'absolute',\r\n\t\ttop: 0,\r\n\t\tleft: 0\r\n\t},\r\n\ttitle: {\r\n\t\tpaddingLeft: theme.spacing(2),\r\n\t\tpaddingRight: theme.spacing(1),\r\n\t\tmarginBottom: theme.spacing(1),\r\n\t\tminHeight: '64px',\r\n\t\tdisplay: 'flex',\r\n\t\tposition: 'relative',\r\n\t\talignItems: 'center'\r\n\t},\r\n\trawEditor: {\r\n\t\tfontFamily: 'Roboto Mono,Consolas,Courier New,monospace !important'\r\n\t}\r\n});\r\n\r\n\r\nclass ConfigurationPage extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tlet settings = { ...Settings.getSettings() };\r\n\t\tlet layout = settings.layout;\r\n\t\tdelete settings.layout;\r\n\t\tdelete settings.iobroker;\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\texpertMode: false,\r\n\t\t\ttab: 'devices',\r\n\t\t\terrors: {},\r\n\t\t\t\r\n\t\t\tsettings: settings || {},\r\n\t\t\tlayout: layout || {},\r\n\t\t\tdevices: Devices.getDevices({ raw: true, copy: true })\r\n\t\t}\r\n\t\t\r\n\t\tthis.socket = Connection.getConnection;\r\n\t\t\r\n\t\tthis._onDevicesChange.bind(this);\r\n\t\tthis._onSettingsChange.bind(this);\r\n\t\tthis._onLayoutsChange.bind(this);\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t *\r\n\t */\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tif (this.state.expertMode) {\r\n\t\t\tlet rawEditor = document.getElementById(this.state.tab);\r\n\t\t\t\r\n\t\t\tif (rawEditor.scrollHeight !== prevState.rawEditorHeight) {\r\n\t\t\t\tthis.setState({ rawEditorHeight: rawEditor.scrollHeight });\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/*\r\n\t * \r\n\t */\r\n\t_onDevicesChange = devices => this.setState({ devices: devices });\r\n\t_onSettingsChange = settings => this.setState({ settings: settings });\r\n\t_onLayoutsChange = (layout, settings) => this.setState(prevState => ({ settings: { ...prevState.settings, ...settings || {} }, layout: layout }));\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\tonRawChange = (props, val) => {\r\n\t\t\r\n\t\ttry {\r\n\t\t\tlet res = JSON.parse(val);\r\n\t\t\t\r\n\t\t\tthis.setState(prevStates => {\r\n\t\t\t\tlet nextErrors = { ...prevStates.errors }\r\n\t\t\t\tdelete nextErrors[props.id];\r\n\t\t\t\t\r\n\t\t\t\treturn {\r\n\t\t\t\t\terrors: nextErrors,\r\n\t\t\t\t\t[props.type]: res\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthis.setState(prevStates => ({\r\n\t\t\t\terrors: {\r\n\t\t\t\t\t...prevStates.errors,\r\n\t\t\t\t\t[props.id]: i18n.t('Invalid JSON format')\r\n\t\t\t\t}\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * \r\n\t */\r\n\t_handleTabChange = (event, tab) => this.setState({ tab });\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_cancel = () => this.props.navigate('home');\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\t_save = () => {\r\n\t\tlet result = [\r\n\t\t\tthis.socket.setState(DEFAULTS.NODE_SETTINGS, JSON.stringify({ ...this.state.settings, layout: this.state.layout })),\r\n\t\t\tthis.socket.setState(DEFAULTS.NODE_DEVICES, JSON.stringify(this.state.devices))\r\n\t\t];\r\n\t\t\r\n\t\tPromise.all(result)\r\n\t\t\t.then(() => window.location.reload())\r\n\t\t\t.catch(err => console.error(err));\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog\r\n\tclasses={{ CustomDialog: classes.pinToTop }}\r\n\tfullWidth={true}\r\n\tmaxWidth={false}\r\n\t\r\n\topen={(this.props.page === 'configuration')}\r\n\tonClose={this._cancel}\r\n\t\r\n\theader={[\r\n\t\t<Typography key=\"header\" variant=\"h6\">\r\n\t\t\t{i18n.t('Configuration')}\r\n\t\t\t<Inputs.SwitchInline\r\n\t\t\t\tkey=\"Input-expertMode\"\r\n\t\t\t\tid=\"expertMode\"\r\n\t\t\t\tsize=\"small\"\r\n\t\t\t\tlabel={i18n.t('Expert mode')}\r\n\t\t\t\tonChange={(key, val) => this.setState(prevState => ({ expertMode: val, tab: prevState.expertMode ? prevState.tab.substr(0, prevState.tab.length-3) : prevState.tab + 'Raw' }))}\r\n\t\t\t\tval={this.state.expertMode}\r\n\t\t\t\t/>\r\n\t\t</Typography>,\r\n\t\t\r\n\t\t<Tabs\r\n\t\t\tkey=\"tabs\"\r\n\t\t\tvalue={this.state.tab}\r\n\t\t\tindicatorColor=\"primary\"\r\n\t\t\ttextColor=\"primary\"\r\n\t\t\tonChange={this._handleTabChange}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{this.state.expertMode === true && <Tab value=\"devicesRaw\" label={i18n.t('Devices')} />}\r\n\t\t\t{this.state.expertMode === true && <Tab value=\"layoutRaw\" label={i18n.t('Layout')} />}\r\n\t\t\t{this.state.expertMode === true && <Tab value=\"settingsRaw\" label={i18n.t('Settings')} />}\r\n\t\t\t{this.state.expertMode !== true && <Tab value=\"devices\" label={i18n.t('Devices')} />}\r\n\t\t\t{this.state.expertMode !== true && <Tab value=\"layout\" label={i18n.t('Layout')} />}\r\n\t\t\t{this.state.expertMode !== true && <Tab value=\"settings\" label={i18n.t('Settings')} />}\r\n\t\t</Tabs>\r\n\t]}\r\n\tactions={[\r\n\t\t<Button key='action-cancel' autoFocus onClick={this._cancel} color=\"secondary\">\r\n\t\t\t{i18n.t('Cancel')}\r\n\t\t</Button>,\r\n\t\t<Button key='action-save' onClick={this._save} color=\"primary\" variant=\"contained\" disabled={Object.keys(this.state.errors).length > 0}>\r\n\t\t\t{i18n.t('Save')}\r\n\t\t</Button>\r\n\t]}\r\n\t>\r\n\t\r\n\t<div hidden={this.state.tab !== 'devices'}>\r\n\t\t<Paper className={classes.paper}>\r\n\t\t\t{this.state.tab === 'devices' && <DevicesListPage onChange={this._onDevicesChange} />}\r\n\t\t</Paper>\r\n\t</div>\r\n\t{this.state.expertMode === true && \r\n\t<div hidden={this.state.tab !== 'devicesRaw'}>\r\n\t\t<Paper className={classes.paper}>\r\n\t\t\t<Typography className={classes.title} variant=\"h6\">\r\n\t\t\t\t{i18n.t('Raw Editor') + ' ' + i18n.t('Devices')}\r\n\t\t\t</Typography>\r\n\t\t\t<Inputs.Text\r\n\t\t\t\tid=\"devicesRaw\"\r\n\t\t\t\tlabel={['JSON Editor', (this.state.errors['devicesRaw'] !== undefined ? ' (' + this.state.errors['devicesRaw'] + ')' : '')]}\r\n\t\t\t\tInputProps={{ disableUnderline: true, className: classes.rawEditor }}\r\n\t\t\t\tinputProps={{ style: { height: this.state.rawEditorHeight } }}\r\n\t\t\t\tmultiline\r\n\t\t\t\twidth=\"99%\"\r\n\t\t\t\terror={this.state.errors['devicesRaw'] !== undefined}\r\n\t\t\t\tonChange={(props, val) => this.onRawChange({ ...props, type: 'devices' }, val)}\r\n\t\t\t\tval={JSON.stringify(this.state.devices, null, 3)}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</Paper>\r\n\t</div>}\r\n\t<div hidden={this.state.tab !== 'settings'} style={{ width: '100%' }}>\r\n\t\t<Paper className={classes.title}>\r\n\t\t\t<Typography variant=\"h6\">\r\n\t\t\t\t{i18n.t('Settings')}\r\n\t\t\t</Typography>\r\n\t\t</Paper>\r\n\t\t{this.state.tab === 'settings' && <SettingsPage settings={this.state.settings} onChange={this._onSettingsChange} />}\r\n\t\t\r\n\t</div>\r\n\t{this.state.expertMode === true && \r\n\t<div hidden={this.state.tab !== 'settingsRaw'} style={{ width: '100%' }}>\r\n\t\t<Paper className={classes.paper}>\r\n\t\t\t<Typography className={classes.title} variant=\"h6\">\r\n\t\t\t\t{i18n.t('Raw Editor') + ' ' + i18n.t('Settings')}\r\n\t\t\t</Typography>\r\n\t\t\t<Inputs.Text\r\n\t\t\t\tid=\"settingsRaw\"\r\n\t\t\t\tlabel={['JSON Editor', (this.state.errors['settingsRaw'] !== undefined ? ' (' + this.state.errors['settingsRaw'] + ')' : '')]}\r\n\t\t\t\tInputProps={{ disableUnderline: true, className: classes.rawEditor }}\r\n\t\t\t\tinputProps={{ style: { height: this.state.rawEditorHeight } }}\r\n\t\t\t\tmultiline\r\n\t\t\t\twidth=\"99%\"\r\n\t\t\t\terror={this.state.errors['settingsRaw'] !== undefined}\r\n\t\t\t\tonChange={(props, val) => this.onRawChange({ ...props, type: 'settings' }, val)}\r\n\t\t\t\tval={JSON.stringify(this.state.settings, null, 3)}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</Paper>\r\n\t</div>}\r\n\t<div hidden={this.state.tab !== 'layout'}>\r\n\t\t<Paper>\r\n\t\t\t<Typography className={classes.title} variant=\"h6\">\r\n\t\t\t\t{i18n.t('Layout')}\r\n\t\t\t</Typography>\r\n\t\t</Paper>\r\n\t\t{this.state.tab === 'layout' && <LayoutsPage settings={this.state.settings} layout={this.state.layout} onChange={this._onLayoutsChange} />}\r\n\t\t\r\n\t</div>\r\n\t{this.state.expertMode === true && \r\n\t<div hidden={this.state.tab !== 'layoutRaw'} style={{ width: '100%' }}>\r\n\t\t<Paper className={classes.paper}>\r\n\t\t\t<Typography className={classes.title} variant=\"h6\">\r\n\t\t\t\t{i18n.t('Raw Editor') + ' ' + i18n.t('Layout')}\r\n\t\t\t</Typography>\r\n\t\t\t<Inputs.Text\r\n\t\t\t\tid=\"layoutRaw\"\r\n\t\t\t\tlabel={['JSON Editor', (this.state.errors['layoutRaw'] !== undefined ? ' (' + this.state.errors['layoutRaw'] + ')' : '')]}\r\n\t\t\t\tInputProps={{ disableUnderline: true, className: classes.rawEditor }}\r\n\t\t\t\tinputProps={{ style: { height: this.state.rawEditorHeight } }}\r\n\t\t\t\tmultiline\r\n\t\t\t\twidth=\"99%\"\r\n\t\t\t\terror={this.state.errors['layoutRaw'] !== undefined}\r\n\t\t\t\tonChange={(props, val) => this.onRawChange({ ...props, type: 'layout' }, val)}\r\n\t\t\t\tval={JSON.stringify(this.state.layout || {}, null, 3)}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t</Paper>\r\n\t</div>}\r\n\t\r\n</Dialog>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(ConfigurationPage);\r\n","import EventEmitter from 'events'\r\nimport io from 'socket.io-client'\r\n\r\n\r\n/**\r\n * Class for Socket.io conncetion handling.\r\n *\r\n * @description This is based on an implementation @GermanBluefox (https://github.com/GermanBluefox), see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\t\t\t\tOnly required functions are taken from source class. Major change is that all events are emitted, so proper error handling is possible in the App.\r\n *\r\n *\r\n * @param\t{String}\t\turl\r\n * @param\t{Object}\t\toptions\r\n * @return\t{Socket}\r\n * @see https://github.com/ioBroker/ioBroker.socketio/blob/master/lib/socket.js https://github.com/ioBroker/ioBroker.js-controller/blob/master/lib/adapter.js#L635\r\n *\r\n */\r\nexport default class Socket extends EventEmitter {\r\n\t\r\n\tconstructor(url = null, options = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\t// socket connection\r\n\t\tthis.socket = io(url, { timeout: 10000, ...options, query: 'ws=true' });\r\n\t\tthis.statesSubscribes = {}; // subscribed states\r\n\t\t\r\n\t\t/*\r\n\t\t * API events\r\n\t\t * @see https://github.com/socketio/socket.io-client/blob/HEAD/docs/API.md#socket\r\n\t\t *\r\n\t\t */\r\n\t\t// connect\r\n\t\tthis.socket.on('connect', () => this.emit('connect'));\r\n\t\t\r\n\t\t// reconnect: Fired upon a successful reconnection.\r\n\t\tthis.socket.on('reconnect', attempts => this.emit('reconnect', attempts));\r\n\t\t\r\n\t\t// reconnect_error: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_error', error => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_error', 'message': (error && error.message) || 'Reconnection error' }));\r\n\t\t\r\n\t\t// reconnect_failed: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_failed', () => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_failed', 'message': 'Reconnection failed' }));\r\n\t\t\r\n\t\t// discconect\r\n\t\tthis.socket.on('disconnect', reason => this.emit('disconnect', reason));\r\n\t\t\r\n\t\t// error\r\n\t\tthis.socket.on('error', error => this.emit('error', { 'type': 'error', 'event': 'error', 'message': (error && error.message) || 'Unknown error' }));\r\n\t\t\r\n\t\t// connect_failed\r\n\t\tthis.socket.on('connect_failed', error => this.emit('error', { 'type': 'connect', 'event': 'connect_error', 'message': (error && error.message) || 'Connection error' }));\r\n\t\t\r\n\t\t// connect_error\r\n\t\tthis.socket.on('connect_error', error => this.emit('error', { 'type': 'connect', 'event': 'connect_error', 'message': (error && error.message) || 'Connection error' }));\r\n\t\t\r\n\t\t// connect_timeout\r\n\t\tthis.socket.on('connect_timeout', () => this.emit('error', { 'type': 'connect', 'event': 'connect_timeout', 'message': 'Connect ran into timeout' }));\r\n\t\t\r\n\t\t/*\r\n\t\t * ioBroker events\r\n\t\t *\r\n\t\t */\r\n\t\tthis.socket.on('stateChange', (id, state) => setTimeout(() => this.stateChange(id, state), 0));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to multiple states by setting a callback.\r\n\t *\r\n\t */\r\n\t_getPatternFromId(id) {\r\n\t\tlet pattern = id\r\n\t\t\t.replace(/\\./g, '\\\\.')\r\n\t\t\t.replace(/\\*/g, '.*')\r\n\t\t\t.replace(/\\(/g, '\\\\(')\r\n\t\t\t.replace(/\\)/g, '\\\\)')\r\n\t\t\t.replace(/\\+/g, '\\\\+')\r\n\t\t\t.replace(/\\[/g, '\\\\[');\r\n\r\n\t\tif (pattern.indexOf('*') === -1) {\r\n\t\t\tpattern += '$';\r\n\t\t}\r\n\t\t\r\n\t\treturn pattern;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to multiple states by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeStates(ids, cb) {\r\n\t\tids = Array.isArray(ids) ? ids : [ids];\r\n\t\tids.forEach(id => this.subscribeState(id, cb));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to a state by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeState(id, cb) {\r\n\t\t\r\n\t\tif (!this.statesSubscribes[id]) {\r\n\t\t\tlet reg = this._getPatternFromId(id);\r\n\t\t\tthis.statesSubscribes[id] = { reg: new RegExp(reg), cbs: [cb] };\r\n\t\t\t\r\n\t\t\tif (this.socket.connected) {\r\n\t\t\t\tthis.socket.emit('subscribe', id);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.statesSubscribes[id].cbs.indexOf(cb) === -1 && this.statesSubscribes[id].cbs.push(cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Fires pre-registered callbacks (via subscribeState) upon state change.\r\n\t *\r\n\t */\r\n\tstateChange(id, state) {\r\n\t\t\r\n\t\tid = id ? id.replace(/[\\s'\"]/g, '_') : '';\r\n\t\tfor (const task in this.statesSubscribes) {\r\n\t\t\tif (this.statesSubscribes.hasOwnProperty(task) && this.statesSubscribes[task].reg.test(id)) {\r\n\t\t\t\tthis.statesSubscribes[task].cbs.forEach(cb => cb(id, state));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetAdapterInstances(adapter, cb) {\r\n\t\t\r\n\t\tif (typeof adapter === 'function') {\r\n\t\t\tcb = adapter;\r\n\t\t\tadapter = null;\r\n\t\t}\r\n\t\t\r\n\t\treturn this.getObjectView('system', 'instance', { 'startkey': 'system.adapter.' + (adapter ? adapter + '.' : ''), 'endkey': 'system.adapter.' + (adapter ? adapter + '.999' : 'zzz') }, cb);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object.\r\n\t *\r\n\t */\r\n\tgetObject(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getObject(id, (err, obj) => err ? reject(err) : resolve(obj)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getObject', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets an object view.\r\n\t *\r\n\t */\r\n\tgetObjectView(design, search, params, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getObjectView(design, search, params, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getObjectView', design, search, params, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a remote ressource.\r\n\t *\r\n\t */\r\n\tgetRemoteResource(url, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getRemoteResource(url, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('httpGet', url, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a state.\r\n\t *\r\n\t */\r\n\tgetState(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getState(id, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getState', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets multiple states at once.\r\n\t *\r\n\t */\r\n\tgetStates(pattern, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStates(pattern, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getStates', pattern, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the state history.\r\n\t *\r\n\t */\r\n\tgetStateHistory(id, options, cb) {\r\n\t\t\r\n\t\tif (typeof options === 'function') {\r\n\t\t\tcb = options;\r\n\t\t\toptions = {};\r\n\t\t}\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStateHistory(id, options, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getHistory', id, options, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a state.\r\n\t *\r\n\t */\r\n\tsetState(id, val, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.setState(id, val, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('setState', id, val, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Unsubscribe from multiple states.\r\n\t *\r\n\t */\r\n\tunsubscribeStates(ids) {\r\n\t\tids = Array.isArray(ids) ? ids : [ids];\r\n\t\tids.forEach(id => this.unsubscribeState(id));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Unsubscribe a state.\r\n\t *\r\n\t */\r\n\tunsubscribeState(id) {\r\n\t\t\r\n\t\tif (this.statesSubscribes[id] && this.socket.connected) {\r\n\t\t\tthis.socket.emit('unsubscribe', id);\r\n\t\t\tdelete this.statesSubscribes[id];\r\n\t\t}\r\n\t}\r\n}\r\n","import Socket from './Socket'\r\n\r\n/**\r\n * Connection\r\n +\r\n *\r\n */\r\nexport default class Connection {\r\n\r\n\t/*\r\n\t * URL\r\n\t */\r\n\tstatic url = window.location.hostname;\r\n\t\r\n\t/*\r\n\t * Connection\r\n\t */\r\n\tstatic connection = null;\r\n\t\r\n\t/**\r\n\t * Connects to the Socket.\r\n\t *\r\n\t * @param\t{String}\turl\r\n\t * @param\t{Array}\t\tlisteners\r\n\t * @return\t{Connection}\r\n\t */\r\n\tstatic connect(url = null, listeners = null) {\r\n\t\t\r\n\t\t// set URL\r\n\t\tif (url) {\r\n\t\t\tConnection.setUrl = url;\r\n\t\t}\r\n\t\t\r\n\t\t// connect\r\n\t\tConnection.connection = new Socket(Connection.url);\r\n\t\t\r\n\t\t// set listeners\r\n\t\tif (listeners) {\r\n\t\t\tConnection.setListeners = listeners;\r\n\t\t}\r\n\t\t\r\n\t\t// return connection\r\n\t\treturn Connection.connection;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the current Connection.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Connection}\tCurrent Connection\r\n\t */\r\n\tstatic get getConnection() {\r\n\t\treturn Connection.connection || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get the current URL.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get getUrl() {\r\n\t\treturn Connection.url;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Reconnect to the Socket.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get reconnect() {\r\n\t\treturn Connection.connect;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets an event listener.\r\n\t *\r\n\t * @param\t{Object}\t\t\tlistener\r\n\t * @param\t{String}\t\t\tlistener.event\r\n\t * @param\t{Function}\t\t\tlistener.callback\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setListener(listener) {\r\n\t\tConnection.connection.on(listener.event, listener.callback);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set event listeners.\r\n\t *\r\n\t * @param\t{Array<Object>}\t\tlisteners\r\n\t * @return \t{Boolean}\r\n\t */\r\n\tstatic set setListeners(listeners = []) {\r\n\t\t\r\n\t\tif (!listeners || !Array.isArray(listeners)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tlisteners.forEach(listener => Connection.setListener = listener);\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a new URL (has to be set before calling connect()).\r\n\t *\r\n\t * @param\t{String}\tURL\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setUrl(url) {\r\n\t\tConnection.url = url;\r\n\t}\r\n}\r\n","\r\nexport const ModuleSettings = {\r\n\tAdapterStatus: require('./AdapterStatus').ModuleSettings || {},\r\n\tChart: require('./Chart').ModuleSettings || {},\r\n\tDateTime: require('./DateTime').ModuleSettings || {},\r\n\tMap: require('./Map').ModuleSettings || {},\r\n\tMultimedia: require('./Multimedia').ModuleSettings || {},\r\n\tStateList: require('./StateList').ModuleSettings || {},\r\n\tStateListHorizontal: require('./StateListHorizontal').ModuleSettings || {},\r\n\tWeather: require('./Weather').ModuleSettings || {}\r\n}\r\n\r\nexport const ModuleConfigurations = {\r\n\tAdapterStatus: require('./AdapterStatus').ModuleConfig || [],\r\n\tChart: require('./Chart').ModuleConfig || [],\r\n\tDateTime: require('./DateTime').ModuleConfig || [],\r\n\tMap: require('./Map').ModuleConfig || [],\r\n\tMultimedia: require('./Multimedia').ModuleConfig || [],\r\n\tStateList: require('./StateList').ModuleConfig || [],\r\n\tStateListHorizontal: require('./StateListHorizontal').ModuleConfig || [],\r\n\tWeather: require('./Weather').ModuleConfig || []\r\n}\r\n\r\nexport default {\r\n\tAdapterStatus: require('./AdapterStatus').default,\r\n\tChart: require('./Chart').default,\r\n\tDateTime: require('./DateTime').default,\r\n\tMap: require('./Map').default,\r\n\tMultimedia: require('./Multimedia').default,\r\n\tStateList: require('./StateList').default,\r\n\tStateListHorizontal: require('./StateListHorizontal').default,\r\n\tWeather: require('./Weather').default\r\n}","\r\nexport default {\r\n\tdefaults: require('./defaults').default,\r\n\t\r\n\tblind: require('./blind/').default,\r\n\tdoor: require('./door/').default,\r\n\theating: require('./heating/').default,\r\n\tjalousie: require('./blind/').default,\r\n\tlight: require('./light/').default,\r\n\tlocation: require('./location/').default,\r\n\tuser: require('./user/').default,\r\n\twindow: require('./window/').default\r\n}"],"sourceRoot":""}