{"version":3,"sources":["functions/blind.js","functions/door.js","i18n sync /^/.*/.js$","i18n/de.js","i18n/en.js","functions/heating.js","functions/defaults.js","i18n.js","functions/location.js","functions/user.js","components/StateListHorizontal.js","components/Map.js","components/Chart.js","components/GridContainer.js","components/StatusSnackbar.js","Socket.js","Connection.js","functions/index.js","Function.js","Device.js","components/TopBar.js","helpers/useWindowDimensions.js","components/TabBar.js","components/Popup.js","components/Widget.js","components/index.js","theme.js","Jarvis.js","App.js","serviceWorker.js","index.js","helpers/colorConverters.js","functions/light.js","components/StateListItem.js","components/StateList.js"],"names":["configurations","level","icon","level2","unit","components","defaults","LevelComponent","actions","styles","open","state","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","temperature","value","val","toFixed","setTemperature","humidity","props","Level","min","max","useStyles","makeStyles","theme","component","padding","spacing","sliderMarkLabel","breakpoints","down","display","Action","withStyles","primaryAction","secondaryAction","color","fontSize","classes","device","stateKey","className","clsx","primaryStateKey","secondaryStateKey","PowerAction","stateVal","parentOnChange","onChange","useState","checked","setChecked","useEffect","Fragment","target","setDeviceState","catch","err","console","error","Label","label","linebreak","br","Component","title","children","step","markSteps","setLevel","markStep","markLabel","onChangeCommitted","defaultValue","valueLabelDisplay","marks","Array","number","_any","toString","battery","door","position","power","wind","i18n","language","log","languages","isArray","forEach","loadTranslation","translation","require","default","message","setTranslation","translations","lang","word","options","placeholders","indexOf","parts","split","length","join","shift","key","replace","RegExp","ucFirst","charAt","toUpperCase","slice","navigator","userLanguage","StateListHorizontal","horizontal","width","height","mapOverview","left","bottom","zIndex","alignItems","margin","cursor","mapIconContainer","mapIconParent","backgroundColor","boxShadow","borderRadius","mapIcon","palette","primary","main","transform","content","mapTooltip","Map","settings","devices","defaultZoom","zoom","defaultPosition","markers","setMarkers","useRef","memoizedMapInitialised","useCallback","current","this","memoizedHandleClick","flyTo","requestDeviceState","prevMarkers","on","mapMarkers","marker","Marker","push","item","attributes","avatar","alt","name","src","onClick","getIcon","aria-label","arrow","t","useFlyTo","center","whenReady","attribution","url","markerIcon","offset","info","function","substr","L","divIcon","html","iconSize","memoizedHandleMouseEvent","closeTooltip","openTooltip","riseOnHover","onMouseOver","direction","tooltipDirection","permanent","tooltipPermanent","Chart","charts","setCharts","requestDeviceStateHistory","prevCharts","history","temp","labels","data","entry","ts","datasets","fill","lineTension","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","style","gridContainer","paddingLeft","GridContainer","contents","columns","grid","column","Grid","xs","sm","md","lg","Math","round","xl","warn","container","success","green","dark","warning","amber","iconVariant","opacity","marginRight","variantIcon","CheckCircleIcon","WarningIcon","ErrorIcon","InfoIcon","StatusSnackbar","autoHideDuration","closeButton","onClose","variant","other","Icon","Snackbar","anchorOrigin","vertical","SnackbarContent","action","IconButton","Socket","socket","io","timeout","query","statesSubscribes","emit","attempts","reason","setTimeout","stateChange","cb","cbs","reg","connected","task","hasOwnProperty","test","Promise","reject","getState","getStateHistory","setState","EventEmitter","Connection","listeners","setUrl","connection","setListeners","listener","event","callback","setListener","window","location","hostname","blind","heating","jalousie","light","user","Function","functionType","functionId","toLowerCase","functions","defaultStyles","_isFunction","undefined","obj","Device","deviceProperties","sysLang","room","states","parent","_setProperties","stateSubscriptions","historySubscriptions","moment","stateType","s","node","config","attribute","ignoredStates","ignoredState","hiddenStates","hideStates","hideState","secondary","stateOrAttribute","groups","group","sort","divider","timeChanged","lc","fromNow","pair","option","values","_getUserSetting","_getConfigurationSetting","property","getStyle","stateProperty","deviceState","defaultIcon","subscribe","responses","_getStateFromKey","then","_updateDeviceState","subscribeDeviceState","res","subscribeState","params","getDeviceState","child","appBar","flexGrow","toolbar","menuButton","paddingRight","transition","flexShrink","userSelect","TopBar","AppBar","Toolbar","Typography","getWindowDimensions","innerWidth","innerHeight","paddingBottom","tabs","borderBottom","fixed","top","indicator","fullscreen","marginLeft","marginTop","TabBar","selectTab","tabBarProps","tab","setTab","setFixed","handleScroll","threshold","scrollY","prevFixed","document","getElementById","paddingTop","offsetTop","offsetHeight","addEventListener","removeEventListener","renderedTabs","i","Tab","Tabs","selectedTab","root","TabPanel","renderedTab","windowDimensions","setWindowDimensions","handleResize","useWindowDimensions","mapHeight","setMapHeight","topBarHeight","hidden","setHidden","Box","role","DialogTitle","right","grey","disableTypography","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Popup","prevProps","prevState","getConnection","allSettled","forceUpdate","nextProps","nextState","closeDialog","Dialog","maxWidth","fullWidth","dividers","StateList","openDialog","Button","autoFocus","React","card","cardHeaderNoContents","cardAvatar","cardContent","Widget","iconStyle","Card","CardHeader","Avatar","createElement","CardContent","blue","pink","createMuiTheme","debug","getGroup","groupId","Tag","COMPONENTS","getGridContents","gridContents","columnContents","index","Jarvis","tabTitle","notificationDrawer","dialog","dialogContents","bind","layout","tabsEnabled","widgetProps","tabPanels","tabLabel","tabPanel","Date","now","ThemeProvider","topBarTitle","getTabPanels","App","loaded","errorMessage","noErrorFunction","connect","JSON","parse","useSettings","processDevices","email","LogRocket","init","uuid","identify","setLanguage","loadTranslations","pageTitle","pageFavicon","href","get","promises","results","result","status","deviceList","groupedDevices","deviceId","jarvis","processDevice","groupDevice","item1","item2","stringify","justify","minHeight","CircularProgress","loading","topBar","tabBar","gridColumns","SkeletonLoader","Skeleton","gridItem","loaders","random","loader","renderError","renderLoadingProgress","renderLoadingSkeleton","Boolean","match","ReactDOM","render","serviceWorker","ready","registration","unregister","HsvToRgb","h","r","g","b","f","p","q","v","floor","RgbToHex","LightColorAction","colorSpace","setColorSpace","colors","Red","Green","Blue","Hue","Saturation","Brightness","LightColorComponent","initialColor","helpers","onChangeComplete","colorTemperature","hue","rgb","hsv","hex","setHue","hsl","defaultListDivider","defaultListSectionDivider","defaultListSectionText","defaultListIcon","horizontalListItem","textAlign","horizontalListItemIcon","minWidth","horizontalListItemAction","verticalListItemAction","ListDivider","ListItem","ListItemIconElement","customClassNames","classNames","StateListItem","prevSubgroup","getAction","subgroup","finger","button","ListItemIcon","ListItemText","getComponent","getOption","subtitle","ListItemSecondaryAction","horizontalList","flexDirection","flexWrap","List","dense","listItem"],"mappings":"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","file":"static/js/main.0aa1b627.chunk.js","sourcesContent":["import defaults from './defaults'\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tlevel: {\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t},\r\n\t\tlevel2: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel2: defaults.components.LevelComponent\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","var map = {\n\t\"./de.js\": 229,\n\t\"./en.js\": 230\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 228;","export default {\r\n\t/*\r\n\t * LOADING SCREEN\r\n\t */\r\n\t\"Retrieving settings\": \"Einstellungen werden geladen\",\r\n\t\r\n\t/*\r\n\t * GENERAL\r\n\t */\r\n\t\"on\": \"an\",\r\n\t\"off\": \"aus\",\r\n\t\r\n\t\"user\": \"User\",\r\n\t\"users\": \"Users\",\r\n\t\r\n\t\"door\": \"Tür\",\r\n\t\"window\": \"Fenster\",\r\n\t\r\n\t\"open\": \"offen\",\r\n\t\"closed\": \"geschlossen\",\r\n\t\r\n\t\"power\": \"Gerät an\",\r\n\t\"brightness\": \"Helligkeit\",\r\n\t\"wind\": \"Wind\",\r\n\t\"battery\": \"Batterie\",\r\n\t\r\n\t\r\n\t/*\r\n\t * BLINDS\r\n\t */\r\n\t\"blind#level\": \"Behanghöhe\",\r\n\t\"blind#level2\": \"Lamellenposition\",\r\n\t\r\n\t\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"light#power\": \"Licht\",\r\n\t\"light#level\": \"Helligkeit\",\r\n\t\"colorTemperature\": \"Farbtemperatur\",\r\n\t\"hue\": \"Farbe\",\r\n\t\"light#rgb\": \"Farbraum Rot-Grün-Blau (RGB)\",\r\n\t\"hex\": \"Farbe\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HEATING\r\n\t */\r\n\t\"temperature\": \"Temperatur\",\r\n\t\"humidity\": \"Luftfeuchtigkeit\",\r\n\t\"setTemperature\": \"eingestellte Temperatur\",\r\n\t\r\n\t\r\n\t/*\r\n\t * DOOR\r\n\t */\r\n\t\"bell\": \"Klingel\",\r\n\t\"lock\": \"Schloß\",\r\n\t\"presence\": \"Präsenz\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HOUSEHOLD\r\n\t */\r\n\t\"running\": \"Gerät läuft\",\r\n\t\"consumption\": \"Verbrauch\"\r\n}","export default {\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"level\": \"Brightness\",\r\n\t\"colorTemperature\": \"Color Temperature\",\r\n\t\"hue\": \"Color\",\r\n\t\"color\": \"Color\",\r\n\t\"hex\": \"Color\",\r\n}","import React from 'react'\r\n\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction HeatingSetTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={0} max={35} {...props} />\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\ttemperature: {\r\n\t\t\tvalue: (val) => val.toFixed(1),\r\n\t\t\tunit: ' °C'\r\n\t\t},\r\n\t\tsetTemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer-chevron-up'\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tsetTemperature: HeatingSetTemperatureComponent\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Slider from '@material-ui/core/Slider'\r\nimport Switch from '@material-ui/core/Switch'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tprimaryAction: props => ({\r\n\t\t...props.styles\r\n\t}),\r\n\tsecondaryAction: props => ({\r\n\t\tcolor: '#999',\r\n\t\tfontSize: '14px',\r\n\t\t...props.styles\r\n\t}),\r\n});\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\tcomponent: {\r\n\t\tpadding: theme.spacing(2, 8, 2, 2)\r\n\t},\r\n\tsliderMarkLabel: {\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tdisplay: 'none',\r\n\t\t\t'&:nth-child(5)': { display: 'block' },\r\n\t\t\t'&:nth-child(15)': { display: 'block' },\r\n\t\t\t'&:nth-child(25)': { display: 'block' }\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nconst Action = withStyles(styles)(props => {\r\n//function Action(props) {\r\n\tconst { classes, device, state, stateKey } = props;\r\n\t//const classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\r\n<span className={clsx((stateKey === device.primaryStateKey && classes.primaryAction) || (stateKey === device.secondaryStateKey && classes.secondaryAction))}>\r\n\t{state.value} {state.unit}\r\n</span>\r\n\r\n\t);\r\n});\r\n\r\nfunction PowerAction(props) {\r\n\tconst { device, stateKey, stateVal, onChange: parentOnChange } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal);\r\n\tuseEffect(() => setChecked(stateVal), [stateVal]);\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n<Switch\r\n\tchecked={checked}\r\n\tonChange={parentOnChange || onChange}\r\n\tvalue={checked !== true}\r\n\tcolor=\"primary\"\r\n\t/>\r\n\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction Label(props) {\r\n\tconst { label, br } = props;\r\n\tconst linebreak = br || false;\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t<Typography>{label}</Typography>\r\n\t{linebreak && <br />}\r\n</React.Fragment>\r\n\t\r\n\t);\r\n}\r\n\r\nfunction Component(props) {\r\n\tconst { title, children } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Label label={title} />\r\n\t<div className={classes.component}>\r\n\t\t{children}\r\n\t\r\n\t</div>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\nfunction LevelComponent(props) {\r\n\tlet { device, stateKey, stateVal, title, min, max, step, markSteps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onChange = (e, val) => {\r\n\t\tsetLevel(val);\r\n\t\tdevice.setDeviceState(stateKey, val).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [level, setLevel] = useState(stateVal);\r\n\tuseEffect(() => setLevel(stateVal), [stateVal]);\r\n\t\r\n\t// default settings\r\n\tmin = min || 0;\r\n\tmax = max || 100;\r\n\tstep = step || 1;\r\n\tmarkSteps = markSteps || 11; // 0 to 10\r\n\tlet markStep = ((max-min)/(markSteps-1)) || 10;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<Slider\r\n\t\tclasses={{ markLabel: classes.sliderMarkLabel }}\r\n\t\t//onChange\r\n\t\tonChangeCommitted={onChange}\r\n\t\tdefaultValue={level}\r\n\t\tvalueLabelDisplay=\"auto\"\r\n\t\tmarks={[...Array(markSteps).keys()].map(number => ({ 'value': min+number*markStep, 'label': min+number*markStep }))}\r\n\t\tmin={min}\r\n\t\tmax={max}\r\n\t\tstep={step}\r\n\t/>\r\n\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\t_any: {\r\n\t\t\tvalue: (val) => val.toString(),\r\n\t\t\t//unit\r\n\t\t\t//icon\r\n\t\t\t//state\r\n\t\t},\r\n\t\tbattery: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'battery-medium'\r\n\t\t},\r\n\t\tdoor: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'water-percent'\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tpower: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\ttemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer'\r\n\t\t},\r\n\t\twind: {\r\n\t\t\tunit: ' km/h',\r\n\t\t\ticon: 'weather-windy'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tLabel,\r\n\t\tComponent,\r\n\t\tLevelComponent,\r\n\t\t\r\n\t\tlevel: LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tAction,\r\n\t\tPowerAction,\r\n\t\t\r\n\t\tpower: PowerAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': {\r\n\t\t\t\t\t'color': '#090',\r\n\t\t\t\t\t'fontWeight': 'bold'\r\n\t\t\t\t},\r\n\t\t\t\t'false': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","/**\r\n * Internationalization\r\n * Based on https://raw.githubusercontent.com/ioBroker/adapter-react/master/src/i18n.js.\r\n * Copyright 2018-2019 bluefox <dogafox@gmail.com>\r\n *\r\n * MIT License\r\n *\r\n *\r\n */\r\nexport default class i18n {\r\n\r\n\t/*\r\n\t * holds the translations\r\n\t */\r\n\tstatic translations = {};\r\n\r\n\t/*\r\n\t * default language\r\n\t */\r\n\tstatic language = navigator.language || navigator.userLanguage || 'en';\r\n\r\n\t/**\r\n\t * Override default language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setLanguage(language) {\r\n\t\tif (language) {\r\n\t\t\ti18n.language = language;\r\n\t\t\tconsole.log('i18n: Set language to ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads multiple translations.\r\n\t *\r\n\t * @param\t{String|Array}\tlanguages\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslations(languages) {\r\n\t\t\r\n\t\tif (languages) {\r\n\t\t\tlanguages = Array.isArray(languages) ? languages : [languages];\r\n\t\t\tlanguages.forEach(language => i18n.loadTranslation(language));\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads a translation.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslation(language) {\r\n\t\t\r\n\t\tif (language) {\r\n\t\t\tlet translation;\r\n\t\t\ttry {\r\n\t\t\t\ttranslation = require('./i18n/' + language + '.js').default;\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tconsole.error(err.message);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\ti18n.setTranslation(language, translation);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a translation for language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @param\t{Object}\ttranslation\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setTranslation(language, translation) {\r\n\t\tif (language && translation) {\r\n\t\t\ti18n.translations[language] = { ...i18n.translations[language] || {}, ...translation };\r\n\t\t\tconsole.log('i18n: Set translations for language ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic getLanguage() {\r\n\t\treturn i18n.lang;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\t{String}\tword\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @param\t{Boolean}\t[options.ucFirst=false]\r\n\t * @param\t{Object}\t[placeholders={}]\r\n\t * @param\t{String}\t[language=i18n.language]\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic t(word, options = {}, placeholders = {}, language = i18n.language) {\r\n\t\t\r\n\t\tword = word.toString();\r\n\t\tif (i18n.translations[language]) {\r\n\t\t\t\r\n\t\t\t// check if word is concatenated\r\n\t\t\tif (word.indexOf('#') > -1) {\r\n\t\t\t\t\r\n\t\t\t\tlet parts = word.split('#');\r\n\t\t\t\twhile (parts.length > 0 && !i18n.translations[language][parts.join('#')]) {\r\n\t\t\t\t\tparts.shift();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tword = i18n.translations[language][parts.join('#')] || word;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tword = i18n.translations[language][word] || word;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// replace placeholders\r\n\t\tfor (let key in placeholders) {\r\n\t\t\tword = word.replace(RegExp('%' + key + '%', 'g'), placeholders[key]);\r\n\t\t}\r\n\t\t\r\n\t\t// options\r\n\t\tif (options.ucFirst) {\r\n\t\t\tword = word.charAt(0).toUpperCase() + word.slice(1);\r\n\t\t}\r\n\t\t\r\n\t\treturn word;\r\n\t}\r\n}\r\n","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'home'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'account'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react';\r\n\r\nimport StateList from './StateList';\r\n\r\n\r\nexport default function StateListHorizontal(props) {\r\n\treturn (<StateList horizontal={true} {...props} />);\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport L from 'leaflet'\r\nimport { Map as LeafletMap, TileLayer, Marker as LeafletMarker, Tooltip as LeafletTooltip } from 'react-leaflet'\r\n\r\nimport i18n from '../i18n'\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tmap: {\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapOverview: {\r\n\t\tcolor: '#666',\r\n\t\tposition: 'absolute',\r\n\t\tleft: 0,\r\n\t\tbottom: 0,\r\n\t\twidth: '100%',\r\n\t\theight: '60px',\r\n\t\tzIndex: 999,\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\t\r\n\t\t'& > *': {\r\n\t\t\tmargin: theme.spacing(1),\r\n\t\t\tcursor: 'pointer',\r\n\t\t},\r\n\t},\r\n\t/*\r\n\t * MARKER WITH ICON\r\n\t *\r\n\tmapIconContainer: {\r\n\t\tbackgroundImage: 'url(\"https://unpkg.com/leaflet@1.6.0/dist/images/marker-icon-2x.png\")',\r\n\t\tbackgroundSize: '100% 100%'\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tborderRadius: '10px',\r\n\t\theight: '20px',\r\n\t\twidth: '20px',\r\n\t\tmargin: '3px auto',\r\n\t\ttextAlign: 'center'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '1.2rem',\r\n\t\tdisplay: 'block',\r\n\t\tmargin: '-4px 0 0 1px',\r\n\t\tcolor: '#f00',\r\n\t\tposition: 'absolute'\r\n\t}\r\n\t*/\r\n\tmapIconContainer: {\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tboxShadow: '0 0 0 8px rgba(255, 255, 255, 0.3)',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '2rem',\r\n\t\tcolor: theme.palette.primary.main,\r\n\t\ttransform: 'translate3d(4px, -4px,0)', /* for fontSize: '2.3rem' -> 'translate3d(2px, -8px,0)', */\r\n\t\tdisplay: 'block',\r\n\t\t\r\n\t\t'&:after': {\r\n\t\t\tcontent: '\"\"',\r\n\t\t\tdisplay: 'block',\r\n\t\t\tpadding: '50% 0%'\r\n\t\t}\r\n\t},\r\n\tmapTooltip: {\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Map(props) {\r\n\tconst { settings, devices } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [zoom,] = useState(settings.component.defaultZoom);\r\n\tconst [position,] = useState(Array.isArray(settings.component.defaultPosition) ? settings.component.defaultPosition : settings.component.defaultPosition.split(','));\r\n\tconst [markers, setMarkers] = useState({});\r\n\t\r\n\t// map instance\r\n\tconst map = useRef();\r\n\tconst memoizedMapInitialised = useCallback(function() {map.current = this}, [],);\r\n\t\r\n\t// Marker click in overview\r\n\tconst memoizedHandleClick = useCallback(flyTo => map.current.flyTo(flyTo.split(',')), [],);\r\n\t\r\n\t// get gps position coordinates\r\n\tuseEffect(() => {\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('position').catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\t\r\n\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\tif (!prevMarkers[device.id]) {\r\n\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: null };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('stateChange', (stateKey, state) => {\r\n\t\t\t\t\r\n\t\t\t\tif (stateKey === 'position') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\t\tif (!prevMarkers[device.id] || prevMarkers[device.id].position !== state.val) {\r\n\t\t\t\t\t\t\tdevice.options.position = state.val;\r\n\t\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: device };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\r\n\t}, [devices]);\r\n\t\r\n\t// add markers\r\n\tlet mapMarkers = [], mapOverview = [];\r\n\tif (devices.length > 0 && devices.length === Object.keys(markers).length) {\r\n\t\t\r\n\t\tfor (let key in markers) {\r\n\t\t\tlet device = markers[key];\r\n\t\t\tif (device !== null) {\r\n\t\t\t\tlet marker = <Marker key={'marker-' + device.id} position={device.options.position} device={device} settings={settings.component} />\r\n\t\t\t\tmapMarkers.push(marker);\r\n\t\t\t\t\r\n\t\t\t\tlet item = null;\r\n\t\t\t\tif (device.attributes.avatar) {\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} src={device.attributes.avatar} onClick={() => memoizedHandleClick(device.options.position)} />\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tconst icon = device.getIcon('position');\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} onClick={() => memoizedHandleClick(device.options.position)}><span className={clsx('mdi mdi-' + icon)}></span></Avatar>\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tmapOverview.push(<Tooltip key={'tooltip-' + device.id} title={device.name} aria-label={device.name} arrow>{item}</Tooltip>);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Box className={classes.mapOverview}>\r\n\t\t<Typography>{i18n.t('Jump to')}:</Typography>\r\n\t\t{mapOverview}\r\n\t</Box>\r\n\t<LeafletMap useFlyTo={true} center={position} zoom={zoom} className={classes.map} whenReady={memoizedMapInitialised}>\r\n\t\t<TileLayer\r\n\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n\t\t\turl='https://{s}.tile.osm.org/{z}/{x}/{y}.png'\r\n\t\t\t/>\r\n\t\t\r\n\t\t{mapMarkers}\r\n\t</LeafletMap>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nfunction Marker(props) {\r\n\tconst { position, device, settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tlet markerIcon = null, offset = 40;\r\n\tconsole.info('Marker for ' + device.function + ' ' + device.name + ' added to map.');\r\n\t\r\n\t// Marker with avatar / picture\r\n\tif (device.attributes && device.attributes.avatar && device.attributes.avatar.substr(0, 11) === 'data:image/') {\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<img src=\"' + device.attributes.avatar + '\" class=\"' + classes.mapIconParent + '\" />',\r\n\t\t\ticonSize: [ 64, 64 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker with Icon\r\n\telse {\r\n\t\toffset = 30;\r\n\t\tconst icon = device.getIcon('position');\r\n\t\t\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<div class=\"' + classes.mapIconParent + '\"><span class=\"' + clsx(classes.mapIcon, 'mdi mdi-' + icon) + '\"></span></div>',\r\n\t\t\ticonSize: [ 40, 40 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker MouseOver / MouseOut (bring tooltip to front if markers overlay)\r\n\tconst memoizedHandleMouseEvent = useCallback(function() {this.closeTooltip().openTooltip()}, [],);\r\n\r\n\treturn (\r\n\r\n<LeafletMarker riseOnHover={true} position={Array.isArray(position) ? position : position.split(',')} icon={markerIcon} onMouseOver={memoizedHandleMouseEvent}>\r\n\t<LeafletTooltip className={classes.mapTooltip} direction={settings.tooltipDirection || 'bottom'} permanent={settings.tooltipPermanent || true} offset={[0,offset]}>\r\n\t\t{device.name}\r\n\t</LeafletTooltip>\r\n</LeafletMarker>\r\n\r\n\t);\r\n}","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { Line } from 'react-chartjs-2';\r\n\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n}));\r\n\r\n\r\nexport default function Chart(props) {\r\n\tconst { component, devices } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [charts, setCharts] = useState({});\r\n\t\r\n\t// get history\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceStateHistory().catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\t\r\n\t\t\t\tsetCharts(prevCharts => {\r\n\t\t\t\t\tif (!prevCharts[device.id]) {\r\n\t\t\t\t\t\treturn { ...prevCharts, [device.id]: null };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn prevCharts;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('historyChange', (stateKey, history) => {\r\n\t\t\t\t\r\n\t\t\t\tlet temp = {};\r\n\t\t\t\tif (!charts[stateKey]) {\r\n\t\t\t\t\t\r\n\t\t\t\t\ttemp[stateKey] = {\r\n\t\t\t\t\t\tlabels: [],\r\n\t\t\t\t\t\tdata: []\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t\thistory.forEach(entry => {\r\n\t\t\t\t\t\ttemp[stateKey].labels.push(entry.ts);\r\n\t\t\t\t\t\ttemp[stateKey].data.push(entry.val);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetCharts(prevCharts => ({ ...prevCharts, [stateKey]: temp[stateKey] }));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t/*\r\n\t\t\t\tif (stateKey === device.primaryKey) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetCharts(prevCharts => {\r\n\t\t\t\t\t\tif (!prevCharts[device.id] || prevMarkers[device.id].position !== state.val) {\r\n\t\t\t\t\t\t\tdevice.options.position = state.val;\r\n\t\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: device };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t});\r\n\t\t});\r\n\t\r\n\t}, [devices]);\r\n\t\r\n\t// INDEX: { ts: 1577796089456, val: 3971.88 }\r\n/*\r\n\t\r\n\tvar myLineChart = new Chart(chart.current, {\r\n    // The type of chart we want to create\r\n    type: 'line',\r\n\r\n    // The data for our dataset\r\n    data: {\r\n        labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],\r\n        datasets: [{\r\n            label: 'My First dataset',\r\n            backgroundColor: 'rgb(255, 99, 132)',\r\n            borderColor: 'rgb(255, 99, 132)',\r\n            data: [0, 10, 5, 2, 20, 30, 45]\r\n        }]\r\n    },\r\n\r\n    // Configuration options go here\r\n    options: {}\r\n});\r\n*/\r\n\r\nlet data = {};\r\n\r\nconsole.log(charts);\r\n\r\nif (charts && charts['brightness']) {\r\ndata = {\r\n  labels: charts['brightness'].labels,\r\n  datasets: [\r\n    {\r\n      label: 'My First dataset',\r\n      fill: false,\r\n      lineTension: 0.1,\r\n      backgroundColor: 'rgba(75,192,192,0.4)',\r\n      borderColor: 'rgba(75,192,192,1)',\r\n      borderCapStyle: 'butt',\r\n      borderDash: [],\r\n      borderDashOffset: 0.0,\r\n      borderJoinStyle: 'miter',\r\n      pointBorderColor: 'rgba(75,192,192,1)',\r\n      pointBackgroundColor: '#fff',\r\n      pointBorderWidth: 1,\r\n      pointHoverRadius: 5,\r\n      pointHoverBackgroundColor: 'rgba(75,192,192,1)',\r\n      pointHoverBorderColor: 'rgba(220,220,220,1)',\r\n      pointHoverBorderWidth: 2,\r\n      pointRadius: 1,\r\n      pointHitRadius: 10,\r\n      data: charts['brightness'].data\r\n    }\r\n  ]\r\n};\r\n\r\n} \r\n\r\n\r\n\treturn (\r\n\r\n<div className={'chart-container'} style={{ position: 'relative' }}>\r\n\t<Line data={data} />\r\n</div>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\n\r\nimport Grid from '@material-ui/core/Grid';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tgridContainer: {\r\n\t\tpaddingLeft: theme.spacing(1),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(0.4)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function GridContainer(props) {\r\n\tconst { contents = {} } = props;\r\n\t\r\n\tconst classes = useStyles();\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tlet grid = [];\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\t\r\n\t\tif (!contents[column]) {\r\n\t\t\tconsole.warn('No content for column #' + column + '!');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t\r\n\t\tgrid.push(\r\n\t\t\t<Grid key={column} item\t\t\t\t// @see https://material-ui.com/customization/breakpoints/\r\n\t\t\t\txs={12}\t\t\t\t\t\t\t//    0 -  600px\r\n\t\t\t\tsm={6}\t\t\t\t\t\t\t//  600 -  960px\r\n\t\t\t\tmd={6}\t\t\t\t\t\t\t//  960 - 1280px\r\n\t\t\t\tlg={Math.round(12/columns)}\t\t// 1280 - 1920px\r\n\t\t\t\txl={Math.round(12/columns)}\t\t// \t\t> 1920px\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{contents[column]}\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container spacing={0} className={classes.gridContainer}>\r\n\t{grid}\r\n</Grid>\r\n\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport WarningIcon from '@material-ui/icons/Warning';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { amber, green } from '@material-ui/core/colors';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tsuccess: {\r\n\t\tbackgroundColor: green[600],\r\n\t},\r\n\terror: {\r\n\t\tbackgroundColor: theme.palette.error.dark,\r\n\t},\r\n\tinfo: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t},\r\n\twarning: {\r\n\t\tbackgroundColor: amber[700],\r\n\t},\r\n\ticon: {\r\n\t\tfontSize: 20,\r\n\t},\r\n\ticonVariant: {\r\n\t\topacity: 0.9,\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tmessage: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t},\r\n}));\r\n\r\n\r\nconst variantIcon = {\r\n\tsuccess: CheckCircleIcon,\r\n\twarning: WarningIcon,\r\n\terror: ErrorIcon,\r\n\tinfo: InfoIcon,\r\n};\r\n\r\n\r\nexport default function StatusSnackbar(props) {\r\n\tconst classes = useStyles();\r\n\tlet { className, open, autoHideDuration, message, closeButton, onClose, variant, ...other } = props;\r\n\tconst Icon = variantIcon[variant];\r\n\t\r\n\topen = open || true;\r\n\tautoHideDuration = autoHideDuration || null;\r\n\treturn (\r\n\r\n<Snackbar\r\n\tanchorOrigin={{\r\n\t\tvertical: 'bottom',\r\n\t\thorizontal: 'center',\r\n\t}}\r\n\topen={open}\r\n\tautoHideDuration={autoHideDuration}\r\n\tonClose={onClose}\r\n\t>\r\n\t<SnackbarContent\r\n\t\tclassName={clsx(classes[variant], className)}\r\n\t\tmessage={\r\n\t\t\t<span id=\"client-snackbar\" className={classes.message}>\r\n\t\t\t\t<Icon className={clsx(classes.icon, classes.iconVariant)} />\r\n\t\t\t\t{message}\r\n\t\t\t</span>\r\n\t\t}\r\n\t\taction={closeButton && [\r\n\t\t\t<IconButton key=\"close\" aria-label=\"close\" color=\"inherit\" onClick={onClose}>\r\n\t\t\t\t<CloseIcon className={classes.icon} />\r\n\t\t\t</IconButton>,\r\n\t\t]}\r\n\t\t{...other}\r\n\t\t/>\r\n\t\t\r\n</Snackbar>\r\n\r\n\t);\r\n}","import EventEmitter from 'events';\r\nimport io from 'socket.io-client';\r\n\r\n\r\n/**\r\n * Class for Socket.io conncetion handling.\r\n *\r\n * @description This is based on an implementation @GermanBluefox (https://github.com/GermanBluefox), see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\t\t\t\tOnly required functions are taken from source class. Major change is that all events are emitted, so proper error handling is possible in the App.\r\n *\r\n *\r\n * @param\t{String}\t\turl\r\n * @param\t{Object}\t\toptions\r\n * @return\t{Socket}\r\n * @see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\r\n */\r\nexport default class Socket extends EventEmitter {\r\n\t\r\n\tconstructor(url = null, options = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\t// socket connection\r\n\t\tthis.socket = io(url, { timeout: 10000, ...options, query: 'ws=true' });\r\n\t\tthis.statesSubscribes = {}; // subscribed states\r\n\t\t\r\n\t\t/*\r\n\t\t * API events\r\n\t\t * @see https://github.com/socketio/socket.io-client/blob/HEAD/docs/API.md#socket\r\n\t\t *\r\n\t\t */\r\n\t\t// connect\r\n\t\tthis.socket.on('connect', () => this.emit('connect'));\r\n\t\t\r\n\t\t// reconnect: Fired upon a successful reconnection.\r\n\t\tthis.socket.on('reconnect', attempts => this.emit('reconnect', attempts));\r\n\t\t\r\n\t\t// reconnect_error: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_error', error => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// reconnect_failed: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_failed', () => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_failed', 'message': 'Reconnection failed!' }));\r\n\t\t\r\n\t\t// discconect\r\n\t\tthis.socket.on('disconnect', reason => this.emit('disconnect', reason));\r\n\t\t\r\n\t\t// connect_error\r\n\t\tthis.socket.on('connect_error', error => this.emit('error', { 'type': 'connect', 'event': 'connect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// connect_timeout\r\n\t\tthis.socket.on('connect_timeout', () => this.emit('error', { 'type': 'connect', 'event': 'connect_timeout', 'message': 'Connect ran into timeout!' }));\r\n\t\t\r\n\t\t// error\r\n\t\tthis.socket.on('error', error => this.emit('error', { 'type': 'error', 'event': 'error', 'message': error.message }));\r\n\t\t\r\n\t\t/*\r\n\t\t * ioBroker events\r\n\t\t *\r\n\t\t */\r\n\t\tthis.socket.on('stateChange', (id, state) => setTimeout(() => this.stateChange(id, state), 0));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to a state by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeState(id, cb) {\r\n\t\t\r\n\t\tif (!this.statesSubscribes[id]) {\r\n\t\t\tlet reg = id\r\n\t\t\t\t.replace(/\\./g, '\\\\.')\r\n\t\t\t\t.replace(/\\*/g, '.*')\r\n\t\t\t\t.replace(/\\(/g, '\\\\(')\r\n\t\t\t\t.replace(/\\)/g, '\\\\)')\r\n\t\t\t\t.replace(/\\+/g, '\\\\+')\r\n\t\t\t\t.replace(/\\[/g, '\\\\[');\r\n\r\n\t\t\tif (reg.indexOf('*') === -1) {\r\n\t\t\t\treg += '$';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.statesSubscribes[id] = { reg: new RegExp(reg), cbs: [cb] };\r\n\t\t\t\r\n\t\t\tif (this.socket.connected) {\r\n\t\t\t\tthis.socket.emit('subscribe', id);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.statesSubscribes[id].cbs.indexOf(cb) === -1 && this.statesSubscribes[id].cbs.push(cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Fires pre-registered callbacks (via subscribeState) upon state change.\r\n\t *\r\n\t */\r\n\tstateChange(id, state) {\r\n\t\t\r\n\t\tid = id ? id.replace(/[\\s'\"]/g, '_') : '';\r\n\t\tfor (const task in this.statesSubscribes) {\r\n\t\t\tif (this.statesSubscribes.hasOwnProperty(task) && this.statesSubscribes[task].reg.test(id)) {\r\n\t\t\t\tthis.statesSubscribes[task].cbs.forEach(cb => cb(id, state));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a state.\r\n\t *\r\n\t */\r\n\tgetState(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getState(id, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getState', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the state history.\r\n\t *\r\n\t */\r\n\tgetStateHistory(id, options, cb) {\r\n\t\t\r\n\t\tif (typeof options === 'function') {\r\n\t\t\tcb = options;\r\n\t\t\toptions = {};\r\n\t\t}\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStateHistory(id, options, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getHistory', id, options, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a state.\r\n\t *\r\n\t */\r\n\tsetState(id, val, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.setState(id, val, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('setState', id, val, cb);\r\n\t\t}\r\n\t}\r\n}\r\n","import Socket from './Socket'\r\n\r\n/**\r\n * Connection\r\n +\r\n *\r\n */\r\nexport default class Connection {\r\n\r\n\t/*\r\n\t * URL\r\n\t */\r\n\tstatic url = window.location.hostname;\r\n\t\r\n\t/*\r\n\t * Connection\r\n\t */\r\n\tstatic connection = null;\r\n\t\r\n\t/**\r\n\t * Connects to the Socket.\r\n\t *\r\n\t * @param\t{String}\turl\r\n\t * @param\t{Array}\t\tlisteners\r\n\t * @return\t{Connection}\r\n\t */\r\n\tstatic connect(url = null, listeners = null) {\r\n\t\t\r\n\t\t// set URL\r\n\t\tif (url) {\r\n\t\t\tConnection.setUrl = url;\r\n\t\t}\r\n\t\t\r\n\t\t// connect\r\n\t\tConnection.connection = new Socket(Connection.url);\r\n\t\t\r\n\t\t// set listeners\r\n\t\tif (listeners) {\r\n\t\t\tConnection.setListeners = listeners;\r\n\t\t}\r\n\t\t\r\n\t\t// return connection\r\n\t\treturn Connection.connection;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the current Connection.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Connection}\tCurrent Connection\r\n\t */\r\n\tstatic get getConnection() {\r\n\t\treturn Connection.connection || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get the current URL.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get getUrl() {\r\n\t\treturn Connection.url;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets an event listener.\r\n\t *\r\n\t * @param\t{Object}\t\t\tlistener\r\n\t * @param\t{String}\t\t\tlistener.event\r\n\t * @param\t{Function}\t\t\tlistener.callback\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setListener(listener) {\r\n\t\tConnection.connection.on(listener.event, listener.callback);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set event listeners.\r\n\t *\r\n\t * @param\t{Array<Object>}\t\tlisteners\r\n\t * @return \t{Boolean}\r\n\t */\r\n\tstatic set setListeners(listeners = []) {\r\n\t\t\r\n\t\tif (!listeners || !Array.isArray(listeners)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tlisteners.forEach(listener => Connection.setListener = listener);\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a new URL (has to be set before calling connect()).\r\n\t *\r\n\t * @param\t{String}\tURL\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setUrl(url) {\r\n\t\tConnection.url = url;\r\n\t}\r\n}\r\n","\r\nexport default {\r\n\tdefaults: require('./defaults').default,\r\n\t\r\n\tblind: require('./blind').default,\r\n\tdoor: require('./door').default,\r\n\theating: require('./heating').default,\r\n\tjalousie: require('./blind').default,\r\n\tlight: require('./light').default,\r\n\tlocation: require('./location').default,\r\n\tuser: require('./user').default,\r\n\twindow: require('./door').default\r\n}","import EventEmitter from 'events';\r\nimport functions from './functions';\r\n\r\n\r\n/**\r\n * Function\r\n *\r\n * @param\t{String}\t\tfunctionType\r\n * @return\t{Function}\r\n *\r\n */\r\nexport default class Function extends EventEmitter {\r\n\t\r\n\tconstructor(functionType) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.function = functionType;\r\n\t\t\r\n\t\tif (!this.function) {\t\r\n\t\t\tthrow new Error('No function given!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.functionId = this.function.toLowerCase();\r\n\t\t\r\n\t\t// configuration\r\n\t\tthis.defaults = functions['defaults'].configurations;\r\n\t\tthis.configurations = (functions[this.functionId] && functions[this.functionId].configurations) || {};\r\n\t\t\r\n\t\t// styles\r\n\t\tthis.defaultStyles = functions['defaults'].styles;\r\n\t\tthis.styles = (functions[this.functionId] && functions[this.functionId].styles) || {};\r\n\t\t\r\n\t\t// components and actions\r\n\t\tthis.components = { ...functions['defaults'].components, ...(functions[this.functionId] && functions[this.functionId].components) || {} };\r\n\t\tthis.actions = { ...functions['defaults'].actions, ...(functions[this.functionId] && functions[this.functionId].actions) || {} };\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Mixed}\r\n\t * @private\r\n\t */\r\n\t_applyFunction(key, val) {\r\n\t\treturn this._isFunction(key) ? key(val) : val;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{String}\r\n\t * @private\r\n\t */\r\n\t_getValueFromSettings(settings, defaults = '') {\r\n\t\t\r\n\t\tfor (let key in settings) {\r\n\t\t\tif (settings[key] !== undefined) {\r\n\t\t\t\treturn settings[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn defaults;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isFunction(key) {\r\n\t\treturn key && typeof key === 'function';\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isValue(val) {\r\n\t\treturn val !== undefined; // || val === null || val === false; // null is considered a value, so it can be used to actually null the output\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_setObjectStructure(obj, defaultValue = undefined) {\r\n\t\t\r\n\t\tif (!obj || typeof obj != 'object') {\r\n\t\t\tobj = { 'default': obj || defaultValue };\r\n\t\t}\r\n\t\telse if (typeof obj == 'object' && !obj.default) {\r\n\t\t\tobj.default = defaultValue;\r\n\t\t}\r\n\t\t\r\n\t\treturn obj;\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport i18n from './i18n'\r\nimport Function from './Function'\r\nimport * as moment from 'moment/min/moment-with-locales.min.js'\r\n\r\n\r\n/**\r\n * Device\r\n *\r\n * @param\t{Object}\tdeviceProperties\r\n * @param\t{String}\tdeviceProperties.id\r\n * @param\t{String}\tdeviceProperties.name\r\n * @param\t{String}\t[deviceProperties.room=null]\r\n * @param\t{String}\tdeviceProperties.function\r\n * @param\t{Object}\tdeviceProperties.states\r\n * @param\t{Object}\t[deviceProperties.attributes={}]\r\n * @param\t{Object}\tdeviceProperties.options\r\n * @param\t{Object}\tsocket\r\n * @return\t{Device}\r\n *\r\n */\r\nexport default class Device extends Function {\r\n\t\r\n\tconstructor(deviceProperties, socket, language = window.sysLang || 'en') {\r\n\t\ttry {\r\n\t\t\tsuper(deviceProperties.function);\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthrow new Error('No function given for device ' + deviceProperties.name + '!');\r\n\t\t}\r\n\t\t\r\n\t\t// initialise class data\r\n\t\tthis.id = deviceProperties.id;\r\n\t\tthis.name = deviceProperties.name;\r\n\t\t\r\n\t\tthis.room = deviceProperties.room || null;\r\n\t\t\r\n\t\tthis.states = deviceProperties.states;\r\n\t\tthis.options = deviceProperties.options;\r\n\t\tthis.attributes = deviceProperties.attributes || {};\r\n\t\t\r\n\t\tthis.socket = socket;\r\n\t\t\r\n\t\t// verify data\r\n\t\tif (!this.options || typeof this.options !== 'object' || Object.keys(this.options).length === 0) {\r\n\t\t\tthrow new Error('Device' + (deviceProperties.id || deviceProperties.name ? ' ' + (deviceProperties.name || deviceProperties.id) : '') + ' not defined for jarvis!');\r\n\t\t}\r\n\t\telse if (!this.states || typeof this.states !== 'object' || Object.keys(this.states).length === 0) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no states defined)!');\r\n\t\t}\r\n\t\telse if (!this.id || !this.name || !this.function) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no id, name or function defined)!');\r\n\t\t}\r\n\t\telse if (!this.socket) {\t\r\n\t\t\tthrow new Error('No socket given!');\r\n\t\t}\r\n\t\t\r\n\t\t// hierarchy\r\n\t\tthis.children = deviceProperties.children || [];\r\n\t\tthis.parent = deviceProperties.parent || null;\r\n\t\t\r\n\t\t// do some stuff\r\n\t\tthis._setProperties();\r\n\t\tthis.stateSubscriptions = [];\r\n\t\tthis.historySubscriptions = [];\r\n\t\t\r\n\t\t// set some stuff\r\n\t\tmoment.locale(language);\r\n\t\t\r\n\t\t// listen for errors of the device\r\n\t\tthis.on('error', err => console.error('Device error occured!', err));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object|String}\r\n\t * @private\r\n\t */\r\n\t_getStateFromKey(stateKey = null, stateType = 'state') {\r\n\t\t\r\n\t\t// already a state object\r\n\t\tif (stateKey && typeof stateKey === 'object') {\r\n\t\t\treturn stateKey;\r\n\t\t}\r\n\t\t\r\n\t\t// get state object\r\n\t\tlet s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tif (!s || !s[stateType]) {\r\n\t\t\treturn 'Incorrect or non-defined state key for device ' + this.name + '!';\r\n\t\t}\r\n\t\telse if (typeof s[stateType] == 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey][stateType] = { 'node': s[stateType] };\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\telse if (typeof s[stateType] == 'object' && !s[stateType].node) {\r\n\t\t\treturn 'No ' + stateType + ' specified for device ' + this.name + '!';\r\n\t\t}\r\n\t\t\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getConfigurationSetting(config, stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this[config][stateKey]) {\r\n\t\t\t\r\n\t\t\t// 1. if stateKey (e.g. level, power) is available, try to replace an attribute (e.g. icon, unit or for styles state, icon) based on current state (e.g. true, false)\r\n\t\t\tif (typeof this[config][stateKey][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config][stateKey][attribute][stateVal]) ? this[config][stateKey][attribute][stateVal] : this[config][stateKey][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 2. if #1 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config][stateKey][attribute])) {\r\n\t\t\t\treturn this[config][stateKey][attribute](stateVal);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 3. fallback to stateKey with attribute, if defined but neither an object (thus stateless) nor a function\r\n\t\t\telse if (typeof this[config][stateKey][attribute] === 'string') {\r\n\t\t\t\treturn this[config][stateKey][attribute];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (this[config]['_any']) {\r\n\t\t\t\r\n\t\t\t// 4. fallback to _any if no stateKey (e.g. level, power) is given, but consider attribute to be stateful (e.g. true, false)\r\n\t\t\tif (typeof this[config]['_any'][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config]['_any'][attribute][stateVal]) ? this[config]['_any'][attribute][stateVal] : this[config]['_any'][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 5. if #4 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config]['_any'][attribute])) {\r\n\t\t\t\treturn this[config]['_any'][attribute](stateVal);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// nothing, return undefined (not null, because this would mean take an empty value)\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getUserSetting(stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this.options[attribute][stateKey]) {\r\n\t\t\t\r\n\t\t\tif (typeof this.options[attribute][stateKey] === 'object') {\r\n\t\t\t\treturn super._isValue(this.options[attribute][stateKey][stateVal]) ? this.options[attribute][stateKey][stateVal] : this.options[attribute][stateKey]['default'];\r\n\t\t\t}\r\n\t\t\telse if (super._isFunction(this.options[attribute][stateKey])) {\r\n\t\t\t\treturn this.options[attribute][stateKey](stateVal);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn this.options[attribute][stateKey];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return void\r\n\t * @private\r\n\t *\r\n\t */\r\n\t_setProperties() {\r\n\t\t\r\n\t\tlet states = Object.keys(this.states);\r\n\t\t\r\n\t\t// delete ignored states\r\n\t\tif (this.options.ignoredStates) {\r\n\t\t\tthis.options.ignoredStates = Array.isArray(this.options.ignoredStates) ? this.options.ignoredStates : [this.options.ignoredStates];\r\n\t\t\t\r\n\t\t\tthis.options.ignoredStates.forEach(ignoredState => {\r\n\t\t\t\tif (this.states[ignoredState]) {\r\n\t\t\t\t\tdelete this.states[ignoredState];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// delete ignored states\r\n\t\tthis.options.hiddenStates = [];\r\n\t\tif (this.options.hideStates) {\r\n\t\t\tthis.options.hideStates = Array.isArray(this.options.hideStates) ? this.options.hideStates : [this.options.hideStates];\r\n\t\t\t\r\n\t\t\tthis.options.hideStates.forEach(hideState => {\r\n\t\t\t\tif (this.states[hideState]) {\r\n\t\t\t\t\tthis.options.hiddenStates.push(hideState);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// properties\r\n\t\tthis.primaryStateKey = this.options.primary || states[0];\r\n\t\tthis.secondaryStateKey = this.options.secondary || null;\r\n\t\t\r\n\t\t// bring user settings for value, state, unit, icon and styles in structure\r\n\t\t['value', 'state', 'unit', 'icon', 'styles'].forEach(key => {\r\n\t\t\t\r\n\t\t\tlet stateOrAttribute = this.options[key] && Object.keys(this.options[key])[0];\r\n\t\t\tthis.options[key] = !this.options[key] ? {} : super._setObjectStructure(stateOrAttribute && states.indexOf(stateOrAttribute) > -1 ? this.options[key] : { [this.primaryStateKey]: this.options[key] });\r\n\t\t});\r\n\t\t\r\n\t\t// all options\r\n\t\tthis.options.groups = Array.isArray(this.options.group) ? this.options.group : [this.options.group];\r\n\t\tthis.options.sort = this.options.sort || 999;\r\n\t\t\r\n\t\tthis.options.label = (this.options.label && (typeof this.options.label === 'string' && this.options.label.replace(/%name%/g, this.name))) || this.options.label || this.name;\r\n\t\t//this.options.subtitle = this.options.subtitle;\r\n\t\tthis.options.divider = this.options.divider || false;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_updateDeviceState(stateKey, state) {\r\n\t\t\r\n\t\t// add time changed\r\n\t\tstate.timeChanged = moment(state.lc-2000).fromNow();\r\n\t\t\r\n\t\t// add unit\r\n\t\tstate.unit = '';\r\n\t\t\r\n\t\t// assign value\r\n\t\tstate.value = state.val;\r\n\t\t\r\n\t\t// mapping of value to state values\r\n\t\t[{ 'value': 'value' }, { 'state': 'value' }, { 'unit': 'unit' }].forEach(pair => {\r\n\t\t\tlet attribute = Object.keys(pair).toString();\r\n\t\t\tlet option = Object.values(pair).toString();\r\n\t\t\tlet settings = {};\r\n\t\t\t\r\n\t\t\t// get user setting\r\n\t\t\tsettings['options'] = this._getUserSetting(stateKey, attribute, state.value);\r\n\t\t\t\r\n\t\t\t// get function setting or fallback to defaults\r\n\t\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, state.value);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tstate[option] = super._getValueFromSettings(settings, state[option]);\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\tstate.value = i18n.t(state.value);\r\n\t\treturn state;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tget(property) {\r\n\t\treturn this[property] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetAction(stateKey = null) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state.val;\r\n\t\t\r\n\t\tconst Action = this.actions[stateKey] || this.actions.Action;\r\n\t\treturn <Action key={'action-' + this.id + '-' + stateKey} device={this} state={state} stateKey={stateKey} stateVal={stateVal} styles={this.getStyle('state', stateKey, stateVal)} />\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetComponent(stateKey) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tconst stateVal = this.states[stateKey].state.value.val;\r\n\t\t\r\n\t\tconst Component = this.components[stateKey];\r\n\t\treturn (Component && <Component title={i18n.t(this.function + '#' + stateKey)} device={this} stateKey={stateKey} stateVal={stateVal} />) || i18n.t(this.function + '#' + stateKey);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateProperty=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetDeviceState(stateKey = null, stateProperty = null) {\r\n\t\tconst s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tlet deviceState = null;\r\n\t\t\r\n\t\tif (s && s.state && stateProperty !== null && s.state.value !== undefined && s.state.value[stateProperty] !== undefined) {\r\n\t\t\tdeviceState = s.state.value[stateProperty];\r\n\t\t}\r\n\t\telse if (s && s.state && stateProperty === null && s.state.value !== undefined) {\r\n\t\t\tdeviceState = s.state.value;\r\n\t\t}\r\n\t\t\r\n\t\treturn deviceState;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get an icon based on the current device state (or falls back to a default).\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateVal=default]\r\n\t * @param\t{String}\t[defaultIcon=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetIcon(stateKey, stateVal = '', defaultIcon = '?') {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'icon', stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, 'icon', stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, defaultIcon);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetOption(option, stateVal = 'default') {\r\n\t\treturn (this.options[option] && (this.options[option][stateVal] || this.options[option]['default'])) || this.options[option] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetStyle(attribute, stateKey, stateVal = 'default') {\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'styles', attribute, stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['styles', 'defaultStyles'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, {});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests all state values from the backend.\r\n\t *\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Array<Promises>}\r\n\t *\r\n\t */\r\n\trequestDeviceStates(subscribe = false) {\r\n\t\t\r\n\t\tlet responses = [];\r\n\t\tfor (let stateKey in this.states) {\r\n\t\t\tresponses.push(this.requestDeviceState(stateKey, subscribe));\r\n\t\t}\r\n\t\t\r\n\t\treturn responses;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceState(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.value !== undefined && this.stateSubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getState(s.state.node)\r\n\t\t\t\t\t.then(state => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (state === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceStateHistory(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.history !== undefined && this.historySubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('historyChange', stateKey, s.state.history);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getStateHistory(s.state.node)\r\n\t\t\t\t\t.then(history => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (history === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.history = history; // this._updateDeviceState(stateKey, state);\t\t\t// callback(err, data, step, sessionId);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('historyChange', stateKey, s.state.history);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetAction(action) {\r\n\t\tthis.options.action = action;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetComponent(component) {\r\n\t\tthis.options.label = component;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\tvalue\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsetDeviceState(stateKey = null, value) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey, 'action');\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.socket.setState(s.action.node, value)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\r\n\t\t\t\t\t// get state value if not subscribed\r\n\t\t\t\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\t\t\t\tthis.requestDeviceState(stateKey);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// resolve\r\n\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsubscribeDeviceState(stateKey = null) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\t// add subscription\t\r\n\t\tthis.stateSubscriptions.push(stateKey);\r\n\t\t\r\n\t\t// subscribe\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tthis.socket.subscribeState(s.state.node, (id, state, params) => {\r\n\t\t\t\t\r\n\t\t\t\tif (state && state.val !== this.getDeviceState(stateKey, 'val')) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// format value\r\n\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish state change\r\n\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish to children as well\r\n\t\t\t\t\tthis.children.forEach(child => child.emit('stateChange', stateKey, s.state.value));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t});\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Badge from '@material-ui/core/Badge';\r\nimport NotificationsIcon from '@material-ui/icons/Notifications';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tappBar: {\r\n\t\tflexGrow: 1,\r\n\t\tboxShadow: 'none',\r\n\t\ttransform: 'none',\r\n\t},\r\n\ttoolbar: {\r\n\t\tbackgroundColor: theme.palette.primary.main\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2),\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingRight: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TopBar(props) {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { children, title } = props;\r\n\tconst [ icon, label ] = title.indexOf('|') > -1 ? title.split('|') : [ null, title ];\r\n\treturn (\r\n\r\n<AppBar id=\"appBar\" position=\"static\" className={classes.appBar}>\r\n\r\n\t<Toolbar className={classes.toolbar}>\r\n\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t{icon && <span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>}\r\n\t\t\t{label !== 'null' && label}\r\n\t\t</Typography>\r\n\t\t{/*\r\n\t\t<IconButton color=\"inherit\">\r\n\t\t\t<Badge badgeContent={17} color=\"secondary\">\r\n\t\t\t\t<NotificationsIcon />\r\n\t\t\t</Badge>\r\n\t\t</IconButton>\r\n\t\t*/}\r\n\t</Toolbar>\r\n\t\r\n\t{children}\r\n</AppBar>\r\n\r\n\t);\r\n}\r\n","/*\r\n * by QoP <https://stackoverflow.com/users/4484822/qop>\r\n * @see https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\r\n */\r\nimport { useState, useEffect } from 'react';\r\n\r\nfunction getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\nexport default function useWindowDimensions() {\r\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      setWindowDimensions(getWindowDimensions());\r\n    }\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return windowDimensions;\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport useWindowDimensions from '../helpers/useWindowDimensions';\r\n\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Box from '@material-ui/core/Box';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingBottom: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t},\r\n\ttabs: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tpaddingLeft: theme.spacing(),\r\n\t\tcolor: '#fff',\r\n\t\twidth: 'calc(100% - ' + theme.spacing() + 'px)',\r\n\t\tzIndex: 101,\r\n\t\tborderBottom: '5px solid #eee'\r\n\t},\r\n\tfixed: {\r\n\t\tposition: 'fixed',\r\n\t\ttop: 0\r\n\t},\r\n\tindicator: {\r\n\t\tbackgroundColor: '#fff',\r\n\t},\r\n\tfullscreen: {\r\n\t\tmarginLeft: -theme.spacing(),\r\n\t\tmarginTop: '-5px',\r\n\t},\r\n\tgrid: {\r\n\t\tpaddingBottom: '30px'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TabBar(props) {\r\n\tlet { tabs, selectTab } = props;\r\n\tconst classes = useStyles();\r\n\tlet tabBarProps = useRef({});\r\n\t\r\n\t// tab\r\n\tconst [tab, setTab] = useState(0);\r\n\tconst handleChange = (event, selectedTab) => {\r\n\t\tselectTab(selectedTab, tabs[selectedTab]);\r\n\t\tsetTab(selectedTab);\r\n\t}\r\n\t\r\n\t// scroll\r\n\tconst [fixed, setFixed] = useState(false);\r\n\tconst handleScroll = useCallback(() => {\r\n\t\tconst threshold = (tabBarProps.current.top + tabBarProps.current.height - 53);\r\n\t\tconst fixed = window.scrollY >= threshold;\r\n\t\t\r\n\t\tsetFixed(prevFixed => {\r\n\t\t\tif (prevFixed !== fixed) {\r\n\t\t\t\tdocument.getElementById('root').style.paddingTop = fixed ? (threshold-5-8) + 'px' : 0;\r\n\t\t\t\treturn fixed;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevFixed;\r\n\t\t});\r\n\t\t\r\n\t}, [tabBarProps]);\r\n\r\n\tuseEffect(() => {\r\n\t\ttabBarProps.current = {\r\n\t\t\ttop: document.getElementById('tabBar').offsetTop,\r\n\t\t\theight: document.getElementById('tabBar').offsetHeight\r\n\t\t}\r\n\t\t\r\n\t\twindow.addEventListener('scroll', handleScroll);\r\n\t\treturn () => window.removeEventListener('keydown', handleScroll, 0);\r\n\t\t\r\n\t}, [handleScroll]);\r\n\t\r\n\t// render tabs\r\n\tconst renderedTabs = tabs.map((tab, i) => {\r\n\t\tconst [ icon, label ] = tab.indexOf('|') > -1 ? tab.split('|') : [ null, tab ];\r\n\t\treturn <Tab key={'tab' + i} icon={<span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>} label={!fixed && label !== 'null' ? label : null} />\r\n\t});\r\n\t\r\n\treturn (\r\n\r\n<Tabs\r\n\tid=\"tabBar\"\r\n\tvalue={tab}\r\n\tonChange={handleChange}\r\n\tvariant=\"scrollable\"\r\n\tclasses={{\r\n\t\troot: clsx(classes.tabs, fixed && classes.fixed),\r\n\t\tindicator: classes.indicator\r\n\t}}>\r\n\t\r\n\t{renderedTabs}\r\n</Tabs>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport function TabPanel(props) {\r\n\tconst { children, selectedTab, renderedTab, fullscreen } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\t// get map height based on viewport\r\n\tconst { height } = useWindowDimensions();\r\n\tconst [mapHeight, setMapHeight] = useState(height);\r\n\tlet topBarHeight = useRef({});\r\n\t\r\n\tuseEffect(() => {\r\n\t\ttopBarHeight.current = document.getElementById('appBar').offsetHeight;\r\n\t\tsetMapHeight(height-topBarHeight.current+5);\r\n\t\t\r\n\t}, [height]);\r\n\t\r\n\t/*\r\n\t * Some components need to be visible upon loading, so proper initialise.\r\n\t * Due to the 'hidden' attribute though, they might be hidden.\r\n\t * This is a workaround to initially show everything for a short period of time and then hide according to tab settings.\r\n\t *\r\n\t */\r\n\tconst [hidden, setHidden] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tsetTimeout(() => setHidden(selectedTab !== renderedTab), 10);\r\n\t\t\r\n\t}, [selectedTab, renderedTab]);\r\n\t\r\n\treturn (\r\n\r\n<Box\r\n\trole=\"tabpanel\"\r\n\thidden={hidden}\r\n\tid={'tabpanel-' + renderedTab}\r\n\tclassName={clsx(fullscreen ? classes.fullscreen : classes.grid)}\r\n\tstyle={{ height: mapHeight + 'px' }}\r\n\t>\r\n\t\r\n\t{children}\r\n</Box>\r\n\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport Connection from '../Connection';\r\nimport Device from '../Device';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\r\nimport MuiDialogContent from '@material-ui/core/DialogContent';\r\nimport MuiDialogActions from '@material-ui/core/DialogActions';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport StateList from './StateList';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n});\r\n\r\n\r\nconst DialogTitle = withStyles(styles)(props => {\r\n\tconst { children, classes, onClose, ...other } = props;\r\n\treturn (\r\n\r\n<MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n\t<Typography variant=\"h6\">{children}</Typography>\r\n\t{onClose ? (\r\n\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t<CloseIcon />\r\n\t</IconButton>\r\n\t) : null}\r\n</MuiDialogTitle>\r\n\r\n\t);\r\n});\r\n\r\nconst DialogContent = withStyles(theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(1)\r\n\t\t}\r\n\t},\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles(theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n}))(MuiDialogActions);\r\n\r\n\r\nexport default class Popup extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tchildren: []\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tlet device = this.props.contents && this.props.contents.device;\r\n\t\tif (device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\t\r\n\t\t\t// loop through states and request status\r\n\t\t\tlet responses = [];\r\n\t\t\tlet children = [];\r\n\t\t\t\r\n\t\t\tfor (let stateKey in device.states) {\r\n\t\t\t\t\r\n\t\t\t\tif (device.states[stateKey].state === undefined || device.options.hiddenStates.indexOf(stateKey) > -1) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet child = new Device({\r\n\t\t\t\t\t\t\t'parent': device,\r\n\t\t\t\t\t\t\t'id': device.id + '#' + stateKey,\r\n\t\t\t\t\t\t\t'name': device.name,\r\n\t\t\t\t\t\t\t'function': device.function,\r\n\t\t\t\t\t\t\t'states': { [stateKey]: device.states[stateKey] },\r\n\t\t\t\t\t\t\t'options': {\r\n\t\t\t\t\t\t\t\t'primary': stateKey,\r\n\t\t\t\t\t\t\t\t'divider': children.length !== 0,\r\n\t\t\t\t\t\t\t\t'subgroup': null,\r\n\t\t\t\t\t\t\t\t'subtitle': null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tConnection.getConnection,\r\n\t\t\t\t\t\twindow.language\r\n\t\t\t\t\t);\r\n\t\t\t\t\r\n\t\t\t\t// add child to parent\r\n\t\t\t\tdevice.children.push(child);\r\n\t\t\t\t\r\n\t\t\t\t// retrieve state\r\n\t\t\t\tresponses.push(child.requestDeviceState(null, true));\r\n\t\t\t\tchildren.push(child);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tPromise.allSettled(responses).then(() => {\r\n\t\t\t\tconsole.info('Retrieved ' + Object.keys(children).length + ' states for device ' + device.name + '.', responses);\r\n\t\t\t\tthis.setState({ 'children': children }, () => this.forceUpdate());\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if (!device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\tthis.setState({ 'children': [] }, () => this.forceUpdate());\r\n\t\t}\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(nextProps, nextState) {\r\n\t\treturn !this.props.contents || this.props.contents.ts !== nextProps.contents.ts;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { open, closeDialog, contents } = this.props;\r\n\t\tconst { device } = contents;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog onClose={closeDialog} open={open || false} maxWidth={'md'} fullWidth={true}>\r\n\t<DialogTitle onClose={closeDialog}>\r\n\t\t{device.name}\r\n\t</DialogTitle>\r\n\t<DialogContent dividers style={{ padding: 0 }}>\r\n\t\t\r\n\t\t<StateList openDialog={null} devices={this.state.children} component={true} action={true} />\t\r\n\t\t\r\n\t</DialogContent>\r\n\t<DialogActions>\r\n\t\t<Button autoFocus onClick={closeDialog} color=\"primary\">\r\n\t\t\tClose\r\n\t\t</Button>\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t\t);\r\n\t};\r\n}\r\n","import React from 'react';\r\n\r\nimport Card from '@material-ui/core/Card';\r\nimport CardHeader from '@material-ui/core/CardHeader';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tcard: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t},\r\n\tcardHeaderNoContents: {\r\n\t\tpadding: theme.spacing(),\r\n\t},\r\n\tcardAvatar: props => ({\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff',\r\n\t\tfontSize: '24px',\r\n\t\t...props\r\n\t}),\r\n\tcardContent: {\r\n\t\tpadding: theme.spacing(0, 2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpadding: theme.spacing(0)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Widget(props) {\r\n\tconst { title, icon, iconStyle } = props;\r\n\tconst classes = useStyles(iconStyle);\r\n\t\r\n\treturn (\r\n\r\n<Card className={classes.card}>\r\n\t<CardHeader\r\n\t\tavatar={icon !== null &&\r\n\t\t\t<Avatar variant=\"rounded\" classes={{ root: classes.cardAvatar }}>\r\n\t\t\t\t{React.createElement('span', { 'className': 'mdi mdi-' + (icon || 'home') })}\r\n\t\t\t</Avatar>\r\n\t\t}\r\n\t\ttitle={title &&\r\n\t\t\t<Typography variant=\"h5\" component=\"h2\">\r\n\t\t\t\t{title}\r\n\t\t\t</Typography>\r\n\t\t}\r\n\t/>\r\n\t<CardContent className={classes.cardContent}>\r\n\t\t{props.children}\r\n\t</CardContent>\r\n</Card>\r\n\r\n\t);\r\n}\r\n","\r\nexport default {\r\n\tStateList: require('./StateList').default,\r\n\tStateListHorizontal: require('./StateListHorizontal').default,\r\n\tMap: require('./Map').default,\r\n\tChart: require('./Chart').default\r\n}","import { createMuiTheme } from '@material-ui/core/styles';\r\nimport { pink } from '@material-ui/core/colors';\r\nimport blue from '@material-ui/core/colors/blue';\r\n\r\nconst primary = blue[700];\r\nconst secondary = pink;\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: {\r\n\t\t\tmain: primary \r\n\t\t},\r\n\t\tsecondary: secondary,\r\n\t},\r\n\tcomponents: {\r\n\t\ticon: {\r\n\t\t\tfontSize: '24px',\r\n\t\t\tcolor: primary\r\n\t\t},\r\n\t\t'finger': {\r\n\t\t\tcursor: 'pointer'\r\n\t\t}\r\n\t}\r\n});\r\n\r\nconsole.debug(theme);\r\nexport default theme;","import React from 'react';\n\n//import Drawer from '@material-ui/core/Drawer';\n\nimport TopBar from './components/TopBar';\nimport TabBar, { TabPanel } from './components/TabBar';\nimport GridContainer from './components/GridContainer';\nimport Popup from './components/Popup';\nimport Widget from './components/Widget';\nimport COMPONENTS from './components';\n\n\n/*\n * STYLES\n */\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport theme from './theme';\n\n\n/*\n *\n */\nconst getGroup = (groupId, group, props = {}) => {\n\t\n\t// group empty\n\tif (!group) {\n\t\tconsole.error('Group ' + groupId + ' defined in columns but not assigned to any devices!');\n\t\treturn null;\n\t}\n\t\n\t// get module for component\n\tgroup.settings.component = typeof group.settings.component === 'string' ? { 'module': group.settings.component } : (group.settings.component || {})\n\tconst Tag = COMPONENTS[group.settings.component.module || 'StateList'];\n\tif (Tag === undefined) {\n\t\tconsole.error('Undefined component \"' + group.settings.component + '\" used!');\n\t\treturn null;\n\t}\n\t\n\treturn <Tag key={'Tag' + groupId} devices={group.devices} openDialog={props.action ? props.action : null} settings={{ ...group.settings, ...props }} />\n}\n\n\n/*\n *\n */\nconst getGridContents = (contents, groups, props = {}) => {\n\t\n\tlet gridContents = {};\n\tconst columns = Object.keys(contents).length;\n\t\n\tfor (let column = 1; column <= columns; column++) {\n\t\t\n\t\tlet columnContents = contents[column];\n\t\tgridContents[column] = gridContents[column] || [];\n\t\t\n\t\t// no contents, thus add placeholder\n\t\tif (!columnContents || columnContents.length === 0) {\n\t\t\tgridContents[column].push(null);\n\t\t}\n\t\t\n\t\t// add contents\n\t\telse {\n\t\t\tfor (let index in columnContents) {\n\t\t\t\t\n\t\t\t\tlet groupId = columnContents[index];\n\t\t\t\tlet group = groups[groupId];\n\t\t\t\t\n\t\t\t\tlet content = getGroup(groupId, group, props);\n\t\t\t\tif (content) {\n\t\t\t\t\tgridContents[column].push(\n\t\t\t\t\t\t<Widget key={'Box-' + groupId + '-' + index} title={group.settings.title !== null ? (group.settings.title || group.name) : null} icon={group.settings.icon} iconStyle={group.settings.iconStyle}>\n\t\t\t\t\t\t\t{content}\n\t\t\t\t\t\t</Widget>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn gridContents;\n}\n\n\nexport default class Jarvis extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tselectedTab: 0,\n\t\t\ttabTitle: '',\n\t\t\t\n\t\t\tnotificationDrawer: false,\n\t\t\tdialog: false,\n\t\t\tdialogContents: {\n\t\t\t\t'ts': 0,\n\t\t\t\t'device': {}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// bind methods\n\t\tthis.closeDialog = this.closeDialog.bind(this);\n\t\tthis.openDialog = this.openDialog.bind(this);\n\t\tthis.selectTab = this.selectTab.bind(this);\n\t\t//this.toggleDrawer = this.toggleDrawer.bind(this);\n\t\t\n\t\t// initialise\n\t\tthis.gridContents = {};\n\t\tthis.layout = this.props.settings.layout;\n\t\tthis.tabs = Object.keys(this.layout);\n\t\tthis.tabsEnabled = this.tabs[0] !== 1;\n\t\tthis.state.tabTitle = this.tabs[this.state.selectedTab];\n\t\t\n\t\t// no tabs defined, so layout wrap into default tab\n\t\tif (!this.tabsEnabled) {\n\t\t\tthis.layout = { 'Home': this.layout };\n\t\t\tthis.tabs.push('1');\n\t\t}\n\t\t\n\t\t// widget props\n\t\tthis.widgetProps = {}\n\t}\n\t\n\tgetTabPanels() {\n\t\t\n\t\tlet tab = 0;\n\t\tlet tabPanels = [];\n\t\tfor (let tabLabel in this.layout) {\n\t\t\tconst contents = this.layout[tabLabel];\n\t\t\t\n\t\t\t// fullscreen in component\n\t\t\tif (!this.gridContents[tabLabel] && typeof contents === 'string') {\n\t\t\t\tthis.gridContents[tabLabel] = getGroup(contents, this.props.groups[contents], { action: this.openDialog, ...this.widgetProps });\n\t\t\t}\n\t\t\t\n\t\t\t// grid layout\n\t\t\telse if (!this.gridContents[tabLabel]) {\n\t\t\t\tthis.gridContents[tabLabel] = <GridContainer contents={getGridContents(contents, this.props.groups, { action: this.openDialog, ...this.widgetProps })} />\n\t\t\t}\n\t\t\t\n\t\t\tlet tabPanel = (\n\t\t\t\t<TabPanel key={'tabPanel-' + tab} renderedTab={tab} selectedTab={this.state.selectedTab} fullscreen={typeof contents === 'string'}>\n\t\t\t\t\t{this.gridContents[tabLabel]}\n\t\t\t\t</TabPanel>\n\t\t\t);\n\t\t\t\n\t\t\ttabPanels.push(tabPanel);\n\t\t\ttab++;\n\t\t}\n\t\t\n\t\treturn tabPanels;\n\t}\n\t\n\tcloseDialog() {\n\t\tthis.setState({ 'dialog': false, 'dialogContents': { 'ts': Date.now(), 'device': {} } });\n\t}\n\t\n\topenDialog(device) {\n\t\tthis.setState({ 'dialog': true, 'dialogContents': { 'ts': Date.now(), 'device': device } });\n\t}\n\t\n\tselectTab(tab, title) {\n\t\tthis.setState({ selectedTab: tab, tabTitle: title });\n\t}\n\t\n\t/*\n\ttoggleDrawer(drawer, open) {\n\t\tthis.setState({ [drawer]: open });\n\t};\n\t*/\n\t\n    render() {\n        return (\n\n<ThemeProvider theme={theme}>\n\t<TopBar title={this.props.settings.topBarTitle || (this.tabsEnabled && this.state.tabTitle) || 'jarvis'}>\n\t\t{this.tabsEnabled && <TabBar tabs={this.tabs} selectTab={this.selectTab} />}\n\t</TopBar>\n\t\n\t{/*\n\t<Drawer anchor=\"right\" open={this.state.notificationDrawer} onClose={this.toggleDrawer('notificationDrawer', false)}>\n\t\t\n\t</Drawer>\n\t*/}\n\n\t<Popup open={this.state.dialog} contents={this.state.dialogContents} closeDialog={this.closeDialog} />\n\t{this.getTabPanels()}\n\t\n</ThemeProvider>\n\n\t\t)\n\t}\n}\n","import React from 'react';\nimport LogRocket from 'logrocket';\nimport uuid from 'uuid/v3';\n\nimport Grid from '@material-ui/core/Grid';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Typography from '@material-ui/core/Typography';\nimport Skeleton from '@material-ui/lab/Skeleton';\n\nimport GridContainer from './components/GridContainer';\nimport StatusSnackbar from './components/StatusSnackbar';\n\nimport i18n from './i18n';\nimport Connection from './Connection';\nimport Device from './Device';\nimport Jarvis from './Jarvis';\n\n\n/*\n * STYLES\n */\nimport { withStyles } from '@material-ui/core/styles';\nconst styles = theme => ({\n\tloading: {\n\t\tmargin: '10px 0 0 0',\n\t\tcolor: '#999'\n\t},\n\tgridItem: {\n\t\tmargin: theme.spacing(1, 1, 0, 0),\n\t\t[theme.breakpoints.down('md')]: {\n\t\t\tmarginRight: theme.spacing(0.4, 0.4, 0, 0)\n\t\t}\n\t}\n});\n\n\n/*\n * CONSTANTS\n *\n */\nconst NODE_SETTINGS = 'jarvis.0.settings';\nconst NODE_DEVICES = 'jarvis.0.devices';\n\n\nclass App extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tloaded: [],\n\t\t\terror: false,\n\t\t\terrorMessage: ''\n\t\t}\n\t};\n\t\n\tcomponentDidMount() {\n\t\t\n\t\t// connect and get connection\n\t\tconst noErrorFunction = () => this.setState({ error: false, errorMessage: '' });\n\t\tconst url = window.location.hostname === 'localhost' ? 'https://192.168.178.29:8082' : null;\n\t\tconst listeners = [\n\t\t\t{ 'event': 'connect', 'callback': noErrorFunction },\n\t\t\t{ 'event': 'reconnect', 'callback': noErrorFunction },\n\t\t\t{ 'event': 'disconnect', 'callback': noErrorFunction },\n\t\t\t{ 'event': 'error', 'callback': err => this.setState({ error: true, errorMessage: i18n.t('Connection lost! Trying to reconnect') + '..' }) }\n\t\t];\n\t\t\n\t\tthis.socket = Connection.connect(url, listeners);\n\t\t\n\t\t\n\t\t// retrieve settings\n\t\tthis.settings = {};\n\t\tthis.socket.getState(NODE_SETTINGS)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.settings = state && JSON.parse(state.val);\n\t\t\t\t\tthis.useSettings();\n\t\t\t\t\tthis.setState({ loaded: [...this.state.loaded, 'settings'] });\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing settings!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: err\n\t\t\t\t});\n\t\t\t});\n\t\t\n\t\t\n\t\t// retrieve devices\n\t\tthis.devices = {};\n\t\tthis.groups = {};\n\t\t\n\t\tthis.socket.getState(NODE_DEVICES)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.devices = state && JSON.parse(state.val);\n\t\t\t\t\tthis.processDevices(this.devices).then(groups => {\n\t\t\t\t\t\tthis.groups = groups;\n\t\t\t\t\t\tthis.setState({ loaded: [...this.state.loaded, 'groups'] });\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing devices!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: err\n\t\t\t\t});\n\t\t\t});\n    }\n\n\t/**\n\t *\n\t *\n\t */\n\tuseSettings() {\n\t\t\n\t\t// LogRocket\n\t\tif (this.settings.debug && this.settings.debug.name && this.settings.debug.email && this.settings.debug.email.indexOf('@') > -1) {\n\t\t\tLogRocket.init('36n1xl/jarvis');\n\t\t\t\n\t\t\tlet id = uuid(this.settings.debug.name + '#' + this.settings.debug.email, 'e63359dc-bc1c-476e-81cd-8f580d09a557');\n\t\t\tLogRocket.identify(id, {\n\t\t\t\tname: this.settings.debug.name,\n\t\t\t\temail: this.settings.debug.email\n\t\t\t});\n\t\t\t\n\t\t\tconsole.info('Opt-In for providing debugging details to the developer. Your ID is: ' + id);\n\t\t}\n\t\t\n\t\t// language\n\t\twindow.language = (this.settings.language || navigator.language || navigator.userLanguage || 'en').substr(0, 2);\n\t\ti18n.setLanguage(window.language);\n\t\ti18n.loadTranslations(['en', 'de']);\n\t\t\n\t\t// page title\n\t\tif (this.settings.pageTitle) {\n\t\t\tdocument.title = this.settings.pageTitle;\n\t\t}\n\t\t\n\t\t// favicon\n\t\tif (this.settings.pageFavicon && this.settings.pageFavicon.substr(0, 5) === 'data:') {\n\t\t\tdocument.getElementById('favicon').href = this.settings.pageFavicon;\n\t\t}\n\t\t\n\t\t// translations\n\t\tif (this.settings.translations) {\n\t\t\t\n\t\t\tlet translations = this.settings.translations;\n\t\t\tfor (let language in translations) {\n\t\t\t\ti18n.setTranslation(language, translations[language]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tgroupDevice(groups, device) {\n\t\t\n\t\t// add device to group(s)\n\t\tlet options = device.get('options');\n\t\toptions.groups.forEach(group => {\n\t\t\t\n\t\t\tlet groupId = group.toLowerCase().replace(/ /g, '');\n\t\t\tif (!groups[groupId]) {\n\t\t\t\tgroups[groupId] = { 'id': groupId, 'name': group, 'settings': (this.settings.groups && this.settings.groups[groupId]) || {}, 'devices': [device] };\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgroups[groupId].devices.push(device);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn groups;\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevice(deviceProperties) {\n\t\t\n\t\tlet promises = [];\n\t\tlet device = null;\n\t\ttry {\n\t\t\tdevice = new Device(deviceProperties, this.socket, window.language);\n\t\t\t\n\t\t\t// request primary state value\n\t\t\tpromises.push(device.requestDeviceState(null, true));\n\t\t\t\n\t\t\t// request secondary state value\n\t\t\tif (device.secondaryStateKey) {\n\t\t\t\tpromises.push(device.requestDeviceState(device.secondaryStateKey, true));\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tcatch(err) {\n\t\t\tconsole.warn(err.message);\n\t\t}\n\t\t\n\t\treturn new Promise(resolve => {\n\t\t\tPromise.allSettled(promises).then(results => {\n\t\t\t\t\n\t\t\t\tresults.forEach(result => {\n\t\t\t\t\tif (result.status === 'rejected') {\n\t\t\t\t\t\tconsole.error(result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tresolve(device);\n\t\t\t});\n\t\t});\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevices(deviceList) {\n\t\t\n\t\t// loop through all devices of in the device list\n\t\tlet promises = [];\n\t\tlet groups = {};\n\t\t\n\t\tlet devices = 0, groupedDevices = 0;\n\t\tfor (let deviceId in deviceList) {\n\t\t\tdevices++;\n\t\t\t\n\t\t\tdeviceList[deviceId].options = deviceList[deviceId].jarvis;\n\t\t\tdelete deviceList[deviceId].jarvis;\n\t\t\t\n\t\t\tlet deviceProperties = { ...deviceList[deviceId], 'id': deviceId };\n\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\n\t\t\t\tthis.processDevice(deviceProperties).then(device => {\n\t\t\t\n\t\t\t\t\tif (device !== null) {\n\t\t\t\t\t\tgroupedDevices++;\n\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t\t\t\tresolve(deviceId);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treject(deviceId);\n\t\t\t\t});\n\t\t\t}));\n\t\t\t\n\t\t\t// check states for own device settings\n\t\t\tfor (let stateKey in deviceProperties.states) {\n\t\t\t\t\n\t\t\t\tlet state = deviceProperties.states[stateKey];\n\t\t\t\tif (state && state.jarvis !== undefined) {\n\t\t\t\t\t\n\t\t\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.processDevice({ ...deviceProperties, 'id': deviceId + '#' + stateKey, 'states': { [stateKey]: state }, 'options': state.jarvis }).then(device => {\n\t\t\t\t\t\n\t\t\t\t\t\t\tif (device !== null) {\n\t\t\t\t\t\t\t\tgroupedDevices++;\n\t\t\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t\t\t\t\t\tresolve(deviceId);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treject(deviceId);\n\t\t\t\t\t\t});\n\t\t\t\t\t}));\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn new Promise(resolve => Promise.allSettled(promises).then(res => {\n\t\t\t\n\t\t\t// sort groups\n\t\t\tfor (let groupId in groups) {\n\t\t\t\tgroups[groupId].devices.sort((item1, item2) => {\n\t\t\t\t\tif (item1.options.sort > item2.options.sort) return 1;\n\t\t\t\t\telse if (item2.options.sort > item1.options.sort) return -1;\n\t\t\t\t\telse return 0;\n\t\t\t\t});\n\t\t\t}\n\t\t\n\t\t\t// return\n\t\t\tconsole.info('Processed ' + devices + ' devices. Added ' + groupedDevices + ' devices in ' + Object.keys(groups).length + ' groups.', res, groups);\n\t\t\tresolve(groups);\n\t\t}));\n\t};\n\t\n\trenderError() {\n\t\tconsole.error(JSON.stringify(this.state.errorMessage));\n\t\treturn (\n\n<StatusSnackbar\n\tkey={'StatusSnackbar'}\n\tvariant=\"error\"\n\tcloseButton={false}\n\tmessage={this.state.errorMessage.toString()}\n\t/>\n\n\t\t);\n\t}\n\t\n\trenderLoadingProgress() {\n\t\tconst { classes } = this.props;\n\t\treturn (\n\n<Grid\n\tkey=\"loadingProcess\" \n\tcontainer\n\tspacing={0}\n\tdirection=\"column\"\n\tjustify=\"center\"\n\talignItems=\"center\"\n\tstyle={{ minHeight: \"100vh\" }}\n\t>\n\n\t<CircularProgress />\n\t<Typography className={classes.loading}>{i18n.t('Retrieving settings')}...</Typography>\n\n</Grid>\n\n\t\t);\n\t};\n\t\n\trenderLoadingSkeleton(props) {\n\t\tconst { classes } = this.props;\n\t\tconst { topBar, tabBar, gridColumns } = props;\n\t\t\n\t\tconst SkeletonLoader = (props) => <Skeleton variant=\"rect\" className={classes.gridItem} height={props.height} />;\n\t\t\n\t\tlet gridContents = {}\n\t\tfor (let column = 1; column <= gridColumns; column++) {\n\t\t\tgridContents[column] = gridContents[column] || [];\n\t\t\t\n\t\t\tlet loaders = Math.random() * (5 - 2) + 2;\n\t\t\tfor (let loader = 1; loader <= loaders; loader++) {\n\t\t\t\tgridContents[column].push(<SkeletonLoader key={column + '#' + loader} height={(Math.random() * (400 - 100) + 100)} />);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn (\n\n<React.Fragment>\n\t{topBar && <Skeleton variant=\"rect\"  height={64} />}\n\t{tabBar && <Skeleton variant=\"rect\"  height={48} />}\n\t<GridContainer key=\"loadingSkeleton\" contents={gridContents} />\n</React.Fragment>\n\n\t\t);\n\t}\n\t\n    render() {\n\t\t\n\t\t// error message\n\t\tconst error = this.state.error ? this.renderError() : null;\n\t\t\n\t\t// loading screens\n\t\tif (this.state.error && this.state.loaded.length < 2) {\n\t\t\treturn error;\n\t\t}\n\t\telse if (this.state.loaded.indexOf('settings') === -1) {\n\t\t\treturn this.renderLoadingProgress();\n\t\t}\n\t\telse if (this.state.loaded.indexOf('groups') === -1) {\n\t\t\tconst tab = Object.keys(this.settings.layout)[0];\n\t\t\treturn this.renderLoadingSkeleton({ topBar: true, tabBar: tab !== 1, gridColumns: (tab !== 1 ? Object.keys(this.settings.layout[tab]).length : tab.length) });\n\t\t}\n\t\t\n\t\t// App\n\t\treturn [ error, <Jarvis key=\"jarvis\" settings={this.settings} groups={this.groups} /> ];\n\t};\n}\n\nexport default withStyles(styles)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","/**\r\n *\r\n *\r\n */\r\nfunction HsvToRgb(h, s = 1, v = 1) {\r\n\tif (Array.isArray(h)) {\r\n\t\tv = h[2];\r\n\t\ts = h[1];\r\n\t\th = h[0];\r\n\t}\r\n\telse if (typeof h === 'string' && h.indexOf(',')) {\r\n\t\t[h, s, v] = h.split(',');\r\n\t}\r\n\t\r\n\tif (h > 1) {\r\n\t\th = h/360;\r\n\t}\r\n\t\r\n\tlet r, g, b, i, f, p, q, t;\r\n\t\r\n\ti = Math.floor(h * 6);\r\n\tf = h * 6 - i;\r\n\tp = v * (1 - s);\r\n\tq = v * (1 - f * s);\r\n\tt = v * (1 - (1 - f) * s);\r\n\t\r\n\tswitch (i % 6) {\r\n\t\tcase 0:\r\n\t\t\tr = v;\r\n\t\t\tg = t;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\t\r\n\t\tcase 1:\r\n\t\t\tr = q;\r\n\t\t\tg = v;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 2:\r\n\t\t\tr = p;\r\n\t\t\tg = v;\r\n\t\t\tb = t;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 3:\r\n\t\t\tr = p;\r\n\t\t\tg = q;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 4:\r\n\t\t\tr = t;\r\n\t\t\tg = p;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 5:\r\n\t\t\tr = v;\r\n\t\t\tg = p;\r\n\t\t\tb = q;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault: // for webpack\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn [\r\n\t\tMath.round(r * 255),\r\n\t\tMath.round(g * 255),\r\n\t\tMath.round(b * 255)\r\n\t];\r\n}\r\n\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction RgbToHex(r, g, b) {\r\n\tif (Array.isArray(r)) {\r\n\t\tb = r[2];\r\n\t\tg = r[1];\r\n\t\tr = r[0];\r\n\t}\r\n\telse if (typeof r === 'string' && r.indexOf(',')) {\r\n\t\t[r, g, b] = r.split(',');\r\n\t}\r\n\t\r\n\tr = r > 1 ? r / 255 : r;\r\n\tg = g > 1 ? g / 255 : g;\r\n\tb = b > 1 ? b / 255 : b;\r\n\t\r\n\tr = Math.round(r.toString(16)*100);\r\n\tg = Math.round(g.toString(16)*100);\r\n\tb = Math.round(b.toString(16)*100);\r\n\t\r\n\tif (r.length === 1) r = '0' + r;\r\n\tif (g.length === 1) g = '0' + g;\r\n\tif (b.length === 1) b = '0' + b;\r\n\t\r\n\treturn \"#\" + r + g + b;\r\n}\r\n\r\n\r\nexport default {\r\n\tHsvToRgb,\r\n\tRgbToHex\r\n}","import React, { useState, useEffect } from 'react'\r\nimport { HuePicker, SketchPicker as ColorPicker } from 'react-color'\r\n\r\nimport helpers from '../helpers/colorConverters'\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction LightLevelAction(props) {\r\n\tconst { device, stateKey, stateVal } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked ? 100 : 0).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal > 0);\r\n\tuseEffect(() => setChecked(stateVal > 0), [stateVal]);\r\n\t\r\n\t// only show percentage if device has a switch itself\r\n\tif (device.parent && device.parent.states.power) {\r\n\t\treturn <defaults.actions.Action device={device} stateKey={stateKey} stateVal={checked} onChange={onChange} />;\r\n\t}\r\n\t\r\n\treturn <defaults.actions.PowerAction device={device} stateKey={stateKey} stateVal={checked} onChange={onChange} />\r\n}\r\n\r\nfunction LightColorAction(props) {\r\n\tconst { stateKey, stateVal } = props;\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(stateVal);\r\n\tuseEffect(() => setColorSpace(stateVal), [stateVal]);\r\n\t\r\n\tlet colors, labels = {};\r\n\tif (stateKey === 'rgb' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Red: colors[0], Green: colors[1], Blue: colors[2] };\r\n\t\t\r\n\t}\r\n\telse if (stateKey === 'hsv' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Hue: colors[0], Saturation: colors[1], Brightness: colors[2] };\r\n\t}\r\n\t\r\n\tconst Label = defaults.components.Label;\r\n\tlet label = [];\r\n\tfor (let key in labels) {\r\n\t\tlabel.push(<Label key={key} label={key + ' ' + labels[key]} br={true} />);\r\n\t}\r\n\t\r\n\treturn label;\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction LightColorTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={2000} max={6500} step={10} {...props} />\r\n\t);\r\n}\r\n\r\nfunction LightHueComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tsetHue(Math.round(color.hsl.h));\r\n\t\tdevice.setDeviceState(stateKey, Math.round(color.hsl.h)).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [hue, setHue] = useState(stateVal);\r\n\tuseEffect(() => setHue(stateVal), [stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\tconst color = helpers.RgbToHex(helpers.HsvToRgb(hue));\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<HuePicker\r\n\t\tcolor={color}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\nfunction LightColorComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tcolor = color[stateKey];\r\n\t\t\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tcolor = [color.r, color.g, color.b].join(',');\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tcolor = [color.h, color.s, color.v].join(',');\r\n\t\t}\r\n\t\t\r\n\t\tconsole.log(color);\r\n\t\tdevice.setDeviceState(stateKey, color).catch(err => console.error(err));\r\n\t};\r\n\t\r\n\tlet initialColor = stateVal || '#ffffff';\r\n\t\r\n\t// RGB\r\n\tif (stateKey === 'rgb') {\r\n\t\tinitialColor = helpers.RgbToHex(initialColor);\r\n\t}\r\n\t// HSV\r\n\telse if (stateKey === 'hsv') {\r\n\t\tinitialColor = helpers.RgbToHex(helpers.HsvToRgb(initialColor));\r\n\t}\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(initialColor);\r\n\tuseEffect(() => {\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(stateVal));\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(helpers.HsvToRgb(stateVal)));\r\n\t\t}\r\n\t\t// HEX\r\n\t\telse if (stateKey === 'hex') {\r\n\t\t\tsetColorSpace(stateVal);\r\n\t\t}\r\n\t}, [stateKey, stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<ColorPicker\r\n\t\tcolor={colorSpace}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\nconst color = {\r\n\ticon: {\r\n\t\t'default': 'palette',\r\n\t},\r\n\tunit: ' °'\r\n}\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tpower: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'lightbulb-on',\r\n\t\t\t\t'false': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tvalue: (val) => val > 0 && val <= 1 ? val * 100 : val,\r\n\t\t\tunit: (value) => value !== 'off' ? ' %' : null,\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'lightbulb-on',\r\n\t\t\t\t'0': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': 'off'\r\n\t\t\t},\r\n\t\t},\r\n\t\tcolorTemperature: {\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'thermometer',\r\n\t\t\t},\r\n\t\t\tunit: ' °K'\r\n\t\t},\r\n\t\thue: color,\r\n\t\trgb: color,\r\n\t\thsv: color,\r\n\t\thex: color\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel: defaults.components.LevelComponent,\r\n\t\tcolorTemperature: LightColorTemperatureComponent,\r\n\t\trgb: LightColorComponent,\r\n\t\thsv: LightColorComponent,\r\n\t\thex: LightColorComponent,\r\n\t\thue: LightHueComponent\r\n\t},\r\n\tactions: {\r\n\t\tpower: defaults.actions.PowerAction,\r\n\t\tlevel: LightLevelAction,\r\n\t\trgb: LightColorAction,\r\n\t\thsv: LightColorAction,\r\n\t\thex: LightColorAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListDivider: {\r\n\t\tmargin: '0 0 5px 0'\r\n\t},\r\n\tdefaultListSectionDivider: {\r\n\t\tmargin: '5px 0 0 0'\r\n\t},\r\n\tdefaultListSectionText: {\r\n\t\tmargin: '5px 0 0 0',\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: '5px 0 0 10px',\r\n\t\t}\r\n\t},\r\n\tdefaultListIcon: props => ({\r\n\t\t...theme.components.icon,\r\n\t\t...props.styles\r\n\t}),\r\n\thorizontalListItem: {\r\n\t\tdisplay: 'inline-block',\r\n\t\ttextAlign: 'center',\r\n\t\tpaddingRight: '16px',\r\n\t\twidth: '150px',\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\thorizontalListItemIcon: {\r\n\t\tminWidth: 'auto'\r\n\t},\r\n\thorizontalListItemAction: {\r\n\t\ttextAlign: 'center',\r\n\t\ttop: 0,\r\n\t\tright: 0,\r\n\t\tposition: 'static',\r\n\t\ttransform: 'none',\r\n\t},\r\n\tverticalListItemAction: {\r\n\t\ttextAlign: 'right'\r\n\t},\r\n});\r\n\r\n\r\nconst ListDivider = withStyles(styles)(props => {\r\n\tconst { classes, title } = props;\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t<ListItem divider className={classes.defaultListSectionDivider} />\r\n\t<li>\r\n\t\t<Typography\r\n\t\t\tclassName={classes.defaultListSectionText}\r\n\t\t\tdisplay=\"block\"\r\n\t\t\tvariant=\"caption\"\r\n\t\t>\r\n\t\t{title}\r\n\t\t</Typography>\r\n\t</li>\r\n</React.Fragment>\r\n\t\r\n\t);\r\n});\r\n\r\nconst ListItemIconElement = withStyles(styles)(props => {\r\n\tconst { customClassNames, children, classes } = props;\r\n\t\r\n\tlet classNames = Array.isArray(customClassNames) ? customClassNames : [customClassNames];\r\n\tclassNames = classNames.map(className => (classes[className] ? classes[className] : className));\r\n\t\r\n\treturn <span className={clsx(classNames)}>{children}</span>\r\n});\r\n\r\n\r\nclass StateListItem extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t\tthis.state[this.props.device.primaryStateKey] = this.props.device.getDeviceState() || {}\r\n\t\t\r\n\t\tif (this.props.device.secondaryStateKey) {\r\n\t\t\tthis.state[this.props.device.secondaryStateKey] = this.props.device.getDeviceState(this.props.device.secondaryStateKey) || {}\r\n\t\t}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\tthis.props.device.on('stateChange', (stateKey, state) => {\r\n\t\t\tif (stateKey === this.props.device.primaryStateKey || stateKey === this.props.device.secondaryStateKey) {\r\n\t\t\t\tthis.setState({ [stateKey]: state });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, prevSubgroup, device, component, action } = this.props;\r\n\t\t\r\n\t\tconst state = this.state[device.primaryStateKey];\r\n\t\tconst options = device.get('options');\r\n\t\t\r\n\t\tlet icon = device.getIcon(device.primaryStateKey, state.val);\r\n\t\tlet primary = device.getAction();\r\n\t\tlet secondary = action && this.state[device.secondaryStateKey] ? device.getAction(device.secondaryStateKey) : null;\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{options.divider && options.divider !== 'after' && <ListItem divider className={classes.defaultListDivider} />}\r\n\t{prevSubgroup !== null && options.subgroup !== null && options.subgroup !== prevSubgroup && <ListDivider title={options.subgroup} />}\r\n\t\r\n\t<ListItem\r\n\t\tclassName={clsx(this.props.openDialog && classes.finger, horizontal && classes.horizontalListItem)}\r\n\t\tbutton={this.props.openDialog !== null}\r\n\t\tonClick={this.props.openDialog && this.openDialog.bind(this)}\r\n\t\t>\r\n\t\t\r\n\t\t<ListItemIcon className={clsx(horizontal && classes.horizontalListItemIcon)}>\r\n\t\t{icon === null ? <React.Fragment /> :\r\n\t\t\t<ListItemIconElement customClassNames={['defaultListIcon','mdi mdi-' + icon]} styles={device.getStyle('icon', device.primaryStateKey, state.val)} />\r\n\t\t}\r\n\t\t</ListItemIcon>\r\n\t\t\r\n\t\t<ListItemText\r\n\t\t\tprimary={(component && device.getComponent()) || device.getOption('label')}\r\n\t\t\tsecondary={(options.subtitle !== null ? (options.subtitle || (state && state.timeChanged) || null) : null)}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={ horizontal ? classes.horizontalListItemAction : classes.verticalListItemAction }>\r\n\t\t\t{!secondary ? primary : [ primary, <br key={'br_' + device.id} />, secondary ]}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t\r\n\t{options.divider && options.divider === 'after' && <ListItem divider style={{margin: '5px 0'}} />}\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateListItem);\r\n","import React from 'react';\r\n\r\nimport List from '@material-ui/core/List';\r\nimport StateListItem from './StateListItem';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\thorizontalList: {\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'row',\r\n\t\tflexWrap: 'wrap'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function StateList(props) {\r\n\tconst { horizontal, openDialog, devices, component, action } = props;\r\n\tconst classes = useStyles();\r\n\tlet subgroup;\r\n\t\r\n\treturn (\r\n\r\n<List dense={true} className={horizontal && classes.horizontalList}>\r\n\t{devices.map(device => {\r\n\t\tconst listItem = <StateListItem\r\n\t\t\t\t\t\t\tkey={device.get('id')}\r\n\t\t\t\t\t\t\thorizontal={horizontal}\r\n\t\t\t\t\t\t\topenDialog={openDialog}\r\n\t\t\t\t\t\t\tprevSubgroup={subgroup}\r\n\t\t\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t\t\tcomponent={component || false}\r\n\t\t\t\t\t\t\taction={action || true}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tsubgroup = device.getOption('subgroup');\r\n\t\treturn listItem;\r\n\t})}\r\n</List>\r\n\r\n\t);\r\n}\r\n"],"sourceRoot":""}