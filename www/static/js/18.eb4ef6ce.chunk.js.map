{"version":3,"sources":["components/Collapsible.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toArray.js","pages/ConfigurationPage/DevicesPage/ComponentConfigPage.js","pages/ConfigurationPage/DevicesPage/JsonEditor.js","pages/ConfigurationPage/DevicesPage/Devices.config.js","pages/ConfigurationPage/DevicesPage/StateExplorer.js","pages/ConfigurationPage/DevicesPage/DevicesPage.js","../node_modules/@material-ui/icons/Edit.js","../node_modules/@material-ui/icons/KeyboardArrowRight.js","../node_modules/@material-ui/icons/Add.js"],"names":["useStyles","makeStyles","theme","transition","duration","transitions","shortest","expanded","Collapsible","position","create","left","top","right","height","content","opacity","backgroundColor","palette","divider","display","margin","marginTop","marginBottom","CollapsibleSummary","minHeight","padding","spacing","CollapsibleSummaryContent","flexGrow","CollapsibleSummaryExpandIcon","transform","CollapsibleDetails","CollapsibleContext","React","createContext","forwardRef","props","ref","arr","defaultExpanded","childrenProp","children","className","other","classes","useState","undefined","setExpanded","handleChange","useCallback","event","Children","toArray","arrayWithHoles","iterableToArray","unsupportedIterableToArray","nonIterableRest","summary","contextValue","useMemo","toggle","Paper","elevation","root","clsx","Provider","value","Collapse","in","timeout","aria-labelledby","id","role","expandIcon","onClick","onBlur","onFocusVisible","useContext","ButtonBase","focusRipple","disableRipple","component","aria-expanded","stopPropagation","IconButton","size","tabIndex","aria-hidden","ComponentConfig","memo","Log","_","_onClose","_onChange","config","attributes","open","setOpen","useEffect","componentConfiguration","Object","keys","map","configKey","configOption","val","_translate","info","otherConfigOption","label","i18n","t","selection","Tag","Inputs","type","key","disableTypography","container","item","width","inputProps","style","textAlign","onChange","header","actions","Button","variant","color","dense","maxWidth","fullWidth","disablePadding","JsonEditor","mode","allowedModes","htmlElementProps","JsonEditorPopup","indexOf","Error","TreeView","TreeItem","text","secondary","action","hover","TreeItemContent","paddingRight","TreeItemError","error","light","textDecoration","cursor","fontWeight","TreeItemExpanded","TreeItemSelected","TreeItemGroup","paddingLeft","TreeItemLabel","Entry","alignItems","Group","EntryIcon","marginRight","EntryText","indexObjects","list","index","objectsTree","objectId","substr","lastIndexOf","namespace","push","StateExplorer","Cache","get","objectList","setObjectList","selectedItem","useRef","searchTimeout","Connection","connection","getObjects","then","res","forEach","promise","i","status","Array","isArray","rows","obj","sort","tree","_objectList","Date","now","set","catch","message","stack","Fieldset","Text","clearTimeout","current","setTimeout","data","filter","toLowerCase","prevObjectList","timeConverter","parseDate","updated","startIcon","defaultCollapseIcon","defaultExpandIcon","onNodeSelect","e","renderTree","states","channelKey","length","concat","stateKey","Item","nodeId","channel","details","group","otherProps","selected","common","name","GroupIcon","StateIcon","caption","title","arrow","getLanguage","StateExplorerPopup","state","onClose","s","iconContainer","flexDirection","alignRight","justifyContent","marginLeft","ModifyIcon","verticalAlign","heading","ListItem","drag","userSelect","isDragging","_merge","require","_copy","DevicesPage","device","setDevice","errors","setErrors","EDITOR","prevErrors","nextErrors","_addState","newStateKey","replace","prevDevice","_addDefaultStates","func","FUNCTIONS","stateKeys","reverse","substitute","xs","onDelete","savedDevice","options","split","base","characteristic","param","_updated","onSave","_onSave","disabled","FieldsetItem","columns","autoFocus","required","Select","function","funcKey","FUNCTION_ICONS","sortOptionsByKey","icon","Switch","suppressPopup","DeviceStates","_renameState","nextDevice","splice","sKey","_moveState","source","destination","_deleteState","AddDeviceState","StateAddRef","setError","onAddState","_setNewStateKey","shrink","onEnter","renderedStates","DragDeviceState","onDragEnd","droppableId","provided","snapshot","innerRef","droppableProps","placeholder","draggableId","draggableProps","dragHandleProps","DeviceState","fields","DevicesStates","field","DeviceStateField","prompt","fontSize","noPadding","fieldProps","deviceDefaults","json","DeviceStateFieldJsonEditor","DeviceStateFieldAutoComplete","DeviceStateFieldStateExplorer","DeviceStateFieldOther","node","setValue","showJsonEditor","setShowJsonEditor","additionalProps","Fragment","DeviceStateFieldInput","setVal","showStateExplorer","setShowStateExplorer","components","option","getComponents","componentConfig","setComponentConfig","property","componentsOptions","userConfig","c","renderOption","Input","ucFirst","_interopRequireDefault","_interopRequireWildcard","defineProperty","exports","default","_default","createElement","d"],"mappings":"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","file":"static/js/18.eb4ef6ce.chunk.js","sourcesContent":["import React, { useState, useCallback, useMemo } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ButtonBase from '@material-ui/core/ButtonBase'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Collapse from '@material-ui/core/Collapse'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport ExpandIcon from '@material-ui/icons/KeyboardArrowRight'\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => {\r\n\tconst transition = {\r\n\t\tduration: theme.transitions.duration.shortest,\r\n\t};\r\n\t\r\n\treturn {\r\n\t\texpanded: {\r\n\t\t},\r\n\t\tCollapsible: {\r\n\t\t\tposition: 'relative',\r\n\t\t\ttransition: theme.transitions.create(['margin'], transition),\r\n\t\t\t'&:before': {\r\n\t\t\t\tposition: 'absolute',\r\n\t\t\t\tleft: 0,\r\n\t\t\t\ttop: -1,\r\n\t\t\t\tright: 0,\r\n\t\t\t\theight: 1,\r\n\t\t\t\tcontent: '\"\"',\r\n\t\t\t\topacity: 1,\r\n\t\t\t\tbackgroundColor: theme.palette.divider,\r\n\t\t\t\ttransition: theme.transitions.create(['opacity', 'background-color'], transition),\r\n\t\t\t},\r\n\t\t\t'&:first-child': {\r\n\t\t\t\t'&:before': {\r\n\t\t\t\t\tdisplay: 'none',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t'&$expanded': {\r\n\t\t\t\tmargin: '16px 0',\r\n\t\t\t\t'&:first-child': {\r\n\t\t\t\t\tmarginTop: 0,\r\n\t\t\t\t},\r\n\t\t\t\t'&:last-child': {\r\n\t\t\t\t\tmarginBottom: 0,\r\n\t\t\t\t},\r\n\t\t\t\t'&:before': {\r\n\t\t\t\t\topacity: 0,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t'&$expanded + &': {\r\n\t\t\t\t'&:before': {\r\n\t\t\t\t\tdisplay: 'none',\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t},\r\n\t\tCollapsibleSummary: {\r\n\t\t\tdisplay: 'flex',\r\n\t\t\tminHeight: 8 * 6,\r\n\t\t\ttransition: theme.transitions.create(['min-height', 'background-color'], transition),\r\n\t\t\tpadding: theme.spacing(0, 2),\r\n\t\t\t'&$expanded': {\r\n\t\t\t\tminHeight: 64,\r\n\t\t\t}\r\n\t\t},\r\n\t\tCollapsibleSummaryContent: {\r\n\t\t\tdisplay: 'flex',\r\n\t\t\tflexGrow: 1,\r\n\t\t\ttransition: theme.transitions.create(['margin'], transition),\r\n\t\t\tmargin: '12px 0',\r\n\t\t\t\r\n\t\t\t'&$expanded': {\r\n\t\t\t\tmargin: '20px 0',\r\n\t\t\t},\r\n\t\t},\r\n\t\tCollapsibleSummaryExpandIcon: {\r\n\t\t\ttransform: 'rotate(0deg)',\r\n\t\t\ttransition: theme.transitions.create('transform', transition),\r\n\t\t\t'&:hover': {\r\n\t\t\t\t// Disable the hover effect for the IconButton,\r\n\t\t\t\t// because a hover effect should apply to the entire Expand button and\r\n\t\t\t\t// not only to the IconButton.\r\n\t\t\t\tbackgroundColor: 'transparent',\r\n\t\t\t},\r\n\t\t\t'&$expanded': {\r\n\t\t\t\ttransform: 'rotate(90deg)',\r\n\t\t\t},\r\n\t\t},\r\n\t\tCollapsibleDetails: {\r\n\t\t\t//display: 'flex',\r\n\t\t\tpadding: theme.spacing(0, 2, 2, 4),\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst CollapsibleContext = React.createContext({});\r\n\r\nexport default React.forwardRef(function Collapsible(props, ref) {\r\n\tconst { expanded: defaultExpanded, children: childrenProp, className, ...other } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [expanded, setExpanded] = useState(defaultExpanded !== undefined ? defaultExpanded : false);\r\n\tconst handleChange = useCallback(\r\n\t\t(event) => {\r\n\t\t\tsetExpanded(!expanded);\r\n\t\t},\r\n\t\t[expanded, setExpanded]\r\n\t);\r\n\t\r\n\tconst [summary, ...children] = React.Children.toArray(childrenProp);\r\n\tconst contextValue = useMemo(() => ({ expanded, toggle: handleChange }), [ expanded, handleChange ]);\r\n\t\r\n\treturn (\r\n\t\t<Paper\r\n\t\t\televation={0} \r\n\t\t\tclasses={{ root: clsx(classes.Collapsible, { [classes.expanded]: expanded }, className) }}\r\n\t\t\tref={ref}\r\n\t\t\t{...other}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<CollapsibleContext.Provider value={contextValue}>{summary}</CollapsibleContext.Provider>\r\n\t\t\t<Collapse in={expanded} timeout=\"auto\">\r\n\t\t\t\t<div aria-labelledby={summary.props.id} id={summary.props['aria-controls']} role=\"region\">\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</div>\r\n\t\t\t</Collapse>\r\n\t\t</Paper>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nexport const CollapsibleSummary = React.forwardRef(function CollapsibleSummary(props, ref) {\r\n\tconst { children, className, expandIcon, onBlur, onClick, onFocusVisible, ...other } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { expanded, toggle } = React.useContext(CollapsibleContext);\r\n\tconst handleChange = (event) => {\r\n\t\tevent.stopPropagation();\r\n\t\t\r\n\t\tif (toggle) {\r\n\t\t\ttoggle(event);\r\n\t\t}\r\n\t\tif (onClick) {\r\n\t\t\tonClick(event);\r\n\t\t}\r\n\t};\r\n\t\r\n\treturn (\r\n\t\t<ButtonBase\r\n\t\t\tfocusRipple={false}\r\n\t\t\tdisableRipple\r\n\t\t\tcomponent=\"div\"\r\n\t\t\taria-expanded={expanded}\r\n\t\t\tclassName={clsx(classes.CollapsibleSummary, { [classes.expanded]: expanded }, className)}\r\n\t\t\tonClick={handleChange}\r\n\t\t\tref={ref}\r\n\t\t\t{...other}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<IconButton\r\n\t\t\t\tclassName={clsx(classes.CollapsibleSummaryExpandIcon, { [classes.expanded]: expanded })}\r\n\t\t\t\tcomponent=\"div\"\r\n\t\t\t\tsize=\"small\"\r\n\t\t\t\ttabIndex={null}\r\n\t\t\t\trole={null}\r\n\t\t\t\taria-hidden\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{expandIcon ? expandIcon : <ExpandIcon />}\r\n\t\t\t</IconButton>\r\n\t\t\t<div className={clsx(classes.CollapsibleSummaryContent, { [classes.expanded]: expanded })}>\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</ButtonBase>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nexport const CollapsibleDetails = React.forwardRef(function CollapsibleDetails(props, ref) {\r\n\tconst { className, ...other } = props;\r\n\tconst classes = useStyles();\r\n\r\n\treturn <div className={clsx(classes.CollapsibleDetails, className)} ref={ref} {...other} />;\r\n});\r\n","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}","import React, { useState, useEffect } from 'react'\r\n//import clsx from 'clsx'\r\n\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Info from '../../../components/Info'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n}));\r\n */\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst ComponentConfig = React.memo(props => {\r\n\tLog._('WidgetPage', 'RENDER ComponentConfig', 'development');\r\n\t//const classes = useStyles();\r\n\tconst { _onClose, _onChange, id, config, attributes } = props;\r\n\t\r\n\tconst [open,setOpen] = useState(false);\r\n\tconst onClose = () => {\r\n\t\tsetOpen(false)\r\n\t\t_onClose();\r\n\t}\r\n\t\r\n\tuseEffect(() => {\r\n\t\tsetOpen(config !== null);\r\n\t}, [config]);\r\n\t\r\n\tif (id === null || config === null || config === undefined) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t// component configuration\r\n\tconst componentConfiguration = Object.keys(config).map(configKey => {\r\n\t\tlet configOption = config[configKey];\r\n\t\tconfigOption = typeof configOption === 'object' ? configOption : { 'label': configKey, 'val': configOption.val !== undefined ? configOption.val : configOption }\r\n\t\tlet { _translate, info, ...otherConfigOption } = configOption;\r\n\t\t\r\n\t\totherConfigOption.label = configOption.label || configKey;\r\n\t\totherConfigOption.label = _translate ? i18n.t(configOption.label) : configOption.label;\r\n\t\totherConfigOption.val = _translate ? i18n.t(configOption.val) : configOption.val;\r\n\t\totherConfigOption.selection = typeof otherConfigOption.selection === 'function' ? otherConfigOption.selection(props) : otherConfigOption.selection;\r\n\t\t\r\n\t\tconst Tag = Inputs[configOption.type || 'Text'];\r\n\t\treturn (\r\n\t\t\t<ListItem key={'Config-' + configKey} divider>\r\n\t\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t\t<Grid container spacing={1}>\r\n\t\t\t\t\t\t<Grid item><Info info={info} /></Grid>\r\n\t\t\t\t\t\t<Grid item><Typography>{i18n.t(otherConfigOption.label)}</Typography></Grid>\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</ListItemText>\r\n\t\t\t\t\r\n\t\t\t\t<ListItemSecondaryAction>\r\n\t\t\t\t\t<Tag\r\n\t\t\t\t\t\tkey={'componentConfig.' + id + '.' + configKey}\r\n\t\t\t\t\t\tid={'componentConfig.' + id + '.' + configKey}\r\n\t\t\t\t\t\t{...otherConfigOption}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel=''\r\n\t\t\t\t\t\twidth={180}\r\n\t\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\t\tstyle: { textAlign: 'right' }\r\n\t\t\t\t\t\t}} \r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tonChange={(props, val) => _onChange(props, val, attributes)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</ListItemSecondaryAction>\r\n\t\t\t</ListItem>\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('Component configuration')}\r\n\t\t\tactions={\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={onClose} color=\"primary\" label=\"Apply\" />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='xs'\r\n\t\t\tfullWidth={true}\r\n\t\t\topen={open}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<List dense disablePadding>\r\n\t\t\t\t{componentConfiguration}\r\n\t\t\t</List>\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default ComponentConfig;\r\n","import React from 'react'\r\n//import clsx from 'clsx'\r\n\r\nimport i18n from '../../../controller/i18n'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\nimport { JsonEditor as Editor } from 'jsoneditor-react'\r\nimport 'jsoneditor-react/es/editor.min.css'\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst JsonEditor = React.forwardRef((props, ref) => {\r\n\tconst { val, height, _onChange } = props;\r\n\t\r\n\treturn (\r\n\t\t<Editor\r\n\t\t\tref={ref}\r\n\t\t\tvalue={val || {}}\r\n\t\t\tmode='text'\r\n\t\t\tallowedModes={['tree', 'view', 'form', 'text']}\r\n\t\t\thtmlElementProps={{ style: { 'height': height || 0, 'display': !height ? 'none' : 'block' } }}\r\n\t\t\tonChange={_onChange}\r\n\t\t\t/>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nexport const JsonEditorPopup = React.memo(props => {\r\n\tconst { open, _onClose } = props;\r\n\t\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('JSON Editor')}\r\n\t\t\tactions={\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={_onClose} color=\"primary\" label=\"Apply\" />\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='sm'\r\n\t\t\tfullWidth={true}\r\n\t\t\topen={open}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<JsonEditor {...props} />\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default JsonEditor;\r\n","\r\n\r\nexport default {\r\n\t\"state\": {\r\n\t\t\"label\": \"config#Devices#state#label\",\r\n\t\t\"info\": \"config#Devices#state#info\",\r\n\t\t\r\n\t\t//<IGNORE>\r\n\t\t// white space not allowed\r\n\t\t\"onValidate\": val => {\r\n\t\t\tif (val.indexOf(' ') > -1) {\r\n\t\t\t\tthrow new Error('No whitespaces allowed in the state');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn val;\r\n\t\t}//</IGNORE>\r\n\t},\r\n\t\"stateStyle\": {\r\n\t\t\"label\": \"config#Devices#stateStyle#label\",\r\n\t\t\"info\": \"config#Devices#stateStyle#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"properties\": {\r\n\t\t\"label\": \"config#Devices#properties#label\",\r\n\t\t\"info\": \"config#Devices#properties#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"display\": {\r\n\t\t\"label\": \"config#Devices#display#label\",\r\n\t\t\"info\": \"config#Devices#display#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"label\": {\r\n\t\t\"label\": \"config#Devices#label#label\",\r\n\t\t\"info\": \"config#Devices#label#info\"\r\n\t},\r\n\t\"unit\": {\r\n\t\t\"label\": \"config#Devices#unit#label\",\r\n\t\t\"info\": \"config#Devices#unit#info\",\r\n\t\t\"json\": true,\r\n\t\t\r\n\t\t// if only a single string is given for a unit, convert it to a json compatible format to it will pass validation later\r\n\t\t\"onValidate\": val => val.indexOf(\" \") === -1 && val.indexOf('\"') === -1 && val.indexOf(\"}\") === -1 && val.indexOf(\"{\") === -1 ? '\"' + val + '\"' : val\r\n\t},\r\n\t\"icon\": {\r\n\t\t\"label\": \"config#Devices#icon#label\",\r\n\t\t\"info\": \"config#Devices#icon#info\",\r\n\t\t\"link\": \"https://materialdesignicons.com/\",\r\n\t\t\"json\": true,\r\n\t\t\r\n\t\t// if only a single string is given for an icon, convert it to a json compatible format to it will pass validation later\r\n\t\t\"onValidate\": val => val.indexOf(\" \") === -1 && val.indexOf('\"') === -1 && val.indexOf(\"}\") === -1 && val.indexOf(\"{\") === -1 ? '\"' + val + '\"' : val\r\n\t},\r\n\t\"iconStyle\": {\r\n\t\t\"label\": \"config#Devices#iconStyle#label\",\r\n\t\t\"info\": \"config#Devices#iconStyle#info\",\r\n\t\t\"json\": true\r\n\t},\r\n\t\"placeholder_1\": {\r\n\t\t\"type\": \"Placeholder\"\r\n\t},\r\n\t\"action\": {\r\n\t\t\"label\": \"config#Devices#action#label\",\r\n\t\t\"info\": \"config#Devices#action#info\",\r\n\t\t\r\n\t\t//<IGNORE>\r\n\t\t// white space not allowed\r\n\t\t\"onValidate\": val => {\r\n\t\t\tif (val.indexOf(' ') > -1) {\r\n\t\t\t\tthrow new Error('No whitespaces allowed in the state');\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn val;\r\n\t\t}//</IGNORE>\r\n\t},\r\n\t\"bodyElement\": {\r\n\t\t\"label\": \"config#Devices#bodyElement#label\",\r\n\t\t\"autoComplete\": true,\r\n\t\t\"autoHighlight\": true,\r\n\t\t\"options\": null,\r\n\t\t\"renderOption\": null\r\n\t},\r\n\t\"actionElement\": {\r\n\t\t\"label\": \"config#Devices#actionElement#label\",\r\n\t\t\"autoComplete\": true,\r\n\t\t\"autoHighlight\": true,\r\n\t\t\"options\": null,\r\n\t\t\"renderOption\": null\r\n\t},\r\n\t\"hide\": {\r\n\t\t\"label\": \"config#Devices#hide#label\",\r\n\t\t\"info\": \"config#Devices#hide#info\",\r\n\t\t\"type\": \"Switch\"\r\n\t}\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Cache from '../../../controller/Cache'\r\nimport Connection from '../../../controller/Connection'\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\nimport timeConverter from '../../../helpers/timeConverter'\r\n\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport TreeItem from '@material-ui/lab/TreeItem'\r\nimport TreeView from '@material-ui/lab/TreeView'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport CollapseIcon from '@material-ui/icons/ArrowDropDown'\r\nimport ExpandIcon from '@material-ui/icons/ArrowRight'\r\nimport GroupIcon from '@material-ui/icons/Folder'\r\nimport RefreshIcon from '@material-ui/icons/Refresh'\r\nimport StateIcon from '@material-ui/icons/BookmarkBorder'\r\n\r\nimport Dialog from '../../../components/Dialog'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tdivider: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\tTreeView: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t'&:focus > $TreeItemContent $TreeItemLabel, &:hover > $TreeItemContent $TreeItemLabel, &$TreeItemSelected > $TreeItemContent $TreeItemLabel': {\r\n\t\t\tbackgroundColor: 'transparent',\r\n\t\t},\r\n\t},\r\n\tTreeItem: {\r\n\t\tcolor: theme.palette.text.secondary,\r\n\t\t'&:hover > $TreeItemContent': {\r\n\t\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\t},\r\n\t},\r\n\tTreeItemContent: {\r\n\t\tcolor: theme.palette.text.secondary,\r\n\t\tpaddingRight: theme.spacing(1),\r\n\t\t//fontWeight: theme.typography.fontWeightMedium,\r\n\t\t'$TreeItemExpanded > &': {\r\n\t\t\t//fontWeight: theme.typography.fontWeightRegular,\r\n\t\t},\r\n\t},\r\n\tTreeItemError: {\r\n\t\tbackgroundColor: theme.palette.error.light,\r\n\t\ttextDecoration: 'line-through',\r\n\t\tcursor: 'not-allowed !important',\r\n\t\tfontWeight: 'normal',\r\n\t},\r\n\tTreeItemExpanded: {\r\n\t},\r\n\tTreeItemSelected: {\r\n\t\tfontWeight: 'bold !important',\r\n\t},\r\n\tTreeItemGroup: {\r\n\t\tfontWeight: 'initial',\r\n\t\t'& $TreeItemContent': {\r\n\t\t\tpaddingLeft: theme.spacing(2),\r\n\t\t},\r\n\t},\r\n\tTreeItemLabel: {\r\n\t\tfontWeight: 'inherit',\r\n\t\tcolor: 'inherit',\r\n\t},\r\n\tEntry: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tpadding: theme.spacing(0.5, 0),\r\n\t},\r\n\tGroup: {\r\n\t\t//fontWeight: 'bold'\r\n\t},\r\n\tEntryIcon: {\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tEntryText: {\r\n\t\tfontWeight: 'inherit',\r\n\t\tflexGrow: 1,\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst indexObjects = (list, index) => {\r\n\tlet objectsTree = {}\r\n\tlet root = [];\r\n\t\r\n\tfor (let objectId of list) {\r\n\t\t\r\n\t\t// index state\r\n\t\tobjectsTree[objectId.substr(0, objectId.lastIndexOf('.'))] = objectsTree[objectId.substr(0, objectId.lastIndexOf('.'))] || {}\r\n\t\tobjectsTree[objectId.substr(0, objectId.lastIndexOf('.'))][objectId] = index[objectId];\r\n\t\t\r\n\t\t// make sure state is added to all its parents\r\n\t\tlet namespace = objectId;\r\n\t\twhile (namespace.indexOf('.') > -1) {\r\n\t\t\tconst id = namespace;\r\n\t\t\tnamespace = namespace.substr(0, namespace.lastIndexOf('.'));\r\n\t\t\t\r\n\t\t\tif (objectsTree[namespace] === undefined || objectsTree[namespace][id] === undefined) {\r\n\t\t\t\tobjectsTree[namespace] = objectsTree[namespace] || {}\r\n\t\t\t\tobjectsTree[namespace][id] = {}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (namespace && namespace.indexOf('.') === -1 && root.indexOf(namespace) === -1) {\r\n\t\t\t\troot.push(namespace);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn [ root, objectsTree ];\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst StateExplorer = React.memo(props => {\r\n\tconst { val, _onChange } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\tconst [objectList,setObjectList] = useState(Cache.get('objectList') || null);\r\n\tconst selectedItem = useRef(val);\r\n\tconst searchTimeout = useRef();\r\n\t\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (objectList === null || !objectList.root) {\r\n\t\t\tconst socket = Connection.connection;\r\n\t\t\tsocket.getObjects()\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tlet list = [];\r\n\t\t\t\t\tlet index = {}\r\n\t\t\t\t\t\r\n\t\t\t\t\tres.forEach((promise, i) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (promise.status === 'fulfilled' && promise.value && Array.isArray(promise.value.rows)) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// read results and sort\r\n\t\t\t\t\t\t\tfor (let obj of promise.value.rows) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// skip system\r\n\t\t\t\t\t\t\t\tif (obj.id.substr(0,6) === 'system') {\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t// index result\r\n\t\t\t\t\t\t\t\tindex[obj.id] = obj.value;\r\n\t\t\t\t\t\t\t\tlist.push(obj.id);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t// index sorted results\r\n\t\t\t\t\tlist.sort();\r\n\t\t\t\t\tconst [ root, tree ] = indexObjects(list, index);\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst _objectList = {\r\n\t\t\t\t\t\t'updated': Date.now(),\r\n\t\t\t\t\t\t'root': root.sort(),\r\n\t\t\t\t\t\t'list': list,\r\n\t\t\t\t\t\t'tree': tree\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tCache.set('objectList', _objectList);\r\n\t\t\t\t\tsetObjectList(_objectList);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(error => {\r\n\t\t\t\t\tLog._('StateExplorer', error.message, 'error', true, error.stack);\r\n\t\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t}, [objectList]);\r\n\t\r\n\t//\r\n\tconst search = (props, val) => {\r\n\t\tclearTimeout(searchTimeout.current);\r\n\t\tsearchTimeout.current = setTimeout(() => {\r\n\t\t\tconst data = Cache.get('objectList');\r\n\t\t\t\r\n\t\t\tconst [ root, tree ] = indexObjects(data.list.filter(obj => obj.toLowerCase().indexOf(val.toLowerCase()) > -1), data.tree);\r\n\t\t\tsetObjectList(prevObjectList => ({\r\n\t\t\t\t...prevObjectList,\r\n\t\t\t\t'root': root.sort(),\r\n\t\t\t\t'tree': tree\r\n\t\t\t}));\r\n\t\t\t\r\n\t\t}, 750);\r\n\t}\r\n\t\r\n\t//\r\n\tconst selectObject = (e, val) => {\r\n\t\tconst selected = objectList.tree[val] || null; // tree only holds channels, thus null will be a state\r\n\t\t\r\n\t\tif (selected === null) {\r\n\t\t\tval = val.indexOf(' ') === -1 ? val : '';\r\n\t\t\tselectedItem.current = val;\r\n\t\t\t_onChange(val);\r\n\t\t}\r\n\t}\r\n\t\r\n\t//\r\n\tconst renderTree = key => {\r\n\t\tlet states = [];\r\n\t\tlet children = [];\r\n\t\t\r\n\t\t// channels\r\n\t\tif (objectList.tree[key]) {\r\n\t\t\tObject.keys(objectList.tree[key]).forEach(channelKey => {\r\n\t\t\t\tconst child = objectList.tree[key][channelKey];\r\n\t\t\t\t\r\n\t\t\t\tif (child.type === 'state') {\r\n\t\t\t\t\tstates.push(channelKey);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tchildren.push(renderTree(channelKey));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\t\r\n\t\t// states\r\n\t\tif (states.length > 0) {\r\n\t\t\tchildren = children.concat(\r\n\t\t\t\tstates.map(stateKey => <Item key={stateKey} error={(stateKey.indexOf(' ') > -1)} nodeId={stateKey} label={<Entry key={stateKey} error={(stateKey.indexOf(' ') > -1)} id={stateKey.substr(stateKey.lastIndexOf('.')+1)} {...objectList.tree[stateKey.substr(0, stateKey.lastIndexOf('.'))][stateKey]} />} />)\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\tconst channel = key.substr(key.lastIndexOf('.')+1);\r\n\t\tconst details = key.indexOf('.') > -1 ? objectList.tree[key.substr(0, key.lastIndexOf('.'))][key] : {}\r\n\t\treturn (\r\n\t\t\t<Item key={key} nodeId={key} children={children} label={<Entry key={key} group id={channel} {...details} />} />\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<Paper>\r\n\t\t\t<Inputs.Fieldset>\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tid='search'\r\n\t\t\t\t\tlabel='Search'\r\n\t\t\t\t\tonChange={search}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<div className={classes.divider} />\r\n\t\t\t\t<div style={{ margin: 'auto 0' }}>\r\n\t\t\t\t\t{objectList !== null && <span style={{ margin: 'auto 0' }}>{i18n.t('Last refresh') + ': ' + timeConverter.parseDate(objectList.updated, 'dd.MM.yyyy, HH:mm:ss')}</span>}\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\tlabel='refresh'\r\n\t\t\t\t\t\tstartIcon={<RefreshIcon />}\r\n\t\t\t\t\t\tonClick={() => setObjectList(null)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t\t<Divider />\r\n\t\t\t\r\n\t\t\t{(objectList === null || !objectList.root) ?\r\n\t\t\t<LinearProgress />\r\n\t\t\t:\r\n\t\t\t<TreeView\r\n\t\t\t\tclassName={classes.TreeView}\r\n\t\t\t\tdefaultCollapseIcon={<CollapseIcon />}\r\n\t\t\t\tdefaultExpandIcon={<ExpandIcon />}\r\n\t\t\t\tonNodeSelect={selectObject}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{objectList.root.map(key => renderTree(key))}\r\n\t\t\t</TreeView>}\r\n\t\t</Paper>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst Item = props => {\r\n\tconst { children, error, ...otherProps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<TreeItem\r\n\t\t\tclasses={{\r\n\t\t\t\troot: clsx(error && classes.TreeItemError, classes.TreeItem),\r\n\t\t\t\tcontent: classes.TreeItemContent,\r\n\t\t\t\texpanded: classes.TreeItemExpanded,\r\n\t\t\t\tselected: classes.TreeItemSelected,\r\n\t\t\t\tgroup: classes.TreeItemGroup,\r\n\t\t\t\tlabel: classes.TreeItemLabel\r\n\t\t\t}}\r\n\t\t\t\r\n\t\t\t{...otherProps}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{children || null}\r\n\t\t</TreeItem>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst Entry = props => {\r\n\tconst { id, error, type, group, common } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst name = common && common.name ? common.name : '';\t\r\n\tconst EntryIcon = group ? GroupIcon : StateIcon;\r\n\treturn (\r\n\t\t<div className={clsx(error && classes.TreeItemError, classes.Entry, group && classes.Group)}>\r\n\t\t\t<EntryIcon color=\"inherit\" className={classes.EntryIcon} />\r\n\t\t\t<EntryText width=\"40%\" caption label={id} />\r\n\t\t\t{name.length > 60 ? \r\n\t\t\t\t<Tooltip title={name} arrow>\r\n\t\t\t\t\t<div style={{ width: '40%' }}>\r\n\t\t\t\t\t\t<EntryText label={name.substr(0, 60) + '...'} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t:\r\n\t\t\t\t<EntryText width=\"40%\" label={name} />\r\n\t\t\t}\r\n\t\t\t<EntryText width=\"10%\" label={type} />\r\n\t\t\t<EntryText width=\"10%\" label={common && common.role} />\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst EntryText = props => {\r\n\tconst { label, width, caption } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<div style={{ width: width || '100%' }}>\r\n\t\t\t<Typography variant={caption ? 'caption' : 'body2'} className={classes.EntryText}>\r\n\t\t\t\t{(label && label[i18n.getLanguage()]) || label || ''}\r\n\t\t\t</Typography>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nexport const StateExplorerPopup = React.memo(props => {\r\n\tconst { open, _onClose, _onChange } = props;\r\n\t\r\n\tconst state = useRef(props.val);\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\theader={i18n.t('State Explorer')}\r\n\t\t\tactions={[\r\n\t\t\t\t<Inputs.Button key='action-cancel' variant=\"text\" onClick={_onClose} color=\"secondary\" label=\"Cancel\" />,\r\n\t\t\t\t<Inputs.Button key=\"action-save\" variant=\"text\" onClick={() => _onChange(state.current)} color=\"primary\" label=\"Apply\" />\r\n\t\t\t]}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='lg'\r\n\t\t\tfullWidth={true}\r\n\t\t\t\r\n\t\t\topen={open}\r\n\t\t\tonClose={_onClose}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<StateExplorer {...props} _onChange={s => state.current = s} />\r\n\t\t</Dialog>\r\n\t);\r\n});\r\n\r\nexport default StateExplorer;\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd'\r\n\r\nimport DevicesStates from './Devices.config'\r\nimport i18n from '../../../controller/i18n'\r\nimport Log from '../../../controller/Log'\r\nimport FUNCTIONS, { icons as FUNCTION_ICONS, componentsOptions } from '../../../functions'\r\nimport ucFirst from '../../../helpers/utils'\r\n\r\nimport Grid from '@material-ui/core/Grid'\r\nimport List from '@material-ui/core/List'\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\n\r\nimport AddIcon from '@material-ui/icons/Add'\r\nimport EditIcon from '@material-ui/icons/Edit'\r\nimport DeleteIcon from '@material-ui/icons/Delete'\r\n\r\nimport ComponentConfig from '../DevicesPage/ComponentConfigPage'\r\nimport { JsonEditorPopup } from '../DevicesPage/JsonEditor'\r\nimport { StateExplorerPopup } from '../DevicesPage/StateExplorer'\r\nimport { Screenshot, getComponents } from '../../../modules/StateList/StateList.settings'\r\n\r\nimport Collapsible, { CollapsibleSummary, CollapsibleDetails } from '../../../components/Collapsible'\r\nimport Dialog from '../../../components/Dialog'\r\nimport Icon from '../../../components/Icon'\r\nimport Inputs from '../../../components/Inputs'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nconst useStyles = makeStyles(theme => ({\r\n\tfullWidth: {\r\n\t\twidth: '100%',\r\n\t},\r\n\ticonContainer: {\r\n\t\tflexDirection: 'column',\r\n\t\talignItems: 'center'\r\n\t},\r\n\talignRight: {\r\n\t\tdisplay: 'flex',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\t\r\n\t\t'& > :not(:first-child)': {\r\n\t\t\tmarginLeft: 8,\r\n\t\t}\r\n\t},\r\n\tModifyIcon: {\r\n\t\tverticalAlign: 'bottom'\r\n\t},\r\n\theading: {\r\n\t\tmargin: 'auto auto auto 0'\r\n\t},\r\n\tListItem: {\r\n\t\tpadding: 0\r\n\t},\r\n\tdrag: {\r\n\t\tcursor: 'grab !important',\r\n\t\tuserSelect: 'none',\r\n\t\t\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: theme.palette.action.hover,\r\n\t\t}\r\n\t},\r\n\tisDragging: {\r\n\t\tbackgroundColor: theme.palette.action.selected,\r\n\t}\r\n}));\r\n\r\n\r\nconst _merge = require('deepmerge');\r\nconst _copy = require('rfdc')();\r\n\r\nconst DevicesPage = React.memo(props => {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [device,setDevice] = useState(_copy(props.device));\r\n\tconst [errors,setErrors] = useState({});\r\n\tconst EDITOR = useRef({});\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onChange = useCallback((props, val) => {\r\n\t\t\r\n\t\t// error handler\r\n\t\tsetErrors(prevErrors => {\r\n\t\t\tlet nextErrors = { ...prevErrors }\r\n\t\t\t\r\n\t\t\t// error occured\r\n\t\t\tif (props.error && props.error !== prevErrors[props.id]) {\r\n\t\t\t\tnextErrors[props.id] = props.error;\r\n\t\t\t\treturn nextErrors;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// no error -> remove old error\r\n\t\t\telse if (!props.error && prevErrors[props.id]) {\r\n\t\t\t\tdelete nextErrors[props.id];\r\n\t\t\t\treturn nextErrors;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevErrors;\r\n\t\t});\r\n\t\t\r\n\t\t// set value\r\n\t\tEDITOR.current[props.id] = val;\r\n\t\t\r\n\t}, []);\r\n\t\r\n\t/*\r\n\t * trigger initial validation\r\n\t */\r\n\tuseEffect(() => {\r\n\t\tif (!props.device.name) {\r\n\t\t\tsetErrors(prevErrors => ({\r\n\t\t\t\t...prevErrors,\r\n\t\t\t\t'device->name': true\r\n\t\t\t}));\r\n\t\t}\r\n\t\t\r\n\t}, [props.device.name]);\r\n\t\r\n\tif (device === null) {\r\n\t\treturn null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _onSave = () => {\r\n\t\tlet savedDevice = { ...device }\r\n\t\tsavedDevice.options = savedDevice.options || {}\r\n\t\tsavedDevice.attributes = savedDevice.attributes || {}\r\n\t\t\r\n\t\tfor (const key in EDITOR.current) {\r\n\t\t\tconst val = EDITOR.current[key];\r\n\t\t\tconst [ type, base, characteristic, param ] = key.split('->');\r\n\t\t\t\r\n\t\t\t// states\r\n\t\t\tif (type === 'states') {\r\n\t\t\t\tif (typeof savedDevice[type][base] === 'object' && characteristic.toLowerCase().indexOf('config') > -1) {\r\n\t\t\t\t\tsavedDevice[type][base][characteristic] = savedDevice[type][base][characteristic] || {}\r\n\t\t\t\t\tsavedDevice[type][base][characteristic][param] = val;\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof savedDevice[type][base] === 'object') {\r\n\t\t\t\t\tsavedDevice[type][base][characteristic] = val;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tsavedDevice[type][base] = {\r\n\t\t\t\t\t\t'state': savedDevice[type][base],\r\n\t\t\t\t\t\t[characteristic]: val\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// options or attributes\r\n\t\t\telse if (type === 'options' || type === 'attributes') {\r\n\t\t\t\tsavedDevice[type][base] = val;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// device\r\n\t\t\telse {\r\n\t\t\t\tsavedDevice[base] = val;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// save\r\n\t\tsavedDevice.attributes._updated = Date.now();\r\n\t\tprops.onSave(savedDevice);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _deleteDevice = () => props.onDelete && props.onDelete(device.id);\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _addState = newStateKey => {\r\n\t\t\r\n\t\tconst stateKey = newStateKey.replace(/ /g, '');\r\n\t\tsetDevice(prevDevice => ({\r\n\t\t\t...prevDevice,\r\n\t\t\tstates: {\r\n\t\t\t\t[stateKey]: {},\r\n\t\t\t\t...prevDevice.states || {}\r\n\t\t\t}\r\n\t\t}));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _renameState = (stateKey, newStateKey) => {\r\n\t\tnewStateKey = newStateKey.replace(/ /g, '');\r\n\t\t\r\n\t\t// verify state key does not exist\r\n\t\tif (device.states[newStateKey] !== undefined) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t// replace state key in layout\r\n\t\t//props.onReplaceStateKey(device.id, stateKey, newStateKey); // this is wrong here because Device has to be saved first\r\n\t\tEDITOR.current['states->' + newStateKey + '->_renamed'] = stateKey;\r\n\t\t\r\n\t\t// change state key in EDITOR\r\n\t\tlet state = {}\r\n\t\tfor (let key in EDITOR.current) {\r\n\t\t\tconst [ type, base, characteristic ] = key.split('->');\r\n\t\t\t\r\n\t\t\tif (type === 'states' && base === stateKey) {\r\n\t\t\t\tstate[characteristic] = EDITOR.current[key];\r\n\t\t\t\tEDITOR.current[type + '->' + newStateKey + '->' + characteristic] = EDITOR.current[key];\r\n\t\t\t\tdelete EDITOR.current[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// change state key in device\r\n\t\tsetDevice(prevDevice => {\r\n\t\t\tconst nextDevice = { ...prevDevice, 'states': {} }\r\n\t\t\t\r\n\t\t\tconst states = Object.keys(prevDevice.states);\r\n\t\t\tconst position = states.indexOf(stateKey);\r\n\t\t\tstates.splice(position, 1, newStateKey);\r\n\t\t\t\r\n\t\t\tfor (let sKey of states) {\r\n\t\t\t\tnextDevice.states[sKey] = {\r\n\t\t\t\t\t...prevDevice.states[sKey === newStateKey ? stateKey : sKey],\r\n\t\t\t\t\t...state\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn nextDevice;\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _addDefaultStates = func => {\r\n\t\t\r\n\t\tif (FUNCTIONS[func] !== undefined) {\r\n\t\t\tconst stateKeys = Object.keys(device.states || {});\r\n\t\t\tObject.keys(FUNCTIONS[func]).reverse().forEach(stateKey => {\r\n\t\t\t\tconst state = FUNCTIONS[func][stateKey];\r\n\t\t\t\t\r\n\t\t\t\tif (state.substitute !== true && stateKeys.indexOf(stateKey) === -1 && stateKey.substr(0,1) !== '_') {\r\n\t\t\t\t\t_addState(stateKey);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _moveState = res => {\r\n\t\t\r\n\t\tif (res.source && res.destination && res.source.index !== res.destination.index) {\r\n\t\t\t\r\n\t\t\tsetDevice(prevDevice => {\r\n\t\t\t\tlet nextDevice = { ...prevDevice, 'states': {} }\r\n\t\t\t\t\r\n\t\t\t\tlet states = Object.keys(prevDevice.states);\r\n\t\t\t\tstates.splice(res.destination.index, 0, states.splice(res.source.index, 1)[0]);\r\n\t\t\t\tstates.forEach(stateKey => {\r\n\t\t\t\t\tnextDevice.states[stateKey] = prevDevice.states[stateKey];\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\treturn nextDevice;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t */\r\n\tconst _deleteState = stateKey => {\r\n\t\t\r\n\t\t//props.onStateDelete(device.id, stateKey); // this is wrong here because Device has to be saved first\r\n\t\tsetDevice(prevDevice => {\r\n\t\t\tlet nextDevice = { ...prevDevice }\r\n\t\t\tdelete nextDevice.states[stateKey];\r\n\t\t\treturn nextDevice;\r\n\t\t});\r\n\t}\r\n\t\r\n\t/*\r\n\t *\r\n\t */\r\n\tLog._('DevicesPages', 'RENDER DevicesPage', 'development');\r\n\treturn (\r\n\t\t<Dialog\r\n\t\t\tid='DeviceConfiguration'\r\n\t\t\theader={i18n.t('Device Configuration') + ' (' + i18n.t('Device ID') + ': ' + device.id + ')'}\r\n\t\t\tactions={[\r\n\t\t\t\t<Grid key='actions' container>\r\n\t\t\t\t\t<Grid item xs={6}>\r\n\t\t\t\t\t\t{device.name && <Inputs.Button key='action->delete' variant=\"text\" onClick={() => _deleteDevice()} color=\"secondary\" startIcon={<DeleteIcon />} label=\"Delete Device\" />}\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t\t<Grid item xs={6} className={classes.alignRight}>\r\n\t\t\t\t\t\t<Inputs.Button key='action->cancel' className=\"cancel\" variant=\"text\" onClick={() => props.onClose()} color=\"secondary\" label=\"Cancel\" />\r\n\t\t\t\t\t\t<Inputs.Button key='action->save' className=\"apply\" variant=\"text\" onClick={() => _onSave()} color=\"primary\" disabled={Object.keys(errors).length > 0} label=\"Apply\" />\r\n\t\t\t\t\t</Grid>\r\n\t\t\t\t</Grid>\r\n\t\t\t]}\r\n\t\t\t\r\n\t\t\tdense\r\n\t\t\tmaxWidth='lg'\r\n\t\t\tfullWidth={true}\r\n\t\t\t\r\n\t\t\topen={true}\r\n\t\t\tonClose={() => props.onClose()}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<Inputs.Fieldset label='General'>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tkey=\"device->name\"\r\n\t\t\t\t\t\tid=\"device->name\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\tautoFocus\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Device'\r\n\t\t\t\t\t\tval={device.name}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tkey=\"device->label\"\r\n\t\t\t\t\t\tid=\"device->label\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Label'\r\n\t\t\t\t\t\tval={device.label || ''}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Select\r\n\t\t\t\t\t\tkey=\"device->function\"\r\n\t\t\t\t\t\tid=\"device->function\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Function'\r\n\t\t\t\t\t\tval={device.function || 'other'}\r\n\t\t\t\t\t\tselection={\r\n\t\t\t\t\t\t\tObject.keys(FUNCTIONS).map(funcKey => {\r\n\t\t\t\t\t\t\t\tconst func = funcKey !== '_defaults' ? funcKey : 'other';\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t[func]: i18n.t(func),\r\n\t\t\t\t\t\t\t\t\t'icon': FUNCTION_ICONS[funcKey] || null,\r\n\t\t\t\t\t\t\t\t\t'_key': func,\r\n\t\t\t\t\t\t\t\t\t'_translated': true,\r\n\t\t\t\t\t\t\t\t\t'_sort': i18n.t(func)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsortOptionsByKey\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// add default state keys of function (if not added already)\r\n\t\t\t\t\t\t\tif (Object.keys(device.states).length === 0) {\r\n\t\t\t\t\t\t\t\t_addDefaultStates(val);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t_onChange(props, val);\r\n\t\t\t\t\t\t\tsetDevice(prevDevice => ({\r\n\t\t\t\t\t\t\t\t...prevDevice,\r\n\t\t\t\t\t\t\t\t'function': val\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Text\r\n\t\t\t\t\t\tkey=\"device->icon\"\r\n\t\t\t\t\t\tid=\"device->icon\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Icon'\r\n\t\t\t\t\t\tval={device.icon || ''}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t\t\r\n\t\t\t\t<Inputs.FieldsetItem columns={3}>\r\n\t\t\t\t\t<Inputs.Switch\r\n\t\t\t\t\t\tkey=\"device->suppressPopup\"\r\n\t\t\t\t\t\tid=\"device->suppressPopup\"\r\n\t\t\t\t\t\twidth={200}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlabel='Suppress Popup'\r\n\t\t\t\t\t\tinfo='Do not open the device details in the popup when the device is clicked'\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tval={device.suppressPopup !== undefined ? device.suppressPopup : false}\r\n\t\t\t\t\t\tonChange={_onChange}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</Inputs.FieldsetItem>\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t\t\r\n\t\t\t<Inputs.Fieldset label='States'>\r\n\t\t\t\t<DeviceStates\r\n\t\t\t\t\t_onChange={_onChange}\r\n\t\t\t\t\t_addState={_addState}\r\n\t\t\t\t\t_addDefaultStates={_addDefaultStates}\r\n\t\t\t\t\t_renameState={_renameState}\r\n\t\t\t\t\t_moveState={_moveState}\r\n\t\t\t\t\t_deleteState={_deleteState}\r\n\t\t\t\t\terrors={errors}\r\n\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t</Inputs.Fieldset>\r\n\t\t</Dialog>\r\n\t)\r\n});\r\n\r\nexport default DevicesPage;\r\n\r\n\r\n/*\r\n *\r\n */\r\nconst AddDeviceState = React.memo(props => {\r\n\tLog._('DevicesPages', 'RENDER AddDeviceState', 'development');\r\n\tconst { device } = props;\r\n\t\r\n\tconst StateAddRef = useRef();\r\n\tconst [error,setError] = useState('');\r\n\t\r\n\tconst onAddState = () => {\r\n\t\tconst newStateKey = StateAddRef.current.value || '';\r\n\t\t\r\n\t\t// empty state key\r\n\t\tif (!newStateKey) {\r\n\t\t\tsetError(i18n.t('Type in a state key / identifier'));\r\n\t\t}\r\n\r\n\t\t// state key exists already\r\n\t\telse if (Object.keys(device.states || {}).indexOf(newStateKey) > -1) {\r\n\t\t\tsetError(i18n.t('State key already used'));\r\n\t\t}\r\n\t\t\r\n\t\t// add state\r\n\t\telse {\r\n\t\t\tsetError('');\r\n\t\t\tprops._setNewStateKey(newStateKey)\r\n\t\t\tprops._addState(newStateKey);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<ListItem key='StatesListItemLabel->add' dense divider className=\"DeviceStateAdd\">\r\n\t\t\t<ListItemIcon>\r\n\t\t\t\t<IconButton size=\"small\" disabled>\r\n\t\t\t\t\t<AddIcon />\r\n\t\t\t\t</IconButton>\r\n\t\t\t</ListItemIcon>\r\n\t\t\t\r\n\t\t\t<ListItemText disableTypography style={{ display: 'flex' }}>\r\n\t\t\t\t<Inputs.Text\r\n\t\t\t\t\tid='states->add'\r\n\t\t\t\t\tref={StateAddRef}\r\n\t\t\t\t\tshrink={true}\r\n\t\t\t\t\tlabel='new state key'\r\n\t\t\t\t\tval={props.newStateKey}\r\n\t\t\t\t\tonEnter={onAddState}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t<div style={{ display: 'flex', margin: 'auto 0' }}>\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\tclassName=\"DeviceStateAddButton\"\r\n\t\t\t\t\t\tlabel='add state'\r\n\t\t\t\t\t\tonClick={onAddState}\r\n\t\t\t\t\t\twidth={275}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<Inputs.Button\r\n\t\t\t\t\t\tlabel='add default states'\r\n\t\t\t\t\t\tonClick={() => props._addDefaultStates(device.function)}\r\n\t\t\t\t\t\twidth={275}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t\t<span style={{ color: '#900' }}>{error}</span>\r\n\t\t\t</ListItemText>\r\n\t\t</ListItem>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceStates = React.memo(props => {\r\n\tLog._('DevicesPages', 'RENDER DeviceStates', 'development');\r\n\tconst { device, _moveState } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst newStateKey = useRef('');\r\n\tconst setNewStateKey = val => newStateKey.current = val;\r\n\t\r\n\tconst renderedStates = Object.keys(device.states || {}).map((stateKey, i) => {\r\n\t\tlet state = device.states[stateKey];\r\n\t\tstate = typeof state === 'string' ? { 'state': state } : state;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<DragDeviceState\r\n\t\t\t\t{...props}\r\n\t\t\t\tkey={'DeviceState->' + stateKey}\r\n\t\t\t\tindex={i}\r\n\t\t\t\tstate={{ ...state, 'key': stateKey }}\r\n\t\t\t\texpanded={stateKey === newStateKey.current}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t);\r\n\t});\r\n\t\r\n\treturn (\r\n\t\t<List classes={{ root: classes.fullWidth }} dense>\r\n\t\t\t<AddDeviceState newStateKey={newStateKey.current} _setNewStateKey={setNewStateKey} {...props} />\r\n\t\t\t<DragDropContext onDragEnd={_moveState}>\r\n\t\t\t\t<Droppable\r\n\t\t\t\t\tkey='DeviceStates'\r\n\t\t\t\t\tdroppableId='states'\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{(provided, snapshot) => (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t{...provided.droppableProps}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{renderedStates}\r\n\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Droppable>\r\n\t\t\t</DragDropContext>\r\n\t\t</List>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DragDeviceState = props => {\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\t\t<Draggable\r\n\t\t\tkey={props.state.key}\r\n\t\t\tdraggableId={'state->' + props.state.key}\r\n\t\t\tindex={props.index}\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t{(provided, snapshot) => (\r\n\t\t\t<div\r\n\t\t\t\tclassName={clsx(classes.drag, snapshot.isDragging && classes.isDragging)}\r\n\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t<DeviceState {...props} />\r\n\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</Draggable>\r\n\t);\r\n}\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceState = React.memo(props => {\r\n\tLog._('DevicesPages', 'RENDER DeviceState', 'development');\r\n\tconst { state, expanded, _renameState, _deleteState } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst fields = Object.keys(DevicesStates).map(field => <DeviceStateField key={'DeviceStateField->' + state.key + '->' + field} {...props} field={field} />);\r\n\tconst renameState = () => {\r\n\t\tconst stateKey = prompt(i18n.t('Rename State Key'), state.key);\r\n\t\t\r\n\t\tif (stateKey && stateKey !== state.key) {\r\n\t\t\t_renameState(state.key, stateKey);\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<ListItem\r\n\t\t\tkey={'StatesListItem->' + state.key}\r\n\t\t\tclasses={{ root: clsx(classes.ListItem, 'DeviceState') }}\r\n\t\t\tdense\r\n\t\t\t>\r\n\t\t\t\r\n\t\t\t<ListItemText disableTypography>\r\n\t\t\t\t<Collapsible key={'DeviceState->' + state.key} expanded={expanded} className={'DeviceState DeviceState->' + state.key}>\r\n\t\t\t\t\t<CollapsibleSummary>\r\n\t\t\t\t\t\t<Typography classes={{ root: classes.heading }} display=\"inline\">{state.key}</Typography>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<IconButton size=\"small\" onClick={renameState}>\r\n\t\t\t\t\t\t\t<EditIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t<IconButton size=\"small\" onClick={e => {e.stopPropagation();_deleteState(state.key)}}>\r\n\t\t\t\t\t\t\t<DeleteIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t<Icon style={{ fontSize: '1.5em', margin: 'auto 8px' }} icon=\"mdi:drag\" />\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</CollapsibleSummary>\r\n\t\t\t\t\t<CollapsibleDetails>\r\n\t\t\t\t\t\t<Inputs.Fieldset noPadding>\r\n\t\t\t\t\t\t\t{fields}\r\n\t\t\t\t\t\t</Inputs.Fieldset>\r\n\t\t\t\t\t</CollapsibleDetails>\r\n\t\t\t\t</Collapsible>\r\n\t\t\t</ListItemText>\r\n\t\t</ListItem>\r\n\t);\r\n});\r\n\r\n/*\r\n *\r\n */\r\nconst DeviceStateField = React.memo(props => {\r\n\tconst { device, field } = props;\r\n\tconst fieldProps = DevicesStates[field];\r\n\tconst deviceDefaults = _merge(FUNCTIONS['_defaults'], FUNCTIONS[device.function] || {});\r\n\t\r\n\t// JSON\r\n\tif (fieldProps.json === true) {\r\n\t\treturn <DeviceStateFieldJsonEditor {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n\t\r\n\t// AutoComplete\r\n\telse if (fieldProps.options !== undefined) {\r\n\t\treturn <DeviceStateFieldAutoComplete {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n\t\r\n\t// State Explorer\r\n\telse if (field === 'state' || field === 'action') {\r\n\t\treturn <DeviceStateFieldStateExplorer {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n\t\r\n\t// Other\r\n\telse {\r\n\t\treturn <DeviceStateFieldOther {...props} fieldProps={fieldProps} deviceDefaults={deviceDefaults} />\r\n\t}\r\n});\r\n\r\nconst DeviceStateFieldJsonEditor = React.memo(props => {\r\n\tconst { state, field, _onChange } = props;\r\n\t\r\n\t\r\n\tconst value = useRef(state[field] && state[field].node ? state[field].node : (state[field] || ''));\r\n\tconst setValue = val => value.current = val;\r\n\tconst [showJsonEditor,setShowJsonEditor] = useState(false);\r\n\t\r\n\t// additional props\r\n\tlet additionalProps = {}\r\n\tadditionalProps.action = () => setShowJsonEditor(true);\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t\r\n\t\t\t<JsonEditorPopup\r\n\t\t\t\topen={showJsonEditor}\r\n\t\t\t\t_onClose={() => {}}\r\n\t\t\t\tval={value.current}\r\n\t\t\t\theight={500}\r\n\t\t\t\t_onChange={val => {\r\n\t\t\t\t\t_onChange({ 'id': 'states->' + state.key + '->' + field }, val);\r\n\t\t\t\t\tsetValue(val);\r\n\t\t\t\t\tsetShowJsonEditor(false);\r\n\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<DeviceStateFieldInput {...props} additionalProps={additionalProps} val={value.current} setVal={setValue} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldStateExplorer = React.memo(props => {\r\n\tconst { state, field, _onChange } = props;\r\n\t\r\n\t\r\n\tconst [value,setValue] = useState(state[field] && state[field].node ? state[field].node : (state[field] || ''));\r\n\tconst setVal = val => setValue(val);\r\n\tconst [showStateExplorer,setShowStateExplorer] = useState(false);\r\n\t\r\n\t// additional props\r\n\tlet additionalProps = {}\r\n\tadditionalProps.action = () => setShowStateExplorer(true);\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t\r\n\t\t\t<StateExplorerPopup\r\n\t\t\t\topen={showStateExplorer}\r\n\t\t\t\t_onClose={() => setShowStateExplorer(false)}\r\n\t\t\t\tval={value}\r\n\t\t\t\t_onChange={val => {\r\n\t\t\t\t\t_onChange({ 'id': 'states->' + state.key + '->' + field }, val);\r\n\t\t\t\t\tsetValue(val);\r\n\t\t\t\t\tsetShowStateExplorer(false);\r\n\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<DeviceStateFieldInput {...props} additionalProps={additionalProps} val={value} setVal={setVal} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldAutoComplete = React.memo(props => {\r\n\tconst { device, deviceDefaults, state, field, fieldProps, _onChange } = props;\r\n\t\r\n\t\r\n\t// components\r\n\tconst components = {\r\n\t\t'screenshot': (option, state) => <Screenshot func={device.function} option={option} selected={state.selected} />,\r\n\t\t'bodyElement': getComponents(device.function, 'body'),\r\n\t\t'actionElement': getComponents(device.function, 'action')\r\n\t}\r\n\t\r\n\tconst [value,setValue] = useState(\r\n\t\t(state[field] && state[field].node !== undefined) || state[field] !== undefined ? // prefer if given but empty (which means user has unselected it)\r\n\t\t\t((state[field] && state[field].node) || state[field] || '') : (\r\n\t\t\t\t(field.indexOf('Element') > -1 && deviceDefaults[state.key.toLowerCase()] && deviceDefaults[state.key.toLowerCase()][field]) ||\r\n\t\t\t\t(field.indexOf('Element') > -1 && deviceDefaults['_any'] && deviceDefaults['_any'][field]) ||\r\n\t\t\t\t''\r\n\t\t\t)\r\n\t);\r\n\t\r\n\tconst setVal = val => setValue(val);\r\n\tconst [componentConfig,setComponentConfig] = useState(null);\r\n\t\r\n\t//\r\n\tconst property = useRef({});\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tif (value && property.current[value] === undefined) {\r\n\t\t\tlet config = _merge(\r\n\t\t\t\tcomponentsOptions['_defaults'][value] || {},\r\n\t\t\t\t(componentsOptions[props.device.function] && componentsOptions[props.device.function][value]) || {}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\t// apply user specific values\r\n\t\t\tconst userConfig = props.state[value + 'Config'] || {}\r\n\t\t\tObject.keys(userConfig).forEach(c => {\r\n\t\t\t\tconfig[c] = typeof config[c] !== 'object' ? { 'val': config[c] } : config[c];\r\n\t\t\t\tconfig[c].val = userConfig[c];\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tproperty.current[value] = config;\r\n\t\t}\r\n\t\t\r\n\t}, [value, props.device, props.state]);\r\n\t\r\n\t// additional props\r\n\tlet additionalProps = {}\r\n\tif (fieldProps.options !== undefined) {\r\n\t\tadditionalProps.options = typeof fieldProps.options === 'function' ? fieldProps.options(props.device) : components[field];\r\n\t}\r\n\t\r\n\tif (fieldProps.renderOption !== undefined) {\r\n\t\tadditionalProps.renderOption = typeof fieldProps.renderOption === 'function' ? ((option, state) => fieldProps.renderOption(option, state, props.device)) : components['screenshot'];\r\n\t}\r\n\t\r\n\tadditionalProps.action = ((componentsOptions['_defaults'] && componentsOptions['_defaults'][value]) || (componentsOptions[device.function] && componentsOptions[device.function][value])) && (() => setComponentConfig({ 'id': field + 'Config', 'config': property.current[value] }));\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t\r\n\t\t\t<ComponentConfig\r\n\t\t\t\t_onClose={() => setComponentConfig(null)}\r\n\t\t\t\t_onChange={(props, val) => {\r\n\t\t\t\t\tconst key = props.id.substr(props.id.lastIndexOf('.')+1);\r\n\t\t\t\t\tproperty.current[value][key].val = val;\r\n\t\t\t\t\t_onChange({ ...props, 'id': 'states->' + state.key + '->' + value + 'Config->' + key }, val);\r\n\t\t\t\t}}\r\n\t\t\t\tid={(componentConfig && componentConfig.id) || null}\r\n\t\t\t\tconfig={(componentConfig && componentConfig.config) || {}}\r\n\t\t\t\tdevice={device}\r\n\t\t\t\t/>\r\n\t\t\t\r\n\t\t\t<DeviceStateFieldInput {...props} additionalProps={additionalProps} val={value} setVal={setVal} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldOther = React.memo(props => {\r\n\tconst { state, field } = props;\r\n\t\r\n\t\r\n\tconst [value,setValue] = useState(state[field] && state[field].node ? state[field].node : (state[field] || ''));\r\n\tconst setVal = val => setValue(val);\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment key={'StatesListItemField->' + state.key + '->' + field}>\r\n\t\t\t<DeviceStateFieldInput {...props} val={value} setVal={setVal} />\r\n\t\t</React.Fragment>\r\n\t);\r\n});\r\n\r\nconst DeviceStateFieldInput = React.memo(props => {\r\n\tconst { deviceDefaults, state, field, fieldProps, additionalProps, setVal, _onChange } = props;\r\n\t\r\n\t\r\n\tconst Input = Inputs[fieldProps.type || 'Text'];\r\n\t\r\n\treturn (\r\n\t\t<Inputs.FieldsetItem className={'field->' + field} columns={4}>\r\n\t\t\t<Input\r\n\t\t\t\t{...fieldProps}\r\n\t\t\t\t{...additionalProps}\r\n\t\t\t\t\r\n\t\t\t\tid={'states->' + state.key + '->' + field}\r\n\t\t\t\tshrink={true}\r\n\t\t\t\tlabel={fieldProps.label || ucFirst(field)}\r\n\t\t\t\tplaceholder={(deviceDefaults[state.key.toLowerCase()] && deviceDefaults[state.key.toLowerCase()][field.replace('Element', '')]) || fieldProps.val || ''}\r\n\t\t\t\twidth={370}\r\n\t\t\t\tval={props.val}\r\n\t\t\t\t\r\n\t\t\t\tonChange={(props, val) => {\r\n\t\t\t\t\tsetVal(val);\r\n\t\t\t\t\ttypeof fieldProps.onChange === 'function' ? fieldProps.onChange(props, val, _onChange) : _onChange(props, val);\r\n\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t</Inputs.FieldsetItem>\r\n\t);\r\n});\r\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"\n}), 'Edit');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z\"\n}), 'KeyboardArrowRight');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\"\n}), 'Add');\n\nexports.default = _default;"],"sourceRoot":""}