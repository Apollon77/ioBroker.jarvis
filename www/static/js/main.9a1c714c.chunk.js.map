{"version":3,"sources":["Socket.js","functions/light.js","functions/index.js","functions/defaults.js","functions/heating.js","Function.js","Device.js","components/StateListItem.js","components/StateList.js","components/Popup.js","components/Box.js","theme.js","Jarvis.js","components/StateListHorizontal.js","App.js","serviceWorker.js","index.js"],"names":["Socket","url","options","socket","io","query","statesSubscribes","on","emit","attempt","attempts","error","reason","id","cb","this","cbs","indexOf","push","reg","replace","RegExp","connected","err","states","Object","keys","forEach","state","task","hasOwnProperty","test","Promise","resolve","reject","getState","val","setState","EventEmitter","useStyles","makeStyles","theme","slider","padding","spacing","Label","props","title","Typography","Level","device","min","max","step","markSteps","classes","markStep","Fragment","stateKey","Slider","onChangeCommitted","e","setDeviceState","defaultValue","value","valueLabelDisplay","marks","Array","map","number","defaults","configurations","power","toString","battery","unit","humidity","level","temperature","wind","light","colorTemperature","hue","icons","defaultOn","defaultOff","components","actions","useState","checked","setChecked","useEffect","Switch","onChange","color","heating","toFixed","setTemperature","Function","functionType","function","Error","functionId","toLowerCase","icon","functions","component","action","configuration","key","Device","deviceProperties","name","room","attributes","length","_setProperties","stateSubscriptions","s","primaryStateKey","node","obj","default","primary","secondaryStateKey","secondary","styles","groups","isArray","group","sort","label","_setObjectStructure","mapping","secondaryStateMapping","primaryStateMapping","subtitle","divider","timeChanged","moment","lc","fromNow","property","Action","Component","stateProperty","deviceState","undefined","option","stateVal","attribute","subscribe","responses","requestDeviceState","_getStateFromKey","then","_updateDeviceState","subscribeDeviceState","catch","message","res","subscribeState","getDeviceState","defaultListIcon","defaultListItemActionPrimary","defaultListItemActionSecondary","fontSize","horizontalListItem","display","textAlign","paddingRight","minWidth","marginTop","horizontalListItemIcon","horizontalListItemAction","top","right","position","transform","verticalListItemAction","ListDivider","ListItem","style","margin","variant","ListItemIconElement","withStyles","customClassNames","children","classNames","className","multipleClassNames","ListItemAction","StateListItem","openDialog","horizontal","prevSubgroup","console","log","get","getStyle","getOption","subgroup","finger","button","onClick","bind","ListItemIcon","ListItemText","ListItemSecondaryAction","React","horizontalList","flexDirection","flexWrap","StateList","devices","List","dense","listItem","DialogTitle","root","closeButton","palette","grey","onClose","other","disableTypography","IconButton","aria-label","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Popup","prevProps","prevState","contents","ts","child","getIcon","getComponent","getAction","allSettled","forceUpdate","nextProps","nextState","open","closeDialog","Dialog","maxWidth","fullWidth","dividers","Button","autoFocus","card","marginLeft","breakpoints","down","cardHeaderNoContents","cardAvatar","backgroundColor","main","cardContent","Box","iconStyle","Card","CardHeader","avatar","Avatar","createElement","CardContent","blue","pink","createMuiTheme","cursor","debug","COMPONENTS","StateListHorizontal","Map","getGridColumn","columnContent","index","groupId","Tag","settings","Jarvis","notificationDrawer","dialog","dialogContents","Date","now","grid","columns","column","gridColumn","Grid","item","xs","sm","md","lg","Math","round","xl","getGrid","ThemeProvider","container","gridContainer","paddingLeft","DEAULTS_STATES","true","false","0","DEFAULT_STYLES","App","loaded","errorMessage","window","location","hostname","JSON","parse","useSettings","processDevices","document","favicon","substr","getElementById","href","warn","deviceList","groupedDevices","deviceId","jarvis","processDevice","groupDevice","item1","item2","info","alert","renderLoading","Boolean","match","ReactDOM","render","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.9a1c714c.chunk.js","sourcesContent":["import EventEmitter from 'events';\r\nimport io from 'socket.io-client';\r\n\r\n\r\n/**\r\n * Class for Socket.io conncetion handling.\r\n *\r\n * @description This is based on an implementation @GermanBluefox (https://github.com/GermanBluefox), see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\t\t\t\tOnly required functions are taken from source class. Major change is that all events are emitted, so proper error handling is possible in the App.\r\n *\r\n *\r\n * @param\t{String}\t\turl\r\n * @param\t{Object}\t\toptions\r\n * @return\t{Socket}\r\n * @see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\r\n */\r\nexport default class Socket extends EventEmitter {\r\n\t\r\n\tconstructor(url = null, options = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\t// socket connection\r\n\t\tthis.socket = io(url, { ...options, query: 'ws=true' });\r\n\t\tthis.statesSubscribes = {}; // subscribe for states\r\n\t\t\r\n\t\t\r\n\t\t/*\r\n\t\t * API events\r\n\t\t * @see https://github.com/socketio/socket.io-client/blob/HEAD/docs/API.md#socket\r\n\t\t *\r\n\t\t */\r\n\t\t// connect\r\n\t\tthis.socket.on('connect', () => this.emit('connect'));\r\n\t\t\r\n\t\t// reconnect_attempt: Fired upon an attempt to reconnect.\r\n\t\tthis.socket.on('reconnect_attempt', attempt => this.emit('reconnect', attempt));\r\n\t\t\r\n\t\t// reconnect: Fired upon a successful reconnection.\r\n\t\tthis.socket.on('reconnect', attempts => this.emit('reconnect', attempts));\r\n\t\t\r\n\t\t// reconnect_error: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_error', error => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_error', 'error': error }));\r\n\t\t\r\n\t\t// reconnect_failed: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_failed', () => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_failed', 'error': null }));\r\n\t\t\r\n\t\t// discconect\r\n\t\tthis.socket.on('disconnect', reason => this.emit('disconnect', reason));\r\n\t\t\r\n\t\t// connect_error\r\n\t\tthis.socket.on('connect_error', error => this.emit('error', { 'type': 'connect', 'event': 'connect_error', 'error': error }));\r\n\t\t\r\n\t\t// connect_timeout\r\n\t\tthis.socket.on('connect_timeout', error => this.emit('error', { 'type': 'connect', 'event': 'connect_timeout', 'error': error }));\r\n\t\t\r\n\t\t// error\r\n\t\tthis.socket.on('error', error => this.emit('error', { 'type': 'error', 'event': 'error', 'error': error }));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to a state by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeState(id, cb) {\r\n\t\tif (!this.statesSubscribes[id]) {\r\n\t\t\tlet reg = id\r\n\t\t\t\t.replace(/\\./g, '\\\\.')\r\n\t\t\t\t.replace(/\\*/g, '.*')\r\n\t\t\t\t.replace(/\\(/g, '\\\\(')\r\n\t\t\t\t.replace(/\\)/g, '\\\\)')\r\n\t\t\t\t.replace(/\\+/g, '\\\\+')\r\n\t\t\t\t.replace(/\\[/g, '\\\\[');\r\n\r\n\t\t\tif (reg.indexOf('*') === -1) {\r\n\t\t\t\treg += '$';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.statesSubscribes[id] = { reg: new RegExp(reg), cbs: [cb] };\r\n\t\t\t\r\n\t\t\tif (this.connected) {\r\n\t\t\t\tthis.socket.emit('subscribe', id);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.statesSubscribes[id].cbs.indexOf(cb) === -1 && this.statesSubscribes[id].cbs.push(cb);\r\n\t\t}\r\n\t\t\r\n\t\tif (typeof cb === 'function') {\r\n\t\t\tthis.socket.emit('getForeignStates', id, (err, states) => states && Object.keys(states).forEach(id => cb(id, states[id])));\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Fires pre-registered callbacks (via subscribeState) upon state change.\r\n\t *\r\n\t */\r\n\tstateChange(id, state) {\r\n\t\tid = id ? id.replace(/[\\s'\"]/g, '_') : '';\r\n\t\tfor (const task in this.statesSubscribes) {\r\n\t\t\tif (this.statesSubscribes.hasOwnProperty(task) && this.statesSubscribes[task].reg.test(id)) {\r\n\t\t\t\tthis.statesSubscribes[task].cbs.forEach(cb => cb(id, state));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a state.\r\n\t *\r\n\t */\r\n\tgetState(id, cb) {\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getState(id, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getState', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a state.\r\n\t *\r\n\t */\r\n\tsetState(id, val, cb) {\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.setState(id, val, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('setState', id, val, cb);\r\n\t\t}\r\n\t}\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\n\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Slider from '@material-ui/core/Slider';\r\nimport Switch from '@material-ui/core/Switch';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tslider: {\r\n\t\tpadding: theme.spacing(2, 30, 2, 2)\r\n\t},\r\n}));\r\n\r\n\r\nfunction Label(props) {\r\n\tconst { title } = props;\r\n\treturn (<Typography>{title}</Typography>);\r\n}\r\n\r\nfunction Power(props) {\r\n\tlet { device, state } = props;\r\n\t\r\n\tconst [checked, setChecked] = useState((state.state && state.state.value && state.state.value.val) || false);\r\n\tconst onChange = (e, val) => device.setDeviceState(state.stateKey, val);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tdevice.on('stateChange', (stateKey, state) => {\r\n\t\t\tif (stateKey === 'power') {\r\n\t\t\t\tsetChecked(state.val);\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\t\r\n\treturn (\r\n\r\n<Switch\r\n\tchecked={checked}\r\n\tonChange={onChange}\r\n\tvalue=\"true\"\r\n\tcolor=\"primary\"\r\n/>\r\n\r\n\t);\r\n}\r\n\r\nfunction Level(props) {\r\n\tlet { device, state, title, min, max, step, markSteps } = props;\r\n\tconst onChange = (e, val) => device.setDeviceState(state.stateKey, val);\r\n\tconst classes = useStyles();\r\n\t\r\n\t// default settings\r\n\tmin = min || 0;\r\n\tmax = max || 100;\r\n\tstep = step || 1;\r\n\tmarkSteps = markSteps || 11; // 0 to 10\r\n\tlet markStep = ((max-min)/(markSteps-1)) || 10;\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Label title={title || state.stateKey } />\r\n\t<div classes={classes.slider}>\r\n\t\t<Slider\r\n\t\t\t//onChange\r\n\t\t\tonChangeCommitted={onChange}\r\n\t\t\tdefaultValue={(state.state && state.state.value && state.state.value.val) || 0}\r\n\t\t\tvalueLabelDisplay=\"auto\"\r\n\t\t\tmarks={[...Array(markSteps).keys()].map(number => ({ 'value': min+number*markStep, 'label': min+number*markStep }))}\r\n\t\t\tmin={min}\r\n\t\t\tmax={max}\r\n\t\t\tstep={step}\r\n\t\t/>\r\n\t\r\n\t</div>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\nfunction ColorTemperature(props) {\r\n\treturn (\r\n\t\t<Level min={2000} max={6500} step={10} {...props} />\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tlevel: {\r\n\t\t\tvalue: (val) => val > 0 && val <= 1 ? val * 100 : val,\r\n\t\t\tunit: (val) => val > 0 ? ' %' : ''\r\n\t\t},\r\n\t\tcolorTemperature: { unit: ' °K' },\r\n\t\thue: { unit: ' °' }\r\n\t},\r\n\ticons: {\r\n\t\tdefaultOn: '',\r\n\t\tdefaultOff: '',\r\n\t\t\r\n\t\tpower: 'light-switch',\r\n\t\tlevel: 'brightness-percent',\r\n\t\tcolorTemperature: 'thermometer'\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel: Level,\r\n\t\tcolorTemperature: ColorTemperature\r\n\t},\r\n\tactions: {\r\n\t\tpower: Power\r\n\t}\r\n}","import defaults from './defaults';\r\nimport light from './light';\r\nimport heating from './heating';\r\n\r\nexport default {\r\n\tdefaults,\r\n\tlight,\r\n\theating\r\n}","export default {\r\n\tconfigurations: {\r\n\t\tpower: {\r\n\t\t\tvalue: (val) => val.toString()\r\n\t\t},\r\n\t\tbattery: { unit: ' %' },\r\n\t\thumidity: { unit: ' %' },\r\n\t\tlevel: { unit: ' %' },\r\n\t\ttemperature: { unit: ' °C' },\r\n\t\twind: { unit: ' km/h' }\r\n\t}\r\n}","import React, { useState, useEffect } from 'react';\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\ttemperature: {\r\n\t\t\tvalue: (val) => val.toFixed(1),\r\n\t\t\tunit: ' °C'\r\n\t\t},\r\n\t\tsetTemperature: { unit: ' °C' },\r\n\t\thumidity: { unit: ' %' }\r\n\t},\r\n\ticons: {\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t}\r\n}","import EventEmitter from 'events';\r\nimport functions from './functions';\r\n\r\n\r\n/**\r\n * Function\r\n *\r\n * @param\t{String}\t\tfunctionType\r\n * @return\t{Function}\r\n *\r\n */\r\nexport default class Function extends EventEmitter {\r\n\t\r\n\tconstructor(functionType) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.function = functionType;\r\n\t\t\r\n\t\tif (!this.function) {\t\r\n\t\t\tthrow new Error('No function given!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.functionId = this.function.toLowerCase();\r\n\t\tthis.icon = (functions[this.functionId] && functions[this.functionId].icons) || {};\r\n\t\tthis.component = (functions[this.functionId] && functions[this.functionId].components) || {};\r\n\t\tthis.action = (functions[this.functionId] && functions[this.functionId].actions) || {};\r\n\t\tthis.configuration = (functions[this.functionId] && functions[this.functionId].configurations) || functions['defaults'].configurations;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetStateValue(stateKey, state) {\r\n\t\t\r\n\t\t['value', 'unit'].forEach(key => {\r\n\t\t\tstate[key] = (this.configuration[stateKey] && this.configuration[stateKey][key] && ((typeof this.configuration[stateKey][key] === 'function' && this.configuration[stateKey][key](state.val)) || (typeof this.configuration[stateKey][key] !== 'function' && this.configuration[stateKey][key]))) || state[key] || '';\r\n\t\t});\r\n\t\t\r\n\t\treturn state;\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport Function from './Function';\r\nimport moment from 'moment';\r\n\r\n\r\n/**\r\n * Device\r\n *\r\n * @param\t{Object}\tdeviceProperties\r\n * @param\t{String}\tdeviceProperties.id\r\n * @param\t{String}\tdeviceProperties.name\r\n * @param\t{String}\t[deviceProperties.room=null]\r\n * @param\t{String}\tdeviceProperties.function\r\n * @param\t{Object}\tdeviceProperties.states\r\n * @param\t{Object}\t[deviceProperties.attributes={}]\r\n * @param\t{Object}\tdeviceProperties.options\r\n * @param\t{Object}\tsocket\r\n * @return\t{Device}\r\n *\r\n */\r\nexport default class Device extends Function {\r\n\t\r\n\tconstructor(deviceProperties, socket, defaults = { 'states': {}, 'styles': {} }) {\r\n\t\ttry {\r\n\t\t\tsuper(deviceProperties.function);\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthrow new Error('No function given for device ' + deviceProperties.name + '!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.id = deviceProperties.id;\r\n\t\tthis.name = deviceProperties.name;\r\n\t\t\r\n\t\tthis.room = deviceProperties.room || null;\r\n\t\t\r\n\t\tthis.states = deviceProperties.states;\r\n\t\tthis.options = deviceProperties.options;\r\n\t\tthis.attributes = deviceProperties.attributes || {};\r\n\t\t\r\n\t\tthis.socket = socket;\r\n\t\t\r\n\t\tif (!this.options || typeof this.options !== 'object' || Object.keys(this.options).length === 0) {\r\n\t\t\tthrow new Error('Device' + (deviceProperties.id || deviceProperties.name ? ' ' + (deviceProperties.name || deviceProperties.id) : '') + ' not defined for jarvis!');\r\n\t\t}\r\n\t\telse if (!this.states || typeof this.states !== 'object' || Object.keys(this.states).length === 0) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no states defined)!');\r\n\t\t}\r\n\t\telse if (!this.id || !this.name || !this.function) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no id, name or function defined)!');\r\n\t\t}\r\n\t\telse if (!this.socket) {\t\r\n\t\t\tthrow new Error('No socket given!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.defaults = defaults;\r\n\t\tthis._setProperties();\r\n\t\tthis.stateSubscriptions = [];\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object|String}\r\n\t * @private\r\n\t */\r\n\t_getStateFromKey(stateKey = null) {\r\n\t\t\r\n\t\t// already a state object\r\n\t\tif (stateKey && typeof stateKey === 'object') {\r\n\t\t\treturn stateKey;\r\n\t\t}\r\n\t\t\r\n\t\t// get state object\r\n\t\tlet s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tif (!s || !s.state) {\r\n\t\t\treturn 'Incorrect or non-defined state key for device ' + this.name + '!';\r\n\t\t}\r\n\t\telse if (typeof s.state == 'string') {\r\n\t\t\ts.state = { 'node': s.state };\r\n\t\t}\r\n\t\telse if (typeof s.state == 'object' && !s.state.node) {\r\n\t\t\treturn 'No state specified to retrieve for device ' + this.name + '!';\r\n\t\t}\r\n\t\t\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_setObjectStructure(obj, defaultValue = null) {\r\n\t\t\r\n\t\tif (!obj || typeof obj != 'object') {\r\n\t\t\tobj = { 'default': obj || defaultValue };\r\n\t\t}\r\n\t\telse if (typeof obj == 'object' && !obj.default) {\r\n\t\t\tobj.default = defaultValue;\r\n\t\t}\r\n\t\t\r\n\t\treturn obj;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return void\r\n\t * @private\r\n\t *\r\n\t */\r\n\t_setProperties() {\r\n\t\t\r\n\t\t// properties\r\n\t\tthis.primaryStateKey = this.options.primary || Object.keys(this.states)[0];\r\n\t\tthis.secondaryStateKey = this.options.secondary || null;\r\n\t\t\r\n\t\t// styles\r\n\t\tthis.options.styles =  { ...this.defaults.styles, ...this.options.styles || {} };\r\n\t\t\r\n\t\t// all options\r\n\t\tthis.options.groups = Array.isArray(this.options.group) ? this.options.group : [this.options.group];\r\n\t\tthis.options.sort = this.options.sort || 999;\r\n\t\t\r\n\t\tthis.options.label = (this.options.label && (typeof this.options.label === 'string' && this.options.label.replace(/%name%/g, this.name))) || this.options.label || this.name;\r\n\t\tthis.options.icon = this._setObjectStructure(this.options.icon, 'square-medium');\r\n\t\tthis.options.mapping = this._setObjectStructure({ ...this.defaults.states, ...this.options.secondaryStateMapping, ...this.options.primaryStateMapping });\r\n\t\tthis.options.subtitle = this.options.subtitle;\r\n\t\tthis.options.divider = this.options.divider || false;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_updateDeviceState(stateKey, state) {\r\n\t\t\r\n\t\tstate.timeChanged = moment(state.lc-2000).fromNow();\r\n\t\tstate.value = this.options.mapping[stateKey + '#' + state.val] || this.options.mapping[state.val] || state.val;\r\n\t\treturn super.setStateValue(stateKey, state);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tget(property) {\r\n\t\treturn this[property] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetAction(stateKey) {\r\n\t\tconst Action = this.action[stateKey];\r\n\t\treturn (Action && <Action device={this} state={{...this.states[stateKey], 'stateKey': stateKey}} />) || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetComponent(stateKey) {\r\n\t\tconst Component = this.component[stateKey];\r\n\t\treturn (Component && <Component device={this} state={{...this.states[stateKey], 'stateKey': stateKey}} />) || stateKey;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetDeviceState(stateKey = null, stateProperty = null) {\r\n\t\tconst s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tlet deviceState = null;\r\n\t\t\r\n\t\tif (s && s.state && stateProperty !== null && s.state.value !== undefined && s.state.value[stateProperty] !== undefined) {\r\n\t\t\tdeviceState = s.state.value[stateProperty];\r\n\t\t}\r\n\t\telse if (s && s.state && stateProperty === null && s.state.value !== undefined) {\r\n\t\t\tdeviceState = s.state.value;\r\n\t\t}\r\n\t\t\r\n\t\treturn deviceState;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetIcon(stateKey) {\r\n\t\treturn this.icon[stateKey];\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetOption(option, stateVal = 'default') {\r\n\t\treturn (this.options[option] && (this.options[option][stateVal] || this.options[option]['default'])) || this.options[option] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetStyle(attribute, stateVal = 'default') {\r\n\t\treturn (this.options.styles[attribute] && (this.options.styles[attribute][stateVal] || this.options.styles[attribute]['default'])) || {};\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\trender() { return null }\r\n\t\r\n\t/**\r\n\t * Requests all state values from the backend.\r\n\t *\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Array<Promises>}\r\n\t *\r\n\t */\r\n\trequestDeviceStates(subscribe = false) {\r\n\t\t\r\n\t\tlet responses = [];\r\n\t\tfor (let stateKey in this.states) {\r\n\t\t\tresponses.push(this.requestDeviceState(stateKey, subscribe));\r\n\t\t}\r\n\t\t\r\n\t\treturn responses;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\tstateKey\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceState(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.value !== undefined && this.stateSubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getState(s.state.node)\r\n\t\t\t\t\t.then(state => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err.message }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetDeviceState(stateKey = null, value) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tthis.socket.setState(s.state.node, value).then(res => {\r\n\t\t\t\t\r\n\t\t\t\t// get state value if not subscribed\r\n\t\t\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\t\t\tthis.requestDeviceState(stateKey);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsubscribeDeviceState(stateKey = null) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\t// add subscription\t\r\n\t\tthis.stateSubscriptions.push(stateKey);\r\n\t\t\r\n\t\t// subscrbe\r\n\t\tthis.socket.subscribeState(s.state.node, (id, state) => {\r\n\t\t\t\r\n\t\t\tif (state && state.val !== this.getDeviceState(stateKey, 'val')) {\r\n\t\t\t\t\r\n\t\t\t\t// format value\r\n\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\r\n\t\t\t\t// publish state change\r\n\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport multipleClassNames from 'classnames';\r\n\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListIcon: props => ({\r\n\t\t...theme.components.icon,\r\n\t\t...props.styles\r\n\t}),\r\n\tdefaultListItemActionPrimary: props => ({\r\n\t\t...props.styles\r\n\t}),\r\n\tdefaultListItemActionSecondary: props => ({\r\n\t\tcolor: '#999',\r\n\t\tfontSize: '14px',\r\n\t\t...props.styles\r\n\t}),\r\n\thorizontalListItem: {\r\n\t\tdisplay: 'inline-block',\r\n\t\ttextAlign: 'center',\r\n\t\tpaddingRight: '16px',\r\n\t\tminWidth: '150px',\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\thorizontalListItemIcon: {\r\n\t\tminWidth: 'auto'\r\n\t},\r\n\thorizontalListItemAction: {\r\n\t\ttextAlign: 'center',\r\n\t\ttop: 0,\r\n\t\tright: 0,\r\n\t\tposition: 'static',\r\n\t\ttransform: 'none',\r\n\t},\r\n\tverticalListItemAction: {\r\n\t\ttextAlign: 'right'\r\n\t}\r\n});\r\n\r\n\r\nconst ListDivider = ({ title }) => (\r\n\t<React.Fragment>\r\n\t\t<ListItem divider style={{margin: '5px 0 0 0'}} />\r\n\t\t<li>\r\n\t\t\t<Typography\r\n\t\t\t\tstyle={{margin: '5px 0 0 0px'}}\r\n\t\t\t\tdisplay=\"block\"\r\n\t\t\t\tvariant=\"caption\"\r\n\t\t\t>\r\n\t\t\t{title}\r\n\t\t\t</Typography>\r\n\t\t</li>\r\n    </React.Fragment>\r\n);\r\n\r\nconst ListItemIconElement = withStyles(styles)(props => {\r\n\tconst { customClassNames, children, classes, styles } = props;\r\n\t\r\n\tlet classNames = Array.isArray(customClassNames) ? customClassNames : [customClassNames];\r\n\tclassNames = classNames.map(className => (classes[className] ? classes[className] : className));\r\n\t\r\n\treturn (<span className={multipleClassNames(classNames)}>{children}</span>);\r\n});\r\nconst ListItemAction = ListItemIconElement;\r\n\r\n\r\nclass StateListItem extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t\tthis.state[this.props.device.primaryStateKey] = this.props.device.getDeviceState() || {}\r\n\t\t\r\n\t\tif (this.props.device.secondaryStateKey) {\r\n\t\t\tthis.state[this.props.device.secondaryStateKey] = this.props.device.getDeviceState(this.props.device.secondaryStateKey) || {}\r\n\t\t}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\tthis.props.device.on('stateChange', (stateKey, state) => {\r\n\t\t\t\r\n\t\t\tif (stateKey === this.props.device.primaryStateKey || stateKey === this.props.device.secondaryStateKey) {\r\n\t\t\t\tthis.setState({ [stateKey]: state });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, prevSubgroup, device } = this.props;\r\n\t\t\r\n\t\tconsole.log(device);\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tlet options = device.get('options');\r\n\t\tlet icon = null, primary = null, secondary = null, action = null;\r\n\t\tsecondary = this.state[device.secondaryStateKey] && <ListItemAction key={'secondary_' + device.id} customClassNames=\"defaultListItemActionSecondary\" styles={{...device.getStyle('state', this.state[device.secondaryStateKey].val), ...device.getStyle('secondaryState', this.state[device.secondaryStateKey].val)}}>{this.state[device.secondaryStateKey].value} {this.state[device.secondaryStateKey].unit}</ListItemAction>\r\n\t\t\r\n\t\tif (this.state[device.primaryStateKey]) {\r\n\t\t\ticon = device.getOption('icon', this.state[device.primaryStateKey].val);\r\n\t\t\tprimary = <ListItemAction key={'primary_' + device.id} customClassNames=\"defaultListItemActionPrimary\" styles={{...device.getStyle('state', this.state[device.primaryStateKey].val), ...device.getStyle('primaryState', this.state[device.primaryStateKey].val)}}>{this.state[device.primaryStateKey].value} {this.state[device.primaryStateKey].unit}</ListItemAction>\r\n\t\t\taction = device.getOption('action') || (!secondary ? primary : [primary, <br key={'br_' + device.id} />, secondary]);\r\n\t\t}\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t{options.divider && <ListItem divider style={{margin: '5px 0'}} />}\r\n\t{prevSubgroup !== null && options.subgroup !== null && options.subgroup !== prevSubgroup && <ListDivider title={options.subgroup} />}\r\n\t\r\n\t<ListItem\r\n\t\tclassName={multipleClassNames(this.props.openDialog && classes.finger, horizontal && classes.horizontalListItem)}\r\n\t\tbutton={this.props.openDialog !== null}\r\n\t\tonClick={this.props.openDialog && this.openDialog.bind(this)}\r\n\t\t>\r\n\t\t\r\n\t\t{icon !== null &&\r\n\t\t<ListItemIcon className={ horizontal && classes.horizontalListItemIcon }>\r\n\t\t\t<ListItemIconElement customClassNames={['defaultListIcon','mdi mdi-' + icon]} styles={device.getStyle('icon', this.state[device.primaryStateKey].val)} />\r\n\t\t</ListItemIcon>\r\n\t\t}\r\n\t\t\r\n\t\t<ListItemText\r\n\t\t\tprimary={device.getOption('label')}\r\n\t\t\tsecondary={(options.subtitle !== null ? (options.subtitle || (this.state[device.primaryStateKey] && this.state[device.primaryStateKey].timeChanged) || null) : null)}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={ horizontal ? classes.horizontalListItemAction : classes.verticalListItemAction }>\r\n\t\t\t{action}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateListItem);\r\n","import React from 'react';\r\n\r\nimport List from '@material-ui/core/List';\r\nimport StateListItem from './StateListItem';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\thorizontalList: {\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'row',\r\n\t\tflexWrap: 'wrap'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function StateList(props) {\r\n\tconst { horizontal, openDialog, devices } = props;\r\n\tconst classes = useStyles();\r\n\tlet subgroup;\r\n\t\r\n\treturn (\r\n\r\n<List dense={true} className={horizontal && classes.horizontalList}>\r\n\t{devices.map(device => {\r\n\t\tconst listItem = <StateListItem horizontal={horizontal} openDialog={openDialog} prevSubgroup={subgroup} key={device.get('id')} device={device} />;\r\n\t\tsubgroup = device.getOption('subgroup');\r\n\t\treturn listItem;\r\n\t})}\r\n</List>\r\n\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport Device from '../Device';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\r\nimport MuiDialogContent from '@material-ui/core/DialogContent';\r\nimport MuiDialogActions from '@material-ui/core/DialogActions';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport StateList from './StateList';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n});\r\n\r\n\r\nconst DialogTitle = withStyles(styles)(props => {\r\n\tconst { children, classes, onClose, ...other } = props;\r\n\treturn (\r\n\r\n<MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n\t<Typography variant=\"h6\">{children}</Typography>\r\n\t{onClose ? (\r\n\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t<CloseIcon />\r\n\t</IconButton>\r\n\t) : null}\r\n</MuiDialogTitle>\r\n\r\n\t);\r\n});\r\n\r\nconst DialogContent = withStyles(theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles(theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n}))(MuiDialogActions);\r\n\r\n\r\nexport default class Popup extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tchildren: []\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tif (this.props.contents && this.props.contents.device && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\tlet device = this.props.contents && this.props.contents.device;\r\n\t\t\t\r\n\t\t\t// loop through states and request status\r\n\t\t\tlet responses = [];\r\n\t\t\tlet children = [];\r\n\t\t\t\r\n\t\t\tfor (let stateKey in device.states) {\r\n\t\t\t\t\r\n\t\t\t\tif (device.states[stateKey].state === undefined) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\tlet child = new Device({\r\n\t\t\t\t\t\t\t'id': device.id + '#' + stateKey,\r\n\t\t\t\t\t\t\t'name': device.name,\r\n\t\t\t\t\t\t\t'function': device.function,\r\n\t\t\t\t\t\t\t'states': { [stateKey]: device.states[stateKey] },\r\n\t\t\t\t\t\t\t'options': {\r\n\t\t\t\t\t\t\t\t'primary': stateKey,\r\n\t\t\t\t\t\t\t\t'icon': { 'default': device.getIcon(stateKey) || 'tune' },\r\n\t\t\t\t\t\t\t\t'label': device.getComponent(stateKey),\r\n\t\t\t\t\t\t\t\t'action': device.getAction(stateKey),\r\n\t\t\t\t\t\t\t\t'divider': children.length !== 0,\r\n\t\t\t\t\t\t\t\t'subgroup': null,\r\n\t\t\t\t\t\t\t\t'subtitle': null\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdevice.socket\r\n\t\t\t\t\t);\r\n\t\t\t\t\r\n\t\t\t\tresponses.push(child.requestDeviceState(null, true));\r\n\t\t\t\tchildren.push(child);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tPromise.allSettled(responses).then(() => this.setState({ 'children': children }, () => this.forceUpdate()));\r\n\t\t}\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(nextProps, nextState) {\r\n\t\treturn !this.props.contents || this.props.contents.ts !== nextProps.contents.ts;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { open, closeDialog, contents } = this.props;\r\n\t\tconst { ts, device } = contents;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog onClose={closeDialog} open={open || false} maxWidth={'md'} fullWidth={true}>\r\n\t<DialogTitle onClose={closeDialog}>\r\n\t\t{device.name}\r\n\t</DialogTitle>\r\n\t<DialogContent dividers style={{ padding: 0 }}>\r\n\t\t\r\n\t\t<StateList openDialog={null} devices={this.state.children} />\t\r\n\t\t\r\n\t</DialogContent>\r\n\t<DialogActions>\r\n\t\t<Button autoFocus onClick={closeDialog} color=\"primary\">\r\n\t\t\tClose\r\n\t\t</Button>\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t\t);\r\n\t};\r\n}\r\n","import React from 'react';\r\n\r\nimport Card from '@material-ui/core/Card';\r\nimport CardHeader from '@material-ui/core/CardHeader';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tcard: {\r\n\t\tmargin: theme.spacing(),\r\n\t\tmarginLeft: 0,\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: theme.spacing(0.5)\r\n\t\t}\r\n\t},\r\n\tcardHeaderNoContents: {\r\n\t\tpadding: theme.spacing(),\r\n\t},\r\n\tcardAvatar: props => ({\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff',\r\n\t\tfontSize: '24px',\r\n\t\t...props\r\n\t}),\r\n\tcardContent: {\r\n\t\tpadding: theme.spacing(0, 2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpadding: theme.spacing(0)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Box(props) {\r\n\tconst { title, icon, iconStyle } = props;\r\n\tconst classes = useStyles(iconStyle);\r\n\t\r\n\treturn (\r\n\r\n<Card className={classes.card}>\r\n\t<CardHeader\r\n\t\tavatar={icon !== null &&\r\n\t\t\t<Avatar variant=\"rounded\" classes={{ root: classes.cardAvatar }}>\r\n\t\t\t\t{React.createElement('span', { 'className': 'mdi mdi-' + (icon || 'home') })}\r\n\t\t\t</Avatar>\r\n\t\t}\r\n\t\ttitle={title &&\r\n\t\t\t<Typography variant=\"h5\" component=\"h2\">\r\n\t\t\t\t{title}\r\n\t\t\t</Typography>\r\n\t\t}\r\n\t/>\r\n\t<CardContent className={classes.cardContent}>\r\n\t\t{props.children}\r\n\t</CardContent>\r\n</Card>\r\n\r\n\t);\r\n}\r\n","import { createMuiTheme } from '@material-ui/core/styles';\r\nimport { pink } from '@material-ui/core/colors';\r\nimport blue from '@material-ui/core/colors/blue';\r\n\r\nconst primary = blue[700];\r\nconst secondary = pink;\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: {\r\n\t\t\tmain: primary \r\n\t\t},\r\n\t\tsecondary: pink,\r\n\t},\r\n\tcomponents: {\r\n\t\ticon: {\r\n\t\t\tfontSize: '24px',\r\n\t\t\tcolor: primary\r\n\t\t},\r\n\t\t'finger': {\r\n\t\t\tcursor: 'pointer'\r\n\t\t}\r\n\t}\r\n});\r\n\r\nconsole.debug(theme);\r\nexport default theme;","import React from 'react';\n\nimport Grid from '@material-ui/core/Grid';\nimport Drawer from '@material-ui/core/Drawer';\n//import Tabs from './components/Tabs';\n\nimport Popup from './components/Popup';\nimport Box from './components/Box';\nimport StateList from './components/StateList';\nimport StateListHorizontal from './components/StateListHorizontal';\n//import Map from './components/Map';\n\n/*\n * STYLES\n */\nimport { ThemeProvider, withStyles } from '@material-ui/core/styles';\nimport theme from './theme';\nconst styles = theme => ({\n\t'gridContainer': {\n\t\tpaddingLeft: theme.spacing(),\n\t\t[theme.breakpoints.down('md')]: {\n\t\t\tpaddingLeft: theme.spacing(0),\n\t\t\tbackgroundColor: '#f00'\n\t\t}\n\t}\n});\n\n/*\n * COMPONENTS\n */\nconst COMPONENTS = {\n\tStateList,\n\tStateListHorizontal,\n\tMap\n}\n\n/*\n *\n */\nconst getGridColumn = (columnContent, groups, action = null) => {\n\tconsole.log(\"getGridColumn()\");\n\t\n\tlet contents = [];\n\tfor (let index in columnContent) {\n\t\t\n\t\tlet groupId = columnContent[index];\n\t\tlet group = groups[groupId];\n\t\t\n\t\tif (!group) {\n\t\t\tconsole.error('Group ' + groupId + ' defined in columns but not assigned to any devices!');\n\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tconst Tag = COMPONENTS[group.settings.component || 'StateList'];\n\t\tif (Tag === undefined) {\n\t\t\tconsole.error('Undefined component \"' + group.settings.component + '\" used!');\n\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tcontents.push(\n\t\t\t<Box key={'Box' + groupId} title={group.settings.title !== null ? (group.settings.title || group.name) : null} icon={group.settings.icon} iconStyle={group.settings.iconStyle}>\n\t\t\t\t<Tag key={'Tag' + groupId} devices={group.devices} openDialog={action} />\n\t\t\t</Box>\n\t\t);\n\t}\n\t\n\treturn contents;\n};\n\n/*\n *\n */\nconst getGrid = (columns = 3, contents = {}, groups, action) => {\n\tconsole.log(\"getGrid()\");\n\t\n\tlet grid = [];\n\tfor (let column = 1; column <= columns; column++) {\n\t\t\n\t\tif (!contents[column]) {\n\t\t\tconsole.error('No content for column #' + column + '!');\n\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tconst gridColumn = getGridColumn(contents[column], groups, action);\n\t\tgrid.push(\n\t\t\t<Grid key={column} item\t\t\t\t// @see https://material-ui.com/customization/breakpoints/\n\t\t\t\txs={12}\t\t\t\t\t\t\t//    0 -  600px\n\t\t\t\tsm={6}\t\t\t\t\t\t\t//  600 -  960px\n\t\t\t\tmd={6}\t\t\t\t\t\t\t//  960 - 1280px\n\t\t\t\tlg={Math.round(12/columns)}\t\t// 1280 - 1920px\n\t\t\t\txl={Math.round(12/columns)}\t\t// \t\t> 1920px\n\t\t\t\t>\n\t\t\t\t\n\t\t\t\t{gridColumn}\n\t\t\t</Grid>\n\t\t);\n\t}\n\t\n\treturn grid;\n};\n\n\nclass Jarvis extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tnotificationDrawer: false,\n\t\t\tdialog: false,\n\t\t\tdialogContents: {\n\t\t\t\t'ts': 0,\n\t\t\t\t'device': {}\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.openDialog = this.openDialog.bind(this);\n\t\tthis.closeDialog = this.closeDialog.bind(this);\n\t\t//this.toggleDrawer = this.toggleDrawer.bind(this);\n\t};\n\t\n\topenDialog(device) {\n\t\tthis.setState({ 'dialog': true, 'dialogContents': { 'ts': Date.now(), 'device': device } });\n\t};\n\t\n\tcloseDialog() {\n\t\tthis.setState({ 'dialog': false, 'dialogContents': { 'ts': Date.now(), 'device': {} } });\n\t};\n\t\n\t/*\n\ttoggleDrawer(drawer, open) {\n\t\tthis.setState({ [drawer]: open });\n\t};\n\t*/\n\t\n    render() {\n\t\tconst { classes } = this.props;\n\t\tconst grid = getGrid(\n\t\t\tthis.props.settings.columns && this.props.settings.columns.number,\n\t\t\tthis.props.settings.columns && this.props.settings.columns.groups,\n\t\t\tthis.props.groups,\n\t\t\tthis.openDialog\n\t\t);\n\t\t\n        return (\n\n<ThemeProvider theme={theme}>\n\t{/*\n\t<Tabs />\n\t\n\t{/*\n\t<Drawer anchor=\"right\" open={this.state.notificationDrawer} onClose={this.toggleDrawer('notificationDrawer', false)}>\n\t\t\n\t</Drawer>\n\t\t<Map />\n\t*/}\n\n\t<Popup open={this.state.dialog} contents={this.state.dialogContents} closeDialog={this.closeDialog} />\n\t<Grid container spacing={0} className={classes.gridContainer}>\n\t\t{grid}\n\t</Grid>\n</ThemeProvider>\n\n\t\t)\n\t};\n}\n\nexport default withStyles(styles)(Jarvis);\n","import React from 'react';\r\n\r\nimport StateList from './StateList';\r\n\r\n\r\nexport default function StateListHorizontal(props) {\r\n\treturn (<StateList horizontal={true} {...props} />);\r\n}\r\n","import React from 'react';\nimport Socket from './Socket';\nimport Device from './Device';\nimport Jarvis from './Jarvis';\n\n/*\n *\n *\n */\nconst NODE_SETTINGS = 'jarvis.0.settings';\nconst NODE_DEVICES = 'jarvis.0.devices';\n\nconst DEAULTS_STATES = { true: 'an', false: 'aus', 0: 'aus' };\nconst DEFAULT_STYLES = {\n\t'state': {\n\t\ttrue: { 'color': '#090', 'fontWeight': 'bold' },\n\t\tfalse: { 'color': '#999' },\n\t\t0: { 'color': '#999' }\n\t}\n};\n\n\nclass App extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tloaded: [],\n\t\t\terror: false,\n\t\t\terrorMessage: ''\n\t\t}\n\t};\n\t\n\tcomponentDidMount() {\n\t\t\n\t\t// data connection\n\t\tlet url = window.location.hostname === 'localhost' ? 'https://192.168.178.29:8082' : null;\n\t\tthis.socket = new Socket(url);\n\t\t\n\t\tthis.socket.on('error', error => {\n\t\t\tthis.setState({\n\t\t\t\terror: true,\n\t\t\t\terrorMessage: error\n\t\t\t});\n\t\t});\n\t\t\n\t\t\n\t\t// get settings\n\t\tthis.settings = {};\n\t\t\n\t\tthis.socket.getState(NODE_SETTINGS)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.settings = state && JSON.parse(state.val);\n\t\t\t\t\tthis.useSettings();\n\t\t\t\t\tthis.setState({ loaded: [...this.state.loaded, 'settings'] });\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing settings!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: err\n\t\t\t\t});\n\t\t\t});\n\t\t\n\t\t\n\t\t// get devices\n\t\tthis.devices = {};\n\t\tthis.groups = {};\n\t\t\n\t\tthis.socket.getState(NODE_DEVICES)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.devices = state && JSON.parse(state.val);\n\t\t\t\t\tthis.groups = this.processDevices(this.devices);\n\t\t\t\t\tthis.setState({ loaded: [...this.state.loaded, 'groups'] });\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing devices!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: err\n\t\t\t\t});\n\t\t\t});\n    };\n\t\n\t/**\n\t *\n\t *\n\t */\n\tuseSettings() {\n\t\t// page title\n\t\tif (this.settings.title) {\n\t\t\tdocument.title = this.settings.title;\n\t\t}\n\t\t\n\t\t// favicon\n\t\tif (this.settings.favicon && this.settings.favicon.substr(0, 5) === 'data:') {\n\t\t\tdocument.getElementById('favicon').href = this.settings.favicon;\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tgroupDevice(groups, device) {\n\t\t\n\t\t// add device to group(s)\n\t\tlet options = device.get('options');\n\t\toptions.groups.forEach(group => {\n\t\t\t\n\t\t\tlet groupId = group.toLowerCase().replace(/ /g, '');\n\t\t\tif (!groups[groupId]) {\n\t\t\t\tgroups[groupId] = { 'id': groupId, 'name': group, 'settings': (this.settings.groups && this.settings.groups[groupId]) || {}, 'devices': [device] };\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgroups[groupId].devices.push(device);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn groups;\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevice(deviceProperties) {\n\t\t\n\t\tlet device = null;\n\t\ttry {\n\t\t\tdevice = new Device(deviceProperties, this.socket, { 'states': DEAULTS_STATES, 'styles': DEFAULT_STYLES });\n\t\t\t\n\t\t\t// request primary state value\n\t\t\tdevice.requestDeviceState(null, true).catch(err => console.error(err));\n\t\t\t\n\t\t\t// request secondary state value\n\t\t\tif (device.secondaryStateKey) {\n\t\t\t\tdevice.requestDeviceState(device.secondaryStateKey, true).catch(err => console.error(err));\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tcatch(err) {\n\t\t\tconsole.warn(err.message);\n\t\t}\n\t\t\n\t\treturn device;\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevices(deviceList) {\n\t\t\n\t\t// loop through all devices of in the device list\n\t\tlet groups = {};\n\t\t\n\t\tlet devices = 0, groupedDevices = 0, device, deviceProperties;\n\t\tfor (let deviceId in deviceList) {\n\t\t\tdevices++;\n\t\t\t\n\t\t\tdeviceList[deviceId].options = deviceList[deviceId].jarvis;\n\t\t\tdelete deviceList[deviceId].jarvis;\n\t\t\t\n\t\t\tdeviceProperties = { ...deviceList[deviceId], 'id': deviceId };\n\t\t\tdevice = this.processDevice(deviceProperties);\n\t\t\t\n\t\t\tif (device !== null) {\n\t\t\t\tgroupedDevices++;\n\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t}\n\t\t\t\n\t\t\t// check states for own device settings\n\t\t\tlet state;\n\t\t\tfor (let stateKey in deviceProperties.states) {\n\t\t\t\t\n\t\t\t\tstate = deviceProperties.states[stateKey];\n\t\t\t\tif (state && state.jarvis !== undefined) {\n\t\t\t\t\tdevice = this.processDevice({ ...deviceProperties, 'id': deviceId + '#' + stateKey, 'states': { [stateKey]: state }, 'options': state.jarvis });\n\t\t\t\t\t\n\t\t\t\t\tif (device !== null) {\n\t\t\t\t\t\tgroupedDevices++;\n\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// sort groups\n\t\tfor (let groupId in groups) {\n\t\t\tgroups[groupId].devices.sort((item1, item2) => {\n\t\t\t\tif (item1.options.sort > item2.options.sort) return 1;\n\t\t\t\telse if (item2.options.sort > item1.options.sort) return -1;\n\t\t\t\telse return 0;\n\t\t\t});\n\t\t}\n\t\t\n\t\t// return\n\t\tconsole.info('Processed ' + devices + ' devices. Added ' + groupedDevices + ' devices in ' + Object.keys(groups).length + ' groups.');\n\t\tconsole.debug(groups);\n\t\treturn groups;\n\t};\n\t\n\trenderLoading() {\n\t\treturn null;\n\t};\n\t\n    render() {\n\t\tif (this.state.error) {\n\t\t\talert(this.state.errorMessage);\n\t\t}\n\t\t\n\t\tif (this.state.loaded.length < 2) {\n\t\t\treturn this.renderLoading();\n\t\t}\n\t\t\n        return <Jarvis settings={this.settings} groups={this.groups} />\n\t};\n}\n\t\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}