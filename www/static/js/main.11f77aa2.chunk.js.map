{"version":3,"sources":["modules/StateListItem.js","modules/StateList.js","functions/blind.js","functions/door.js","i18n sync /^/.*/.js$","i18n/de.js","i18n/en.js","functions/heating.js","functions/defaults.js","i18n.js","functions/location.js","functions/user.js","modules/StateListHorizontal.js","modules/Map.js","modules/Chart.js","components/GridContainer.js","components/StatusSnackbar.js","Socket.js","Connection.js","functions/index.js","Function.js","Device.js","components/TopBar.js","helpers/useWindowDimensions.js","components/TabBar.js","modules/index.js","components/Popup.js","components/Widget.js","theme.js","Jarvis.js","App.js","serviceWorker.js","index.js","helpers/colorConverters.js","functions/light.js"],"names":["styles","theme","defaultListDivider","margin","defaultListSectionDivider","defaultListSectionText","breakpoints","down","defaultListIcon","props","components","icon","horizontalListItem","display","textAlign","paddingRight","width","marginTop","horizontalListItemIcon","minWidth","horizontalListItemAction","top","right","position","transform","verticalListItemAction","ListDivider","withStyles","classes","title","Fragment","ListItem","divider","className","Typography","variant","ListItemIconElement","customClassNames","children","classNames","Array","isArray","map","clsx","StateListItem","state","device","primaryStateKey","getDeviceState","secondaryStateKey","this","on","stateKey","setState","openDialog","horizontal","prevSubgroup","component","action","options","get","getIcon","val","primary","getAction","secondary","subgroup","finger","button","onClick","bind","ListItemIcon","getStyle","ListItemText","getComponent","getOption","subtitle","timeChanged","ListItemSecondaryAction","key","id","style","React","Component","useStyles","makeStyles","horizontalList","flexDirection","flexWrap","StateList","devices","List","dense","listItem","configurations","level","level2","unit","defaults","LevelComponent","actions","open","webpackContext","req","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","temperature","value","toFixed","setTemperature","humidity","Level","min","max","padding","spacing","sliderMarkLabel","Action","primaryAction","secondaryAction","color","fontSize","PowerAction","stateVal","parentOnChange","onChange","useState","checked","setChecked","useEffect","target","setDeviceState","catch","err","console","error","Label","label","linebreak","br","step","markSteps","setLevel","markStep","markLabel","onChangeCommitted","defaultValue","valueLabelDisplay","marks","number","_any","toString","battery","door","power","wind","i18n","language","log","languages","forEach","loadTranslation","translation","require","default","message","setTranslation","translations","lang","word","placeholders","indexOf","parts","split","length","join","shift","replace","RegExp","ucFirst","charAt","toUpperCase","slice","navigator","userLanguage","StateListHorizontal","height","mapOverview","left","bottom","zIndex","alignItems","cursor","mapIconContainer","mapIconParent","backgroundColor","boxShadow","borderRadius","mapIcon","palette","main","content","mapTooltip","Map","settings","defaultZoom","zoom","defaultPosition","markers","setMarkers","useRef","memoizedMapInitialised","useCallback","current","memoizedHandleClick","flyTo","requestDeviceState","prevMarkers","mapMarkers","marker","Marker","push","item","attributes","avatar","alt","name","src","aria-label","arrow","t","useFlyTo","center","whenReady","attribution","url","markerIcon","offset","info","function","substr","L","divIcon","html","iconSize","memoizedHandleMouseEvent","closeTooltip","openTooltip","riseOnHover","onMouseOver","direction","tooltipDirection","permanent","tooltipPermanent","Chart","charts","setCharts","requestDeviceStateHistory","prevCharts","history","temp","labels","data","entry","ts","datasets","fill","lineTension","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","gridContainer","paddingLeft","GridContainer","contents","columns","grid","column","Grid","xs","sm","md","lg","Math","round","xl","warn","container","success","green","dark","warning","amber","iconVariant","opacity","marginRight","variantIcon","CheckCircleIcon","WarningIcon","ErrorIcon","InfoIcon","StatusSnackbar","autoHideDuration","closeButton","onClose","other","Icon","Snackbar","anchorOrigin","vertical","SnackbarContent","IconButton","Socket","socket","io","timeout","query","statesSubscribes","emit","attempts","reason","setTimeout","stateChange","cb","cbs","reg","connected","task","hasOwnProperty","test","Promise","reject","getState","getStateHistory","EventEmitter","Connection","listeners","setUrl","connection","setListeners","listener","event","callback","setListener","window","location","hostname","blind","heating","jalousie","light","user","Function","functionType","functionId","toLowerCase","functions","defaultStyles","_isFunction","undefined","obj","Device","deviceProperties","sysLang","room","states","parent","_setProperties","stateSubscriptions","historySubscriptions","moment","stateType","s","node","config","attribute","ignoredStates","ignoredState","hiddenStates","hideStates","hideState","stateOrAttribute","groups","group","sort","lc","fromNow","pair","option","values","_getUserSetting","_getConfigurationSetting","property","stateProperty","deviceState","defaultIcon","subscribe","responses","_getStateFromKey","then","_updateDeviceState","subscribeDeviceState","res","subscribeState","params","child","appBar","flexGrow","toolbar","menuButton","transition","flexShrink","userSelect","TopBar","AppBar","Toolbar","getWindowDimensions","innerWidth","innerHeight","paddingBottom","tabs","borderBottom","fixed","indicator","fullscreen","marginLeft","TabBar","selectTab","tabBarProps","tab","setTab","setFixed","handleScroll","threshold","scrollY","prevFixed","document","getElementById","paddingTop","offsetTop","offsetHeight","addEventListener","removeEventListener","renderedTabs","i","Tab","Tabs","selectedTab","root","TabPanel","renderedTab","windowDimensions","setWindowDimensions","handleResize","useWindowDimensions","mapHeight","setMapHeight","topBarHeight","hidden","setHidden","Box","role","DialogTitle","grey","disableTypography","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Popup","prevProps","prevState","forceUpdate","getConnection","allSettled","nextProps","nextState","closeDialog","Dialog","maxWidth","fullWidth","dividers","Button","autoFocus","card","cardHeaderNoContents","cardAvatar","cardContent","Widget","iconStyle","Card","CardHeader","Avatar","createElement","CardContent","blue","pink","createMuiTheme","debug","getGroup","groupId","Tag","Modules","getGridContents","gridContents","columnContents","index","Jarvis","tabTitle","notificationDrawer","dialog","dialogContents","layout","tabsEnabled","widgetProps","tabPanels","tabLabel","tabPanel","Date","now","ThemeProvider","topBarTitle","getTabPanels","App","loaded","errorMessage","noErrorFunction","protocol","port","connect","JSON","parse","useSettings","processDevices","email","LogRocket","init","uuid","identify","setLanguage","loadTranslations","pageTitle","pageFavicon","href","promises","results","result","status","deviceList","groupedDevices","deviceId","jarvis","processDevice","groupDevice","item1","item2","stringify","justify","minHeight","CircularProgress","loading","topBar","tabBar","gridColumns","SkeletonLoader","Skeleton","animation","gridItem","loaders","random","loader","renderError","renderLoadingProgress","renderLoadingSkeleton","Boolean","match","ReactDOM","render","serviceWorker","ready","registration","unregister","HsvToRgb","h","r","g","b","f","p","q","v","floor","RgbToHex","parseInt","LightColorAction","colorSpace","setColorSpace","colors","Red","Green","Blue","Hue","Saturation","Brightness","LightColorComponent","initialColor","helpers","onChangeComplete","colorTemperature","hue","rgb","hsv","hex","setHue","hsl"],"mappings":"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","file":"static/js/main.11f77aa2.chunk.js","sourcesContent":["import React from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport ListItem from '@material-ui/core/ListItem'\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\r\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\r\nimport ListItemText from '@material-ui/core/ListItemText'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tdefaultListDivider: {\r\n\t\tmargin: '0 0 5px 0'\r\n\t},\r\n\tdefaultListSectionDivider: {\r\n\t\tmargin: '5px 0 0 0'\r\n\t},\r\n\tdefaultListSectionText: {\r\n\t\tmargin: '5px 0 0 0',\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: '5px 0 0 10px',\r\n\t\t}\r\n\t},\r\n\tdefaultListIcon: props => ({\r\n\t\t...theme.components.icon,\r\n\t\t...props.styles\r\n\t}),\r\n\thorizontalListItem: {\r\n\t\tdisplay: 'inline-block',\r\n\t\ttextAlign: 'center',\r\n\t\tpaddingRight: '16px',\r\n\t\twidth: '140px',\r\n\t\tmarginTop: '10px'\r\n\t},\r\n\thorizontalListItemIcon: {\r\n\t\tminWidth: 'auto'\r\n\t},\r\n\thorizontalListItemAction: {\r\n\t\ttextAlign: 'center',\r\n\t\ttop: 0,\r\n\t\tright: 0,\r\n\t\tposition: 'static',\r\n\t\ttransform: 'none',\r\n\t},\r\n\tverticalListItemAction: {\r\n\t\ttextAlign: 'right'\r\n\t},\r\n});\r\n\r\n\r\nconst ListDivider = withStyles(styles)(props => {\r\n\tconst { classes, title } = props;\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t<ListItem divider className={classes.defaultListSectionDivider} />\r\n\t<li>\r\n\t\t<Typography\r\n\t\t\tclassName={classes.defaultListSectionText}\r\n\t\t\tdisplay=\"block\"\r\n\t\t\tvariant=\"caption\"\r\n\t\t>\r\n\t\t{title}\r\n\t\t</Typography>\r\n\t</li>\r\n</React.Fragment>\r\n\t\r\n\t);\r\n});\r\n\r\nconst ListItemIconElement = withStyles(styles)(props => {\r\n\tconst { customClassNames, children, classes } = props;\r\n\t\r\n\tlet classNames = Array.isArray(customClassNames) ? customClassNames : [customClassNames];\r\n\tclassNames = classNames.map(className => (classes[className] ? classes[className] : className));\r\n\t\r\n\treturn <span className={clsx(classNames)}>{children}</span>\r\n});\r\n\r\n\r\nclass StateListItem extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {}\r\n\t\tthis.state[this.props.device.primaryStateKey] = this.props.device.getDeviceState() || {}\r\n\t\t\r\n\t\tif (this.props.device.secondaryStateKey) {\r\n\t\t\tthis.state[this.props.device.secondaryStateKey] = this.props.device.getDeviceState(this.props.device.secondaryStateKey) || {}\r\n\t\t}\r\n\t}\r\n\t\r\n\tcomponentDidMount() {\r\n\t\t\r\n\t\tthis.props.device.on('stateChange', (stateKey, state) => {\r\n\t\t\tif (stateKey === this.props.device.primaryStateKey || stateKey === this.props.device.secondaryStateKey) {\r\n\t\t\t\tthis.setState({ [stateKey]: state });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\topenDialog() {\r\n\t\tthis.props.openDialog(this.props.device);\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { classes, horizontal, prevSubgroup, device, component, action } = this.props;\r\n\t\t\r\n\t\tconst state = this.state[device.primaryStateKey];\r\n\t\tconst options = device.get('options');\r\n\t\t\r\n\t\tlet icon = device.getIcon(device.primaryStateKey, state.val);\r\n\t\tlet primary = device.getAction();\r\n\t\tlet secondary = action && this.state[device.secondaryStateKey] ? device.getAction(device.secondaryStateKey) : null;\r\n\t\t\r\n\t\treturn (\r\n\r\n<React.Fragment>\r\n\t\r\n\t{options.divider && options.divider !== 'after' && <ListItem divider className={classes.defaultListDivider} />}\r\n\t{prevSubgroup !== null && options.subgroup !== null && options.subgroup !== prevSubgroup && <ListDivider title={options.subgroup} />}\r\n\t\r\n\t<ListItem\r\n\t\tclassName={clsx(this.props.openDialog && classes.finger, horizontal && classes.horizontalListItem)}\r\n\t\tbutton={this.props.openDialog !== null}\r\n\t\tonClick={this.props.openDialog && this.openDialog.bind(this)}\r\n\t\t>\r\n\t\t\r\n\t\t<ListItemIcon className={clsx(horizontal && classes.horizontalListItemIcon)}>\r\n\t\t{icon === null ? <React.Fragment /> :\r\n\t\t\t<ListItemIconElement customClassNames={['defaultListIcon','mdi mdi-' + icon]} styles={device.getStyle('icon', device.primaryStateKey, state.val)} />\r\n\t\t}\r\n\t\t</ListItemIcon>\r\n\t\t\r\n\t\t<ListItemText\r\n\t\t\tprimary={(component && device.getComponent()) || device.getOption('label')}\r\n\t\t\tsecondary={(options.subtitle !== null ? (options.subtitle || (state && state.timeChanged) || null) : null)}\r\n\t\t\t/>\r\n\t\t\r\n\t\t<ListItemSecondaryAction className={ horizontal ? classes.horizontalListItemAction : classes.verticalListItemAction }>\r\n\t\t\t{!secondary ? primary : [ primary, <br key={'br_' + device.id} />, secondary ]}\r\n\t\t</ListItemSecondaryAction>\r\n\t</ListItem>\r\n\t\r\n\t{options.divider && options.divider === 'after' && <ListItem divider style={{margin: '5px 0'}} />}\r\n\t\r\n</React.Fragment>\r\n\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withStyles(styles)(StateListItem);\r\n","import React from 'react';\r\n\r\nimport List from '@material-ui/core/List';\r\nimport StateListItem from './StateListItem';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\thorizontalList: {\r\n\t\tdisplay: 'flex',\r\n\t\tflexDirection: 'row',\r\n\t\tflexWrap: 'wrap'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function StateList(props) {\r\n\tconst { horizontal, openDialog, devices, component, action } = props;\r\n\tconst classes = useStyles();\r\n\tlet subgroup;\r\n\t\r\n\treturn (\r\n\r\n<List dense={true} className={horizontal && classes.horizontalList}>\r\n\t{devices.map(device => {\r\n\t\tconst listItem = <StateListItem\r\n\t\t\t\t\t\t\tkey={device.get('id')}\r\n\t\t\t\t\t\t\thorizontal={horizontal}\r\n\t\t\t\t\t\t\topenDialog={openDialog}\r\n\t\t\t\t\t\t\tprevSubgroup={subgroup}\r\n\t\t\t\t\t\t\tdevice={device}\r\n\t\t\t\t\t\t\tcomponent={component || false}\r\n\t\t\t\t\t\t\taction={action || true}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\r\n\t\tsubgroup = device.getOption('subgroup');\r\n\t\treturn listItem;\r\n\t})}\r\n</List>\r\n\r\n\t);\r\n}\r\n","import defaults from './defaults'\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tlevel: {\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t},\r\n\t\tlevel2: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'window-shutter-open',\r\n\t\t\t\t'>90': 'window-shutter-open',\r\n\t\t\t\t'<=90': 'window-shutter'\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel2: defaults.components.LevelComponent\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\topen: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","var map = {\n\t\"./de.js\": 228,\n\t\"./en.js\": 229\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 227;","export default {\r\n\t/*\r\n\t * LOADING SCREEN\r\n\t */\r\n\t\"Retrieving settings\": \"Einstellungen werden geladen\",\r\n\t\r\n\t/*\r\n\t * GENERAL\r\n\t */\r\n\t\"on\": \"an\",\r\n\t\"off\": \"aus\",\r\n\t\r\n\t\"user\": \"User\",\r\n\t\"users\": \"Users\",\r\n\t\r\n\t\"door\": \"Tür\",\r\n\t\"window\": \"Fenster\",\r\n\t\r\n\t\"open\": \"offen\",\r\n\t\"closed\": \"geschlossen\",\r\n\t\r\n\t\"power\": \"Gerät an\",\r\n\t\"brightness\": \"Helligkeit\",\r\n\t\"wind\": \"Wind\",\r\n\t\"battery\": \"Batterie\",\r\n\t\r\n\t\r\n\t/*\r\n\t * BLINDS\r\n\t */\r\n\t\"blind#level\": \"Behanghöhe\",\r\n\t\"blind#level2\": \"Lamellenposition\",\r\n\t\r\n\t\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"light#power\": \"Licht\",\r\n\t\"light#level\": \"Helligkeit\",\r\n\t\"colorTemperature\": \"Farbtemperatur\",\r\n\t\"hue\": \"Farbe\",\r\n\t\"light#rgb\": \"Farbraum Rot-Grün-Blau (RGB)\",\r\n\t\"hex\": \"Farbe\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HEATING\r\n\t */\r\n\t\"temperature\": \"Temperatur\",\r\n\t\"humidity\": \"Luftfeuchtigkeit\",\r\n\t\"setTemperature\": \"eingestellte Temperatur\",\r\n\t\r\n\t\r\n\t/*\r\n\t * DOOR\r\n\t */\r\n\t\"bell\": \"Klingel\",\r\n\t\"lock\": \"Schloß\",\r\n\t\"presence\": \"Präsenz\",\r\n\t\r\n\t\r\n\t/*\r\n\t * HOUSEHOLD\r\n\t */\r\n\t\"running\": \"Gerät läuft\",\r\n\t\"consumption\": \"Verbrauch\"\r\n}","export default {\r\n\t/*\r\n\t * LIGHT\r\n\t */\r\n\t\"level\": \"Brightness\",\r\n\t\"colorTemperature\": \"Color Temperature\",\r\n\t\"hue\": \"Color\",\r\n\t\"color\": \"Color\",\r\n\t\"hex\": \"Color\",\r\n}","import React from 'react'\r\n\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction HeatingSetTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={0} max={35} {...props} />\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\ttemperature: {\r\n\t\t\tvalue: (val) => val.toFixed(1),\r\n\t\t\tunit: ' °C'\r\n\t\t},\r\n\t\tsetTemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer-chevron-up'\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tsetTemperature: HeatingSetTemperatureComponent\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React, { useState, useEffect } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Slider from '@material-ui/core/Slider'\r\nimport Switch from '@material-ui/core/Switch'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles, withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\tprimaryAction: props => ({\r\n\t\t...props.styles\r\n\t}),\r\n\tsecondaryAction: props => ({\r\n\t\tcolor: '#999',\r\n\t\tfontSize: '14px',\r\n\t\t...props.styles\r\n\t}),\r\n});\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n\tcomponent: {\r\n\t\tpadding: theme.spacing(2, 8, 2, 2)\r\n\t},\r\n\tsliderMarkLabel: {\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tdisplay: 'none',\r\n\t\t\t'&:nth-child(5)': { display: 'block' },\r\n\t\t\t'&:nth-child(15)': { display: 'block' },\r\n\t\t\t'&:nth-child(25)': { display: 'block' }\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nconst Action = withStyles(styles)(props => {\r\n//function Action(props) {\r\n\tconst { classes, device, state, stateKey } = props;\r\n\t//const classes = useStyles();\r\n\t\r\n\treturn (\r\n\r\n<span className={clsx((stateKey === device.primaryStateKey && classes.primaryAction) || (stateKey === device.secondaryStateKey && classes.secondaryAction))}>\r\n\t{state.value} {state.unit}\r\n</span>\r\n\r\n\t);\r\n});\r\n\r\nfunction PowerAction(props) {\r\n\tconst { device, stateKey, stateVal, onChange: parentOnChange } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal);\r\n\tuseEffect(() => setChecked(stateVal), [stateVal]);\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n<Switch\r\n\tchecked={checked}\r\n\tonChange={parentOnChange || onChange}\r\n\tvalue={checked !== true}\r\n\tcolor=\"primary\"\r\n\t/>\r\n\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction Label(props) {\r\n\tconst { label, br } = props;\r\n\tconst linebreak = br || false;\r\n\t\r\n\treturn (\r\n\t\r\n<React.Fragment>\r\n\t<Typography>{label}</Typography>\r\n\t{linebreak && <br />}\r\n</React.Fragment>\r\n\t\r\n\t);\r\n}\r\n\r\nfunction Component(props) {\r\n\tconst { title, children } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Label label={title} />\r\n\t<div className={classes.component}>\r\n\t\t{children}\r\n\t\r\n\t</div>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\nfunction LevelComponent(props) {\r\n\tlet { device, stateKey, stateVal, title, min, max, step, markSteps } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst onChange = (e, val) => {\r\n\t\tsetLevel(val);\r\n\t\tdevice.setDeviceState(stateKey, val).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [level, setLevel] = useState(stateVal);\r\n\tuseEffect(() => setLevel(stateVal), [stateVal]);\r\n\t\r\n\t// default settings\r\n\tmin = min || 0;\r\n\tmax = max || 100;\r\n\tstep = step || 1;\r\n\tmarkSteps = markSteps || 11; // 0 to 10\r\n\tlet markStep = ((max-min)/(markSteps-1)) || 10;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<Slider\r\n\t\tclasses={{ markLabel: classes.sliderMarkLabel }}\r\n\t\t//onChange\r\n\t\tonChangeCommitted={onChange}\r\n\t\tdefaultValue={level}\r\n\t\tvalueLabelDisplay=\"auto\"\r\n\t\tmarks={[...Array(markSteps).keys()].map(number => ({ 'value': min+number*markStep, 'label': min+number*markStep }))}\r\n\t\tmin={min}\r\n\t\tmax={max}\r\n\t\tstep={step}\r\n\t/>\r\n\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\t_any: {\r\n\t\t\tvalue: (val) => val.toString(),\r\n\t\t\t//unit\r\n\t\t\t//icon\r\n\t\t\t//state\r\n\t\t},\r\n\t\tbattery: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'battery-medium'\r\n\t\t},\r\n\t\tdoor: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'door-open',\r\n\t\t\t\t'false': 'door-closed'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'open',\r\n\t\t\t\t'false': 'closed'\r\n\t\t\t},\r\n\t\t},\r\n\t\thumidity: {\r\n\t\t\tunit: ' %',\r\n\t\t\ticon: 'water-percent'\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tunit: ' %'\r\n\t\t},\r\n\t\tposition: {\r\n\t\t\ticon: 'map-marker'\r\n\t\t},\r\n\t\tpower: {\r\n\t\t\tstate: {\r\n\t\t\t\t'true': 'on',\r\n\t\t\t\t'false': 'off'\r\n\t\t\t},\r\n\t\t\ticon: 'power'\r\n\t\t},\r\n\t\ttemperature: {\r\n\t\t\tunit: ' °C',\r\n\t\t\ticon: 'thermometer'\r\n\t\t},\r\n\t\twind: {\r\n\t\t\tunit: ' km/h',\r\n\t\t\ticon: 'weather-windy'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tLabel,\r\n\t\tComponent,\r\n\t\tLevelComponent,\r\n\t\t\r\n\t\tlevel: LevelComponent\r\n\t},\r\n\tactions: {\r\n\t\tAction,\r\n\t\tPowerAction,\r\n\t\t\r\n\t\tpower: PowerAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'true': {\r\n\t\t\t\t\t'color': '#090',\r\n\t\t\t\t\t'fontWeight': 'bold'\r\n\t\t\t\t},\r\n\t\t\t\t'false': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","/**\r\n * Internationalization\r\n * Based on https://raw.githubusercontent.com/ioBroker/adapter-react/master/src/i18n.js.\r\n * Copyright 2018-2019 bluefox <dogafox@gmail.com>\r\n *\r\n * MIT License\r\n *\r\n *\r\n */\r\nexport default class i18n {\r\n\r\n\t/*\r\n\t * holds the translations\r\n\t */\r\n\tstatic translations = {};\r\n\r\n\t/*\r\n\t * default language\r\n\t */\r\n\tstatic language = navigator.language || navigator.userLanguage || 'en';\r\n\r\n\t/**\r\n\t * Override default language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setLanguage(language) {\r\n\t\tif (language) {\r\n\t\t\ti18n.language = language;\r\n\t\t\tconsole.log('i18n: Set language to ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads multiple translations.\r\n\t *\r\n\t * @param\t{String|Array}\tlanguages\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslations(languages) {\r\n\t\t\r\n\t\tif (languages) {\r\n\t\t\tlanguages = Array.isArray(languages) ? languages : [languages];\r\n\t\t\tlanguages.forEach(language => i18n.loadTranslation(language));\r\n\t\t\t\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Loads a translation.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic loadTranslation(language) {\r\n\t\t\r\n\t\tif (language) {\r\n\t\t\tlet translation;\r\n\t\t\ttry {\r\n\t\t\t\ttranslation = require('./i18n/' + language + '.js').default;\r\n\t\t\t}\r\n\t\t\tcatch(err) {\r\n\t\t\t\tconsole.error(err.message);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\ti18n.setTranslation(language, translation);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a translation for language.\r\n\t *\r\n\t * @param\t{String}\tlanguage\r\n\t * @param\t{Object}\ttranslation\r\n\t * @return\t{Boolean}\r\n\t */\r\n\tstatic setTranslation(language, translation) {\r\n\t\tif (language && translation) {\r\n\t\t\ti18n.translations[language] = { ...i18n.translations[language] || {}, ...translation };\r\n\t\t\tconsole.log('i18n: Set translations for language ' + language + '.');\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic getLanguage() {\r\n\t\treturn i18n.lang;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get current set language.\r\n\t *\r\n\t * @param\t{String}\tword\r\n\t * @param\t{Object}\t[options={}]\r\n\t * @param\t{Boolean}\t[options.ucFirst=false]\r\n\t * @param\t{Object}\t[placeholders={}]\r\n\t * @param\t{String}\t[language=i18n.language]\r\n\t * @return\t{String}\r\n\t */\r\n\tstatic t(word, options = {}, placeholders = {}, language = i18n.language) {\r\n\t\t\r\n\t\tword = word.toString();\r\n\t\tif (i18n.translations[language]) {\r\n\t\t\t\r\n\t\t\t// check if word is concatenated\r\n\t\t\tif (word.indexOf('#') > -1) {\r\n\t\t\t\t\r\n\t\t\t\tlet parts = word.split('#');\r\n\t\t\t\twhile (parts.length > 0 && !i18n.translations[language][parts.join('#')]) {\r\n\t\t\t\t\tparts.shift();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tword = i18n.translations[language][parts.join('#')] || word;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tword = i18n.translations[language][word] || word;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// replace placeholders\r\n\t\tfor (let key in placeholders) {\r\n\t\t\tword = word.replace(RegExp('%' + key + '%', 'g'), placeholders[key]);\r\n\t\t}\r\n\t\t\r\n\t\t// options\r\n\t\tif (options.ucFirst) {\r\n\t\t\tword = word.charAt(0).toUpperCase() + word.slice(1);\r\n\t\t}\r\n\t\t\r\n\t\treturn word;\r\n\t}\r\n}\r\n","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'home'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","\r\nexport default {\r\n\tconfigurations: {\r\n\t\tposition: {\r\n\t\t\ticon: 'account'\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t},\r\n\tactions: {\r\n\t},\r\n\tstyles: {\r\n\t}\r\n}","import React from 'react';\r\n\r\nimport StateList from './StateList';\r\n\r\n\r\nexport default function StateListHorizontal(props) {\r\n\treturn (<StateList horizontal={true} {...props} />);\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport L from 'leaflet'\r\nimport { Map as LeafletMap, TileLayer, Marker as LeafletMarker, Tooltip as LeafletTooltip } from 'react-leaflet'\r\n\r\nimport i18n from '../i18n'\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Avatar from '@material-ui/core/Avatar'\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tmap: {\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapOverview: {\r\n\t\tcolor: '#666',\r\n\t\tposition: 'absolute',\r\n\t\tleft: 0,\r\n\t\tbottom: 0,\r\n\t\twidth: '100%',\r\n\t\theight: '60px',\r\n\t\tzIndex: 999,\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\t\r\n\t\t'& > *': {\r\n\t\t\tmargin: theme.spacing(1),\r\n\t\t\tcursor: 'pointer',\r\n\t\t},\r\n\t},\r\n\t/*\r\n\t * MARKER WITH ICON\r\n\t *\r\n\tmapIconContainer: {\r\n\t\tbackgroundImage: 'url(\"https://unpkg.com/leaflet@1.6.0/dist/images/marker-icon-2x.png\")',\r\n\t\tbackgroundSize: '100% 100%'\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tborderRadius: '10px',\r\n\t\theight: '20px',\r\n\t\twidth: '20px',\r\n\t\tmargin: '3px auto',\r\n\t\ttextAlign: 'center'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '1.2rem',\r\n\t\tdisplay: 'block',\r\n\t\tmargin: '-4px 0 0 1px',\r\n\t\tcolor: '#f00',\r\n\t\tposition: 'absolute'\r\n\t}\r\n\t*/\r\n\tmapIconContainer: {\r\n\t},\r\n\tmapIconParent: {\r\n\t\tbackgroundColor: '#fff',\r\n\t\tboxShadow: '0 0 0 8px rgba(255, 255, 255, 0.3)',\r\n\t\tborderRadius: '50%',\r\n\t\twidth: '100%',\r\n\t\theight: '100%'\r\n\t},\r\n\tmapIcon: {\r\n\t\tfontSize: '2rem',\r\n\t\tcolor: theme.palette.primary.main,\r\n\t\ttransform: 'translate3d(4px, -4px,0)', /* for fontSize: '2.3rem' -> 'translate3d(2px, -8px,0)', */\r\n\t\tdisplay: 'block',\r\n\t\t\r\n\t\t'&:after': {\r\n\t\t\tcontent: '\"\"',\r\n\t\t\tdisplay: 'block',\r\n\t\t\tpadding: '50% 0%'\r\n\t\t}\r\n\t},\r\n\tmapTooltip: {\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Map(props) {\r\n\tconst { settings, devices } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [zoom,] = useState(settings.component.defaultZoom);\r\n\tconst [position,] = useState(Array.isArray(settings.component.defaultPosition) ? settings.component.defaultPosition : settings.component.defaultPosition.split(','));\r\n\tconst [markers, setMarkers] = useState({});\r\n\t\r\n\t// map instance\r\n\tconst map = useRef();\r\n\tconst memoizedMapInitialised = useCallback(function() {map.current = this}, [],);\r\n\t\r\n\t// Marker click in overview\r\n\tconst memoizedHandleClick = useCallback(flyTo => map.current.flyTo(flyTo.split(',')), [],);\r\n\t\r\n\t// get gps position coordinates\r\n\tuseEffect(() => {\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceState('position').catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\t\r\n\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\tif (!prevMarkers[device.id]) {\r\n\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: null };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('stateChange', (stateKey, state) => {\r\n\t\t\t\t\r\n\t\t\t\tif (stateKey === 'position') {\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetMarkers(prevMarkers => {\r\n\t\t\t\t\t\tif (!prevMarkers[device.id] || prevMarkers[device.id].position !== state.val) {\r\n\t\t\t\t\t\t\tdevice.options.position = state.val;\r\n\t\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: device };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\r\n\t}, [devices]);\r\n\t\r\n\t// add markers\r\n\tlet mapMarkers = [], mapOverview = [];\r\n\tif (devices.length > 0 && devices.length === Object.keys(markers).length) {\r\n\t\t\r\n\t\tfor (let key in markers) {\r\n\t\t\tlet device = markers[key];\r\n\t\t\tif (device !== null) {\r\n\t\t\t\tlet marker = <Marker key={'marker-' + device.id} position={device.options.position} device={device} settings={settings.component} />\r\n\t\t\t\tmapMarkers.push(marker);\r\n\t\t\t\t\r\n\t\t\t\tlet item = null;\r\n\t\t\t\tif (device.attributes.avatar) {\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} src={device.attributes.avatar} onClick={() => memoizedHandleClick(device.options.position)} />\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tconst icon = device.getIcon('position');\r\n\t\t\t\t\titem = <Avatar key={'overview-' + device.id} alt={device.name} onClick={() => memoizedHandleClick(device.options.position)}><span className={clsx('mdi mdi-' + icon)}></span></Avatar>\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tmapOverview.push(<Tooltip key={'tooltip-' + device.id} title={device.name} aria-label={device.name} arrow>{item}</Tooltip>);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<React.Fragment>\r\n\t<Box className={classes.mapOverview}>\r\n\t\t<Typography>{i18n.t('Jump to')}:</Typography>\r\n\t\t{mapOverview}\r\n\t</Box>\r\n\t<LeafletMap useFlyTo={true} center={position} zoom={zoom} className={classes.map} whenReady={memoizedMapInitialised}>\r\n\t\t<TileLayer\r\n\t\t\tattribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n\t\t\turl='https://{s}.tile.osm.org/{z}/{x}/{y}.png'\r\n\t\t\t/>\r\n\t\t\r\n\t\t{mapMarkers}\r\n\t</LeafletMap>\r\n</React.Fragment>\r\n\r\n\t);\r\n}\r\n\r\n\r\nfunction Marker(props) {\r\n\tconst { position, device, settings } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tlet markerIcon = null, offset = 40;\r\n\tconsole.info('Marker for ' + device.function + ' ' + device.name + ' added to map.');\r\n\t\r\n\t// Marker with avatar / picture\r\n\tif (device.attributes && device.attributes.avatar && device.attributes.avatar.substr(0, 11) === 'data:image/') {\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<img src=\"' + device.attributes.avatar + '\" class=\"' + classes.mapIconParent + '\" />',\r\n\t\t\ticonSize: [ 64, 64 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker with Icon\r\n\telse {\r\n\t\toffset = 30;\r\n\t\tconst icon = device.getIcon('position');\r\n\t\t\r\n\t\tmarkerIcon = L.divIcon({\r\n\t\t\tclassName: classes.mapIconContainer,\r\n\t\t\thtml: '<div class=\"' + classes.mapIconParent + '\"><span class=\"' + clsx(classes.mapIcon, 'mdi mdi-' + icon) + '\"></span></div>',\r\n\t\t\ticonSize: [ 40, 40 ]\r\n\t\t});\r\n\t}\r\n\t\r\n\t// Marker MouseOver / MouseOut (bring tooltip to front if markers overlay)\r\n\tconst memoizedHandleMouseEvent = useCallback(function() {this.closeTooltip().openTooltip()}, [],);\r\n\r\n\treturn (\r\n\r\n<LeafletMarker riseOnHover={true} position={Array.isArray(position) ? position : position.split(',')} icon={markerIcon} onMouseOver={memoizedHandleMouseEvent}>\r\n\t<LeafletTooltip className={classes.mapTooltip} direction={settings.tooltipDirection || 'bottom'} permanent={settings.tooltipPermanent || true} offset={[0,offset]}>\r\n\t\t{device.name}\r\n\t</LeafletTooltip>\r\n</LeafletMarker>\r\n\r\n\t);\r\n}","import React, { useState, useEffect, useRef, useCallback } from 'react'\r\nimport clsx from 'clsx'\r\n\r\nimport { Line } from 'react-chartjs-2';\r\n\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n}));\r\n\r\n\r\nexport default function Chart(props) {\r\n\tconst { component, devices } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst [charts, setCharts] = useState({});\r\n\t\r\n\t// get history\r\n\tuseEffect(() => {\r\n\t\t\r\n\t\tdevices.forEach(device => {\r\n\t\t\t\r\n\t\t\t// request device state\r\n\t\t\tdevice.requestDeviceStateHistory().catch(err => {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\t\r\n\t\t\t\tsetCharts(prevCharts => {\r\n\t\t\t\t\tif (!prevCharts[device.id]) {\r\n\t\t\t\t\t\treturn { ...prevCharts, [device.id]: null };\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn prevCharts;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\t// listen for updates\r\n\t\t\tdevice.on('historyChange', (stateKey, history) => {\r\n\t\t\t\t\r\n\t\t\t\tlet temp = {};\r\n\t\t\t\tif (!charts[stateKey]) {\r\n\t\t\t\t\t\r\n\t\t\t\t\ttemp[stateKey] = {\r\n\t\t\t\t\t\tlabels: [],\r\n\t\t\t\t\t\tdata: []\r\n\t\t\t\t\t};\r\n\t\t\t\t\t\r\n\t\t\t\t\thistory.forEach(entry => {\r\n\t\t\t\t\t\ttemp[stateKey].labels.push(entry.ts);\r\n\t\t\t\t\t\ttemp[stateKey].data.push(entry.val);\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetCharts(prevCharts => ({ ...prevCharts, [stateKey]: temp[stateKey] }));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t/*\r\n\t\t\t\tif (stateKey === device.primaryKey) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tsetCharts(prevCharts => {\r\n\t\t\t\t\t\tif (!prevCharts[device.id] || prevMarkers[device.id].position !== state.val) {\r\n\t\t\t\t\t\t\tdevice.options.position = state.val;\r\n\t\t\t\t\t\t\treturn { ...prevMarkers, [device.id]: device };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn prevMarkers;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t});\r\n\t\t});\r\n\t\r\n\t}, [devices]);\r\n\t\r\n\t// INDEX: { ts: 1577796089456, val: 3971.88 }\r\n/*\r\n\t\r\n\tvar myLineChart = new Chart(chart.current, {\r\n    // The type of chart we want to create\r\n    type: 'line',\r\n\r\n    // The data for our dataset\r\n    data: {\r\n        labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],\r\n        datasets: [{\r\n            label: 'My First dataset',\r\n            backgroundColor: 'rgb(255, 99, 132)',\r\n            borderColor: 'rgb(255, 99, 132)',\r\n            data: [0, 10, 5, 2, 20, 30, 45]\r\n        }]\r\n    },\r\n\r\n    // Configuration options go here\r\n    options: {}\r\n});\r\n*/\r\n\r\nlet data = {};\r\n\r\nconsole.log(charts);\r\n\r\nif (charts && charts['brightness']) {\r\ndata = {\r\n  labels: charts['brightness'].labels,\r\n  datasets: [\r\n    {\r\n      label: 'My First dataset',\r\n      fill: false,\r\n      lineTension: 0.1,\r\n      backgroundColor: 'rgba(75,192,192,0.4)',\r\n      borderColor: 'rgba(75,192,192,1)',\r\n      borderCapStyle: 'butt',\r\n      borderDash: [],\r\n      borderDashOffset: 0.0,\r\n      borderJoinStyle: 'miter',\r\n      pointBorderColor: 'rgba(75,192,192,1)',\r\n      pointBackgroundColor: '#fff',\r\n      pointBorderWidth: 1,\r\n      pointHoverRadius: 5,\r\n      pointHoverBackgroundColor: 'rgba(75,192,192,1)',\r\n      pointHoverBorderColor: 'rgba(220,220,220,1)',\r\n      pointHoverBorderWidth: 2,\r\n      pointRadius: 1,\r\n      pointHitRadius: 10,\r\n      data: charts['brightness'].data\r\n    }\r\n  ]\r\n};\r\n\r\n} \r\n\r\n\r\n\treturn (\r\n\r\n<div className={'chart-container'} style={{ position: 'relative' }}>\r\n\t<Line data={data} />\r\n</div>\r\n\r\n\t);\r\n}\r\n","import React from 'react'\r\n\r\nimport Grid from '@material-ui/core/Grid';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tgridContainer: {\r\n\t\tpaddingLeft: theme.spacing(1),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(0.4)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function GridContainer(props) {\r\n\tconst { contents = {} } = props;\r\n\t\r\n\tconst classes = useStyles();\r\n\tconst columns = Object.keys(contents).length;\r\n\t\r\n\tlet grid = [];\r\n\tfor (let column = 1; column <= columns; column++) {\r\n\t\t\r\n\t\tif (!contents[column]) {\r\n\t\t\tconsole.warn('No content for column #' + column + '!');\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t\r\n\t\tgrid.push(\r\n\t\t\t<Grid key={column} item\t\t\t\t// @see https://material-ui.com/customization/breakpoints/\r\n\t\t\t\txs={12}\t\t\t\t\t\t\t//    0 -  600px\r\n\t\t\t\tsm={6}\t\t\t\t\t\t\t//  600 -  960px\r\n\t\t\t\tmd={6}\t\t\t\t\t\t\t//  960 - 1280px\r\n\t\t\t\tlg={Math.round(12/columns)}\t\t// 1280 - 1920px\r\n\t\t\t\txl={Math.round(12/columns)}\t\t// \t\t> 1920px\r\n\t\t\t\t>\r\n\t\t\t\t\r\n\t\t\t\t{contents[column]}\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn (\r\n\r\n<Grid container spacing={0} className={classes.gridContainer}>\r\n\t{grid}\r\n</Grid>\r\n\r\n\t);\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport CheckCircleIcon from '@material-ui/icons/CheckCircle';\r\nimport WarningIcon from '@material-ui/icons/Warning';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\nimport InfoIcon from '@material-ui/icons/Info';\r\n\r\n\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { amber, green } from '@material-ui/core/colors';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tsuccess: {\r\n\t\tbackgroundColor: green[600],\r\n\t},\r\n\terror: {\r\n\t\tbackgroundColor: theme.palette.error.dark,\r\n\t},\r\n\tinfo: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t},\r\n\twarning: {\r\n\t\tbackgroundColor: amber[700],\r\n\t},\r\n\ticon: {\r\n\t\tfontSize: 20,\r\n\t},\r\n\ticonVariant: {\r\n\t\topacity: 0.9,\r\n\t\tmarginRight: theme.spacing(1),\r\n\t},\r\n\tmessage: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t},\r\n}));\r\n\r\n\r\nconst variantIcon = {\r\n\tsuccess: CheckCircleIcon,\r\n\twarning: WarningIcon,\r\n\terror: ErrorIcon,\r\n\tinfo: InfoIcon,\r\n};\r\n\r\n\r\nexport default function StatusSnackbar(props) {\r\n\tconst classes = useStyles();\r\n\tlet { className, open, autoHideDuration, message, closeButton, onClose, variant, ...other } = props;\r\n\tconst Icon = variantIcon[variant];\r\n\t\r\n\topen = open || true;\r\n\tautoHideDuration = autoHideDuration || null;\r\n\treturn (\r\n\r\n<Snackbar\r\n\tanchorOrigin={{\r\n\t\tvertical: 'bottom',\r\n\t\thorizontal: 'center',\r\n\t}}\r\n\topen={open}\r\n\tautoHideDuration={autoHideDuration}\r\n\tonClose={onClose}\r\n\t>\r\n\t<SnackbarContent\r\n\t\tclassName={clsx(classes[variant], className)}\r\n\t\tmessage={\r\n\t\t\t<span id=\"client-snackbar\" className={classes.message}>\r\n\t\t\t\t<Icon className={clsx(classes.icon, classes.iconVariant)} />\r\n\t\t\t\t{message}\r\n\t\t\t</span>\r\n\t\t}\r\n\t\taction={closeButton && [\r\n\t\t\t<IconButton key=\"close\" aria-label=\"close\" color=\"inherit\" onClick={onClose}>\r\n\t\t\t\t<CloseIcon className={classes.icon} />\r\n\t\t\t</IconButton>,\r\n\t\t]}\r\n\t\t{...other}\r\n\t\t/>\r\n\t\t\r\n</Snackbar>\r\n\r\n\t);\r\n}","import EventEmitter from 'events';\r\nimport io from 'socket.io-client';\r\n\r\n\r\n/**\r\n * Class for Socket.io conncetion handling.\r\n *\r\n * @description This is based on an implementation @GermanBluefox (https://github.com/GermanBluefox), see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\t\t\t\tOnly required functions are taken from source class. Major change is that all events are emitted, so proper error handling is possible in the App.\r\n *\r\n *\r\n * @param\t{String}\t\turl\r\n * @param\t{Object}\t\toptions\r\n * @return\t{Socket}\r\n * @see https://github.com/ioBroker/adapter-react/blob/master/src/Connection.js\r\n *\r\n */\r\nexport default class Socket extends EventEmitter {\r\n\t\r\n\tconstructor(url = null, options = {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\t// socket connection\r\n\t\tthis.socket = io(url, { timeout: 10000, ...options, query: 'ws=true' });\r\n\t\tthis.statesSubscribes = {}; // subscribed states\r\n\t\t\r\n\t\t/*\r\n\t\t * API events\r\n\t\t * @see https://github.com/socketio/socket.io-client/blob/HEAD/docs/API.md#socket\r\n\t\t *\r\n\t\t */\r\n\t\t// connect\r\n\t\tthis.socket.on('connect', () => this.emit('connect'));\r\n\t\t\r\n\t\t// reconnect: Fired upon a successful reconnection.\r\n\t\tthis.socket.on('reconnect', attempts => this.emit('reconnect', attempts));\r\n\t\t\r\n\t\t// reconnect_error: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_error', error => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// reconnect_failed: Fired upon a reconnection attempt error.\r\n\t\tthis.socket.on('reconnect_failed', () => this.emit('error', { 'type': 'reconnect', 'event': 'reconnect_failed', 'message': 'Reconnection failed!' }));\r\n\t\t\r\n\t\t// discconect\r\n\t\tthis.socket.on('disconnect', reason => this.emit('disconnect', reason));\r\n\t\t\r\n\t\t// connect_error\r\n\t\tthis.socket.on('connect_error', error => this.emit('error', { 'type': 'connect', 'event': 'connect_error', 'message': error.message }));\r\n\t\t\r\n\t\t// connect_timeout\r\n\t\tthis.socket.on('connect_timeout', () => this.emit('error', { 'type': 'connect', 'event': 'connect_timeout', 'message': 'Connect ran into timeout!' }));\r\n\t\t\r\n\t\t// error\r\n\t\tthis.socket.on('error', error => this.emit('error', { 'type': 'error', 'event': 'error', 'message': error.message }));\r\n\t\t\r\n\t\t/*\r\n\t\t * ioBroker events\r\n\t\t *\r\n\t\t */\r\n\t\tthis.socket.on('stateChange', (id, state) => setTimeout(() => this.stateChange(id, state), 0));\r\n\t}\r\n\t\r\n\t/**\r\n\t * Subscribes to a state by setting a callback.\r\n\t *\r\n\t */\r\n\tsubscribeState(id, cb) {\r\n\t\t\r\n\t\tif (!this.statesSubscribes[id]) {\r\n\t\t\tlet reg = id\r\n\t\t\t\t.replace(/\\./g, '\\\\.')\r\n\t\t\t\t.replace(/\\*/g, '.*')\r\n\t\t\t\t.replace(/\\(/g, '\\\\(')\r\n\t\t\t\t.replace(/\\)/g, '\\\\)')\r\n\t\t\t\t.replace(/\\+/g, '\\\\+')\r\n\t\t\t\t.replace(/\\[/g, '\\\\[');\r\n\r\n\t\t\tif (reg.indexOf('*') === -1) {\r\n\t\t\t\treg += '$';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.statesSubscribes[id] = { reg: new RegExp(reg), cbs: [cb] };\r\n\t\t\t\r\n\t\t\tif (this.socket.connected) {\r\n\t\t\t\tthis.socket.emit('subscribe', id);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.statesSubscribes[id].cbs.indexOf(cb) === -1 && this.statesSubscribes[id].cbs.push(cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Fires pre-registered callbacks (via subscribeState) upon state change.\r\n\t *\r\n\t */\r\n\tstateChange(id, state) {\r\n\t\t\r\n\t\tid = id ? id.replace(/[\\s'\"]/g, '_') : '';\r\n\t\tfor (const task in this.statesSubscribes) {\r\n\t\t\tif (this.statesSubscribes.hasOwnProperty(task) && this.statesSubscribes[task].reg.test(id)) {\r\n\t\t\t\tthis.statesSubscribes[task].cbs.forEach(cb => cb(id, state));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets a state.\r\n\t *\r\n\t */\r\n\tgetState(id, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getState(id, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getState', id, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the state history.\r\n\t *\r\n\t */\r\n\tgetStateHistory(id, options, cb) {\r\n\t\t\r\n\t\tif (typeof options === 'function') {\r\n\t\t\tcb = options;\r\n\t\t\toptions = {};\r\n\t\t}\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.getStateHistory(id, options, (err, state) => err ? reject(err) : resolve(state)));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('getHistory', id, options, cb);\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets a state.\r\n\t *\r\n\t */\r\n\tsetState(id, val, cb) {\r\n\t\t\r\n\t\tif (!cb) {\r\n\t\t\treturn new Promise((resolve, reject) => this.setState(id, val, err => err ? reject(err) : resolve()));\r\n\t\t} else {\r\n\t\t\tthis.socket.emit('setState', id, val, cb);\r\n\t\t}\r\n\t}\r\n}\r\n","import Socket from './Socket'\r\n\r\n/**\r\n * Connection\r\n +\r\n *\r\n */\r\nexport default class Connection {\r\n\r\n\t/*\r\n\t * URL\r\n\t */\r\n\tstatic url = window.location.hostname;\r\n\t\r\n\t/*\r\n\t * Connection\r\n\t */\r\n\tstatic connection = null;\r\n\t\r\n\t/**\r\n\t * Connects to the Socket.\r\n\t *\r\n\t * @param\t{String}\turl\r\n\t * @param\t{Array}\t\tlisteners\r\n\t * @return\t{Connection}\r\n\t */\r\n\tstatic connect(url = null, listeners = null) {\r\n\t\t\r\n\t\t// set URL\r\n\t\tif (url) {\r\n\t\t\tConnection.setUrl = url;\r\n\t\t}\r\n\t\t\r\n\t\t// connect\r\n\t\tConnection.connection = new Socket(Connection.url);\r\n\t\t\r\n\t\t// set listeners\r\n\t\tif (listeners) {\r\n\t\t\tConnection.setListeners = listeners;\r\n\t\t}\r\n\t\t\r\n\t\t// return connection\r\n\t\treturn Connection.connection;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Gets the current Connection.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{Connection}\tCurrent Connection\r\n\t */\r\n\tstatic get getConnection() {\r\n\t\treturn Connection.connection || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get the current URL.\r\n\t *\r\n\t * @param\tvoid\r\n\t * @return\t{String}\tURL\r\n\t */\r\n\tstatic get getUrl() {\r\n\t\treturn Connection.url;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sets an event listener.\r\n\t *\r\n\t * @param\t{Object}\t\t\tlistener\r\n\t * @param\t{String}\t\t\tlistener.event\r\n\t * @param\t{Function}\t\t\tlistener.callback\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setListener(listener) {\r\n\t\tConnection.connection.on(listener.event, listener.callback);\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set event listeners.\r\n\t *\r\n\t * @param\t{Array<Object>}\t\tlisteners\r\n\t * @return \t{Boolean}\r\n\t */\r\n\tstatic set setListeners(listeners = []) {\r\n\t\t\r\n\t\tif (!listeners || !Array.isArray(listeners)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\tlisteners.forEach(listener => Connection.setListener = listener);\r\n\t\treturn true;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Set a new URL (has to be set before calling connect()).\r\n\t *\r\n\t * @param\t{String}\tURL\r\n\t * @return\tvoid\r\n\t */\r\n\tstatic set setUrl(url) {\r\n\t\tConnection.url = url;\r\n\t}\r\n}\r\n","\r\nexport default {\r\n\tdefaults: require('./defaults').default,\r\n\t\r\n\tblind: require('./blind').default,\r\n\tdoor: require('./door').default,\r\n\theating: require('./heating').default,\r\n\tjalousie: require('./blind').default,\r\n\tlight: require('./light').default,\r\n\tlocation: require('./location').default,\r\n\tuser: require('./user').default,\r\n\twindow: require('./door').default\r\n}","import EventEmitter from 'events';\r\nimport functions from './functions';\r\n\r\n\r\n/**\r\n * Function\r\n *\r\n * @param\t{String}\t\tfunctionType\r\n * @return\t{Function}\r\n *\r\n */\r\nexport default class Function extends EventEmitter {\r\n\t\r\n\tconstructor(functionType) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis.function = functionType;\r\n\t\t\r\n\t\tif (!this.function) {\t\r\n\t\t\tthrow new Error('No function given!');\r\n\t\t}\r\n\t\t\r\n\t\tthis.functionId = this.function.toLowerCase();\r\n\t\t\r\n\t\t// configuration\r\n\t\tthis.defaults = functions['defaults'].configurations;\r\n\t\tthis.configurations = (functions[this.functionId] && functions[this.functionId].configurations) || {};\r\n\t\t\r\n\t\t// styles\r\n\t\tthis.defaultStyles = functions['defaults'].styles;\r\n\t\tthis.styles = (functions[this.functionId] && functions[this.functionId].styles) || {};\r\n\t\t\r\n\t\t// components and actions\r\n\t\tthis.components = { ...functions['defaults'].components, ...(functions[this.functionId] && functions[this.functionId].components) || {} };\r\n\t\tthis.actions = { ...functions['defaults'].actions, ...(functions[this.functionId] && functions[this.functionId].actions) || {} };\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Mixed}\r\n\t * @private\r\n\t */\r\n\t_applyFunction(key, val) {\r\n\t\treturn this._isFunction(key) ? key(val) : val;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{String}\r\n\t * @private\r\n\t */\r\n\t_getValueFromSettings(settings, defaults = '') {\r\n\t\t\r\n\t\tfor (let key in settings) {\r\n\t\t\tif (settings[key] !== undefined) {\r\n\t\t\t\treturn settings[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn defaults;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isFunction(key) {\r\n\t\treturn key && typeof key === 'function';\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Boolean}\r\n\t * @private\r\n\t */\r\n\t_isValue(val) {\r\n\t\treturn val !== undefined; // || val === null || val === false; // null is considered a value, so it can be used to actually null the output\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_setObjectStructure(obj, defaultValue = undefined) {\r\n\t\t\r\n\t\tif (!obj || typeof obj != 'object') {\r\n\t\t\tobj = { 'default': obj || defaultValue };\r\n\t\t}\r\n\t\telse if (typeof obj == 'object' && !obj.default) {\r\n\t\t\tobj.default = defaultValue;\r\n\t\t}\r\n\t\t\r\n\t\treturn obj;\r\n\t}\r\n}\r\n","import React from 'react'\r\nimport i18n from './i18n'\r\nimport Function from './Function'\r\nimport * as moment from 'moment/min/moment-with-locales.min.js'\r\n\r\n\r\n/**\r\n * Device\r\n *\r\n * @param\t{Object}\tdeviceProperties\r\n * @param\t{String}\tdeviceProperties.id\r\n * @param\t{String}\tdeviceProperties.name\r\n * @param\t{String}\t[deviceProperties.room=null]\r\n * @param\t{String}\tdeviceProperties.function\r\n * @param\t{Object}\tdeviceProperties.states\r\n * @param\t{Object}\t[deviceProperties.attributes={}]\r\n * @param\t{Object}\tdeviceProperties.options\r\n * @param\t{Object}\tsocket\r\n * @return\t{Device}\r\n *\r\n */\r\nexport default class Device extends Function {\r\n\t\r\n\tconstructor(deviceProperties, socket, language = window.sysLang || 'en') {\r\n\t\ttry {\r\n\t\t\tsuper(deviceProperties.function);\r\n\t\t}\r\n\t\tcatch(err) {\r\n\t\t\tthrow new Error('No function given for device ' + deviceProperties.name + '!');\r\n\t\t}\r\n\t\t\r\n\t\t// initialise class data\r\n\t\tthis.id = deviceProperties.id;\r\n\t\tthis.name = deviceProperties.name;\r\n\t\t\r\n\t\tthis.room = deviceProperties.room || null;\r\n\t\t\r\n\t\tthis.states = deviceProperties.states;\r\n\t\tthis.options = deviceProperties.options;\r\n\t\tthis.attributes = deviceProperties.attributes || {};\r\n\t\t\r\n\t\tthis.socket = socket;\r\n\t\t\r\n\t\t// verify data\r\n\t\tif (!this.options || typeof this.options !== 'object' || Object.keys(this.options).length === 0) {\r\n\t\t\tthrow new Error('Device' + (deviceProperties.id || deviceProperties.name ? ' ' + (deviceProperties.name || deviceProperties.id) : '') + ' not defined for jarvis!');\r\n\t\t}\r\n\t\telse if (!this.states || typeof this.states !== 'object' || Object.keys(this.states).length === 0) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no states defined)!');\r\n\t\t}\r\n\t\telse if (!this.id || !this.name || !this.function) {\r\n\t\t\tthrow new Error('Insufficent properties provided' + (deviceProperties.id || deviceProperties.name ? ' for device ' + (deviceProperties.name || deviceProperties.id) : '') + ' (no id, name or function defined)!');\r\n\t\t}\r\n\t\telse if (!this.socket) {\t\r\n\t\t\tthrow new Error('No socket given!');\r\n\t\t}\r\n\t\t\r\n\t\t// hierarchy\r\n\t\tthis.children = deviceProperties.children || [];\r\n\t\tthis.parent = deviceProperties.parent || null;\r\n\t\t\r\n\t\t// do some stuff\r\n\t\tthis._setProperties();\r\n\t\tthis.stateSubscriptions = [];\r\n\t\tthis.historySubscriptions = [];\r\n\t\t\r\n\t\t// set some stuff\r\n\t\tmoment.locale(language);\r\n\t\t\r\n\t\t// listen for errors of the device\r\n\t\tthis.on('error', err => console.error('Device error occured!', err));\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @return\t{Object|String}\r\n\t * @private\r\n\t */\r\n\t_getStateFromKey(stateKey = null, stateType = 'state') {\r\n\t\t\r\n\t\t// already a state object\r\n\t\tif (stateKey && typeof stateKey === 'object') {\r\n\t\t\treturn stateKey;\r\n\t\t}\r\n\t\t\r\n\t\t// get state object\r\n\t\tlet s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tif (!s || !s[stateType]) {\r\n\t\t\treturn 'Incorrect or non-defined state key for device ' + this.name + '!';\r\n\t\t}\r\n\t\telse if (typeof s[stateType] == 'string') {\r\n\t\t\tthis.states[stateKey || this.primaryStateKey][stateType] = { 'node': s[stateType] };\r\n\t\t\ts = this.states[stateKey || this.primaryStateKey];\r\n\t\t}\r\n\t\telse if (typeof s[stateType] == 'object' && !s[stateType].node) {\r\n\t\t\treturn 'No ' + stateType + ' specified for device ' + this.name + '!';\r\n\t\t}\r\n\t\t\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getConfigurationSetting(config, stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this[config][stateKey]) {\r\n\t\t\t\r\n\t\t\t// 1. if stateKey (e.g. level, power) is available, try to replace an attribute (e.g. icon, unit or for styles state, icon) based on current state (e.g. true, false)\r\n\t\t\tif (typeof this[config][stateKey][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config][stateKey][attribute][stateVal]) ? this[config][stateKey][attribute][stateVal] : this[config][stateKey][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 2. if #1 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config][stateKey][attribute])) {\r\n\t\t\t\treturn this[config][stateKey][attribute](stateVal);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 3. fallback to stateKey with attribute, if defined but neither an object (thus stateless) nor a function\r\n\t\t\telse if (typeof this[config][stateKey][attribute] === 'string') {\r\n\t\t\t\treturn this[config][stateKey][attribute];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (this[config]['_any']) {\r\n\t\t\t\r\n\t\t\t// 4. fallback to _any if no stateKey (e.g. level, power) is given, but consider attribute to be stateful (e.g. true, false)\r\n\t\t\tif (typeof this[config]['_any'][attribute] === 'object') {\r\n\t\t\t\treturn super._isValue(this[config]['_any'][attribute][stateVal]) ? this[config]['_any'][attribute][stateVal] : this[config]['_any'][attribute]['default'];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 5. if #4 is a function, apply it\r\n\t\t\telse if (super._isFunction(this[config]['_any'][attribute])) {\r\n\t\t\t\treturn this[config]['_any'][attribute](stateVal);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// nothing, return undefined (not null, because this would mean take an empty value)\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @private\r\n\t */\r\n\t_getUserSetting(stateKey, attribute, stateVal) {\r\n\t\t\r\n\t\tif (this.options[attribute][stateKey]) {\r\n\t\t\t\r\n\t\t\tif (typeof this.options[attribute][stateKey] === 'object') {\r\n\t\t\t\treturn super._isValue(this.options[attribute][stateKey][stateVal]) ? this.options[attribute][stateKey][stateVal] : this.options[attribute][stateKey]['default'];\r\n\t\t\t}\r\n\t\t\telse if (super._isFunction(this.options[attribute][stateKey])) {\r\n\t\t\t\treturn this.options[attribute][stateKey](stateVal);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn this.options[attribute][stateKey];\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn undefined;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return void\r\n\t * @private\r\n\t *\r\n\t */\r\n\t_setProperties() {\r\n\t\t\r\n\t\tlet states = Object.keys(this.states);\r\n\t\t\r\n\t\t// delete ignored states\r\n\t\tif (this.options.ignoredStates) {\r\n\t\t\tthis.options.ignoredStates = Array.isArray(this.options.ignoredStates) ? this.options.ignoredStates : [this.options.ignoredStates];\r\n\t\t\t\r\n\t\t\tthis.options.ignoredStates.forEach(ignoredState => {\r\n\t\t\t\tif (this.states[ignoredState]) {\r\n\t\t\t\t\tdelete this.states[ignoredState];\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// delete ignored states\r\n\t\tthis.options.hiddenStates = [];\r\n\t\tif (this.options.hideStates) {\r\n\t\t\tthis.options.hideStates = Array.isArray(this.options.hideStates) ? this.options.hideStates : [this.options.hideStates];\r\n\t\t\t\r\n\t\t\tthis.options.hideStates.forEach(hideState => {\r\n\t\t\t\tif (this.states[hideState]) {\r\n\t\t\t\t\tthis.options.hiddenStates.push(hideState);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t// properties\r\n\t\tthis.primaryStateKey = this.options.primary || states[0];\r\n\t\tthis.secondaryStateKey = this.options.secondary || null;\r\n\t\t\r\n\t\t// bring user settings for value, state, unit, icon and styles in structure\r\n\t\t['value', 'state', 'unit', 'icon', 'styles'].forEach(key => {\r\n\t\t\t\r\n\t\t\tlet stateOrAttribute = this.options[key] && Object.keys(this.options[key])[0];\r\n\t\t\tthis.options[key] = !this.options[key] ? {} : super._setObjectStructure(stateOrAttribute && states.indexOf(stateOrAttribute) > -1 ? this.options[key] : { [this.primaryStateKey]: this.options[key] });\r\n\t\t});\r\n\t\t\r\n\t\t// all options\r\n\t\tthis.options.groups = Array.isArray(this.options.group) ? this.options.group : [this.options.group];\r\n\t\tthis.options.sort = this.options.sort || 999;\r\n\t\t\r\n\t\tthis.options.label = (this.options.label && (typeof this.options.label === 'string' && this.options.label.replace(/%name%/g, this.name))) || this.options.label || this.name;\r\n\t\t//this.options.subtitle = this.options.subtitle;\r\n\t\tthis.options.divider = this.options.divider || false;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t *\r\n\t * @return\t{Object}\r\n\t * @private\r\n\t */\r\n\t_updateDeviceState(stateKey, state) {\r\n\t\t\r\n\t\t// add time changed\r\n\t\tstate.timeChanged = moment(state.lc-2000).fromNow();\r\n\t\t\r\n\t\t// add unit\r\n\t\tstate.unit = '';\r\n\t\t\r\n\t\t// assign value\r\n\t\tstate.value = state.val;\r\n\t\t\r\n\t\t// mapping of value to state values\r\n\t\t[{ 'value': 'value' }, { 'state': 'value' }, { 'unit': 'unit' }].forEach(pair => {\r\n\t\t\tlet attribute = Object.keys(pair).toString();\r\n\t\t\tlet option = Object.values(pair).toString();\r\n\t\t\tlet settings = {};\r\n\t\t\t\r\n\t\t\t// get user setting\r\n\t\t\tsettings['options'] = this._getUserSetting(stateKey, attribute, state.value);\r\n\t\t\t\r\n\t\t\t// get function setting or fallback to defaults\r\n\t\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, state.value);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tstate[option] = super._getValueFromSettings(settings, state[option]);\r\n\t\t\t\r\n\t\t});\r\n\t\t\r\n\t\tstate.value = i18n.t(state.value);\r\n\t\treturn state;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tget(property) {\r\n\t\treturn this[property] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetAction(stateKey = null) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tconst state = this.states[stateKey].state.value;\r\n\t\tconst stateVal = state.val;\r\n\t\t\r\n\t\tconst Action = this.actions[stateKey] || this.actions.Action;\r\n\t\treturn <Action key={'action-' + this.id + '-' + stateKey} device={this} state={state} stateKey={stateKey} stateVal={stateVal} styles={this.getStyle('state', stateKey, stateVal)} />\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\t{React.Component}\r\n\t */\r\n\tgetComponent(stateKey) {\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tconst stateVal = this.states[stateKey].state.value.val;\r\n\t\t\r\n\t\tconst Component = this.components[stateKey];\r\n\t\treturn (Component && <Component title={i18n.t(this.function + '#' + stateKey)} device={this} stateKey={stateKey} stateVal={stateVal} />) || i18n.t(this.function + '#' + stateKey);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateProperty=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetDeviceState(stateKey = null, stateProperty = null) {\r\n\t\tconst s = this.states[stateKey || this.primaryStateKey];\r\n\t\t\r\n\t\tlet deviceState = null;\r\n\t\t\r\n\t\tif (s && s.state && stateProperty !== null && s.state.value !== undefined && s.state.value[stateProperty] !== undefined) {\r\n\t\t\tdeviceState = s.state.value[stateProperty];\r\n\t\t}\r\n\t\telse if (s && s.state && stateProperty === null && s.state.value !== undefined) {\r\n\t\t\tdeviceState = s.state.value;\r\n\t\t}\r\n\t\t\r\n\t\treturn deviceState;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Get an icon based on the current device state (or falls back to a default).\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{String}\t[stateVal=default]\r\n\t * @param\t{String}\t[defaultIcon=null]\r\n\t * @return\t{String}\r\n\t */\r\n\tgetIcon(stateKey, stateVal = '', defaultIcon = '?') {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\t\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'icon', stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['configurations', 'defaults'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, 'icon', stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, defaultIcon);\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetOption(option, stateVal = 'default') {\r\n\t\treturn (this.options[option] && (this.options[option][stateVal] || this.options[option]['default'])) || this.options[option] || null;\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tgetStyle(attribute, stateKey, stateVal = 'default') {\r\n\t\tlet settings = {};\r\n\t\t\r\n\t\t// get user setting\r\n\t\tsettings['options'] = this._getUserSetting(stateKey, 'styles', attribute, stateVal);\r\n\t\t\r\n\t\t// get function setting or fallback to defaults\r\n\t\t['styles', 'defaultStyles'].forEach(config => {\r\n\t\t\tsettings[config] = this._getConfigurationSetting(config, stateKey, attribute, stateVal);\r\n\t\t});\r\n\t\t\r\n\t\treturn super._getValueFromSettings(settings, {});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests all state values from the backend.\r\n\t *\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Array<Promises>}\r\n\t *\r\n\t */\r\n\trequestDeviceStates(subscribe = false) {\r\n\t\t\r\n\t\tlet responses = [];\r\n\t\tfor (let stateKey in this.states) {\r\n\t\t\tresponses.push(this.requestDeviceState(stateKey, subscribe));\r\n\t\t}\r\n\t\t\r\n\t\treturn responses;\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceState(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.value !== undefined && this.stateSubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getState(s.state.node)\r\n\t\t\t\t\t.then(state => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (state === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * Requests a state value from the backend.\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @param\t{Boolean}\t[subscribe=false]\r\n\t * @return\t{Promise}\r\n\t *\r\n\t */\r\n\trequestDeviceStateHistory(stateKey = null, subscribe = false) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\r\n\t\t\t// send cached value if present and subscrbe (means always updated)\r\n\t\t\tif (s.state.history !== undefined && this.historySubscriptions.indexOf(stateKey) > -1) {\r\n\t\t\t\t\r\n\t\t\t\t// publish state\r\n\t\t\t\tthis.emit('historyChange', stateKey, s.state.history);\r\n\t\t\t\t\r\n\t\t\t\t// resolve\r\n\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': true });\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// request from backend\r\n\t\t\telse {\r\n\t\t\t\tthis.socket.getStateHistory(s.state.node)\r\n\t\t\t\t\t.then(history => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// state does not exist\r\n\t\t\t\t\t\tif (history === null) {\r\n\t\t\t\t\t\t\treject({ 'success': false, 'stateKey': stateKey, 'error': 'State ' + s.state.node + ' not found!' });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// set result\r\n\t\t\t\t\t\ts.state.history = history; // this._updateDeviceState(stateKey, state);\t\t\t// callback(err, data, step, sessionId);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// publish state change\r\n\t\t\t\t\t\tthis.emit('historyChange', stateKey, s.state.history);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// subscribe to state\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\tif (subscribe) {\r\n\t\t\t\t\t\t\tthis.subscribeDeviceState(stateKey).catch(err => reject(err));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// resolve\r\n\t\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey, 'cached': false });\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetAction(action) {\r\n\t\tthis.options.action = action;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t */\r\n\tsetComponent(component) {\r\n\t\tthis.options.label = component;\r\n\t\t\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\tvalue\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsetDeviceState(stateKey = null, value) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey, 'action');\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tthis.socket.setState(s.action.node, value)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\r\n\t\t\t\t\t// get state value if not subscribed\r\n\t\t\t\t\tif (this.stateSubscriptions.indexOf(stateKey) === -1) {\r\n\t\t\t\t\t\tthis.requestDeviceState(stateKey);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// resolve\r\n\t\t\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => reject({ 'success': false, 'stateKey': stateKey, 'error': err }));\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t *\r\n\t *\r\n\t * @param\t{String}\t[stateKey=this.primaryStateKey]\r\n\t * @return\tvoid\r\n\t */\r\n\tsubscribeDeviceState(stateKey = null) {\r\n\t\t\r\n\t\tstateKey = stateKey || this.primaryStateKey;\r\n\t\tlet s = this._getStateFromKey(stateKey);\r\n\t\tif (typeof s == 'string') {\r\n\t\t\treturn Promise.reject({ 'success': false, 'stateKey': stateKey, 'error': s });\r\n\t\t}\r\n\t\t\r\n\t\t// add subscription\t\r\n\t\tthis.stateSubscriptions.push(stateKey);\r\n\t\t\r\n\t\t// subscribe\r\n\t\treturn new Promise(resolve => {\r\n\t\t\tthis.socket.subscribeState(s.state.node, (id, state, params) => {\r\n\t\t\t\t\r\n\t\t\t\tif (state && state.val !== this.getDeviceState(stateKey, 'val')) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t// format value\r\n\t\t\t\t\ts.state.value = this._updateDeviceState(stateKey, state);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish state change\r\n\t\t\t\t\tthis.emit('stateChange', stateKey, s.state.value);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// publish to children as well\r\n\t\t\t\t\tthis.children.forEach(child => child.emit('stateChange', stateKey, s.state.value));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tresolve({ 'success': true, 'stateKey': stateKey });\r\n\t\t});\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Badge from '@material-ui/core/Badge';\r\nimport NotificationsIcon from '@material-ui/icons/Notifications';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tappBar: {\r\n\t\tflexGrow: 1,\r\n\t\tboxShadow: 'none',\r\n\t\ttransform: 'none',\r\n\t},\r\n\ttoolbar: {\r\n\t\tbackgroundColor: theme.palette.primary.main\r\n\t},\r\n\tmenuButton: {\r\n\t\tmarginRight: theme.spacing(2),\r\n\t},\r\n\ttitle: {\r\n\t\tflexGrow: 1,\r\n\t},\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingRight: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TopBar(props) {\r\n\tconst classes = useStyles();\r\n\t\r\n\tconst { children, title } = props;\r\n\tconst [ icon, label ] = title.indexOf('|') > -1 ? title.split('|') : [ null, title ];\r\n\treturn (\r\n\r\n<AppBar id=\"appBar\" position=\"static\" className={classes.appBar}>\r\n\r\n\t<Toolbar className={classes.toolbar}>\r\n\t\t<Typography variant=\"h6\" className={classes.title}>\r\n\t\t\t{icon && <span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>}\r\n\t\t\t{label !== 'null' && label}\r\n\t\t</Typography>\r\n\t\t{/*\r\n\t\t<IconButton color=\"inherit\">\r\n\t\t\t<Badge badgeContent={17} color=\"secondary\">\r\n\t\t\t\t<NotificationsIcon />\r\n\t\t\t</Badge>\r\n\t\t</IconButton>\r\n\t\t*/}\r\n\t</Toolbar>\r\n\t\r\n\t{children}\r\n</AppBar>\r\n\r\n\t);\r\n}\r\n","/*\r\n * by QoP <https://stackoverflow.com/users/4484822/qop>\r\n * @see https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\r\n */\r\nimport { useState, useEffect } from 'react';\r\n\r\nfunction getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\nexport default function useWindowDimensions() {\r\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      setWindowDimensions(getWindowDimensions());\r\n    }\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return windowDimensions;\r\n}\r\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport clsx from 'clsx';\r\n\r\nimport useWindowDimensions from '../helpers/useWindowDimensions';\r\n\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Box from '@material-ui/core/Box';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\ticon: {\r\n\t\t...theme.components.icon,\r\n\t\tcolor: '#fff',\r\n\t\tpaddingBottom: '6px',\r\n\t\twidth: '1em',\r\n\t\theight: '1em',\r\n\t\tdisplay: 'inline-block',\r\n\t\tfontSize: '1.5rem',\r\n\t\ttransition: 'fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms',\r\n\t\tflexShrink: 0,\r\n\t\tuserSelect: 'none'\r\n\t},\r\n\ttabs: {\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tpaddingLeft: theme.spacing(),\r\n\t\tcolor: '#fff',\r\n\t\twidth: 'calc(100% - ' + theme.spacing() + 'px)',\r\n\t\tzIndex: 101,\r\n\t\tborderBottom: '5px solid #eee'\r\n\t},\r\n\tfixed: {\r\n\t\tposition: 'fixed',\r\n\t\ttop: 0\r\n\t},\r\n\tindicator: {\r\n\t\tbackgroundColor: '#fff',\r\n\t},\r\n\tfullscreen: {\r\n\t\tmarginLeft: -theme.spacing(),\r\n\t\tmarginTop: '-5px',\r\n\t},\r\n\tgrid: {\r\n\t\tpaddingBottom: '30px'\r\n\t}\r\n}));\r\n\r\n\r\nexport default function TabBar(props) {\r\n\tlet { tabs, selectTab } = props;\r\n\tconst classes = useStyles();\r\n\tlet tabBarProps = useRef({});\r\n\t\r\n\t// tab\r\n\tconst [tab, setTab] = useState(0);\r\n\tconst handleChange = (event, selectedTab) => {\r\n\t\tselectTab(selectedTab, tabs[selectedTab]);\r\n\t\tsetTab(selectedTab);\r\n\t}\r\n\t\r\n\t// scroll\r\n\tconst [fixed, setFixed] = useState(false);\r\n\tconst handleScroll = useCallback(() => {\r\n\t\tconst threshold = (tabBarProps.current.top + tabBarProps.current.height - 53);\r\n\t\tconst fixed = window.scrollY >= threshold;\r\n\t\t\r\n\t\tsetFixed(prevFixed => {\r\n\t\t\tif (prevFixed !== fixed) {\r\n\t\t\t\tdocument.getElementById('root').style.paddingTop = fixed ? (threshold-5-8) + 'px' : 0;\r\n\t\t\t\treturn fixed;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn prevFixed;\r\n\t\t});\r\n\t\t\r\n\t}, [tabBarProps]);\r\n\r\n\tuseEffect(() => {\r\n\t\ttabBarProps.current = {\r\n\t\t\ttop: document.getElementById('tabBar').offsetTop,\r\n\t\t\theight: document.getElementById('tabBar').offsetHeight\r\n\t\t}\r\n\t\t\r\n\t\twindow.addEventListener('scroll', handleScroll);\r\n\t\treturn () => window.removeEventListener('keydown', handleScroll, 0);\r\n\t\t\r\n\t}, [handleScroll]);\r\n\t\r\n\t// render tabs\r\n\tconst renderedTabs = tabs.map((tab, i) => {\r\n\t\tconst [ icon, label ] = tab.indexOf('|') > -1 ? tab.split('|') : [ null, tab ];\r\n\t\treturn <Tab key={'tab' + i} icon={<span className={clsx(classes.icon, 'mdi mdi-' + icon)}></span>} label={!fixed && label !== 'null' ? label : null} />\r\n\t});\r\n\t\r\n\treturn (\r\n\r\n<Tabs\r\n\tid=\"tabBar\"\r\n\tvalue={tab}\r\n\tonChange={handleChange}\r\n\tvariant=\"scrollable\"\r\n\tclasses={{\r\n\t\troot: clsx(classes.tabs, fixed && classes.fixed),\r\n\t\tindicator: classes.indicator\r\n\t}}>\r\n\t\r\n\t{renderedTabs}\r\n</Tabs>\r\n\r\n\t);\r\n}\r\n\r\n\r\nexport function TabPanel(props) {\r\n\tconst { children, selectedTab, renderedTab, fullscreen } = props;\r\n\tconst classes = useStyles();\r\n\t\r\n\t\r\n\t// get map height based on viewport\r\n\tconst { height } = useWindowDimensions();\r\n\tconst [mapHeight, setMapHeight] = useState(height);\r\n\tlet topBarHeight = useRef({});\r\n\t\r\n\tuseEffect(() => {\r\n\t\ttopBarHeight.current = document.getElementById('appBar').offsetHeight;\r\n\t\tsetMapHeight(height-topBarHeight.current+5);\r\n\t\t\r\n\t}, [height]);\r\n\t\r\n\t/*\r\n\t * Some components need to be visible upon loading, so proper initialise.\r\n\t * Due to the 'hidden' attribute though, they might be hidden.\r\n\t * This is a workaround to initially show everything for a short period of time and then hide according to tab settings.\r\n\t *\r\n\t */\r\n\tconst [hidden, setHidden] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tsetTimeout(() => setHidden(selectedTab !== renderedTab), 10);\r\n\t\t\r\n\t}, [selectedTab, renderedTab]);\r\n\t\r\n\treturn (\r\n\r\n<Box\r\n\trole=\"tabpanel\"\r\n\thidden={hidden}\r\n\tid={'tabpanel-' + renderedTab}\r\n\tclassName={clsx(fullscreen ? classes.fullscreen : classes.grid)}\r\n\tstyle={{ height: mapHeight + 'px' }}\r\n\t>\r\n\t\r\n\t{children}\r\n</Box>\r\n\r\n\t);\r\n}\r\n","\r\nexport default {\r\n\tStateList: require('./StateList').default,\r\n\tStateListHorizontal: require('./StateListHorizontal').default,\r\n\tMap: require('./Map').default,\r\n\tChart: require('./Chart').default\r\n}","import React from 'react';\r\nimport Connection from '../Connection';\r\nimport Device from '../Device';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\r\nimport MuiDialogContent from '@material-ui/core/DialogContent';\r\nimport MuiDialogActions from '@material-ui/core/DialogActions';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport Modules from '../modules';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { withStyles } from '@material-ui/core/styles';\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(2),\r\n\t},\r\n\tcloseButton: {\r\n\t\tposition: 'absolute',\r\n\t\tright: theme.spacing(1),\r\n\t\ttop: theme.spacing(1),\r\n\t\tcolor: theme.palette.grey[500],\r\n\t},\r\n});\r\n\r\n\r\nconst DialogTitle = withStyles(styles)(props => {\r\n\tconst { children, classes, onClose, ...other } = props;\r\n\treturn (\r\n\r\n<MuiDialogTitle disableTypography className={classes.root} {...other}>\r\n\t<Typography variant=\"h6\">{children}</Typography>\r\n\t{onClose ? (\r\n\t<IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\r\n\t\t<CloseIcon />\r\n\t</IconButton>\r\n\t) : null}\r\n</MuiDialogTitle>\r\n\r\n\t);\r\n});\r\n\r\nconst DialogContent = withStyles(theme => ({\r\n\troot: {\r\n\t\tpadding: theme.spacing(2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpaddingLeft: theme.spacing(1)\r\n\t\t}\r\n\t},\r\n}))(MuiDialogContent);\r\n\r\nconst DialogActions = withStyles(theme => ({\r\n\troot: {\r\n\t\tmargin: 0,\r\n\t\tpadding: theme.spacing(1),\r\n\t},\r\n}))(MuiDialogActions);\r\n\r\n\r\nexport default class Popup extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\tchildren: []\r\n\t\t};\r\n\t}\r\n\t\r\n\tcomponentDidUpdate(prevProps, prevState) {\r\n\t\t\r\n\t\tlet device = this.props.contents && this.props.contents.device;\r\n\t\tif (device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\t\r\n\t\t\t// get from cache\r\n\t\t\tif (device.children.length) {\r\n\t\t\t\tconsole.info('Got ' + Object.keys(device.children).length + ' states for device ' + device.name + ' from cache.');\r\n\t\t\t\tthis.setState({ 'children': device.children }, () => this.forceUpdate());\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// retrieve new\r\n\t\t\telse {\r\n\t\t\t\t// loop through states and request status\r\n\t\t\t\tlet responses = [];\r\n\t\t\t\tlet children = [];\r\n\t\t\t\t\r\n\t\t\t\tfor (let stateKey in device.states) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (device.states[stateKey].state === undefined || device.options.hiddenStates.indexOf(stateKey) > -1) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet child = new Device({\r\n\t\t\t\t\t\t\t\t'parent': device,\r\n\t\t\t\t\t\t\t\t'id': device.id + '#' + stateKey,\r\n\t\t\t\t\t\t\t\t'name': device.name,\r\n\t\t\t\t\t\t\t\t'function': device.function,\r\n\t\t\t\t\t\t\t\t'states': { [stateKey]: device.states[stateKey] },\r\n\t\t\t\t\t\t\t\t'options': {\r\n\t\t\t\t\t\t\t\t\t'primary': stateKey,\r\n\t\t\t\t\t\t\t\t\t'divider': children.length !== 0,\r\n\t\t\t\t\t\t\t\t\t'subgroup': null,\r\n\t\t\t\t\t\t\t\t\t'subtitle': null\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tConnection.getConnection,\r\n\t\t\t\t\t\t\twindow.language\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// add child to parent\r\n\t\t\t\t\tdevice.children.push(child);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// retrieve state\r\n\t\t\t\t\tresponses.push(child.requestDeviceState(null, true));\r\n\t\t\t\t\tchildren.push(child);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tPromise.allSettled(responses).then(() => {\r\n\t\t\t\t\tconsole.info('Retrieved ' + Object.keys(children).length + ' states for device ' + device.name + '.', responses);\r\n\t\t\t\t\tthis.setState({ 'children': children }, () => this.forceUpdate());\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!device.id && this.props.contents.ts !== prevProps.contents.ts) {\r\n\t\t\tthis.setState({ 'children': [] }, () => this.forceUpdate());\r\n\t\t}\r\n\t}\r\n\t\r\n\tshouldComponentUpdate(nextProps, nextState) {\r\n\t\treturn !this.props.contents || this.props.contents.ts !== nextProps.contents.ts;\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst { open, closeDialog, contents } = this.props;\r\n\t\tconst { device } = contents;\r\n\t\t\r\n\t\treturn (\r\n\r\n<Dialog onClose={closeDialog} open={open || false} maxWidth={'md'} fullWidth={true}>\r\n\t<DialogTitle onClose={closeDialog}>\r\n\t\t{device.name}\r\n\t</DialogTitle>\r\n\t<DialogContent dividers style={{ padding: 0 }}>\r\n\t\t\r\n\t\t<Modules.StateList openDialog={null} devices={this.state.children} component={true} action={true} />\t\r\n\t\t\r\n\t</DialogContent>\r\n\t<DialogActions>\r\n\t\t<Button autoFocus onClick={closeDialog} color=\"primary\">\r\n\t\t\tClose\r\n\t\t</Button>\r\n\t</DialogActions>\r\n</Dialog>\r\n\r\n\t\t);\r\n\t};\r\n}\r\n","import React from 'react';\r\n\r\nimport Card from '@material-ui/core/Card';\r\nimport CardHeader from '@material-ui/core/CardHeader';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n\r\n/*\r\n * STYLES\r\n */\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nconst useStyles = makeStyles(theme => ({\r\n\tcard: {\r\n\t\tmargin: theme.spacing(1, 1, 0, 0),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tmargin: theme.spacing(0.4, 0.4, 0, 0)\r\n\t\t}\r\n\t},\r\n\tcardHeaderNoContents: {\r\n\t\tpadding: theme.spacing(),\r\n\t},\r\n\tcardAvatar: props => ({\r\n\t\tbackgroundColor: theme.palette.primary.main,\r\n\t\tcolor: '#fff',\r\n\t\tfontSize: '24px',\r\n\t\t...props\r\n\t}),\r\n\tcardContent: {\r\n\t\tpadding: theme.spacing(0, 2),\r\n\t\t[theme.breakpoints.down('md')]: {\r\n\t\t\tpadding: theme.spacing(0)\r\n\t\t}\r\n\t}\r\n}));\r\n\r\n\r\nexport default function Widget(props) {\r\n\tconst { title, icon, iconStyle } = props;\r\n\tconst classes = useStyles(iconStyle);\r\n\t\r\n\treturn (\r\n\r\n<Card className={classes.card}>\r\n\t<CardHeader\r\n\t\tavatar={icon !== null &&\r\n\t\t\t<Avatar variant=\"rounded\" classes={{ root: classes.cardAvatar }}>\r\n\t\t\t\t{React.createElement('span', { 'className': 'mdi mdi-' + (icon || 'home') })}\r\n\t\t\t</Avatar>\r\n\t\t}\r\n\t\ttitle={title &&\r\n\t\t\t<Typography variant=\"h5\" component=\"h2\">\r\n\t\t\t\t{title}\r\n\t\t\t</Typography>\r\n\t\t}\r\n\t/>\r\n\t<CardContent className={classes.cardContent}>\r\n\t\t{props.children}\r\n\t</CardContent>\r\n</Card>\r\n\r\n\t);\r\n}\r\n","import { createMuiTheme } from '@material-ui/core/styles';\r\nimport { pink } from '@material-ui/core/colors';\r\nimport blue from '@material-ui/core/colors/blue';\r\n\r\nconst primary = blue[700];\r\nconst secondary = pink;\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: {\r\n\t\t\tmain: primary \r\n\t\t},\r\n\t\tsecondary: secondary,\r\n\t},\r\n\tcomponents: {\r\n\t\ticon: {\r\n\t\t\tfontSize: '24px',\r\n\t\t\tcolor: primary\r\n\t\t},\r\n\t\t'finger': {\r\n\t\t\tcursor: 'pointer'\r\n\t\t}\r\n\t}\r\n});\r\n\r\nconsole.debug(theme);\r\nexport default theme;","import React from 'react';\n\n//import Drawer from '@material-ui/core/Drawer';\n\nimport TopBar from './components/TopBar';\nimport TabBar, { TabPanel } from './components/TabBar';\nimport GridContainer from './components/GridContainer';\nimport Popup from './components/Popup';\nimport Widget from './components/Widget';\nimport Modules from './modules';\n\n\n/*\n * STYLES\n */\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport theme from './theme';\n\n\n/*\n *\n */\nconst getGroup = (groupId, group, props = {}) => {\n\t\n\t// group empty\n\tif (!group) {\n\t\tconsole.error('Group ' + groupId + ' defined in columns but not assigned to any devices!');\n\t\treturn null;\n\t}\n\t\n\t// get module for component\n\tgroup.settings.component = typeof group.settings.component === 'string' ? { 'module': group.settings.component } : (group.settings.component || {})\n\tconst Tag = Modules[group.settings.component.module || 'StateList'];\n\tif (Tag === undefined) {\n\t\tconsole.error('Undefined component \"' + group.settings.component + '\" used!');\n\t\treturn null;\n\t}\n\t\n\treturn <Tag key={'Tag' + groupId} devices={group.devices} openDialog={props.action ? props.action : null} settings={{ ...group.settings, ...props }} />\n}\n\n\n/*\n *\n */\nconst getGridContents = (contents, groups, props = {}) => {\n\t\n\tlet gridContents = {};\n\tconst columns = Object.keys(contents).length;\n\t\n\tfor (let column = 1; column <= columns; column++) {\n\t\t\n\t\tlet columnContents = contents[column];\n\t\tgridContents[column] = gridContents[column] || [];\n\t\t\n\t\t// no contents, thus add placeholder\n\t\tif (!columnContents || columnContents.length === 0) {\n\t\t\tgridContents[column].push(null);\n\t\t}\n\t\t\n\t\t// add contents\n\t\telse {\n\t\t\tfor (let index in columnContents) {\n\t\t\t\t\n\t\t\t\tlet groupId = columnContents[index];\n\t\t\t\tlet group = groups[groupId];\n\t\t\t\t\n\t\t\t\tlet content = getGroup(groupId, group, props);\n\t\t\t\tif (content) {\n\t\t\t\t\tgridContents[column].push(\n\t\t\t\t\t\t<Widget key={'Box-' + groupId + '-' + index} title={group.settings.title !== null ? (group.settings.title || group.name) : null} icon={group.settings.icon} iconStyle={group.settings.iconStyle}>\n\t\t\t\t\t\t\t{content}\n\t\t\t\t\t\t</Widget>\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn gridContents;\n}\n\n\nexport default class Jarvis extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tselectedTab: 0,\n\t\t\ttabTitle: '',\n\t\t\t\n\t\t\tnotificationDrawer: false,\n\t\t\tdialog: false,\n\t\t\tdialogContents: {\n\t\t\t\t'ts': 0,\n\t\t\t\t'device': {}\n\t\t\t}\n\t\t}\n\t\t\n\t\t// bind methods\n\t\tthis.closeDialog = this.closeDialog.bind(this);\n\t\tthis.openDialog = this.openDialog.bind(this);\n\t\tthis.selectTab = this.selectTab.bind(this);\n\t\t//this.toggleDrawer = this.toggleDrawer.bind(this);\n\t\t\n\t\t// initialise\n\t\tthis.gridContents = {};\n\t\tthis.layout = this.props.settings.layout;\n\t\tthis.tabs = Object.keys(this.layout);\n\t\tthis.tabsEnabled = this.tabs[0] !== 1;\n\t\tthis.state.tabTitle = this.tabs[this.state.selectedTab];\n\t\t\n\t\t// no tabs defined, so layout wrap into default tab\n\t\tif (!this.tabsEnabled) {\n\t\t\tthis.layout = { 'Home': this.layout };\n\t\t\tthis.tabs.push('1');\n\t\t}\n\t\t\n\t\t// widget props\n\t\tthis.widgetProps = {}\n\t}\n\t\n\tgetTabPanels() {\n\t\t\n\t\tlet tab = 0;\n\t\tlet tabPanels = [];\n\t\tfor (let tabLabel in this.layout) {\n\t\t\tconst contents = this.layout[tabLabel];\n\t\t\t\n\t\t\t// fullscreen in component\n\t\t\tif (!this.gridContents[tabLabel] && typeof contents === 'string') {\n\t\t\t\tthis.gridContents[tabLabel] = getGroup(contents, this.props.groups[contents], { action: this.openDialog, ...this.widgetProps });\n\t\t\t}\n\t\t\t\n\t\t\t// grid layout\n\t\t\telse if (!this.gridContents[tabLabel]) {\n\t\t\t\tthis.gridContents[tabLabel] = <GridContainer contents={getGridContents(contents, this.props.groups, { action: this.openDialog, ...this.widgetProps })} />\n\t\t\t}\n\t\t\t\n\t\t\tlet tabPanel = (\n\t\t\t\t<TabPanel key={'tabPanel-' + tab} renderedTab={tab} selectedTab={this.state.selectedTab} fullscreen={typeof contents === 'string'}>\n\t\t\t\t\t{this.gridContents[tabLabel]}\n\t\t\t\t</TabPanel>\n\t\t\t);\n\t\t\t\n\t\t\ttabPanels.push(tabPanel);\n\t\t\ttab++;\n\t\t}\n\t\t\n\t\treturn tabPanels;\n\t}\n\t\n\tcloseDialog() {\n\t\tthis.setState({ 'dialog': false, 'dialogContents': { 'ts': Date.now(), 'device': {} } });\n\t}\n\t\n\topenDialog(device) {\n\t\tthis.setState({ 'dialog': true, 'dialogContents': { 'ts': Date.now(), 'device': device } });\n\t}\n\t\n\tselectTab(tab, title) {\n\t\tthis.setState({ selectedTab: tab, tabTitle: title });\n\t}\n\t\n\t/*\n\ttoggleDrawer(drawer, open) {\n\t\tthis.setState({ [drawer]: open });\n\t};\n\t*/\n\t\n    render() {\n        return (\n\n<ThemeProvider theme={theme}>\n\t<TopBar title={this.props.settings.topBarTitle || (this.tabsEnabled && this.state.tabTitle) || 'jarvis'}>\n\t\t{this.tabsEnabled && <TabBar tabs={this.tabs} selectTab={this.selectTab} />}\n\t</TopBar>\n\t\n\t{/*\n\t<Drawer anchor=\"right\" open={this.state.notificationDrawer} onClose={this.toggleDrawer('notificationDrawer', false)}>\n\t\t\n\t</Drawer>\n\t*/}\n\n\t<Popup open={this.state.dialog} contents={this.state.dialogContents} closeDialog={this.closeDialog} />\n\t{this.getTabPanels()}\n\t\n</ThemeProvider>\n\n\t\t)\n\t}\n}\n","import React from 'react';\nimport LogRocket from 'logrocket';\nimport uuid from 'uuid/v3';\n\nimport Grid from '@material-ui/core/Grid';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Typography from '@material-ui/core/Typography';\nimport Skeleton from '@material-ui/lab/Skeleton';\n\nimport GridContainer from './components/GridContainer';\nimport StatusSnackbar from './components/StatusSnackbar';\n\nimport i18n from './i18n';\nimport Connection from './Connection';\nimport Device from './Device';\nimport Jarvis from './Jarvis';\n\n\n/*\n * STYLES\n */\nimport { withStyles } from '@material-ui/core/styles';\nconst styles = theme => ({\n\tloading: {\n\t\tmargin: '10px 0 0 0',\n\t\tcolor: '#999'\n\t},\n\tgridItem: {\n\t\tmargin: theme.spacing(1, 1, 0, 0),\n\t\t[theme.breakpoints.down('md')]: {\n\t\t\tmarginRight: theme.spacing(0.4, 0.4, 0, 0)\n\t\t}\n\t}\n});\n\n\n/*\n * CONSTANTS\n *\n */\nconst NODE_SETTINGS = 'jarvis.0.settings';\nconst NODE_DEVICES = 'jarvis.0.devices';\n\n\nclass App extends React.Component {\n\t\n    constructor(props) {\n\t\tsuper(props);\n\t\t\n\t\tthis.state = {\n\t\t\tloaded: [],\n\t\t\terror: false,\n\t\t\terrorMessage: ''\n\t\t}\n\t};\n\t\n\tcomponentDidMount() {\n\t\t\n\t\t// connect and get connection\n\t\tconst noErrorFunction = () => this.setState({ error: false, errorMessage: '' });\n\t\tconst url = window.location.hostname === 'localhost' ? 'https://192.168.178.29:8082' : (window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : ''));\n\t\tconst listeners = [\n\t\t\t{ 'event': 'connect', 'callback': noErrorFunction },\n\t\t\t{ 'event': 'reconnect', 'callback': noErrorFunction },\n\t\t\t{ 'event': 'disconnect', 'callback': noErrorFunction },\n\t\t\t{ 'event': 'error', 'callback': err => this.setState({ error: true, errorMessage: i18n.t('Connection lost! Trying to reconnect') + '..' }) }\n\t\t];\n\t\t\n\t\tthis.socket = Connection.connect(url, listeners);\n\t\t\n\t\t\n\t\t// retrieve settings\n\t\tthis.settings = {};\n\t\tthis.socket.getState(NODE_SETTINGS)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.settings = state && JSON.parse(state.val);\n\t\t\t\t\tthis.useSettings();\n\t\t\t\t\tthis.setState({ loaded: [...this.state.loaded, 'settings'] });\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing settings!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_SETTINGS: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: err\n\t\t\t\t});\n\t\t\t});\n\t\t\n\t\t\n\t\t// retrieve devices\n\t\tthis.devices = {};\n\t\tthis.groups = {};\n\t\t\n\t\tthis.socket.getState(NODE_DEVICES)\n\t\t\t.then(state => {\n\t\t\t\t\n\t\t\t\ttry {\n\t\t\t\t\tthis.devices = JSON.parse(state.val);\n\t\t\t\t\tthis.processDevices(this.devices).then(groups => {\n\t\t\t\t\t\tthis.groups = groups;\n\t\t\t\t\t\tthis.setState({ loaded: [...this.state.loaded, 'groups'] });\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\terror: true,\n\t\t\t\t\t\terrorMessage: 'Error parsing devices!'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error('GET_DEVICES: ' + err.message);\n\t\t\t\tthis.setState({\n\t\t\t\t\terror: true,\n\t\t\t\t\terrorMessage: 'Socket failed while getting devices!'\n\t\t\t\t});\n\t\t\t});\n    }\n\n\t/**\n\t *\n\t *\n\t */\n\tuseSettings() {\n\t\t\n\t\t// LogRocket\n\t\tif (this.settings.debug && this.settings.debug.name && this.settings.debug.email && this.settings.debug.email.indexOf('@') > -1) {\n\t\t\tLogRocket.init('36n1xl/jarvis');\n\t\t\t\n\t\t\tlet id = uuid(this.settings.debug.name + '#' + this.settings.debug.email, 'e63359dc-bc1c-476e-81cd-8f580d09a557');\n\t\t\tLogRocket.identify(id, {\n\t\t\t\tname: this.settings.debug.name,\n\t\t\t\temail: this.settings.debug.email\n\t\t\t});\n\t\t\t\n\t\t\tconsole.info('Opt-In for providing debugging details to the developer. Your ID is: ' + id);\n\t\t}\n\t\t\n\t\t// language\n\t\twindow.language = (this.settings.language || navigator.language || navigator.userLanguage || 'en').substr(0, 2);\n\t\ti18n.setLanguage(window.language);\n\t\ti18n.loadTranslations(['en', 'de']);\n\t\t\n\t\t// page title\n\t\tif (this.settings.pageTitle) {\n\t\t\tdocument.title = this.settings.pageTitle;\n\t\t}\n\t\t\n\t\t// favicon\n\t\tif (this.settings.pageFavicon && this.settings.pageFavicon.substr(0, 5) === 'data:') {\n\t\t\tdocument.getElementById('favicon').href = this.settings.pageFavicon;\n\t\t}\n\t\t\n\t\t// translations\n\t\tif (this.settings.translations) {\n\t\t\t\n\t\t\tlet translations = this.settings.translations;\n\t\t\tfor (let language in translations) {\n\t\t\t\ti18n.setTranslation(language, translations[language]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tgroupDevice(groups, device) {\n\t\t\n\t\t// add device to group(s)\n\t\tlet options = device.get('options');\n\t\toptions.groups.forEach(group => {\n\t\t\t\n\t\t\tlet groupId = group.toLowerCase().replace(/ /g, '');\n\t\t\tif (!groups[groupId]) {\n\t\t\t\tgroups[groupId] = { 'id': groupId, 'name': group, 'settings': (this.settings.groups && this.settings.groups[groupId]) || {}, 'devices': [device] };\n\t\t\t}\n\t\t\telse {\n\t\t\t\tgroups[groupId].devices.push(device);\n\t\t\t}\n\t\t});\n\t\t\n\t\treturn groups;\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevice(deviceProperties) {\n\t\t\n\t\tlet promises = [];\n\t\tlet device = null;\n\t\ttry {\n\t\t\tdevice = new Device(deviceProperties, this.socket, window.language);\n\t\t\t\n\t\t\t// request primary state value\n\t\t\tpromises.push(device.requestDeviceState(null, true));\n\t\t\t\n\t\t\t// request secondary state value\n\t\t\tif (device.secondaryStateKey) {\n\t\t\t\tpromises.push(device.requestDeviceState(device.secondaryStateKey, true));\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tcatch(err) {\n\t\t\tconsole.warn(err.message);\n\t\t}\n\t\t\n\t\treturn new Promise(resolve => {\n\t\t\tPromise.allSettled(promises).then(results => {\n\t\t\t\t\n\t\t\t\tresults.forEach(result => {\n\t\t\t\t\tif (result.status === 'rejected') {\n\t\t\t\t\t\tconsole.error(result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tresolve(device);\n\t\t\t});\n\t\t});\n\t}\n\t\n\t/**\n\t *\n\t *\n\t */\n\tprocessDevices(deviceList) {\n\t\t\n\t\t// loop through all devices of in the device list\n\t\tlet promises = [];\n\t\tlet groups = {};\n\t\t\n\t\tlet devices = 0, groupedDevices = 0;\n\t\tfor (let deviceId in deviceList) {\n\t\t\tdevices++;\n\t\t\t\n\t\t\tdeviceList[deviceId].options = deviceList[deviceId].jarvis;\n\t\t\tdelete deviceList[deviceId].jarvis;\n\t\t\t\n\t\t\tlet deviceProperties = { ...deviceList[deviceId], 'id': deviceId };\n\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\n\t\t\t\tthis.processDevice(deviceProperties).then(device => {\n\t\t\t\n\t\t\t\t\tif (device !== null) {\n\t\t\t\t\t\tgroupedDevices++;\n\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t\t\t\tresolve(deviceId);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treject(deviceId);\n\t\t\t\t});\n\t\t\t}));\n\t\t\t\n\t\t\t// check states for own device settings\n\t\t\tfor (let stateKey in deviceProperties.states) {\n\t\t\t\t\n\t\t\t\tlet state = deviceProperties.states[stateKey];\n\t\t\t\tif (state && state.jarvis !== undefined) {\n\t\t\t\t\t\n\t\t\t\t\tpromises.push(new Promise((resolve, reject) => {\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.processDevice({ ...deviceProperties, 'id': deviceId + '#' + stateKey, 'states': { [stateKey]: state }, 'options': state.jarvis }).then(device => {\n\t\t\t\t\t\n\t\t\t\t\t\t\tif (device !== null) {\n\t\t\t\t\t\t\t\tgroupedDevices++;\n\t\t\t\t\t\t\t\tgroups = this.groupDevice(groups, device);\n\t\t\t\t\t\t\t\tresolve(deviceId);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treject(deviceId);\n\t\t\t\t\t\t});\n\t\t\t\t\t}));\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn new Promise(resolve => Promise.allSettled(promises).then(res => {\n\t\t\t\n\t\t\t// sort groups\n\t\t\tfor (let groupId in groups) {\n\t\t\t\tgroups[groupId].devices.sort((item1, item2) => {\n\t\t\t\t\tif (item1.options.sort > item2.options.sort) return 1;\n\t\t\t\t\telse if (item2.options.sort > item1.options.sort) return -1;\n\t\t\t\t\telse return 0;\n\t\t\t\t});\n\t\t\t}\n\t\t\n\t\t\t// return\n\t\t\tconsole.info('Processed ' + devices + ' devices. Added ' + groupedDevices + ' devices in ' + Object.keys(groups).length + ' groups.', res, groups);\n\t\t\tresolve(groups);\n\t\t}));\n\t};\n\t\n\trenderError() {\n\t\tconsole.error(JSON.stringify(this.state.errorMessage));\n\t\treturn (\n\n<StatusSnackbar\n\tkey={'StatusSnackbar'}\n\tvariant=\"error\"\n\tcloseButton={false}\n\tmessage={this.state.errorMessage.toString()}\n\t/>\n\n\t\t);\n\t}\n\t\n\trenderLoadingProgress() {\n\t\tconst { classes } = this.props;\n\t\treturn (\n\n<Grid\n\tkey=\"loadingProcess\" \n\tcontainer\n\tspacing={0}\n\tdirection=\"column\"\n\tjustify=\"center\"\n\talignItems=\"center\"\n\tstyle={{ minHeight: \"100vh\" }}\n\t>\n\n\t<CircularProgress />\n\t<Typography className={classes.loading}>{i18n.t('Retrieving settings')}...</Typography>\n\n</Grid>\n\n\t\t);\n\t};\n\t\n\trenderLoadingSkeleton(props) {\n\t\tconst { classes } = this.props;\n\t\tconst { topBar, tabBar, gridColumns } = props;\n\t\t\n\t\tconst SkeletonLoader = (props) => <Skeleton animation=\"wave\" variant=\"rect\" className={classes.gridItem} height={props.height} />;\n\t\t\n\t\tlet gridContents = {}\n\t\tfor (let column = 1; column <= gridColumns; column++) {\n\t\t\tgridContents[column] = gridContents[column] || [];\n\t\t\t\n\t\t\tlet loaders = Math.random() * (5 - 2) + 2;\n\t\t\tfor (let loader = 1; loader <= loaders; loader++) {\n\t\t\t\tgridContents[column].push(<SkeletonLoader key={column + '#' + loader} height={(Math.random() * (400 - 100) + 100)} />);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn (\n\n<React.Fragment>\n\t{topBar && <Skeleton animation=\"wave\" variant=\"rect\" height={64} />}\n\t{tabBar && <Skeleton animation=\"wave\" variant=\"rect\" height={48} />}\n\t<GridContainer key=\"loadingSkeleton\" contents={gridContents} />\n</React.Fragment>\n\n\t\t);\n\t}\n\t\n    render() {\n\t\t\n\t\t// error message\n\t\tconst error = this.state.error ? this.renderError() : null;\n\t\t\n\t\t// loading screens\n\t\tif (this.state.error && this.state.loaded.length < 2) {\n\t\t\treturn error;\n\t\t}\n\t\telse if (this.state.loaded.indexOf('settings') === -1) {\n\t\t\treturn this.renderLoadingProgress();\n\t\t}\n\t\telse if (this.state.loaded.indexOf('groups') === -1) {\n\t\t\tconst tab = Object.keys(this.settings.layout)[0];\n\t\t\treturn this.renderLoadingSkeleton({ topBar: true, tabBar: tab !== 1, gridColumns: (tab !== 1 ? Object.keys(this.settings.layout[tab]).length : tab.length) });\n\t\t}\n\t\t\n\t\t// App\n\t\treturn [ error, <Jarvis key=\"jarvis\" settings={this.settings} groups={this.groups} /> ];\n\t};\n}\n\nexport default withStyles(styles)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","/**\r\n *\r\n *\r\n */\r\nfunction HsvToRgb(h, s = 1, v = 1) {\r\n\tif (Array.isArray(h)) {\r\n\t\tv = h[2];\r\n\t\ts = h[1];\r\n\t\th = h[0];\r\n\t}\r\n\telse if (typeof h === 'string' && h.indexOf(',')) {\r\n\t\t[h, s, v] = h.split(',');\r\n\t}\r\n\t\r\n\tif (h > 1) {\r\n\t\th = h/360;\r\n\t}\r\n\t\r\n\tlet r, g, b, i, f, p, q, t;\r\n\t\r\n\ti = Math.floor(h * 6);\r\n\tf = h * 6 - i;\r\n\tp = v * (1 - s);\r\n\tq = v * (1 - f * s);\r\n\tt = v * (1 - (1 - f) * s);\r\n\t\r\n\tswitch (i % 6) {\r\n\t\tcase 0:\r\n\t\t\tr = v;\r\n\t\t\tg = t;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\t\r\n\t\tcase 1:\r\n\t\t\tr = q;\r\n\t\t\tg = v;\r\n\t\t\tb = p;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 2:\r\n\t\t\tr = p;\r\n\t\t\tg = v;\r\n\t\t\tb = t;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 3:\r\n\t\t\tr = p;\r\n\t\t\tg = q;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 4:\r\n\t\t\tr = t;\r\n\t\t\tg = p;\r\n\t\t\tb = v;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tcase 5:\r\n\t\t\tr = v;\r\n\t\t\tg = p;\r\n\t\t\tb = q;\r\n\t\t\tbreak;\r\n\t\t\r\n\t\tdefault: // for webpack\r\n\t\t\tbreak;\r\n\t}\r\n\t\r\n\treturn [\r\n\t\tMath.round(r * 255),\r\n\t\tMath.round(g * 255),\r\n\t\tMath.round(b * 255)\r\n\t];\r\n}\r\n\r\n\r\n/**\r\n *\r\n *\r\n */\r\nfunction RgbToHex(r, g, b) {\r\n\tif (Array.isArray(r)) {\r\n\t\tb = r[2];\r\n\t\tg = r[1];\r\n\t\tr = r[0];\r\n\t}\r\n\telse if (typeof r === 'string' && r.indexOf(',')) {\r\n\t\t[r, g, b] = r.split(',');\r\n\t}\r\n\t\r\n\tr = parseInt(r).toString(16);\r\n\tg = parseInt(g).toString(16);\r\n\tb = parseInt(b).toString(16);\r\n\t\r\n\tif (r.length === 1) r = '0' + r;\r\n\tif (g.length === 1) g = '0' + g;\r\n\tif (b.length === 1) b = '0' + b;\r\n\t\r\n\treturn \"#\" + r + g + b;\r\n}\r\n\r\n\r\nexport default {\r\n\tHsvToRgb,\r\n\tRgbToHex\r\n}","import React, { useState, useEffect } from 'react'\r\nimport { HuePicker, SketchPicker as ColorPicker } from 'react-color'\r\n\r\nimport helpers from '../helpers/colorConverters'\r\nimport defaults from './defaults'\r\n\r\n\r\n/*\r\n * ACTIONS\r\n *\r\n */\r\nfunction LightLevelAction(props) {\r\n\tconst { device, state, stateKey, stateVal } = props;\r\n\t\r\n\tconst onChange = (e) => {\r\n\t\tsetChecked(e.target.checked);\r\n\t\tdevice.setDeviceState(stateKey, e.target.checked ? 100 : 0).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [checked, setChecked] = useState(stateVal > 0);\r\n\tuseEffect(() => setChecked(stateVal > 0), [stateVal]);\r\n\t\r\n\t// only show percentage if device has a switch itself\r\n\tif (device.parent && device.parent.states.power) {\r\n\t\treturn <defaults.actions.Action device={device} state={state} stateKey={stateKey} stateVal={checked} onChange={onChange} />;\r\n\t}\r\n\t\r\n\treturn <defaults.actions.PowerAction device={device} state={state} stateKey={stateKey} stateVal={checked} onChange={onChange} />\r\n}\r\n\r\nfunction LightColorAction(props) {\r\n\tconst { stateKey, stateVal } = props;\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(stateVal);\r\n\tuseEffect(() => setColorSpace(stateVal), [stateVal]);\r\n\t\r\n\tlet colors, labels = {};\r\n\tif (stateKey === 'rgb' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Red: colors[0], Green: colors[1], Blue: colors[2] };\r\n\t\t\r\n\t}\r\n\telse if (stateKey === 'hsv' && colorSpace) {\r\n\t\tcolors = colorSpace.split(',');\r\n\t\tlabels = { Hue: colors[0], Saturation: colors[1], Brightness: colors[2] };\r\n\t}\r\n\t\r\n\tconst Label = defaults.components.Label;\r\n\tlet label = [];\r\n\tfor (let key in labels) {\r\n\t\tlabel.push(<Label key={key} label={key + ' ' + labels[key]} br={true} />);\r\n\t}\r\n\t\r\n\treturn label;\r\n}\r\n\r\n\r\n/*\r\n * COMPONENTS\r\n *\r\n */\r\nfunction LightColorTemperatureComponent(props) {\r\n\tconst Level = defaults.components.LevelComponent;\r\n\treturn (\r\n\t\t<Level min={2000} max={6500} step={10} {...props} />\r\n\t);\r\n}\r\n\r\nfunction LightHueComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tsetHue(Math.round(color.hsl.h));\r\n\t\tdevice.setDeviceState(stateKey, Math.round(color.hsl.h)).catch(err => console.error(err));\r\n\t}\r\n\t\r\n\tconst [hue, setHue] = useState(stateVal);\r\n\tuseEffect(() => setHue(stateVal), [stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\tconst color = helpers.RgbToHex(helpers.HsvToRgb(hue));\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<HuePicker\r\n\t\tcolor={color}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\nfunction LightColorComponent(props) {\r\n\tconst { device, stateKey, stateVal, title } = props;\r\n\t\r\n\tconst onChangeComplete = (color, e) => {\r\n\t\tcolor = color[stateKey];\r\n\t\t\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tcolor = [color.r, color.g, color.b].join(',');\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tcolor = [color.h, color.s, color.v].join(',');\r\n\t\t}\r\n\t\t\r\n\t\tdevice.setDeviceState(stateKey, color).catch(err => console.error(err));\r\n\t};\r\n\t\r\n\tlet initialColor = stateVal || '#ffffff';\r\n\t\r\n\t// RGB\r\n\tif (stateKey === 'rgb') {\r\n\t\tinitialColor = helpers.RgbToHex(initialColor);\r\n\t}\r\n\t// HSV\r\n\telse if (stateKey === 'hsv') {\r\n\t\tinitialColor = helpers.RgbToHex(helpers.HsvToRgb(initialColor));\r\n\t}\r\n\t\r\n\tconst [colorSpace, setColorSpace] = useState(initialColor);\r\n\tuseEffect(() => {\r\n\t\t// RGB\r\n\t\tif (stateKey === 'rgb') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(stateVal));\r\n\t\t}\r\n\t\t// HSV\r\n\t\telse if (stateKey === 'hsv') {\r\n\t\t\tsetColorSpace(helpers.RgbToHex(helpers.HsvToRgb(stateVal)));\r\n\t\t}\r\n\t\t// HEX\r\n\t\telse if (stateKey === 'hex') {\r\n\t\t\tsetColorSpace(stateVal);\r\n\t\t}\r\n\t}, [stateKey, stateVal]);\r\n\t\r\n\tconst Component = defaults.components.Component;\r\n\treturn (\r\n\r\n<Component title={title || stateKey }>\r\n\t<ColorPicker\r\n\t\tcolor={colorSpace}\r\n\t\twidth={'100%'}\r\n\t\tonChangeComplete={onChangeComplete}\r\n\t\t/>\r\n\t\t\r\n</Component>\r\n\r\n\t);\r\n}\r\n\r\n\r\nconst color = {\r\n\ticon: {\r\n\t\t'default': 'palette',\r\n\t},\r\n\tunit: ' °'\r\n}\r\n\r\nexport default {\r\n\tconfigurations: {\r\n\t\tpower: {\r\n\t\t\ticon: {\r\n\t\t\t\t'true': 'lightbulb-on',\r\n\t\t\t\t'false': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t},\r\n\t\tlevel: {\r\n\t\t\tvalue: (val) => val > 0 && val <= 1 ? val * 100 : val,\r\n\t\t\tunit: (value) => value !== 'off' ? ' %' : null,\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'lightbulb-on',\r\n\t\t\t\t'0': 'lightbulb-off-outline'\r\n\t\t\t},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': 'off'\r\n\t\t\t},\r\n\t\t},\r\n\t\tcolorTemperature: {\r\n\t\t\ticon: {\r\n\t\t\t\t'default': 'thermometer',\r\n\t\t\t},\r\n\t\t\tunit: ' °K'\r\n\t\t},\r\n\t\thue: color,\r\n\t\trgb: color,\r\n\t\thsv: color,\r\n\t\thex: color\r\n\t},\r\n\tcomponents: {\r\n\t\tlevel: defaults.components.LevelComponent,\r\n\t\tcolorTemperature: LightColorTemperatureComponent,\r\n\t\trgb: LightColorComponent,\r\n\t\thsv: LightColorComponent,\r\n\t\thex: LightColorComponent,\r\n\t\thue: LightHueComponent\r\n\t},\r\n\tactions: {\r\n\t\tpower: defaults.actions.PowerAction,\r\n\t\tlevel: LightLevelAction,\r\n\t\trgb: LightColorAction,\r\n\t\thsv: LightColorAction,\r\n\t\thex: LightColorAction\r\n\t},\r\n\tstyles: {\r\n\t\t_any: {\r\n\t\t\t//icon: {},\r\n\t\t\tstate: {\r\n\t\t\t\t'0': {\r\n\t\t\t\t\t'color': '#999'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}"],"sourceRoot":""}